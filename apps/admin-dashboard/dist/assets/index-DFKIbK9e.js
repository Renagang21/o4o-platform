import{r as e,j as s,cO as t,cP as r,cQ as o,u as a,cu as l,V as i}from"./vendor-react-BQ6HOJoh.js";import{c as n,I as c,B as d,b as u}from"./page-template-editor-C7FodHrK.js";import{av as m}from"./wp-misc-DS9m4_P2.js";import{u as p,a as h,b}from"./vendor-query-LYSOqK5P.js";import{u as j,B as g,R as w}from"./RowActions-CWtgHhRk.js";import{C as x}from"./checkbox-BfnqKnJs.js";import{u as y,S as f}from"./ScreenMeta-tTmyBJz3.js";import"./wp-block-editor-a11y-DrduSWFW.js";import"./wp-block-editor-misc-pHCPYvR2.js";import"./wp-block-editor-api-Buev8_QU.js";import"./wp-block-editor-utils-M5qXzE1L.js";import"./wp-block-editor-colors-D38h-Odz.js";import"./wp-blocks-core-6vwQKPfS.js";import"./wp-block-editor-clipboard-Dg0Y1gQ6.js";import"./wp-block-editor-store-B-g1aSix.js";import"./vendor-ui-CrFdsnXa.js";import"./wp-block-editor-dnd-BYoS8-II.js";import"./wp-block-editor-library-BpQvynjE.js";import"./wp-block-editor-menus-BTQ2wZ-f.js";import"./wp-block-editor-keyboard-CeHTtvP5.js";import"./wp-block-editor-typography-Bl_1REQP.js";import"./wp-block-editor-spacing-BD_2CpN7.js";import"./wp-block-editor-core-DL280tSA.js";import"./wp-block-editor-selection-CC4tJpUu.js";import"./wp-block-editor-formats-CLXkimOp.js";import"./wp-block-editor-inline-CpXpUhQU.js";import"./wp-block-editor-ui-B8YE_4QL.js";import"./wp-block-editor-transforms-jLcKa8Hv.js";import"./wp-block-editor-preview-iw2Xu1ib.js";import"./wp-block-editor-global-styles-CV5-K6QF.js";import"./wp-block-editor-borders-BH1devca.js";import"./wp-block-editor-patterns-BXdHo9lm.js";import"./wp-block-editor-navigation-BFSoKzg0.js";import"./wp-block-editor-media-Bg-JiQDT.js";import"./wp-api-BeoadipR.js";import"./wp-i18n-DGPtqsXY.js";import"./wp-core-Y-jV-nrZ.js";import"./vendor-monaco-BxJH8uUv.js";import"./wp-block-editor-upload-BLw1R9wP.js";import"./vendor-utils-D-spY-QM.js";import"./wp-block-editor-templates-o1_wAMb9.js";import"./wp-data-BmtL8k4r.js";import"./wp-components-CeQNCpMW.js";import"./index-C-wyiE3c.js";import"./vendor-socket-CMcZe9fK.js";const k=e.forwardRef(({className:e,...r},o)=>s.jsx(t,{ref:o,className:n("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...r}));k.displayName=t.displayName;const N=e.forwardRef(({className:e,...t},o)=>s.jsx(r,{ref:o,className:n("aspect-square h-full w-full",e),...t}));N.displayName=r.displayName;const v=e.forwardRef(({className:e,...t},r)=>s.jsx(o,{ref:r,className:n("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));v.displayName=o.displayName;const A=({columns:e,data:t,idField:r="id",isAllSelected:o,isSomeSelected:a,onToggleAll:l,onToggleItem:i,isSelected:n,onRowClick:c,rowActions:d,emptyMessage:u="No items found"})=>s.jsxs("table",{className:"wp-list-table widefat fixed striped",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsxs("td",{className:"manage-column column-cb check-column",children:[s.jsx("label",{className:"screen-reader-text",htmlFor:"cb-select-all",children:"Select All"}),s.jsx(x,{id:"cb-select-all",checked:o,indeterminate:a,onCheckedChange:l})]}),e.map(e=>s.jsx("th",{scope:"col",className:`manage-column column-${e.key}${e.sortable?" sortable":""}`,children:e.sortable?s.jsxs("a",{href:"#",children:[s.jsx("span",{children:e.label}),s.jsx("span",{className:"sorting-indicator"})]}):e.label},e.key))]})}),s.jsx("tbody",{children:0===t.length?s.jsx("tr",{children:s.jsx("td",{colSpan:e.length+1,className:"colspanchange",children:u})}):t.map((t,o)=>{const a=String(t[r]),l=n(a);return s.jsxs("tr",{className:`${l?"selected":""} ${o%2==0?"alternate":""}`,children:[s.jsxs("th",{scope:"row",className:"check-column",children:[s.jsxs("label",{className:"screen-reader-text",htmlFor:`cb-select-${a}`,children:["Select ",t.title||t.name||`Item ${a}`]}),s.jsx(x,{id:`cb-select-${a}`,checked:l,onCheckedChange:()=>i(a),onClick:e=>e.stopPropagation()})]}),e.map(r=>s.jsxs("td",{className:`column-${r.key}`,onClick:()=>c?.(t),style:{cursor:c?"pointer":"default"},children:[r.render?r.render(t):t[r.key],r.key===e[0].key&&d&&s.jsx("div",{className:"row-actions",children:d(t)})]},r.key))]},a)})}),s.jsx("tfoot",{children:s.jsxs("tr",{children:[s.jsxs("td",{className:"manage-column column-cb check-column",children:[s.jsx("label",{className:"screen-reader-text",htmlFor:"cb-select-all-2",children:"Select All"}),s.jsx(x,{id:"cb-select-all-2",checked:o,indeterminate:a,onCheckedChange:l})]}),e.map(e=>s.jsx("th",{scope:"col",className:`manage-column column-${e.key}`,children:e.label},e.key))]})})]}),C=()=>(y([{id:"overview",title:"Overview",content:"\n        <p>This screen lists all the existing users for your site. Each user has one of five defined roles as set by the site admin: Site Administrator, Editor, Author, Contributor, or Subscriber. Users with roles other than Administrator will see fewer options when they are logged in, based on their role.</p>\n        <p>To add a new user for your site, click the Add New button at the top of the screen or Add New in the Users menu section.</p>\n      "},{id:"user-roles",title:"User Roles",content:"\n        <p>WordPress uses a concept of Roles, designed to give the site owner the ability to control what users can and cannot do within the site.</p>\n        <p><strong>The default roles are:</strong></p>\n        <ul>\n          <li><strong>Administrator</strong> - Complete access to all administration features</li>\n          <li><strong>Editor</strong> - Can publish and manage posts including those of other users</li>\n          <li><strong>Author</strong> - Can publish and manage their own posts</li>\n          <li><strong>Contributor</strong> - Can write and manage their own posts but cannot publish them</li>\n          <li><strong>Subscriber</strong> - Can only manage their profile</li>\n        </ul>\n      "},{id:"actions",title:"Available Actions",content:"\n        <p>Hovering over a row in the users list will display action links that allow you to manage users. You can perform the following actions:</p>\n        <ul>\n          <li><strong>Edit</strong> takes you to the editable profile screen for that user. You can also reach that screen by clicking on the username.</li>\n          <li><strong>Delete</strong> brings you to the Delete Users screen for confirmation, where you can permanently remove a user from your site and delete or attribute their content to another user.</li>\n          <li><strong>View</strong> takes you to their author archive page.</li>\n          <li><strong>Send password reset</strong> sends an email to the user with a link to reset their password.</li>\n        </ul>\n      "},{id:"bulk-actions",title:"Bulk Actions",content:"\n        <p>You can perform bulk actions on multiple users at once:</p>\n        <ul>\n          <li><strong>Delete</strong> - Remove multiple users at once</li>\n          <li><strong>Change role to...</strong> - Update the role for multiple users simultaneously</li>\n          <li><strong>Send password reset</strong> - Send password reset emails to multiple users</li>\n        </ul>\n        <p>Select the users you want to act on using the checkboxes, then select the action from the Bulk actions menu and click Apply.</p>\n      "}],{title:"For more information:",content:'\n      <p><a href="https://wordpress.org/support/article/users-screen/" target="_blank">Documentation on Managing Users</a></p>\n      <p><a href="https://wordpress.org/support/article/roles-and-capabilities/" target="_blank">Roles and Capabilities</a></p>\n      <p><a href="https://wordpress.org/support/" target="_blank">Support Forums</a></p>\n    '}),null),S=()=>{const t=a(),r=p(),[o,n]=e.useState(""),[x,y]=e.useState("all"),{data:S=[],isLoading:$,error:F}=h({queryKey:["users",x,o],queryFn:async()=>{const e=new URLSearchParams;"all"!==x&&e.set("role",x),o&&e.set("search",o);const s=await u.api.get(`/users?${e}`);return s.data?.data?.users?s.data.data.users:Array.isArray(s.data)?s.data:[]}}),E=b({mutationFn:async e=>{await Promise.all(e.map(e=>u.api.delete(`/users/${e}`)))},onSuccess:()=>{r.invalidateQueries({queryKey:["users"]}),i.success("Selected users deleted successfully")},onError:()=>{i.error("Failed to delete some users")}}),P=b({mutationFn:async({ids:e,role:s})=>{await Promise.all(e.map(e=>u.api.patch(`/users/${e}`,{role:s})))},onSuccess:()=>{r.invalidateQueries({queryKey:["users"]}),i.success("User roles updated successfully")},onError:()=>{i.error("Failed to update some users")}}),R=b({mutationFn:async e=>{await Promise.all(e.map(e=>u.api.post(`/users/${e}/send-password-reset`)))},onSuccess:()=>{i.success("Password reset emails sent successfully")},onError:()=>{i.error("Failed to send some emails")}}),U=[{value:"delete",label:"Delete",action:async e=>{await E.mutateAsync(e)},confirmMessage:"Are you sure you want to delete {count} user(s)? This cannot be undone.",isDestructive:!0},{value:"role-subscriber",label:"Change role to Subscriber",action:async e=>{await P.mutateAsync({ids:e,role:"subscriber"})}},{value:"role-contributor",label:"Change role to Contributor",action:async e=>{await P.mutateAsync({ids:e,role:"contributor"})}},{value:"role-author",label:"Change role to Author",action:async e=>{await P.mutateAsync({ids:e,role:"author"})}},{value:"role-editor",label:"Change role to Editor",action:async e=>{await P.mutateAsync({ids:e,role:"editor"})}},{value:"send-password-reset",label:"Send password reset",action:async e=>{await R.mutateAsync(e)},confirmMessage:"Send password reset email to {count} user(s)?"}],{selectedCount:D,isAllSelected:T,isSomeSelected:q,isProcessing:B,toggleAll:M,toggleItem:I,executeBulkAction:K,isSelected:L}=j({items:S,idField:"id",actions:U}),O=[{key:"username",label:"Username",sortable:!0,render:e=>s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(k,{className:"h-8 w-8",children:[s.jsx(N,{src:e.avatar,alt:e.name}),s.jsx(v,{children:e.name?.substring(0,2).toUpperCase()})]}),s.jsx("div",{children:s.jsx(l,{to:`/users/${e.id}/edit`,className:"font-medium text-blue-600 hover:text-blue-800",children:e.name})})]})},{key:"name",label:"Name",render:e=>e.name},{key:"email",label:"Email",render:e=>s.jsx("a",{href:`mailto:${e.email}`,className:"text-blue-600 hover:text-blue-800",children:e.email})},{key:"role",label:"Role",render:e=>s.jsx(m,{variant:"secondary",children:e.role})},{key:"posts",label:"Posts",render:e=>s.jsx("div",{className:"text-center",children:s.jsx("a",{href:`/posts?author=${e.id}`,className:"text-blue-600 hover:text-blue-800",children:e.posts||0})})}],Q={all:S.length,administrator:S.filter(e=>"administrator"===e.role).length,editor:S.filter(e=>"editor"===e.role).length,author:S.filter(e=>"author"===e.role).length,contributor:S.filter(e=>"contributor"===e.role).length,subscriber:S.filter(e=>"subscriber"===e.role).length};return s.jsxs("div",{className:"wrap",children:[s.jsx(C,{}),s.jsx(f,{}),s.jsx("h1",{className:"wp-heading-inline",children:"Users"}),s.jsx(l,{to:"/users/add",className:"page-title-action",children:"Add New"}),s.jsx("hr",{className:"wp-header-end"}),s.jsxs("ul",{className:"subsubsub",children:[s.jsxs("li",{className:"all",children:[s.jsxs("a",{href:"#",className:"all"===x?"current":"",onClick:()=>y("all"),children:["All ",s.jsxs("span",{className:"count",children:["(",Q.all,")"]})]})," |"]}),s.jsxs("li",{className:"administrator",children:[s.jsxs("a",{href:"#",className:"administrator"===x?"current":"",onClick:()=>y("administrator"),children:["Administrator ",s.jsxs("span",{className:"count",children:["(",Q.administrator,")"]})]})," |"]}),s.jsxs("li",{className:"editor",children:[s.jsxs("a",{href:"#",className:"editor"===x?"current":"",onClick:()=>y("editor"),children:["Editor ",s.jsxs("span",{className:"count",children:["(",Q.editor,")"]})]})," |"]}),s.jsxs("li",{className:"author",children:[s.jsxs("a",{href:"#",className:"author"===x?"current":"",onClick:()=>y("author"),children:["Author ",s.jsxs("span",{className:"count",children:["(",Q.author,")"]})]})," |"]}),s.jsxs("li",{className:"contributor",children:[s.jsxs("a",{href:"#",className:"contributor"===x?"current":"",onClick:()=>y("contributor"),children:["Contributor ",s.jsxs("span",{className:"count",children:["(",Q.contributor,")"]})]})," |"]}),s.jsx("li",{className:"subscriber",children:s.jsxs("a",{href:"#",className:"subscriber"===x?"current":"",onClick:()=>y("subscriber"),children:["Subscriber ",s.jsxs("span",{className:"count",children:["(",Q.subscriber,")"]})]})})]}),s.jsxs("div",{className:"search-box",children:[s.jsx(c,{type:"search",placeholder:"Search users...",value:o,onChange:e=>n(e.target.value),className:"w-[300px]"}),s.jsx(d,{variant:"secondary",children:"Search Users"})]}),s.jsx(g,{actions:U,selectedCount:D,onActionExecute:K,isProcessing:B,position:"top"}),$?s.jsx("div",{className:"text-center py-8",children:"Loading users..."}):F?s.jsx("div",{className:"text-center py-8 text-red-600",children:"Error loading users"}):s.jsx(A,{columns:O,data:S,idField:"id",isAllSelected:T,isSomeSelected:q,onToggleAll:M,onToggleItem:I,isSelected:L,rowActions:e=>{const r=[{label:"Edit",onClick:()=>t(`/users/${e.id}/edit`)},{label:"Delete",onClick:async()=>{confirm(`Delete user ${e.name}?`)&&await E.mutateAsync([e.id])},className:"text-red-600"},{label:"View",onClick:()=>t(`/users/${e.id}`)},{label:"Send password reset",onClick:async()=>{await R.mutateAsync([e.id])}}];return s.jsx(w,{actions:r})},emptyMessage:"No users found"}),s.jsx(g,{actions:U,selectedCount:D,onActionExecute:K,isProcessing:B,position:"bottom"})]})};function $(){return s.jsx(S,{})}export{$ as default};
