import{r as x,j as e,a1 as L,a2 as V,a3 as W,$ as _,O as M,V as g}from"./vendor-react-BZRIq8oW.js";import{c as Q,B as j,L as i,I as c,T as S,W as $,a as z,b as K,d as v,e as f,S as B,f as F,g as T,h as D,i as o,j as y}from"./page-gutenberg-iVBL5IS_.js";import{u as R,a as O,b as E}from"./vendor-query-GrNIwsDq.js";import{s as G}from"./wp-blocks-CnCGET8b.js";const N=x.forwardRef(({className:p,checked:d,onCheckedChange:m,onChange:l,...s},t)=>e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",ref:t,checked:d,onChange:u=>{l?.(u),m?.(u.target.checked)},className:"sr-only peer",...s}),e.jsx("div",{className:Q("w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-2","peer-focus:ring-blue-500 peer-focus:ring-offset-2 rounded-full","peer peer-checked:after:translate-x-full peer-checked:after:border-white","after:content-[''] after:absolute after:top-[2px] after:left-[2px]","after:bg-white after:border-gray-300 after:border after:rounded-full","after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600","peer-disabled:opacity-50 peer-disabled:cursor-not-allowed",p)})]}));N.displayName="Switch";function H(){const p=L(),{id:d}=V(),m=R(),l=d&&d!=="new",[s,t]=x.useState({name:"",slug:"",description:"",area:"general",content:[],settings:{containerWidth:"wide",backgroundColor:"",textColor:"",padding:{top:"",bottom:"",left:"",right:""},customCss:""},isActive:!0,isDefault:!1,priority:0,conditions:{pages:[],postTypes:[],categories:[],userRoles:[]}}),[u,b]=x.useState([]),{data:n,isLoading:A}=O({queryKey:["template-part",d],queryFn:async()=>l?(await y.api.get(`/template-parts/${d}`)).data:null,enabled:!!l});x.useEffect(()=>{n&&(t({name:n.name,slug:n.slug,description:n.description||"",area:n.area,content:n.content,settings:{...s.settings,...n.settings},isActive:n.isActive,isDefault:n.isDefault,priority:n.priority||0,conditions:n.conditions||s.conditions}),b(n.content))},[n]);const w=E({mutationFn:async a=>(await y.api.post("/template-parts",a)).data,onSuccess:()=>{g.success("템플릿 파트가 생성되었습니다"),m.invalidateQueries({queryKey:["template-parts"]}),p("/appearance/template-parts")},onError:()=>{g.error("템플릿 파트 생성에 실패했습니다")}}),C=E({mutationFn:async a=>(await y.api.put(`/template-parts/${d}`,a)).data,onSuccess:()=>{g.success("템플릿 파트가 수정되었습니다"),m.invalidateQueries({queryKey:["template-parts"]}),m.invalidateQueries({queryKey:["template-part",d]})},onError:()=>{g.error("템플릿 파트 수정에 실패했습니다")}}),P=(a,r)=>{b(r)},I=()=>{const a=u.map(h=>({id:h.clientId,type:h.name,data:h.attributes,innerBlocks:h.innerBlocks?k(h.innerBlocks):void 0})),r={...s,content:a};l?C.mutate(r):w.mutate(r)},k=a=>a.map(r=>({id:r.clientId,type:r.name,data:r.attributes,innerBlocks:r.innerBlocks?k(r.innerBlocks):void 0})),q=a=>a.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");return l&&A?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs(j,{variant:"ghost",size:"sm",onClick:()=>p("/appearance/template-parts"),children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"템플릿 파트 목록"]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:l?"템플릿 파트 수정":"새 템플릿 파트"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx("div",{className:"wp-card",children:e.jsxs("div",{className:"wp-card-body space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"name",children:"이름"}),e.jsx(c,{id:"name",value:s.name,onChange:a=>{t({...s,name:a.target.value}),!l&&!s.slug&&t(r=>({...r,slug:q(a.target.value)}))},placeholder:"템플릿 파트 이름",className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"slug",children:"슬러그"}),e.jsx(c,{id:"slug",value:s.slug,onChange:a=>t({...s,slug:a.target.value}),placeholder:"template-part-slug",className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"description",children:"설명 (선택사항)"}),e.jsx(S,{id:"description",value:s.description,onChange:a=>t({...s,description:a.target.value}),placeholder:"이 템플릿 파트에 대한 설명",className:"mt-2",rows:3})]})]})}),e.jsxs("div",{className:"wp-card",children:[e.jsx("div",{className:"wp-card-header",children:e.jsx("h2",{className:"text-lg font-medium",children:"콘텐츠 편집"})}),e.jsx("div",{className:"wp-card-body",children:e.jsx($,{initialContent:G(u),onChange:P,showReusableBlocks:!0})})]}),e.jsx("div",{className:"wp-card",children:e.jsx("div",{className:"wp-card-body",children:e.jsxs(z,{defaultValue:"styles",children:[e.jsxs(K,{children:[e.jsx(v,{value:"styles",children:"스타일"}),e.jsx(v,{value:"conditions",children:"조건"}),e.jsx(v,{value:"advanced",children:"고급"})]}),e.jsxs(f,{value:"styles",className:"space-y-4 mt-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"containerWidth",children:"컨테이너 너비"}),e.jsxs(B,{value:s.settings.containerWidth,onValueChange:a=>t({...s,settings:{...s.settings,containerWidth:a}}),children:[e.jsx(F,{className:"mt-2",children:e.jsx(T,{})}),e.jsxs(D,{children:[e.jsx(o,{value:"full",children:"전체 너비"}),e.jsx(o,{value:"wide",children:"넓은 너비 (max-w-7xl)"}),e.jsx(o,{value:"narrow",children:"좁은 너비 (max-w-4xl)"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"backgroundColor",children:"배경색"}),e.jsx(c,{id:"backgroundColor",type:"color",value:s.settings.backgroundColor||"#ffffff",onChange:a=>t({...s,settings:{...s.settings,backgroundColor:a.target.value}}),className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"textColor",children:"텍스트 색상"}),e.jsx(c,{id:"textColor",type:"color",value:s.settings.textColor||"#000000",onChange:a=>t({...s,settings:{...s.settings,textColor:a.target.value}}),className:"mt-2"})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"패딩"}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 mt-2",children:[e.jsx(c,{placeholder:"상단",value:s.settings.padding?.top||"",onChange:a=>t({...s,settings:{...s.settings,padding:{...s.settings.padding,top:a.target.value}}})}),e.jsx(c,{placeholder:"우측",value:s.settings.padding?.right||"",onChange:a=>t({...s,settings:{...s.settings,padding:{...s.settings.padding,right:a.target.value}}})}),e.jsx(c,{placeholder:"하단",value:s.settings.padding?.bottom||"",onChange:a=>t({...s,settings:{...s.settings,padding:{...s.settings.padding,bottom:a.target.value}}})}),e.jsx(c,{placeholder:"좌측",value:s.settings.padding?.left||"",onChange:a=>t({...s,settings:{...s.settings,padding:{...s.settings.padding,left:a.target.value}}})})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"customCss",children:"사용자 정의 CSS"}),e.jsx(S,{id:"customCss",value:s.settings.customCss||"",onChange:a=>t({...s,settings:{...s.settings,customCss:a.target.value}}),placeholder:".template-part-header { /* CSS */ }",className:"mt-2 font-mono text-sm",rows:5})]})]}),e.jsxs(f,{value:"conditions",className:"space-y-4 mt-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"특정 페이지나 조건에서만 이 템플릿 파트가 표시되도록 설정할 수 있습니다."}),e.jsx("div",{className:"text-center py-8 text-gray-500",children:"조건부 표시 설정은 추후 업데이트될 예정입니다."})]}),e.jsx(f,{value:"advanced",className:"space-y-4 mt-4",children:e.jsxs("div",{children:[e.jsx(i,{htmlFor:"priority",children:"우선순위"}),e.jsx(c,{id:"priority",type:"number",value:s.priority,onChange:a=>t({...s,priority:parseInt(a.target.value)||0}),className:"mt-2"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"같은 영역에 여러 템플릿 파트가 있을 때 표시 순서를 결정합니다. (낮은 숫자가 먼저 표시)"})]})})]})})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"wp-card",children:[e.jsx("div",{className:"wp-card-header",children:e.jsx("h3",{className:"font-medium",children:"게시"})}),e.jsxs("div",{className:"wp-card-body space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"영역:"}),e.jsxs(B,{value:s.area,onValueChange:a=>t({...s,area:a}),children:[e.jsx(F,{className:"w-32",children:e.jsx(T,{})}),e.jsxs(D,{children:[e.jsx(o,{value:"header",children:"헤더"}),e.jsx(o,{value:"footer",children:"푸터"}),e.jsx(o,{value:"sidebar",children:"사이드바"}),e.jsx(o,{value:"general",children:"일반"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{htmlFor:"isActive",className:"text-sm",children:"활성화"}),e.jsx(N,{id:"isActive",checked:s.isActive,onCheckedChange:a=>t({...s,isActive:a})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{htmlFor:"isDefault",className:"text-sm",children:"기본 템플릿"}),e.jsx(N,{id:"isDefault",checked:s.isDefault,onCheckedChange:a=>t({...s,isDefault:a})})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsxs(j,{className:"w-full",onClick:I,disabled:w.isPending||C.isPending,children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),l?"업데이트":"게시"]})})]})]}),e.jsxs("div",{className:"wp-card",children:[e.jsx("div",{className:"wp-card-header",children:e.jsx("h3",{className:"font-medium",children:"미리보기"})}),e.jsxs("div",{className:"wp-card-body",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"저장 후 사이트에서 실제로 어떻게 보이는지 확인할 수 있습니다."}),e.jsxs(j,{variant:"outline",className:"w-full mt-4",onClick:()=>window.open("/","_blank"),children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"사이트에서 보기"]})]})]})]})]})]})}const Z=Object.freeze(Object.defineProperty({__proto__:null,default:H},Symbol.toStringTag,{value:"Module"}));export{N as S,Z as T};
