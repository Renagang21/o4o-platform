import{r as x,j as e,cc as R,cd as E,ce as U,a1 as V,bT as $,V as p}from"./vendor-react-BZRIq8oW.js";import{c as A,I as H,B as K,s as Y,j as w}from"./page-gutenberg-iVBL5IS_.js";import{u as _,a as O,b as k}from"./vendor-query-GrNIwsDq.js";import{u as W,B as F,R as z}from"./RowActions-BifaUqq2.js";import{C as v}from"./checkbox-C85_75t0.js";import{u as G,S as J}from"./ScreenMeta-mtdxyhTZ.js";import"./wp-block-editor-C14Ds6es.js";import"./wp-blocks-CnCGET8b.js";import"./wp-core-BctBwZpo.js";import"./wp-i18n-Niz9RVma.js";import"./wp-element-CB9_H0_F.js";import"./vendor-ui-BkLtITBR.js";import"./vendor-monaco-cpVGocfO.js";import"./vendor-utils-DQ8F5vJI.js";import"./wp-components-CLkQS2qf.js";import"./main-CHoUfaJq.js";import"./vendor-socket-Ch6lN7-G.js";const B=x.forwardRef(({className:r,...a},l)=>e.jsx(R,{ref:l,className:A("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...a}));B.displayName=R.displayName;const P=x.forwardRef(({className:r,...a},l)=>e.jsx(E,{ref:l,className:A("aspect-square h-full w-full",r),...a}));P.displayName=E.displayName;const D=x.forwardRef(({className:r,...a},l)=>e.jsx(U,{ref:l,className:A("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...a}));D.displayName=U.displayName;const X=({columns:r,data:a,idField:l="id",isAllSelected:y,isSomeSelected:o,onToggleAll:d,onToggleItem:i,isSelected:N,onRowClick:f,rowActions:b,emptyMessage:h="No items found"})=>e.jsxs("table",{className:"wp-list-table widefat fixed striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("td",{className:"manage-column column-cb check-column",children:[e.jsx("label",{className:"screen-reader-text",htmlFor:"cb-select-all",children:"Select All"}),e.jsx(v,{id:"cb-select-all",checked:y,indeterminate:o,onCheckedChange:d})]}),r.map(t=>e.jsx("th",{scope:"col",className:`manage-column column-${t.key}${t.sortable?" sortable":""}`,children:t.sortable?e.jsxs("a",{href:"#",children:[e.jsx("span",{children:t.label}),e.jsx("span",{className:"sorting-indicator"})]}):t.label},t.key))]})}),e.jsx("tbody",{children:a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:r.length+1,className:"colspanchange",children:h})}):a.map((t,g)=>{const u=String(t[l]),j=N(u);return e.jsxs("tr",{className:`${j?"selected":""} ${g%2===0?"alternate":""}`,children:[e.jsxs("th",{scope:"row",className:"check-column",children:[e.jsxs("label",{className:"screen-reader-text",htmlFor:`cb-select-${u}`,children:["Select ",t.title||t.name||`Item ${u}`]}),e.jsx(v,{id:`cb-select-${u}`,checked:j,onCheckedChange:()=>i(u),onClick:c=>c.stopPropagation()})]}),r.map(c=>e.jsxs("td",{className:`column-${c.key}`,onClick:()=>f?.(t),style:{cursor:f?"pointer":"default"},children:[c.render?c.render(t):t[c.key],c.key===r[0].key&&b&&e.jsx("div",{className:"row-actions",children:b(t)})]},c.key))]},u)})}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsxs("td",{className:"manage-column column-cb check-column",children:[e.jsx("label",{className:"screen-reader-text",htmlFor:"cb-select-all-2",children:"Select All"}),e.jsx(v,{id:"cb-select-all-2",checked:y,indeterminate:o,onCheckedChange:d})]}),r.map(t=>e.jsx("th",{scope:"col",className:`manage-column column-${t.key}`,children:t.label},t.key))]})})]}),Z=()=>(G([{id:"overview",title:"Overview",content:`
        <p>This screen lists all the existing users for your site. Each user has one of five defined roles as set by the site admin: Site Administrator, Editor, Author, Contributor, or Subscriber. Users with roles other than Administrator will see fewer options when they are logged in, based on their role.</p>
        <p>To add a new user for your site, click the Add New button at the top of the screen or Add New in the Users menu section.</p>
      `},{id:"user-roles",title:"User Roles",content:`
        <p>WordPress uses a concept of Roles, designed to give the site owner the ability to control what users can and cannot do within the site.</p>
        <p><strong>The default roles are:</strong></p>
        <ul>
          <li><strong>Administrator</strong> - Complete access to all administration features</li>
          <li><strong>Editor</strong> - Can publish and manage posts including those of other users</li>
          <li><strong>Author</strong> - Can publish and manage their own posts</li>
          <li><strong>Contributor</strong> - Can write and manage their own posts but cannot publish them</li>
          <li><strong>Subscriber</strong> - Can only manage their profile</li>
        </ul>
      `},{id:"actions",title:"Available Actions",content:`
        <p>Hovering over a row in the users list will display action links that allow you to manage users. You can perform the following actions:</p>
        <ul>
          <li><strong>Edit</strong> takes you to the editable profile screen for that user. You can also reach that screen by clicking on the username.</li>
          <li><strong>Delete</strong> brings you to the Delete Users screen for confirmation, where you can permanently remove a user from your site and delete or attribute their content to another user.</li>
          <li><strong>View</strong> takes you to their author archive page.</li>
          <li><strong>Send password reset</strong> sends an email to the user with a link to reset their password.</li>
        </ul>
      `},{id:"bulk-actions",title:"Bulk Actions",content:`
        <p>You can perform bulk actions on multiple users at once:</p>
        <ul>
          <li><strong>Delete</strong> - Remove multiple users at once</li>
          <li><strong>Change role to...</strong> - Update the role for multiple users simultaneously</li>
          <li><strong>Send password reset</strong> - Send password reset emails to multiple users</li>
        </ul>
        <p>Select the users you want to act on using the checkboxes, then select the action from the Bulk actions menu and click Apply.</p>
      `}],{title:"For more information:",content:`
      <p><a href="https://wordpress.org/support/article/users-screen/" target="_blank">Documentation on Managing Users</a></p>
      <p><a href="https://wordpress.org/support/article/roles-and-capabilities/" target="_blank">Roles and Capabilities</a></p>
      <p><a href="https://wordpress.org/support/" target="_blank">Support Forums</a></p>
    `}),null),ee=()=>{const r=V(),a=_(),[l,y]=x.useState(""),[o,d]=x.useState("all"),{data:i=[],isLoading:N,error:f}=O({queryKey:["users",o,l],queryFn:async()=>{const s=new URLSearchParams;o!=="all"&&s.set("role",o),l&&s.set("search",l);const n=await w.api.get(`/users?${s}`);return n.data?.data?.users?n.data.data.users:Array.isArray(n.data)?n.data:[]}}),b=k({mutationFn:async s=>{await Promise.all(s.map(n=>w.api.delete(`/users/${n}`)))},onSuccess:()=>{a.invalidateQueries({queryKey:["users"]}),p.success("Selected users deleted successfully")},onError:()=>{p.error("Failed to delete some users")}}),h=k({mutationFn:async({ids:s,role:n})=>{await Promise.all(s.map(L=>w.api.patch(`/users/${L}`,{role:n})))},onSuccess:()=>{a.invalidateQueries({queryKey:["users"]}),p.success("User roles updated successfully")},onError:()=>{p.error("Failed to update some users")}}),t=k({mutationFn:async s=>{await Promise.all(s.map(n=>w.api.post(`/users/${n}/send-password-reset`)))},onSuccess:()=>{p.success("Password reset emails sent successfully")},onError:()=>{p.error("Failed to send some emails")}}),g=[{value:"delete",label:"Delete",action:async s=>{await b.mutateAsync(s)},confirmMessage:"Are you sure you want to delete {count} user(s)? This cannot be undone.",isDestructive:!0},{value:"role-subscriber",label:"Change role to Subscriber",action:async s=>{await h.mutateAsync({ids:s,role:"subscriber"})}},{value:"role-contributor",label:"Change role to Contributor",action:async s=>{await h.mutateAsync({ids:s,role:"contributor"})}},{value:"role-author",label:"Change role to Author",action:async s=>{await h.mutateAsync({ids:s,role:"author"})}},{value:"role-editor",label:"Change role to Editor",action:async s=>{await h.mutateAsync({ids:s,role:"editor"})}},{value:"send-password-reset",label:"Send password reset",action:async s=>{await t.mutateAsync(s)},confirmMessage:"Send password reset email to {count} user(s)?"}],{selectedCount:u,isAllSelected:j,isSomeSelected:c,isProcessing:C,toggleAll:M,toggleItem:T,executeBulkAction:S,isSelected:I}=W({items:i,idField:"id",actions:g}),q=[{key:"username",label:"Username",sortable:!0,render:s=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(B,{className:"h-8 w-8",children:[e.jsx(P,{src:s.avatar,alt:s.name}),e.jsx(D,{children:s.name?.substring(0,2).toUpperCase()})]}),e.jsx("div",{children:e.jsx($,{to:`/users/${s.id}/edit`,className:"font-medium text-blue-600 hover:text-blue-800",children:s.name})})]})},{key:"name",label:"Name",render:s=>s.name},{key:"email",label:"Email",render:s=>e.jsx("a",{href:`mailto:${s.email}`,className:"text-blue-600 hover:text-blue-800",children:s.email})},{key:"role",label:"Role",render:s=>e.jsx(Y,{variant:"secondary",children:s.role})},{key:"posts",label:"Posts",render:s=>e.jsx("div",{className:"text-center",children:e.jsx("a",{href:`/posts?author=${s.id}`,className:"text-blue-600 hover:text-blue-800",children:s.posts||0})})}],Q=s=>{const n=[{label:"Edit",onClick:()=>r(`/users/${s.id}/edit`)},{label:"Delete",onClick:async()=>{confirm(`Delete user ${s.name}?`)&&await b.mutateAsync([s.id])},className:"text-red-600"},{label:"View",onClick:()=>r(`/users/${s.id}`)},{label:"Send password reset",onClick:async()=>{await t.mutateAsync([s.id])}}];return e.jsx(z,{actions:n})},m={all:i.length,administrator:i.filter(s=>s.role==="administrator").length,editor:i.filter(s=>s.role==="editor").length,author:i.filter(s=>s.role==="author").length,contributor:i.filter(s=>s.role==="contributor").length,subscriber:i.filter(s=>s.role==="subscriber").length};return e.jsxs("div",{className:"wrap",children:[e.jsx(Z,{}),e.jsx(J,{}),e.jsx("h1",{className:"wp-heading-inline",children:"Users"}),e.jsx($,{to:"/users/add",className:"page-title-action",children:"Add New"}),e.jsx("hr",{className:"wp-header-end"}),e.jsxs("ul",{className:"subsubsub",children:[e.jsxs("li",{className:"all",children:[e.jsxs("a",{href:"#",className:o==="all"?"current":"",onClick:()=>d("all"),children:["All ",e.jsxs("span",{className:"count",children:["(",m.all,")"]})]})," |"]}),e.jsxs("li",{className:"administrator",children:[e.jsxs("a",{href:"#",className:o==="administrator"?"current":"",onClick:()=>d("administrator"),children:["Administrator ",e.jsxs("span",{className:"count",children:["(",m.administrator,")"]})]})," |"]}),e.jsxs("li",{className:"editor",children:[e.jsxs("a",{href:"#",className:o==="editor"?"current":"",onClick:()=>d("editor"),children:["Editor ",e.jsxs("span",{className:"count",children:["(",m.editor,")"]})]})," |"]}),e.jsxs("li",{className:"author",children:[e.jsxs("a",{href:"#",className:o==="author"?"current":"",onClick:()=>d("author"),children:["Author ",e.jsxs("span",{className:"count",children:["(",m.author,")"]})]})," |"]}),e.jsxs("li",{className:"contributor",children:[e.jsxs("a",{href:"#",className:o==="contributor"?"current":"",onClick:()=>d("contributor"),children:["Contributor ",e.jsxs("span",{className:"count",children:["(",m.contributor,")"]})]})," |"]}),e.jsx("li",{className:"subscriber",children:e.jsxs("a",{href:"#",className:o==="subscriber"?"current":"",onClick:()=>d("subscriber"),children:["Subscriber ",e.jsxs("span",{className:"count",children:["(",m.subscriber,")"]})]})})]}),e.jsxs("div",{className:"search-box",children:[e.jsx(H,{type:"search",placeholder:"Search users...",value:l,onChange:s=>y(s.target.value),className:"w-[300px]"}),e.jsx(K,{variant:"secondary",children:"Search Users"})]}),e.jsx(F,{actions:g,selectedCount:u,onActionExecute:S,isProcessing:C,position:"top"}),N?e.jsx("div",{className:"text-center py-8",children:"Loading users..."}):f?e.jsx("div",{className:"text-center py-8 text-red-600",children:"Error loading users"}):e.jsx(X,{columns:q,data:i,idField:"id",isAllSelected:j,isSomeSelected:c,onToggleAll:M,onToggleItem:T,isSelected:I,rowActions:Q,emptyMessage:"No users found"}),e.jsx(F,{actions:g,selectedCount:u,onActionExecute:S,isProcessing:C,position:"bottom"})]})};function ye(){return e.jsx(ee,{})}export{ye as default};
