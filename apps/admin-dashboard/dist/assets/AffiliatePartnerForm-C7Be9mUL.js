import{a3 as e,a4 as a,r as s,V as i,j as n,a5 as r,a1 as l}from"./vendor-react-Bb0TGSr4.js";import{j as t,B as d,C as c,k as o,l as m,t as h,m as u,L as p,I as x,S as j,f as v,g as b,h as y,i as g,T as f}from"./page-gutenberg-CGPrHM9_.js";import{u as N,a as w,b as F}from"./vendor-query-BEO_OofR.js";import"./vendor-monaco-BxJH8uUv.js";import"./vendor-ui-CrFdsnXa.js";import"./vendor-utils-B-KQWpLj.js";import"./wp-foundation-Ht0JG6Uo.js";import"./wp-components-CoD93iDH.js";const C=()=>{const C=e(),{id:k}=a(),q=N(),E=!!k,[M,R]=s.useState({name:"",email:"",website:"",type:"individual",commissionRate:10,paymentMethod:"bank",notes:""}),{data:H,isLoading:S}=w({queryKey:["affiliate-partner",k],queryFn:async()=>(await t.api.get(`/v1/affiliate/partners/${k}`)).data,enabled:E}),K=H?.data,Q=F({mutationFn:async e=>(await t.api.post("/v1/affiliate/partners",e)).data,onSuccess:()=>{i.success("제휴사가 추가되었습니다"),q.invalidateQueries({queryKey:["affiliate-partners"]}),C("/affiliate/partners")},onError:()=>{i.error("제휴사 추가에 실패했습니다")}}),V=F({mutationFn:async e=>(await t.api.put(`/v1/affiliate/partners/${k}`,e)).data,onSuccess:()=>{i.success("제휴사 정보가 수정되었습니다"),q.invalidateQueries({queryKey:["affiliate-partners"]}),q.invalidateQueries({queryKey:["affiliate-partner",k]}),C("/affiliate/partners")},onError:()=>{i.error("제휴사 수정에 실패했습니다")}});s.useEffect(()=>{K&&R({name:K.name,email:K.email,website:K.website||"",type:K.type,commissionRate:K.commissionRate,paymentMethod:K.paymentMethod,bankName:K.bankName||"",accountNumber:K.accountNumber||"",accountHolder:K.accountHolder||"",paypalEmail:K.paypalEmail||"",businessNumber:K.businessNumber||"",notes:K.notes||""})},[K]);const L=(e,a)=>{R(s=>({...s,[e]:a}))};return E&&S?n.jsx("div",{className:"flex items-center justify-center h-96",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-modern-primary"})}):n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsxs(d,{variant:"ghost",size:"sm",onClick:()=>C("/affiliate/partners"),children:[n.jsx(r,{className:"w-4 h-4 mr-2"}),"제휴사 목록"]}),n.jsx("h1",{className:"text-2xl font-bold text-modern-text-primary",children:E?"제휴사 수정":"새 제휴사 추가"})]}),n.jsxs("form",{onSubmit:e=>{e.preventDefault(),E?V.mutate(M):Q.mutate(M)},children:[n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs(c,{children:[n.jsxs(o,{children:[n.jsx(m,{children:"기본 정보"}),n.jsx(h,{children:"제휴사의 기본 정보를 입력하세요"})]}),n.jsxs(u,{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(p,{htmlFor:"name",children:"이름 *"}),n.jsx(x,{id:"name",value:M.name,onChange:e=>L("name",e.target.value),placeholder:"예: 김인플루언서",required:!0})]}),n.jsxs("div",{children:[n.jsx(p,{htmlFor:"email",children:"이메일 *"}),n.jsx(x,{id:"email",type:"email",value:M.email,onChange:e=>L("email",e.target.value),placeholder:"partner@example.com",required:!0})]}),n.jsxs("div",{children:[n.jsx(p,{htmlFor:"website",children:"웹사이트"}),n.jsx(x,{id:"website",type:"url",value:M.website,onChange:e=>L("website",e.target.value),placeholder:"https://example.com"})]}),n.jsxs("div",{children:[n.jsx(p,{htmlFor:"type",children:"제휴사 유형 *"}),n.jsxs(j,{value:M.type,onValueChange:e=>L("type",e),children:[n.jsx(v,{children:n.jsx(b,{})}),n.jsxs(y,{children:[n.jsx(g,{value:"individual",children:"개인"}),n.jsx(g,{value:"influencer",children:"인플루언서"}),n.jsx(g,{value:"blog",children:"블로그"}),n.jsx(g,{value:"business",children:"비즈니스"})]})]})]}),"business"===M.type&&n.jsxs("div",{children:[n.jsx(p,{htmlFor:"businessNumber",children:"사업자번호"}),n.jsx(x,{id:"businessNumber",value:M.businessNumber,onChange:e=>L("businessNumber",e.target.value),placeholder:"123-45-67890"})]})]})]}),n.jsxs(c,{children:[n.jsxs(o,{children:[n.jsx(m,{children:"수수료 및 결제"}),n.jsx(h,{children:"수수료율과 결제 정보를 설정하세요"})]}),n.jsxs(u,{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(p,{htmlFor:"commissionRate",children:"수수료율 (%) *"}),n.jsx(x,{id:"commissionRate",type:"number",min:"0",max:"100",step:"0.1",value:M.commissionRate,onChange:e=>L("commissionRate",parseFloat(e.target.value)),required:!0})]}),n.jsxs("div",{children:[n.jsx(p,{htmlFor:"paymentMethod",children:"결제 방법 *"}),n.jsxs(j,{value:M.paymentMethod,onValueChange:e=>L("paymentMethod",e),children:[n.jsx(v,{children:n.jsx(b,{})}),n.jsxs(y,{children:[n.jsx(g,{value:"bank",children:"계좌이체"}),n.jsx(g,{value:"paypal",children:"페이팔"}),"business"===M.type&&n.jsx(g,{value:"invoice",children:"세금계산서"})]})]})]}),"bank"===M.paymentMethod&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx(p,{htmlFor:"bankName",children:"은행명"}),n.jsx(x,{id:"bankName",value:M.bankName,onChange:e=>L("bankName",e.target.value),placeholder:"예: 국민은행"})]}),n.jsxs("div",{children:[n.jsx(p,{htmlFor:"accountNumber",children:"계좌번호"}),n.jsx(x,{id:"accountNumber",value:M.accountNumber,onChange:e=>L("accountNumber",e.target.value),placeholder:"123-456-789012"})]}),n.jsxs("div",{children:[n.jsx(p,{htmlFor:"accountHolder",children:"예금주"}),n.jsx(x,{id:"accountHolder",value:M.accountHolder,onChange:e=>L("accountHolder",e.target.value),placeholder:"예금주명"})]})]}),"paypal"===M.paymentMethod&&n.jsxs("div",{children:[n.jsx(p,{htmlFor:"paypalEmail",children:"페이팔 이메일"}),n.jsx(x,{id:"paypalEmail",type:"email",value:M.paypalEmail,onChange:e=>L("paypalEmail",e.target.value),placeholder:"paypal@example.com"})]})]})]}),n.jsxs(c,{className:"lg:col-span-2",children:[n.jsxs(o,{children:[n.jsx(m,{children:"추가 정보"}),n.jsx(h,{children:"메모나 특이사항을 입력하세요"})]}),n.jsx(u,{children:n.jsx(f,{value:M.notes,onChange:e=>L("notes",e.target.value),placeholder:"제휴사에 대한 메모나 특이사항을 입력하세요...",rows:4})})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[n.jsx(d,{type:"button",variant:"outline",onClick:()=>C("/affiliate/partners"),children:"취소"}),n.jsxs(d,{type:"submit",disabled:Q.isPending||V.isPending,children:[n.jsx(l,{className:"w-4 h-4 mr-2"}),E?"수정하기":"추가하기"]})]})]})]})};export{C as default};
