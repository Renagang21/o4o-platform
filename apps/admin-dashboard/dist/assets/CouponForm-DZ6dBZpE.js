import{u as e,b as s,r as l,V as o,j as i,bf as r,dm as t,b$ as a,cM as n,S as c}from"./vendor-react-BQ6HOJoh.js";import{B as d}from"./page-template-editor-C7FodHrK.js";import{ak as m,al as p,am as u,an as x}from"./wp-misc-DS9m4_P2.js";import{a as j}from"./api-CD2fx3s3.js";import"./wp-block-editor-a11y-DrduSWFW.js";import"./wp-block-editor-misc-pHCPYvR2.js";import"./wp-block-editor-api-Buev8_QU.js";import"./wp-block-editor-utils-M5qXzE1L.js";import"./wp-block-editor-colors-D38h-Odz.js";import"./wp-blocks-core-6vwQKPfS.js";import"./wp-block-editor-clipboard-Dg0Y1gQ6.js";import"./wp-block-editor-store-B-g1aSix.js";import"./vendor-ui-CrFdsnXa.js";import"./wp-block-editor-dnd-BYoS8-II.js";import"./wp-block-editor-library-BpQvynjE.js";import"./wp-block-editor-menus-BTQ2wZ-f.js";import"./wp-block-editor-keyboard-CeHTtvP5.js";import"./wp-block-editor-typography-Bl_1REQP.js";import"./wp-block-editor-spacing-BD_2CpN7.js";import"./wp-block-editor-core-DL280tSA.js";import"./wp-block-editor-selection-CC4tJpUu.js";import"./wp-block-editor-formats-CLXkimOp.js";import"./wp-block-editor-inline-CpXpUhQU.js";import"./wp-block-editor-ui-B8YE_4QL.js";import"./wp-block-editor-transforms-jLcKa8Hv.js";import"./wp-block-editor-preview-iw2Xu1ib.js";import"./wp-block-editor-global-styles-CV5-K6QF.js";import"./wp-block-editor-borders-BH1devca.js";import"./wp-block-editor-patterns-BXdHo9lm.js";import"./wp-block-editor-navigation-BFSoKzg0.js";import"./wp-block-editor-media-Bg-JiQDT.js";import"./wp-api-BeoadipR.js";import"./wp-i18n-DGPtqsXY.js";import"./wp-core-Y-jV-nrZ.js";import"./vendor-monaco-BxJH8uUv.js";import"./wp-block-editor-upload-BLw1R9wP.js";import"./vendor-utils-D-spY-QM.js";import"./wp-block-editor-templates-o1_wAMb9.js";import"./vendor-query-LYSOqK5P.js";import"./wp-data-BmtL8k4r.js";import"./wp-components-CeQNCpMW.js";const b=()=>{const b=e(),{id:h}=s(),f=!!h,[g,v]=l.useState({code:"",description:"",discountType:"percent",discountValue:0,usageLimitPerCoupon:0,usageLimitPerCustomer:1,freeShipping:!1,excludeSaleItems:!1,individualUseOnly:!0}),[y,w]=l.useState(!1),[N,k]=l.useState(!1);l.useEffect(()=>{f&&C()},[h]);const C=async()=>{try{w(!0);const e=(await j.get(`/v1/coupons/${h}`)).data.data;v({...e,validFrom:e.validFrom?e.validFrom.split("T")[0]:"",validUntil:e.validUntil?e.validUntil.split("T")[0]:""})}catch(e){o.error("Failed to load coupon")}finally{w(!1)}},F=e=>{const{name:s,value:l,type:o}=e.target;if("checkbox"===o){const l=e.target.checked;v(e=>({...e,[s]:l}))}else v("number"===o?e=>({...e,[s]:parseFloat(l)||0}):e=>({...e,[s]:l}))};return y?i.jsx("div",{className:"flex items-center justify-center h-96",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold",children:f?"쿠폰 수정":"새 쿠폰 만들기"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"할인 쿠폰을 생성하고 설정하세요"})]}),i.jsxs(d,{variant:"outline",onClick:()=>b("/ecommerce/coupons"),children:[i.jsx(r,{className:"w-4 h-4 mr-2"}),"취소"]})]}),i.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),g.code)if(g.discountValue<=0)o.error("할인 값을 입력해주세요");else if("percent"===g.discountType&&g.discountValue>100)o.error("퍼센트 할인은 100%를 초과할 수 없습니다");else try{k(!0);const e={...g,validFrom:g.validFrom||void 0,validUntil:g.validUntil||void 0,minOrderAmount:g.minOrderAmount||void 0,maxDiscountAmount:g.maxDiscountAmount||void 0};f?(await j.put(`/v1/coupons/${h}`,e),o.success("쿠폰이 수정되었습니다")):(await j.post("/v1/coupons",e),o.success("쿠폰이 생성되었습니다")),b("/ecommerce/coupons")}catch(s){const e=s.response?.data?.message||"Failed to save coupon";o.error(e)}finally{k(!1)}else o.error("쿠폰 코드를 입력해주세요")},className:"space-y-6",children:[i.jsxs(m,{children:[i.jsx(p,{children:i.jsx(u,{children:"기본 정보"})}),i.jsx(x,{className:"space-y-4",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:"쿠폰 코드 *"}),i.jsx("input",{type:"text",name:"code",value:g.code,onChange:F,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"예: WELCOME10",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:"할인 타입 *"}),i.jsxs("select",{name:"discountType",value:g.discountType,onChange:F,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"percent",children:"퍼센트 할인"}),i.jsx("option",{value:"fixed_cart",children:"정액 할인 (장바구니)"}),i.jsx("option",{value:"fixed_product",children:"정액 할인 (상품별)"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:"할인 값 *"}),i.jsxs("div",{className:"relative",children:["percent"===g.discountType?i.jsx(t,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}):i.jsx(a,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"number",name:"discountValue",value:g.discountValue,onChange:F,className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0",step:"0.01",required:!0})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:"설명"}),i.jsx("input",{type:"text",name:"description",value:g.description,onChange:F,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"쿠폰 설명"})]})]})})]}),i.jsxs(m,{children:[i.jsx(p,{children:i.jsx(u,{children:"사용 제한"})}),i.jsx(x,{className:"space-y-4",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:"최소 주문 금액"}),i.jsx("input",{type:"number",name:"minOrderAmount",value:g.minOrderAmount||"",onChange:F,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0",step:"1000"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:"최대 할인 금액"}),i.jsx("input",{type:"number",name:"maxDiscountAmount",value:g.maxDiscountAmount||"",onChange:F,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0",step:"1000"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:"총 사용 제한"}),i.jsx("input",{type:"number",name:"usageLimitPerCoupon",value:g.usageLimitPerCoupon,onChange:F,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0 (무제한)",min:"0"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"0은 무제한"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:"고객당 사용 제한"}),i.jsx("input",{type:"number",name:"usageLimitPerCustomer",value:g.usageLimitPerCustomer,onChange:F,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"1",min:"1"})]})]})})]}),i.jsxs(m,{children:[i.jsx(p,{children:i.jsx(u,{children:"유효 기간"})}),i.jsx(x,{children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:"시작일"}),i.jsxs("div",{className:"relative",children:[i.jsx(n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"date",name:"validFrom",value:g.validFrom||"",onChange:F,className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:"종료일"}),i.jsxs("div",{className:"relative",children:[i.jsx(n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"date",name:"validUntil",value:g.validUntil||"",onChange:F,className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]})})]}),i.jsxs(m,{children:[i.jsx(p,{children:i.jsx(u,{children:"추가 옵션"})}),i.jsx(x,{className:"space-y-4",children:i.jsxs("div",{className:"space-y-3",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",name:"freeShipping",checked:g.freeShipping,onChange:F,className:"mr-3 rounded"}),i.jsx("span",{className:"text-sm",children:"무료 배송 포함"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",name:"excludeSaleItems",checked:g.excludeSaleItems,onChange:F,className:"mr-3 rounded"}),i.jsx("span",{className:"text-sm",children:"세일 상품 제외"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",name:"individualUseOnly",checked:g.individualUseOnly,onChange:F,className:"mr-3 rounded"}),i.jsx("span",{className:"text-sm",children:"다른 쿠폰과 중복 사용 불가"})]})]})})]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx(d,{type:"button",variant:"outline",onClick:()=>b("/ecommerce/coupons"),children:"취소"}),i.jsx(d,{type:"submit",disabled:N,children:N?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"저장 중..."]}):i.jsxs(i.Fragment,{children:[i.jsx(c,{className:"w-4 h-4 mr-2"}),f?"수정":"생성"]})})]})]})]})};export{b as default};
