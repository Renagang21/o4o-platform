import{a4 as T,a3 as B,r as m,V as r,j as e,a5 as E,bx as y,c8 as f,N as $,bG as _,bD as F,c2 as H,bM as M,bF as V}from"./vendor-react-k21L8gyu.js";import{B as i,a as P,b as I,d as j,e as u,C as c,k as l,l as n,m as d,s as v,t as b}from"./page-gutenberg-DfBK4wFH.js";import{a as h}from"./base-ows5IqTb.js";import{f as q,b as w}from"./vendor-utils-DQ8F5vJI.js";import"./wp-block-editor-DM9yXXIa.js";import"./wp-i18n-DQMG9Moe.js";import"./wp-core-CTkjrE6Y.js";import"./wp-blocks-core-m9M-jdYH.js";import"./wp-misc-eJXghOJf.js";import"./wp-data-CiqFlSQ4.js";import"./vendor-ui-BkLtITBR.js";import"./vendor-monaco-cpVGocfO.js";import"./vendor-query-D5rBm9N_.js";import"./wp-components-C7vO1IIk.js";import"./main-jxz3gomr.js";import"./vendor-socket-Ch6lN7-G.js";function ce(){const{id:t}=T(),o=B(),[a,A]=m.useState(null),[g,C]=m.useState([]),[U,N]=m.useState(!0);m.useEffect(()=>{t&&p()},[t]);const p=async()=>{try{N(!0);const s=await h.get(`/v1/users/${t}`);s.data.success&&A(s.data.data);const x=await h.get(`/v1/users/${t}/approval-history`);x.data.success&&C(x.data.data)}catch{r.error("Failed to load user details"),o("/users")}finally{N(!1)}},k=async()=>{try{await h.post(`/v1/users/${t}/approve`,{notes:"Approved via admin dashboard"}),r.success("User approved successfully"),p()}catch{r.error("Failed to approve user")}},S=async()=>{try{await h.post(`/v1/users/${t}/reject`,{notes:"Rejected via admin dashboard"}),r.success("User rejected successfully"),p()}catch{r.error("Failed to reject user")}},R=s=>({super_admin:"bg-purple-500",admin:"bg-red-500",vendor:"bg-blue-500",seller:"bg-green-500",customer:"bg-gray-500",business:"bg-yellow-500",moderator:"bg-indigo-500",partner:"bg-pink-500"})[s]||"bg-gray-500",D=s=>({active:"bg-green-500",approved:"bg-green-500",pending:"bg-yellow-500",rejected:"bg-red-500"})[s]||"bg-gray-500",L=s=>{switch(s){case"approved":return e.jsx(y,{className:"h-4 w-4 text-green-500"});case"rejected":return e.jsx(f,{className:"h-4 w-4 text-red-500"});default:return e.jsx(V,{className:"h-4 w-4 text-gray-500"})}};return U?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-6"}),e.jsx("div",{className:"h-64 bg-gray-200 rounded"})]})}):a?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(i,{variant:"ghost",onClick:()=>o("/users"),children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),"Back to Users"]}),e.jsx("h1",{className:"text-2xl font-bold",children:a?.name||"Unknown User"})]}),e.jsxs("div",{className:"flex gap-2",children:[a?.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs(i,{onClick:k,children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Approve"]}),e.jsxs(i,{variant:"destructive",onClick:S,children:[e.jsx(f,{className:"mr-2 h-4 w-4"}),"Reject"]})]}),e.jsxs(i,{variant:"outline",onClick:()=>o(`/users/${t}/edit`),children:[e.jsx($,{className:"mr-2 h-4 w-4"}),"Edit"]})]})]}),e.jsxs(P,{defaultValue:"overview",className:"w-full",children:[e.jsxs(I,{children:[e.jsx(j,{value:"overview",children:"Overview"}),e.jsx(j,{value:"history",children:"Approval History"}),e.jsx(j,{value:"activity",children:"Activity"})]}),e.jsxs(u,{value:"overview",className:"space-y-6",children:[e.jsxs(c,{children:[e.jsx(l,{children:e.jsx(n,{children:"User Information"})}),e.jsx(d,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Email"}),e.jsx("p",{className:"font-medium",children:a?.email})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(F,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Status"}),e.jsx(v,{className:`${D(a?.status||"pending")} text-white`,children:a?.status})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(H,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Joined"}),e.jsx("p",{className:"font-medium",children:a?q(new Date(Date.now()),"MMM d, yyyy"):""})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(M,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Last Login"}),e.jsx("p",{className:"font-medium",children:a?.lastLoginAt?w(new Date(a?.lastLoginAt),{addSuffix:!0}):"Never"})]})]})]})})]}),e.jsxs(c,{children:[e.jsx(l,{children:e.jsx(n,{children:"Roles & Permissions"})}),e.jsx(d,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Assigned Roles"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:a?.role?[a.role]:[].map(s=>e.jsx(v,{className:`${R(s)} text-white`,children:s.replace("_"," ")},s))})]}),a?.permissions&&a?.permissions.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Special Permissions"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:a?.permissions.map(s=>e.jsx(v,{variant:"outline",children:s},s))})]})]})})]}),e.jsxs(c,{children:[e.jsx(l,{children:e.jsx(n,{children:"Account Status"})}),e.jsx(d,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Email Verified"}),e.jsx("p",{className:"text-2xl font-bold",children:a?.isEmailVerified?"✓":"✗"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Account Active"}),e.jsx("p",{className:"text-2xl font-bold",children:a?.isActive?"✓":"✗"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Login Attempts"}),e.jsx("p",{className:"text-2xl font-bold",children:a?.loginAttempts||0})]})]})})]})]}),e.jsx(u,{value:"history",className:"space-y-4",children:e.jsxs(c,{children:[e.jsxs(l,{children:[e.jsx(n,{children:"Approval History"}),e.jsx(b,{children:"Timeline of all approval actions for this user"})]}),e.jsx(d,{children:g.length===0?e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No approval history found"}):e.jsx("div",{className:"space-y-4",children:g.map(s=>e.jsxs("div",{className:"flex items-start gap-4 p-4 border rounded-lg",children:[e.jsx("div",{className:"mt-1",children:L(s.action)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("p",{className:"font-medium",children:[s.action==="approved"&&"Approved",s.action==="rejected"&&"Rejected",s.action==="status_changed"&&"Status Changed"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["by ",s.admin?.fullName||s.admin?.email||"System"]})]}),s.notes&&e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s.notes}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("span",{children:[s.previous_status," → ",s.new_status]}),e.jsx("span",{children:w(new Date(s.created_at),{addSuffix:!0})})]})]})]},s.id))})})]})}),e.jsx(u,{value:"activity",children:e.jsxs(c,{children:[e.jsxs(l,{children:[e.jsx(n,{children:"Recent Activity"}),e.jsx(b,{children:"User's recent actions and system events"})]}),e.jsx(d,{children:e.jsx("p",{className:"text-center text-gray-500 py-8",children:"Activity tracking coming soon"})})]})})]})]}):e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-500",children:"User not found"}),e.jsx(i,{onClick:()=>o("/users"),className:"mt-4",children:"Back to Users"})]})})}export{ce as default};
