import{c as e}from"./vendor-ui-CrFdsnXa.js";import{i as t,a as o,c as n}from"./wp-i18n-D2qT7FTy.js";import{u as i,Z as r,_ as s,b as l,a}from"./wp-block-editor-misc-5qbjj7fi.js";import{s as c}from"./wp-block-editor-store-D0LqdVTA.js";import{a as d}from"./wp-block-editor-core-BHvRx-9p.js";import{r as u,j as p}from"./vendor-react-DqgGMt48.js";import{Popover as m,MenuItem as f,ExternalLink as b,Button as h,privateApis as v,__experimentalVStack as k,__experimentalHStack as _,__experimentalHeading as x,__experimentalSpacer as g,__experimentalText as j,ResizableBox as w}from"./wp-components-Jwbue4-Q.js";import{aF as C,aG as N,a3 as E,a1 as L,K as I,ah as R,d as y,c as S,aH as B}from"./wp-misc-nAANEFFa.js";import{U as M}from"./wp-block-editor-formats-DG6_xyZ_.js";import{u as P,f as z}from"./wp-core-BedthL0o.js";import{M as O,E as A}from"./wp-block-editor-utils-BS9xY-75.js";function V(e){return P(t=>{if(!e)return;function o(t){const{deltaX:o,deltaY:n}=t;e.current.scrollBy(o,n)}const n={passive:!0};return t.addEventListener("wheel",o,n),()=>{t.removeEventListener("wheel",o,n)}},[e])}const T=Number.MAX_SAFE_INTEGER;function U({previousClientId:o,nextClientId:n,children:r,__unstablePopoverSlot:s,__unstableContentRef:l,operation:a="insert",nearestSide:f="right",...b}){const[h,v]=u.useReducer(e=>(e+1)%T,0),{orientation:k,rootClientId:_,isVisible:x}=i(e=>{const{getBlockListSettings:t,getBlockRootClientId:i,isBlockVisible:r}=e(c),s=i(null!=o?o:n);return{orientation:t(s)?.orientation||"vertical",rootClientId:s,isVisible:r(o)&&r(n)}},[o,n]),g=d(o),j=d(n),w="vertical"===k,C=u.useMemo(()=>{if(h<0||!g&&!j||!x)return;return{contextElement:"group"===a?j||g:g||j,getBoundingClientRect(){const e=g?g.getBoundingClientRect():null,o=j?j.getBoundingClientRect():null;let n=0,i=0,r=0,s=0;if("group"===a){const t=o||e;i=t.top,r=0,s=t.bottom-t.top,n="left"===f?t.left-2:t.right-2}else w?(i=e?e.bottom:o.top,r=e?e.width:o.width,s=o&&e?o.top-e.bottom:0,n=e?e.left:o.left):(i=e?e.top:o.top,s=e?e.height:o.height,t()?(n=o?o.right:e.left,r=e&&o?e.left-o.right:0):(n=e?e.right:o.left,r=e&&o?o.left-e.right:0));return new window.DOMRect(n,i,r,s)}}},[g,j,h,w,x,a,f]),N=V(l);return u.useLayoutEffect(()=>{if(!g)return;const e=new window.MutationObserver(v);return e.observe(g,{attributes:!0}),()=>{e.disconnect()}},[g]),u.useLayoutEffect(()=>{if(!j)return;const e=new window.MutationObserver(v);return e.observe(j,{attributes:!0}),()=>{e.disconnect()}},[j]),u.useLayoutEffect(()=>{if(g)return g.ownerDocument.defaultView.addEventListener("resize",v),()=>{g.ownerDocument.defaultView?.removeEventListener("resize",v)}},[g]),(g||j)&&x?p.jsx(m,{ref:N,animate:!1,anchor:C,focusOnMount:!1,__unstableSlotName:s,inline:!s,...b,className:e("block-editor-block-popover","block-editor-block-popover__inbetween",b.className),resize:!1,flip:!1,placement:"overlay",variant:"unstyled",children:p.jsx("div",{className:"block-editor-block-popover__inbetween-container",children:r})},n+"--"+_):null}u.createContext();const H=Number.MAX_SAFE_INTEGER;const F=u.forwardRef(function({clientId:t,bottomClientId:o,children:n,__unstablePopoverSlot:i,__unstableContentRef:r,shift:s=!0,...l},a){const c=d(t),f=d(null!=o?o:t),b=z([a,V(r)]),[h,v]=u.useReducer(e=>(e+1)%H,0);u.useLayoutEffect(()=>{if(!c)return;const e=new window.MutationObserver(v);return e.observe(c,{attributes:!0}),()=>{e.disconnect()}},[c]);const k=u.useMemo(()=>{if(!(h<0||!c||o&&!f))return{getBoundingClientRect:()=>f?O(A(c),A(f)):A(c),contextElement:c}},[o,f,c,h]);return!c||o&&!f?null:p.jsx(m,{ref:b,animate:!1,focusOnMount:!1,anchor:k,__unstableSlotName:i,inline:!i,placement:"top-start",resize:!1,flip:!1,shift:s,...l,className:e("block-editor-block-popover",l.className),variant:"unstyled",children:n})}),D=u.forwardRef(({clientId:e,bottomClientId:t,children:o,...n},i)=>p.jsx(F,{...n,bottomClientId:t,clientId:e,__unstableContentRef:void 0,__unstablePopoverSlot:void 0,ref:i,children:o}));function G({selectedElement:e,additionalStyles:t={},children:o}){const[n,i]=u.useState(e.offsetWidth),[r,s]=u.useState(e.offsetHeight);u.useEffect(()=>{const t=new window.ResizeObserver(()=>{i(e.offsetWidth),s(e.offsetHeight)});return t.observe(e,{box:"border-box"}),()=>t.disconnect()},[e]);const l=u.useMemo(()=>({position:"absolute",width:n,height:r,...t}),[n,r,t]);return p.jsx("div",{style:l,children:o})}const X=u.forwardRef(function({clientId:e,bottomClientId:t,children:o,shift:n=!1,additionalStyles:i,...r},s){var l;null!==(l=t)&&void 0!==l||(t=e);const a=d(e);return p.jsx(F,{ref:s,clientId:e,bottomClientId:t,shift:n,...r,children:a&&e===t?p.jsx(G,{selectedElement:a,additionalStyles:i,children:o}):o})});function W({clientId:e}){const{canLock:t,isLocked:n}=r(e),[i,l]=u.useReducer(e=>!e,!1);if(!t)return null;const a=o(n?"Unlock":"Lock");return p.jsxs(p.Fragment,{children:[p.jsx(f,{icon:n?C:N,onClick:l,"aria-expanded":i,"aria-haspopup":"dialog",children:a}),i&&p.jsx(s,{clientId:e,onClose:l})]})}function K({clientId:e,onClose:t}){const{templateLock:o,isLockedByParent:r,isEditingAsBlocks:s}=i(t=>{const{getContentLockingParent:o,getTemplateLock:n,getTemporarilyEditingAsBlocks:i}=l(t(c));return{templateLock:n(e),isLockedByParent:!!o(e),isEditingAsBlocks:i()===e}},[e]),d=a(c),u=!r&&"contentOnly"===o;if(!u&&!s)return null;const{modifyContentLockBlock:m}=l(d);return!s&&u&&p.jsx(f,{onClick:()=>{m(e),t()},children:n("Modify","Unlock content locked blocks")})}function Y({url:t,urlLabel:o,className:n}){const i=e(n,"block-editor-url-popover__link-viewer-url");return t?p.jsx(b,{className:i,href:t,children:o||E(L(t))}):p.jsx("span",{className:i})}const{__experimentalPopoverLegacyPositionToPlacement:Z}=l(v),q=u.forwardRef(({additionalControls:e,children:t,renderSettings:n,placement:i,focusOnMount:r="firstElement",position:s,...l},a)=>{let c;void 0!==s&&y("`position` prop in wp.blockEditor.URLPopover",{since:"6.2",alternative:"`placement` prop"}),void 0!==i?c=i:void 0!==s&&(c=Z(s)),c=c||"bottom";const[d,f]=u.useState(!1),b=!!n&&d;return p.jsxs(m,{ref:a,role:"dialog","aria-modal":"true","aria-label":o("Edit URL"),className:"block-editor-url-popover",focusOnMount:r,placement:c,shift:!0,variant:"toolbar",...l,children:[p.jsx("div",{className:"block-editor-url-popover__input-container",children:p.jsxs("div",{className:"block-editor-url-popover__row",children:[t,!!n&&p.jsx(h,{className:"block-editor-url-popover__settings-toggle",icon:S,label:o("Link settings"),onClick:()=>{f(!d)},"aria-expanded":d,size:"compact"})]})}),b&&p.jsx("div",{className:"block-editor-url-popover__settings",children:n()}),e&&!b&&p.jsx("div",{className:"block-editor-url-popover__additional-controls",children:e})]})});function J({title:e,help:t,actions:n=[],onClose:i}){return p.jsxs(k,{className:"block-editor-inspector-popover-header",spacing:4,children:[p.jsxs(_,{alignment:"center",children:[p.jsx(x,{className:"block-editor-inspector-popover-header__heading",level:2,size:13,children:e}),p.jsx(g,{}),n.map(({label:e,icon:t,onClick:o})=>p.jsx(h,{size:"small",className:"block-editor-inspector-popover-header__action",label:e,icon:t,variant:!t&&"tertiary",onClick:o,children:!t&&e},e)),i&&p.jsx(h,{size:"small",className:"block-editor-inspector-popover-header__action",label:o("Close"),icon:B,onClick:i})]}),t&&p.jsx(j,{children:t})]})}function Q({clientId:e,resizableBoxProps:t,...o}){return p.jsx(X,{clientId:e,__unstablePopoverSlot:"block-toolbar",...o,children:p.jsx(w,{...t})})}q.LinkEditor=function({autocompleteRef:t,className:n,onChangeInputValue:i,value:r,...s}){return p.jsxs("form",{className:e("block-editor-url-popover__link-editor",n),...s,children:[p.jsx(M,{value:r,onChange:i,autocompleteRef:t}),p.jsx(h,{icon:R,label:o("Apply"),type:"submit",size:"compact"})]})},q.LinkViewer=function({className:t,linkClassName:n,onEditLinkClick:i,url:r,urlLabel:s,...l}){return p.jsxs("div",{className:e("block-editor-url-popover__link-viewer",t),...l,children:[p.jsx(Y,{url:r,urlLabel:s,className:n}),i&&p.jsx(h,{icon:I,label:o("Edit"),onClick:i,size:"compact"})]})};export{U as B,J as I,K as M,F as P,Q as R,q as U,X as a,D as b,W as c,V as u};
