import{u as e,b as s,r as l,V as o,j as i,aD as r,cK as n,bn as t,c8 as a,S as c}from"./vendor-react-DqgGMt48.js";import{B as d}from"./page-template-editor-Dej8aqbo.js";import{cF as m,cG as p,cH as u,cI as x}from"./wp-misc-CVe7ECV4.js";import{a as j}from"./api-DpVyZaaZ.js";import"./vendor-monaco-BxJH8uUv.js";import"./vendor-ui-CrFdsnXa.js";import"./vendor-query-D_c3FRkE.js";import"./vendor-utils-C9jLuAcl.js";import"./wp-blocks-core-NinAvWTg.js";import"./wp-block-editor-misc-De1L5-zR.js";import"./wp-core-kvRrOm9B.js";import"./wp-block-editor-api-BKhomcj9.js";import"./wp-block-editor-store-BZ6fZn58.js";import"./wp-block-editor-clipboard-DrG0xX4B.js";import"./wp-i18n-D6_Il8Rt.js";import"./wp-block-editor-global-styles-DiR2HQC4.js";import"./wp-block-editor-typography-W96exnXk.js";import"./wp-components-BJYLMD7r.js";import"./wp-block-editor-spacing-CpdaiY4Q.js";import"./wp-block-editor-menus-IWaA-N3x.js";import"./wp-block-editor-core-BSca1VBH.js";import"./wp-block-editor-utils-Bqn4TiQr.js";import"./wp-block-editor-a11y-YlMsb8JF.js";import"./wp-block-editor-preview-CaF7fUZD.js";import"./wp-block-editor-borders-BtjnCtLF.js";import"./wp-block-editor-formats-B4-8T-Nh.js";import"./wp-block-editor-selection-DYIw7ude.js";import"./wp-block-editor-inline-DHEsfgnI.js";import"./wp-block-editor-ui-l6-7VhtF.js";import"./wp-block-editor-transforms-Bm69JWBw.js";import"./wp-block-editor-patterns-CNk0M6ZZ.js";import"./wp-block-editor-navigation-iME_YXGb.js";import"./wp-block-editor-dnd-DduwJSaE.js";import"./wp-block-editor-media-CVSKmHRK.js";import"./wp-api-Dp_oFsVM.js";import"./wp-block-editor-keyboard-C8o4qxcy.js";import"./wp-block-editor-templates-A6LfENHh.js";import"./wp-data-D64LRRbU.js";const h=()=>{const h=e(),{id:b}=s(),f=!!b,[g,v]=l.useState({code:"",description:"",discountType:"percent",discountValue:0,usageLimitPerCoupon:0,usageLimitPerCustomer:1,freeShipping:!1,excludeSaleItems:!1,individualUseOnly:!0}),[y,w]=l.useState(!1),[N,k]=l.useState(!1);l.useEffect(()=>{f&&C()},[b]);const C=async()=>{try{w(!0);const e=(await j.get(`/v1/coupons/${b}`)).data.data;v({...e,validFrom:e.validFrom?e.validFrom.split("T")[0]:"",validUntil:e.validUntil?e.validUntil.split("T")[0]:""})}catch(e){o.error("Failed to load coupon")}finally{w(!1)}},F=e=>{const{name:s,value:l,type:o}=e.target;if("checkbox"===o){const l=e.target.checked;v(e=>({...e,[s]:l}))}else v("number"===o?e=>({...e,[s]:parseFloat(l)||0}):e=>({...e,[s]:l}))};return y?i.jsx("div",{className:"flex items-center justify-center h-96",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold",children:f?"쿠폰 수정":"새 쿠폰 만들기"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"할인 쿠폰을 생성하고 설정하세요"})]}),i.jsxs(d,{variant:"outline",onClick:()=>h("/ecommerce/coupons"),children:[i.jsx(r,{className:"w-4 h-4 mr-2"}),"취소"]})]}),i.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),g.code)if(g.discountValue<=0)o.error("할인 값을 입력해주세요");else if("percent"===g.discountType&&g.discountValue>100)o.error("퍼센트 할인은 100%를 초과할 수 없습니다");else try{k(!0);const e={...g,validFrom:g.validFrom||void 0,validUntil:g.validUntil||void 0,minOrderAmount:g.minOrderAmount||void 0,maxDiscountAmount:g.maxDiscountAmount||void 0};f?(await j.put(`/v1/coupons/${b}`,e),o.success("쿠폰이 수정되었습니다")):(await j.post("/v1/coupons",e),o.success("쿠폰이 생성되었습니다")),h("/ecommerce/coupons")}catch(s){const e=s.response?.data?.message||"Failed to save coupon";o.error(e)}finally{k(!1)}else o.error("쿠폰 코드를 입력해주세요")},className:"space-y-6",children:[i.jsxs(m,{children:[i.jsx(p,{children:i.jsx(u,{children:"기본 정보"})}),i.jsx(x,{className:"space-y-4",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:"쿠폰 코드 *"}),i.jsx("input",{type:"text",name:"code",value:g.code,onChange:F,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"예: WELCOME10",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:"할인 타입 *"}),i.jsxs("select",{name:"discountType",value:g.discountType,onChange:F,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"percent",children:"퍼센트 할인"}),i.jsx("option",{value:"fixed_cart",children:"정액 할인 (장바구니)"}),i.jsx("option",{value:"fixed_product",children:"정액 할인 (상품별)"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:"할인 값 *"}),i.jsxs("div",{className:"relative",children:["percent"===g.discountType?i.jsx(n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}):i.jsx(t,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"number",name:"discountValue",value:g.discountValue,onChange:F,className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0",step:"0.01",required:!0})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:"설명"}),i.jsx("input",{type:"text",name:"description",value:g.description,onChange:F,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"쿠폰 설명"})]})]})})]}),i.jsxs(m,{children:[i.jsx(p,{children:i.jsx(u,{children:"사용 제한"})}),i.jsx(x,{className:"space-y-4",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:"최소 주문 금액"}),i.jsx("input",{type:"number",name:"minOrderAmount",value:g.minOrderAmount||"",onChange:F,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0",step:"1000"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:"최대 할인 금액"}),i.jsx("input",{type:"number",name:"maxDiscountAmount",value:g.maxDiscountAmount||"",onChange:F,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0",step:"1000"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:"총 사용 제한"}),i.jsx("input",{type:"number",name:"usageLimitPerCoupon",value:g.usageLimitPerCoupon,onChange:F,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0 (무제한)",min:"0"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"0은 무제한"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:"고객당 사용 제한"}),i.jsx("input",{type:"number",name:"usageLimitPerCustomer",value:g.usageLimitPerCustomer,onChange:F,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"1",min:"1"})]})]})})]}),i.jsxs(m,{children:[i.jsx(p,{children:i.jsx(u,{children:"유효 기간"})}),i.jsx(x,{children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:"시작일"}),i.jsxs("div",{className:"relative",children:[i.jsx(a,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"date",name:"validFrom",value:g.validFrom||"",onChange:F,className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:"종료일"}),i.jsxs("div",{className:"relative",children:[i.jsx(a,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"date",name:"validUntil",value:g.validUntil||"",onChange:F,className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]})})]}),i.jsxs(m,{children:[i.jsx(p,{children:i.jsx(u,{children:"추가 옵션"})}),i.jsx(x,{className:"space-y-4",children:i.jsxs("div",{className:"space-y-3",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",name:"freeShipping",checked:g.freeShipping,onChange:F,className:"mr-3 rounded"}),i.jsx("span",{className:"text-sm",children:"무료 배송 포함"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",name:"excludeSaleItems",checked:g.excludeSaleItems,onChange:F,className:"mr-3 rounded"}),i.jsx("span",{className:"text-sm",children:"세일 상품 제외"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",name:"individualUseOnly",checked:g.individualUseOnly,onChange:F,className:"mr-3 rounded"}),i.jsx("span",{className:"text-sm",children:"다른 쿠폰과 중복 사용 불가"})]})]})})]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx(d,{type:"button",variant:"outline",onClick:()=>h("/ecommerce/coupons"),children:"취소"}),i.jsx(d,{type:"submit",disabled:N,children:N?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"저장 중..."]}):i.jsxs(i.Fragment,{children:[i.jsx(c,{className:"w-4 h-4 mr-2"}),f?"수정":"생성"]})})]})]})]})};export{h as default};
