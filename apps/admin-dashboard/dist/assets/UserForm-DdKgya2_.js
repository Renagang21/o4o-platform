import{b as s,u as e,r as a,cd as r,V as t,j as l,A as i,S as d}from"./vendor-react-BoWgD0Bu.js";import{a as o,o as c,_ as n,b as m,s as p,l as u}from"./vendor-forms-XCJr8VLe.js";import{B as j,L as x,I as h,S as v,h as N,i as f,j as g,k as b}from"./page-template-editor-CWJwXWLM.js";import{C as w}from"./checkbox-BX473V1c.js";import{cy as y,cz as k,cA as C,cK as S,cB as U}from"./wp-misc-fiKRzvVp.js";import{a as A}from"./base-BYZzJ4Oh.js";import"./vendor-monaco-BxJH8uUv.js";import"./vendor-ui-CrFdsnXa.js";import"./vendor-query-CbBSyLUF.js";import"./vendor-utils-C9jLuAcl.js";import"./wp-foundation-BzBJX52f.js";import"./wp-block-editor-main-y2nlPlta.js";import"./wp-i18n-BPC8WmOV.js";import"./wp-block-editor-store-PPID3vJI.js";import"./wp-block-editor-utils-C52tDze8.js";import"./wp-components-CKWj6dcl.js";import"./index-Bu1ofPbL.js";import"./vendor-socket-CMcZe9fK.js";const F=c({email:p().email("Invalid email address"),password:p().min(6,"Password must be at least 6 characters").optional().or(u("")),firstName:p().optional(),lastName:p().optional(),roles:m(p()).min(1,"At least one role is required"),status:n(["active","pending","approved","rejected"])});function P(){const{id:c}=s(),n=e(),[m,p]=a.useState(!1),u=!!c,{register:P,handleSubmit:V,setValue:B,watch:E,formState:{errors:L}}=r({resolver:o(F),defaultValues:{email:"",password:"",firstName:"",lastName:"",roles:["customer"],status:"pending"}}),R=E("roles");a.useEffect(()=>{u&&q()},[c]);const q=async()=>{try{p(!0);const s=await A.get(`/v1/users/${c}`);if(s.data.success){const e=s.data.data;B("email",e.email),B("firstName",e.firstName||""),B("lastName",e.lastName||""),B("roles",e.roles),B("status",e.status)}}catch(s){t.error("Failed to load user"),n("/users")}finally{p(!1)}},I=s=>{const e=R||[];e.includes(s)?e.length>1&&B("roles",e.filter(e=>e!==s)):B("roles",[...e,s])};return l.jsxs("div",{className:"p-6",children:[l.jsx("div",{className:"mb-6",children:l.jsxs(j,{variant:"ghost",onClick:()=>n("/users"),children:[l.jsx(i,{className:"mr-2 h-4 w-4"}),"Back to Users"]})}),l.jsx("form",{onSubmit:V(async s=>{try{p(!0);const e={...s,role:s.roles[0]};u?(e.password||delete e.password,await A.put(`/v1/users/${c}`,e),t.success("User updated successfully")):(await A.post("/v1/users",e),t.success("User created successfully")),n("/users")}catch(e){t.error(e.response?.data?.error||"Failed to save user")}finally{p(!1)}}),children:l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[l.jsx("div",{className:"lg:col-span-2",children:l.jsxs(y,{children:[l.jsxs(k,{children:[l.jsx(C,{children:u?"Edit User":"Add New User"}),l.jsx(S,{children:u?"Update user information":"Create a new user account"})]}),l.jsxs(U,{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(x,{htmlFor:"firstName",children:"First Name"}),l.jsx(h,{id:"firstName",...P("firstName"),placeholder:"John"}),L.firstName&&l.jsx("p",{className:"text-sm text-red-500 mt-1",children:L.firstName.message})]}),l.jsxs("div",{children:[l.jsx(x,{htmlFor:"lastName",children:"Last Name"}),l.jsx(h,{id:"lastName",...P("lastName"),placeholder:"Doe"}),L.lastName&&l.jsx("p",{className:"text-sm text-red-500 mt-1",children:L.lastName.message})]})]}),l.jsxs("div",{children:[l.jsx(x,{htmlFor:"email",children:"Email"}),l.jsx(h,{id:"email",type:"email",...P("email"),placeholder:"john.doe@example.com",disabled:u}),L.email&&l.jsx("p",{className:"text-sm text-red-500 mt-1",children:L.email.message})]}),l.jsxs("div",{children:[l.jsxs(x,{htmlFor:"password",children:["Password ",u&&"(leave blank to keep current)"]}),l.jsx(h,{id:"password",type:"password",...P("password"),placeholder:u?"Leave blank to keep current":"Enter password"}),L.password&&l.jsx("p",{className:"text-sm text-red-500 mt-1",children:L.password.message})]}),l.jsxs("div",{children:[l.jsx(x,{htmlFor:"status",children:"Status"}),l.jsxs(v,{value:E("status"),onValueChange:s=>B("status",s),children:[l.jsx(N,{children:l.jsx(f,{placeholder:"Select status"})}),l.jsxs(g,{children:[l.jsx(b,{value:"active",children:"Active"}),l.jsx(b,{value:"pending",children:"Pending"}),l.jsx(b,{value:"approved",children:"Approved"}),l.jsx(b,{value:"rejected",children:"Rejected"})]})]}),L.status&&l.jsx("p",{className:"text-sm text-red-500 mt-1",children:L.status.message})]})]})]})}),l.jsxs("div",{children:[l.jsxs(y,{children:[l.jsxs(k,{children:[l.jsx(C,{children:"User Roles"}),l.jsx(S,{children:"Select one or more roles for this user"})]}),l.jsxs(U,{children:[l.jsx("div",{className:"space-y-3",children:[{value:"super_admin",label:"Super Admin",description:"Full system access"},{value:"admin",label:"Admin",description:"Administrative access"},{value:"vendor",label:"Vendor",description:"Vendor/supplier access"},{value:"seller",label:"Seller",description:"Can sell products"},{value:"customer",label:"Customer",description:"Regular user"},{value:"business",label:"Business",description:"Business account"},{value:"moderator",label:"Moderator",description:"Content moderation"},{value:"partner",label:"Partner",description:"Partner access"}].map(s=>l.jsxs("div",{className:"flex items-start space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>I(s.value),children:[l.jsx(w,{checked:R?.includes(s.value)||!1,onCheckedChange:()=>I(s.value),onClick:s=>s.stopPropagation()}),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"font-medium",children:s.label}),l.jsx("div",{className:"text-sm text-gray-600",children:s.description})]})]},s.value))}),L.roles&&l.jsx("p",{className:"text-sm text-red-500 mt-2",children:L.roles.message})]})]}),l.jsxs("div",{className:"mt-6 flex gap-3",children:[l.jsxs(j,{type:"submit",className:"flex-1",disabled:m,children:[l.jsx(d,{className:"mr-2 h-4 w-4"}),m?"Saving...":u?"Update User":"Create User"]}),l.jsx(j,{type:"button",variant:"outline",onClick:()=>n("/users"),disabled:m,children:"Cancel"})]})]})]})})]})}export{P as default};
