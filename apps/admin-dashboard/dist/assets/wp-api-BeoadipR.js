import"./wp-block-editor-a11y-DrduSWFW.js";import{_ as e}from"./wp-i18n-DGPtqsXY.js";import{n as t,g as r,a as o,h as s,b as i,r as n}from"./wp-misc-DS9m4_P2.js";import"./wp-block-editor-misc-pHCPYvR2.js";import"./wp-block-editor-api-Buev8_QU.js";import"./vendor-react-BQ6HOJoh.js";import"./vendor-monaco-BxJH8uUv.js";import"./wp-block-editor-utils-M5qXzE1L.js";import"./wp-block-editor-colors-D38h-Odz.js";import"./wp-blocks-core-6vwQKPfS.js";import"./wp-block-editor-clipboard-Dg0Y1gQ6.js";import"./wp-block-editor-store-B-g1aSix.js";import"./vendor-ui-CrFdsnXa.js";import"./wp-block-editor-dnd-BYoS8-II.js";import"./wp-block-editor-library-BpQvynjE.js";import"./wp-block-editor-menus-BTQ2wZ-f.js";import"./wp-block-editor-keyboard-CeHTtvP5.js";import"./wp-block-editor-typography-Bl_1REQP.js";import"./wp-block-editor-spacing-BD_2CpN7.js";import"./wp-block-editor-core-DL280tSA.js";import"./wp-block-editor-selection-CC4tJpUu.js";import"./wp-block-editor-formats-CLXkimOp.js";import"./wp-block-editor-inline-CpXpUhQU.js";import"./wp-block-editor-ui-B8YE_4QL.js";import"./wp-block-editor-transforms-jLcKa8Hv.js";import"./wp-block-editor-preview-iw2Xu1ib.js";import"./wp-block-editor-global-styles-CV5-K6QF.js";import"./wp-block-editor-borders-BH1devca.js";import"./wp-block-editor-patterns-BXdHo9lm.js";import"./wp-block-editor-navigation-BFSoKzg0.js";import"./wp-block-editor-media-Bg-JiQDT.js";import"./wp-api-BeoadipR.js";import"./wp-block-editor-upload-BLw1R9wP.js";import"./wp-core-Y-jV-nrZ.js";import"./vendor-utils-D-spY-QM.js";import"./wp-block-editor-templates-o1_wAMb9.js";import"./vendor-query-LYSOqK5P.js";import"./page-template-editor-C7FodHrK.js";import"./wp-data-BmtL8k4r.js";import"./wp-components-CeQNCpMW.js";const a=(e,t)=>{let r,o,s=e.path;return"string"==typeof e.namespace&&"string"==typeof e.endpoint&&(r=e.namespace.replace(/^\/|\/$/g,""),o=e.endpoint.replace(/^\//,""),s=o?r+"/"+o:r),delete e.namespace,delete e.endpoint,t({...e,path:s})};function p(e,t){if(t)return Promise.resolve(e.body);try{return Promise.resolve(new window.Response(JSON.stringify(e.body),{status:200,statusText:"OK",headers:e.headers}))}catch{return Object.entries(e.headers).forEach(([t,r])=>{"link"===t.toLowerCase()&&(e.headers[t]=r.replace(/<([^>]+)>/,(e,t)=>`<${encodeURI(t)}>`))}),Promise.resolve(t?e.body:new window.Response(JSON.stringify(e.body),{status:200,statusText:"OK",headers:e.headers}))}}const c=({path:e,url:t,...r},s)=>({...r,url:t&&o(t,s),path:e&&o(e,s)}),d=e=>e.json?e.json():Promise.reject(e),l=e=>{const{next:t}=(e=>{if(!e)return{};const t=e.match(/<([^>]+)>; rel="next"/);return t?{next:t[1]}:{}})(e.headers.get("link"));return t},m=async(e,t)=>{if(!1===e.parse)return t(e);if(!(e=>{const t=!!e.path&&-1!==e.path.indexOf("per_page=-1"),r=!!e.url&&-1!==e.url.indexOf("per_page=-1");return t||r})(e))return t(e);const r=await v({...c(e,{per_page:100}),parse:!1}),o=await d(r);if(!Array.isArray(o))return o;let s=l(r);if(!s)return o;let i=[].concat(o);for(;s;){const t=await v({...e,path:void 0,url:s,parse:!1}),r=await d(t);i=i.concat(r),s=l(t)}return i},u=new Set(["PATCH","PUT","DELETE"]),h="GET",w=(e,t=!0)=>Promise.resolve(((e,t=!0)=>t?204===e.status?null:e.json?e.json():Promise.reject(e):e)(e,t)).catch(e=>f(e,t));function f(t,r=!0){if(!r)throw t;return(t=>{const r={code:"invalid_json",message:e("The response is not a valid JSON response.")};if(!t||!t.json)throw r;return t.json().catch(()=>{throw r})})(t).then(t=>{const r={code:"unknown_error",message:e("An unknown error occurred.")};throw t||r})}const j={Accept:"application/json, */*;q=0.1"},b={credentials:"include"},g=[(e,t)=>("string"!=typeof e.url||s(e.url,"_locale")||(e.url=o(e.url,{_locale:"user"})),"string"!=typeof e.path||s(e.path,"_locale")||(e.path=o(e.path,{_locale:"user"})),t(e)),a,(e,t)=>{const{method:r=h}=e;return u.has(r.toUpperCase())&&(e={...e,headers:{...e.headers,"X-HTTP-Method-Override":r,"Content-Type":"application/json"},method:"POST"}),t(e)},m];const k=e=>{if(e.status>=200&&e.status<300)return e;throw e};let y=t=>{const{url:r,path:o,data:s,parse:i=!0,...n}=t;let{body:a,headers:p}=t;p={...j,...p},s&&(a=JSON.stringify(s),p["Content-Type"]="application/json");return window.fetch(r||o||window.location.href,{...b,...n,body:a,headers:p}).then(e=>Promise.resolve(e).then(k).catch(e=>f(e,i)).then(e=>w(e,i)),t=>{if(t&&"AbortError"===t.name)throw t;throw{code:"fetch_error",message:e("You are probably offline.")}})};function v(e){return g.reduceRight((e,t)=>r=>t(r,e),y)(e).catch(t=>"rest_cookie_invalid_nonce"!==t.code?Promise.reject(t):window.fetch(v.nonceEndpoint).then(k).then(e=>e.text()).then(t=>(v.nonceMiddleware.nonce=t,v(e))))}v.use=function(e){g.unshift(e)},v.setFetchHandler=function(e){y=e},v.createNonceMiddleware=function(e){const t=(e,r)=>{const{headers:o={}}=e;for(const s in o)if("x-wp-nonce"===s.toLowerCase()&&o[s]===t.nonce)return r(e);return r({...e,headers:{...o,"X-WP-Nonce":t.nonce}})};return t.nonce=e,t},v.createPreloadingMiddleware=function(e){const s=Object.fromEntries(Object.entries(e).map(([e,r])=>[t(e),r]));return(e,i)=>{const{parse:n=!0}=e;let a=e.path;if(!a&&e.url){const{rest_route:t,...s}=r(e.url);"string"==typeof t&&(a=o(t,s))}if("string"!=typeof a)return i(e);const c=e.method||"GET",d=t(a);if("GET"===c&&s[d]){const e=s[d];return delete s[d],p(e,!!n)}if("OPTIONS"===c&&s[c]&&s[c][d]){const e=s[c][d];return delete s[c][d],p(e,!!n)}return i(e)}},v.createRootURLMiddleware=e=>(t,r)=>a(t,t=>{let o,s=t.url,i=t.path;return"string"==typeof i&&(o=e,-1!==e.indexOf("?")&&(i=i.replace("?","&")),i=i.replace(/^\//,""),"string"==typeof o&&-1!==o.indexOf("?")&&(i=i.replace("?","&")),s=o+i),r({...t,url:s})}),v.fetchAllMiddleware=m,v.mediaUploadMiddleware=(t,r)=>{if(!function(e){const t=!!e.method&&"POST"===e.method;return(!!e.path&&-1!==e.path.indexOf("/wp/v2/media")||!!e.url&&-1!==e.url.indexOf("/wp/v2/media"))&&t}(t))return r(t);let o=0;const s=e=>(o++,r({path:`/wp/v2/media/${e}/post-process`,method:"POST",data:{action:"create-image-subsizes"},parse:!1}).catch(()=>o<5?s(e):(r({path:`/wp/v2/media/${e}?force=true`,method:"DELETE"}),Promise.reject())));return r({...t,parse:!1}).catch(r=>{if(!r.headers)return Promise.reject(r);const o=r.headers.get("x-wp-upload-attachment-id");return r.status>=500&&r.status<600&&o?s(o).catch(()=>!1!==t.parse?Promise.reject({code:"post_process",message:e("Media upload failed. If this is a photo or a large image, please scale it down and try again.")}):Promise.reject(r)):f(r,t.parse)}).then(e=>w(e,t.parse))},v.createThemePreviewMiddleware=e=>(t,r)=>{if("string"==typeof t.url){const r=i(t.url,"wp_theme_preview");void 0===r?t.url=o(t.url,{wp_theme_preview:e}):""===r&&(t.url=n(t.url,"wp_theme_preview"))}if("string"==typeof t.path){const r=i(t.path,"wp_theme_preview");void 0===r?t.path=o(t.path,{wp_theme_preview:e}):""===r&&(t.path=n(t.path,"wp_theme_preview"))}return r(t)};export{v as default};
