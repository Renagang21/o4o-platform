import{c as e}from"./vendor-ui-CrFdsnXa.js";import{ac as t,L as n,u as o,b as i,ab as s,_ as l,ad as r,a as c,ae as a,af as d,ag as u,ah as f,ai as g,aj as m,ak as b,al as p,c as k,s as v,am as h,w as I,an as B,ao as y,ap as C,aq as S,ar as E,as as x,at as _,au as w,av as D,aw as L,ax as P,ay as M,az as j,aA as T,aB as N,aC as A,aD as R,aE as O,aF as V,aG as F,aH as z,aI as H,aJ as K}from"./wp-block-editor-misc-pHCPYvR2.js";import{ah as G}from"./wp-block-editor-a11y-DrduSWFW.js";import{s as W}from"./wp-block-editor-store-B-g1aSix.js";import{F as U,W as Z,X,x as $,Y as q,Z as Y,V as Q,_ as J,$ as ee,a0 as te,a1 as ne,a2 as oe,T as ie,a3 as se,a4 as le,a5 as re}from"./wp-block-editor-utils-M5qXzE1L.js";import{r as ce,j as ae,o as de}from"./vendor-react-BQ6HOJoh.js";import{p as ue,c as fe,a as ge,i as me,d as be,b as pe,u as ke}from"./wp-block-editor-selection-CC4tJpUu.js";import{u as ve,c as he}from"./wp-misc-DS9m4_P2.js";import{c as Ie}from"./wp-block-editor-formats-CLXkimOp.js";import{f as Be,r as ye,i as Ce,e as Se,j as Ee,k as xe,v as _e,l as we,a as De,m as Le,n as Pe,h as Me,o as je,q as Te,t as Ne,u as Ae,w as Re,x as Oe,y as Ve,z as Fe,A as ze,B as He}from"./wp-blocks-core-6vwQKPfS.js";import{a as Ke}from"./wp-block-editor-clipboard-Dg0Y1gQ6.js";import{B as Ge,b as We,d as Ue,a as Ze,P as Xe,D as $e,e as qe}from"./wp-block-editor-api-Buev8_QU.js";import{B as Ye,m as Qe,A as Je,d as et,e as tt,u as nt,f as ot}from"./wp-block-editor-menus-BTQ2wZ-f.js";import{u as it}from"./wp-block-editor-inline-CpXpUhQU.js";import{I as st,a as lt,S as rt}from"./wp-block-editor-ui-B8YE_4QL.js";import{B as ct,c as at}from"./wp-block-editor-dnd-BYoS8-II.js";import{i as dt,j as ut,t as ft,p as gt}from"./wp-block-editor-library-BpQvynjE.js";const mt=ce.createContext({}),bt={type:"default"},pt=ce.createContext(bt),kt=pt.Provider;function vt(){return ce.useContext(pt)}function ht({layout:e={},css:o,...i}){const s=t(e.type),[l]=n("spacing.blockGap"),r=null!==l;if(s){if(o)return ae.jsx("style",{children:o});const t=s.getLayoutStyle?.({hasBlockGapSupport:r,layout:e,...i});if(t)return ae.jsx("style",{children:t})}return null}function It(e){const{refsMap:t}=ce.useContext(Ge);return U(n=>(t.set(e,n),()=>t.delete(e)),[e])}function Bt(e,t){"function"==typeof e?e(t):e&&(e.current=t)}function yt(e,t){const{refsMap:n}=ce.useContext(Ge);ce.useLayoutEffect(()=>{Bt(t,n.get(e));const o=n.subscribe(e,()=>Bt(t,n.get(e)));return()=>{o(),Bt(t,null)}},[n,e,t])}function Ct(e){const[t,n]=ce.useState(null);return yt(e,n),t}const St=e=>ye({HTML:e.originalContent});function Et({clientId:e}){const{block:t,canInsertHTMLBlock:n,canInsertClassicBlock:u}=o(t=>{const{canInsertBlockType:n,getBlock:o,getBlockRootClientId:i}=t(W),s=i(e);return{block:o(e),canInsertHTMLBlock:n("core/html",s),canInsertClassicBlock:n("core/freeform",s)}},[e]),{replaceBlock:f}=i(W),[g,m]=ce.useState(!1),b=ce.useCallback(()=>m(!1),[]),p=ce.useMemo(()=>({toClassic(){const e=Be("core/freeform",{content:t.originalContent});return f(t.clientId,e)},toHTML(){const e=Be("core/html",{content:t.originalContent});return f(t.clientId,e)},toBlocks(){const e=St(t);return f(t.clientId,e)},toRecoveredBlock(){const e=Be(t.name,t.attributes,t.innerBlocks);return f(t.clientId,e)}}),[t,f]),k=ce.useMemo(()=>[{title:s("Resolve","imperative verb"),onClick:()=>m(!0)},n&&{title:l("Convert to HTML"),onClick:p.toHTML},u&&{title:l("Convert to Classic Block"),onClick:p.toClassic}].filter(Boolean),[n,u,p]);return ae.jsxs(ae.Fragment,{children:[ae.jsx(r,{actions:[ae.jsx(c,{__next40pxDefaultSize:!0,onClick:p.toRecoveredBlock,variant:"primary",children:l("Attempt recovery")},"recover")],secondaryActions:k,children:l("Block contains unexpected or invalid content.")}),g&&ae.jsx(a,{title:l("Resolve Block"),onRequestClose:b,className:"block-editor-block-compare",children:ae.jsx(d,{block:t,onKeep:p.toHTML,onConvert:p.toBlocks,convertor:St,convertButtonText:l("Convert to Blocks")})})]})}const xt=ae.jsx(r,{className:"block-editor-block-list__block-crash-warning",children:l("This block has encountered an error and cannot be previewed.")}),_t=()=>xt;class wt extends ce.Component{constructor(){super(...arguments),this.state={hasError:!1}}componentDidCatch(){this.setState({hasError:!0})}render(){return this.state.hasError?this.props.fallback:this.props.children}}function Dt({clientId:e}){const[t,n]=ce.useState(""),s=o(t=>t(W).getBlock(e),[e]),{updateBlock:l}=i(W);return ce.useEffect(()=>{n(Ce(s))},[s]),ae.jsx(de,{className:"block-editor-block-list__block-html-textarea",value:t,onBlur:()=>{const o=Se(s.name);if(!o)return;const i=Ee(o,t,s.attributes),r=t||xe(o,i),[c]=t?_e({...s,attributes:i,originalContent:r}):[!0];l(e,{attributes:i,originalContent:r,isValid:c}),t||n(r)},onChange:e=>n(e.target.value)})}function Lt({clientId:e,initialPosition:t}){const n=ce.useRef(),{isBlockSelected:i,isMultiSelecting:s,__unstableGetEditorMode:l}=o(W);return ce.useEffect(()=>{if(!i(e)||s()||"zoom-out"===l())return;if(null==t)return;if(!n.current)return;const{ownerDocument:o}=n.current;if(Z(n.current,o.activeElement))return;const r=u.tabbable.find(n.current).filter(e=>f(e)),c=-1===t,a=r[c?r.length-1:0]||n.current;if(Z(n.current,a)){if(!n.current.getAttribute("contenteditable")){const e=u.tabbable.findNext(n.current);if(e&&Z(n.current,e)&&g(e))return void e.focus()}ue(a,c)}else n.current.focus()},[t,e]),n}function Pt({clientId:e}){const{hoverBlock:t}=i(W);function n(n){if(n.defaultPrevented)return;const o="mouseover"===n.type?"add":"remove";n.preventDefault(),n.currentTarget.classList[o]("is-hovered"),t("add"===o?e:null)}return U(e=>(e.addEventListener("mouseout",n),e.addEventListener("mouseover",n),()=>{e.removeEventListener("mouseout",n),e.removeEventListener("mouseover",n),e.classList.remove("is-hovered"),t(null)}),[])}function Mt(e){const{isBlockSelected:t}=o(W),{selectBlock:n,selectionChange:s}=i(W);return U(o=>{function i(i){o.parentElement.closest('[contenteditable="true"]')||(t(e)?i.target.isContentEditable||s(e):Z(o,i.target)&&n(e))}return o.addEventListener("focusin",i),()=>{o.removeEventListener("focusin",i)}},[t,n])}function jt({clientId:e,isSelected:t}){const{getBlockRootClientId:n,getBlockIndex:s}=o(W),{insertAfterBlock:l,removeBlock:r}=i(W);return U(n=>{if(t)return n.addEventListener("keydown",o),n.addEventListener("dragstart",i),()=>{n.removeEventListener("keydown",o),n.removeEventListener("dragstart",i)};function o(t){const{keyCode:o,target:i}=t;o!==m&&o!==b&&o!==p||i!==n||f(i)||(t.preventDefault(),o===m?l(e):r(e))}function i(e){e.preventDefault()}},[e,t,n,s,l,r])}function Tt(){const{getSettings:e,isZoomOut:t,__unstableGetEditorMode:n}=k(o(W)),{__unstableSetEditorMode:s,resetZoomLevel:l}=k(i(W));return U(o=>{function i(o){if("zoom-out"===n()&&t()&&!o.defaultPrevented){o.preventDefault();const{__experimentalSetIsInserterOpened:t}=e();"function"==typeof t&&t(!1),s("edit"),l()}}return o.addEventListener("dblclick",i),()=>{o.removeEventListener("dblclick",i)}},[e,s,n,t,l])}function Nt(){const e=ce.useContext(hn);return U(t=>{if(e)return e.observe(t),()=>{e.unobserve(t)}},[e])}function At({isSelected:e}){const t=X();return U(n=>{if(e){const{ownerDocument:e}=n,{defaultView:o}=e;if(!o.IntersectionObserver)return;const i=new o.IntersectionObserver(e=>{e[0].isIntersecting||n.scrollIntoView({behavior:t?"instant":"smooth"}),i.disconnect()});return i.observe(n),()=>{i.disconnect()}}},[e])}function Rt(t={},{__unstableIsHtml:n}={}){const{clientId:o,className:i,wrapperProps:s={},isAligned:r,index:c,mode:a,name:d,blockApiVersion:u,blockTitle:f,isSelected:g,isSubtreeDisabled:m,hasOverlay:b,initialPosition:p,blockEditingMode:k,isHighlighted:B,isMultiSelected:y,isPartiallySelected:C,isReusable:S,isDragging:E,hasChildSelected:x,isEditingDisabled:_,hasEditableOutline:w,isTemporarilyEditingAsBlocks:D,defaultClassName:L,isSectionBlock:P}=ce.useContext(mt),M=v(l("Block: %s"),f),j="html"!==a||n?"":"-visual",T=$([t.ref,Lt({clientId:o,initialPosition:p}),It(o),Mt(o),jt({clientId:o,isSelected:g}),Tt(),Pt({clientId:o}),Nt(),h({triggerAnimationOnChange:c,clientId:o}),q({isDisabled:!b}),it({clientId:o,isEnabled:P}),At({isSelected:g})]),N=We(),A=!!N[Ue]&&Y(d)?{"--wp-admin-theme-color":"var(--wp-block-synced-color)","--wp-admin-theme-color--rgb":"var(--wp-block-synced-color--rgb)"}:{};u<2&&o===N.clientId&&!0===globalThis.SCRIPT_DEBUG&&I(`Block type "${d}" must support API version 2 or higher to work correctly with "useBlockProps" method.`);let R=!1;return"-"!==s?.style?.marginTop?.charAt(0)&&"-"!==s?.style?.marginBottom?.charAt(0)&&"-"!==s?.style?.marginLeft?.charAt(0)&&"-"!==s?.style?.marginRight?.charAt(0)||(R=!0),{tabIndex:"disabled"===k?-1:0,...s,...t,ref:T,id:`block-${o}${j}`,role:"document","aria-label":M,"data-block":o,"data-type":d,"data-title":f,inert:m?"true":void 0,className:e("block-editor-block-list__block",{"wp-block":!r,"has-block-overlay":b,"is-selected":g,"is-highlighted":B,"is-multi-selected":y,"is-partially-selected":C,"is-reusable":S,"is-dragging":E,"has-child-selected":x,"is-editing-disabled":_,"has-editable-outline":w,"has-negative-margin":R,"is-content-locked-temporarily-editing-as-blocks":D},i,t.className,s.className,L),style:{...s.style,...t.style,...A}}}Rt.save=we;const{isUnmodifiedBlockContent:Ot}=k(Te);function Vt({children:e,isHtml:t,...n}){return ae.jsx("div",{...Rt(n,{__unstableIsHtml:t}),children:e})}function Ft({block:{__unstableBlockSource:t},mode:n,isLocked:o,canRemove:s,clientId:l,isSelected:r,isSelectionEnabled:c,className:a,__unstableLayoutClassNames:d,name:u,isValid:f,attributes:g,wrapperProps:m,setAttributes:b,onReplace:p,onInsertBlocksAfter:k,onMerge:v,toggleSelection:h}){var I;const{mayDisplayControls:S,mayDisplayParentControls:E,themeSupportsLayout:x,..._}=ce.useContext(mt),{removeBlock:w}=i(W),D=ce.useCallback(()=>w(l),[l,w]),L=vt()||{};let P=ae.jsx(B,{name:u,isSelected:r,attributes:g,setAttributes:b,insertBlocksAfter:o?void 0:k,onReplace:s?p:void 0,onRemove:s?D:void 0,mergeBlocks:s?v:void 0,clientId:l,isSelectionEnabled:c,toggleSelection:h,__unstableLayoutClassNames:d,__unstableParentLayout:Object.keys(L).length?L:void 0,mayDisplayControls:S,mayDisplayParentControls:E,blockEditingMode:_.blockEditingMode,isPreviewMode:_.isPreviewMode});const M=Se(u);M?.getEditWrapperProps&&(m=function(t,n){const o={...t,...n};return t?.hasOwnProperty("className")&&n?.hasOwnProperty("className")&&(o.className=e(t.className,n.className)),t?.hasOwnProperty("style")&&n?.hasOwnProperty("style")&&(o.style={...t.style,...n.style}),o}(m,M.getEditWrapperProps(g)));const j=m&&!!m["data-align"]&&!x,T=a?.includes("is-position-sticky");let N;if(j&&(P=ae.jsx("div",{className:e("wp-block",T&&a),"data-align":m["data-align"],children:P})),f)N="html"===n?ae.jsxs(ae.Fragment,{children:[ae.jsx("div",{style:{display:"none"},children:P}),ae.jsx(Vt,{isHtml:!0,children:ae.jsx(Dt,{clientId:l})})]}):M?.apiVersion>1?P:ae.jsx(Vt,{children:P});else{const e=t?je(t):xe(M,g);N=ae.jsxs(Vt,{className:"has-warning",children:[ae.jsx(Et,{clientId:l}),ae.jsx(y,{children:C(e)})]})}const{"data-align":A,...R}=null!==(I=m)&&void 0!==I?I:{},O={...R,className:e(R.className,A&&x&&`align${A}`,!(A&&T)&&a)};return ae.jsx(mt.Provider,{value:{wrapperProps:O,isAligned:j,..._},children:ae.jsx(wt,{fallback:ae.jsx(Vt,{className:"has-warning",children:ae.jsx(_t,{})}),children:N})})}const zt=S((e,t,n)=>{const{updateBlockAttributes:o,insertBlocks:i,mergeBlocks:s,replaceBlocks:l,toggleSelection:r,__unstableMarkLastChangeAsPersistent:c,moveBlocksToPosition:a,removeBlock:d,selectBlock:u}=e(W);return{setAttributes(e){const{getMultiSelectedBlockClientIds:i}=n.select(W),s=i(),{clientId:l}=t,r=s.length?s:[l];o(r,e)},onInsertBlocks(e,n){const{rootClientId:o}=t;i(e,n,o)},onInsertBlocksAfter(e){const{clientId:o,rootClientId:s}=t,{getBlockIndex:l}=n.select(W),r=l(o);i(e,r+1,s)},onMerge(e){const{clientId:o,rootClientId:r}=t,{getPreviousBlockClientId:c,getNextBlockClientId:f,getBlock:g,getBlockAttributes:m,getBlockName:b,getBlockOrder:p,getBlockIndex:k,getBlockRootClientId:v,canInsertBlockType:h}=n.select(W);function I(){const e=g(o),t=Ae();if(b(o)!==t){const n=Re(e,t);n&&n.length&&l(o,n)}else if(Ne(e)){const e=f(o);e&&n.batch(()=>{d(o),u(e)})}}function B(e,t=!0){const s=v(e),r=p(e),[c]=r;1===r.length&&Oe(g(c))?d(e):n.batch(()=>{const n=g(c),r=Ot(n),m=Ae(),b=Re(n,m),v=!!b?.length&&b.every(t=>h(t.name,e));if(r&&v)l(c,b,t);else if(r&&n.name===m){d(c);const e=f(o);e&&u(e)}else if(h(n.name,s))a([c],e,s,k(e));else{!!b?.length&&b.every(e=>h(e.name,s))?(i(b,k(e),s,t),d(c,!1)):I()}!p(e).length&&Oe(g(e))&&d(e,!1)})}if(e){if(r){const e=f(r);if(e){if(b(r)!==b(e))return void s(r,e);{const t=m(r),o=m(e);if(Object.keys(t).every(e=>t[e]===o[e]))return void n.batch(()=>{a(p(e),e,r),d(e,!1)})}}}const e=f(o);if(!e)return;p(e).length?B(e,!1):s(o,e)}else{const e=c(o);if(e)s(e,o);else if(r){const e=c(r);if(e&&b(r)===b(e)){const t=m(r),o=m(e);if(Object.keys(t).every(e=>t[e]===o[e]))return void n.batch(()=>{a(p(r),r,e),d(r,!1)})}B(r)}else I()}},onReplace(e,n,o){e.length&&!Ne(e[e.length-1])&&c();const i=1===e?.length&&Array.isArray(e[0])?e[0]:e;l([t.clientId],i,n,o)},toggleSelection(e){r(e)}}});Ft=Q(zt,J("editor.BlockListBlock"))(Ft);const Ht=ce.memo(function(e){const{clientId:t,rootClientId:n}=e,i=o(e=>{const{isBlockSelected:o,getBlockMode:i,isSelectionEnabled:s,getTemplateLock:l,isSectionBlock:r,getBlockWithoutAttributes:c,getBlockAttributes:a,canRemoveBlock:d,canMoveBlock:u,getSettings:f,getTemporarilyEditingAsBlocks:g,getBlockEditingMode:m,getBlockName:b,isFirstMultiSelectedBlock:p,getMultiSelectedBlockClientIds:v,hasSelectedInnerBlock:h,getBlocksByName:I,getBlockIndex:B,isBlockMultiSelected:y,isBlockSubtreeDisabled:C,isBlockHighlighted:S,__unstableIsFullySelected:E,__unstableSelectionHasUnmergeableBlock:x,isBlockBeingDragged:_,isDragging:w,__unstableHasActiveBlockOverlayActive:D,getSelectedBlocksInitialCaretPosition:L}=k(e(W)),P=c(t);if(!P)return;const{hasBlockSupport:M,getActiveBlockVariation:j}=e(De),T=a(t),{name:N,isValid:A}=P,R=Se(N),{supportsLayout:O,__unstableIsPreviewMode:V}=f(),F=R?.apiVersion>1,z={isPreviewMode:V,blockWithoutAttributes:P,name:N,attributes:T,isValid:A,themeSupportsLayout:O,index:B(t),isReusable:Pe(R),className:F?T.className:void 0,defaultClassName:F?Le(N):void 0,blockTitle:R?.title};if(V)return z;const H=o(t),K=d(t),G=u(t),U=j(N,T),Z=y(t),X=h(t,!0),$=m(t),q=Me(N,"multiple",!0)?[]:I(N),Y=q.length&&q[0]!==t;return{...z,mode:i(t),isSelectionEnabled:s(),isLocked:!!l(n),isSectionBlock:r(t),canRemove:K,canMove:G,isSelected:H,isTemporarilyEditingAsBlocks:g()===t,blockEditingMode:$,mayDisplayControls:H||p(t)&&v().every(e=>b(e)===N),mayDisplayParentControls:M(b(t),"__experimentalExposeControlsToChildren",!1)&&h(t),blockApiVersion:R?.apiVersion||1,blockTitle:U?.title||R?.title,isSubtreeDisabled:"disabled"===$&&C(t),hasOverlay:D(t)&&!w(),initialPosition:H?L():void 0,isHighlighted:S(t),isMultiSelected:Z,isPartiallySelected:Z&&!E()&&!x(),isDragging:_(t),hasChildSelected:X,isEditingDisabled:"disabled"===$,hasEditableOutline:"disabled"!==$&&"disabled"===m(n),originalBlockClientId:!!Y&&q[0]}},[t,n]),{isPreviewMode:s,mode:l="visual",isSelectionEnabled:r=!1,isLocked:c=!1,canRemove:a=!1,canMove:d=!1,blockWithoutAttributes:u,name:f,attributes:g,isValid:m,isSelected:b=!1,themeSupportsLayout:p,isTemporarilyEditingAsBlocks:v,blockEditingMode:h,mayDisplayControls:I,mayDisplayParentControls:B,index:y,blockApiVersion:C,blockTitle:S,isSubtreeDisabled:E,hasOverlay:x,initialPosition:_,isHighlighted:w,isMultiSelected:D,isPartiallySelected:L,isReusable:P,isDragging:M,hasChildSelected:j,isSectionBlock:T,isEditingDisabled:N,hasEditableOutline:A,className:R,defaultClassName:O,originalBlockClientId:V}=i,F=ce.useMemo(()=>({...u,attributes:g}),[u,g]);if(!i)return null;const z={isPreviewMode:s,clientId:t,className:R,index:y,mode:l,name:f,blockApiVersion:C,blockTitle:S,isSelected:b,isSubtreeDisabled:E,hasOverlay:x,initialPosition:_,blockEditingMode:h,isHighlighted:w,isMultiSelected:D,isPartiallySelected:L,isReusable:P,isDragging:M,hasChildSelected:j,isSectionBlock:T,isEditingDisabled:N,hasEditableOutline:A,isTemporarilyEditingAsBlocks:v,defaultClassName:O,mayDisplayControls:I,mayDisplayParentControls:B,originalBlockClientId:V,themeSupportsLayout:p};return ae.jsx(mt.Provider,{value:z,children:ae.jsx(Ft,{...e,mode:l,isSelectionEnabled:r,isLocked:c,canRemove:a,canMove:d,block:F,name:f,attributes:g,isValid:m,isSelected:b})})});function Kt(e){const{isMultiSelecting:t,getMultiSelectedBlockClientIds:n,hasMultiSelection:o,getSelectedBlockClientId:i,getSelectedBlocksInitialCaretPosition:s,__unstableIsFullySelected:l}=e(W);return{isMultiSelecting:t(),multiSelectedBlockClientIds:n(),hasMultiSelection:o(),selectedBlockClientId:i(),initialPosition:s(),isFullSelection:l()}}function Gt(){const{initialPosition:e,isMultiSelecting:t,multiSelectedBlockClientIds:n,hasMultiSelection:i,selectedBlockClientId:s,isFullSelection:l}=o(Kt,[]);return U(o=>{const{ownerDocument:s}=o,{defaultView:r}=s;if(null==e)return;if(!i||t)return;const{length:c}=n;c<2||l&&(o.contentEditable=!0,o.focus(),r.getSelection().removeAllRanges())},[i,t,n,s,e,l])}function Wt(e,t,n,o){let i,s=u.focusable.find(n);return t&&s.reverse(),s=s.slice(s.indexOf(e)+1),o&&(i=e.getBoundingClientRect()),s.find(function(e){if(!(e.closest("[inert]")||1===e.children.length&&ee(e,e.firstElementChild)&&"true"===e.firstElementChild.getAttribute("contenteditable"))){if(!u.tabbable.isTabbableIndex(e))return!1;if(e.isContentEditable&&"true"!==e.contentEditable)return!1;if(o){const t=e.getBoundingClientRect();if(t.left>=i.right||t.right<=i.left)return!1}return!0}})}function Ut(){const{getMultiSelectedBlocksStartClientId:e,getMultiSelectedBlocksEndClientId:t,getSettings:n,hasMultiSelection:s,__unstableIsFullySelected:l}=o(W),{selectBlock:r}=i(W);return U(o=>{let i;function c(){i=null}function a(c){if(c.defaultPrevented)return;const{keyCode:a,target:d,shiftKey:u,ctrlKey:f,altKey:g,metaKey:m}=c,b=a===D,p=a===P,k=b||p,v=p||a===M,h=b||a===L,I=v||h,B=u||f||g||m,y=h?_:w,{ownerDocument:C}=o,{defaultView:S}=C;if(!I)return;if(s()){if(u)return;if(!l())return;return c.preventDefault(),void(k?r(e()):r(t(),-1))}if(!function(e,t,n){const o=t===D||t===L,{tagName:i}=e,s=e.getAttribute("type");if(o&&!n)return"INPUT"!==i||!["date","datetime-local","month","number","range","time","week"].includes(s);if("INPUT"===i)return["button","checkbox","number","color","file","image","radio","reset","submit"].includes(s);return"TEXTAREA"!==i}(d,a,B))return;h?i||(i=fe(S)):i=null;const E=x(d)?!k:k,{keepCaretInsideBlock:j}=n();if(u)(function(e,t){const n=Wt(e,t,o);return n&&te(n)})(d,k)&&y(d,k)&&(o.contentEditable=!0,o.focus());else if(!h||!_(d,k)||g&&!w(d,E)||j){if(v&&S.getSelection().isCollapsed&&w(d,E)&&!j){const e=Wt(d,E,o);ue(e,k),c.preventDefault()}}else{const e=Wt(d,k,o,!0);e&&(ge(e,g?!k:k,g?void 0:i),c.preventDefault())}}return o.addEventListener("mousedown",c),o.addEventListener("keydown",a),()=>{o.removeEventListener("mousedown",c),o.removeEventListener("keydown",a)}},[])}function Zt(){const{getBlockOrder:e,getSelectedBlockClientIds:t,getBlockRootClientId:n}=o(W),{multiSelect:s,selectBlock:l}=i(W),r=ve();return U(o=>{function i(i){if(!r("core/block-editor/select-all",i))return;const c=t();if(c.length<2&&!j(i.target))return;i.preventDefault();const[a]=c,d=n(a),u=e(d);c.length!==u.length?s(u[0],u[u.length-1]):d&&(o.ownerDocument.defaultView.getSelection().removeAllRanges(),l(d))}return o.addEventListener("keydown",i),()=>{o.removeEventListener("keydown",i)}},[])}function Xt(e,t){e.contentEditable=t,t&&e.focus()}function $t(){const{startMultiSelect:e,stopMultiSelect:t}=i(W),{isSelectionEnabled:n,hasSelectedBlock:s,isDraggingBlocks:l,isMultiSelecting:r}=o(W);return U(o=>{const{ownerDocument:i}=o,{defaultView:c}=i;let a,d;function u(){t(),c.removeEventListener("mouseup",u),d=c.requestAnimationFrame(()=>{if(!s())return;Xt(o,!1);const e=c.getSelection();if(e.rangeCount){const t=e.getRangeAt(0),{commonAncestorContainer:n}=t,o=t.cloneRange();a.contains(n)&&(a.focus(),e.removeAllRanges(),e.addRange(o))}})}function f({buttons:t,target:i,relatedTarget:s}){i.contains(s)||l()||1===t&&(r()||o!==i&&"true"===i.getAttribute("contenteditable")&&n()&&(a=i,e(),c.addEventListener("mouseup",u),Xt(o,!0)))}return o.addEventListener("mouseout",f),()=>{o.removeEventListener("mouseout",f),c.removeEventListener("mouseup",u),c.cancelAnimationFrame(d)}},[e,t,n,s])}function qt(e,t){e.contentEditable!==String(t)&&(e.contentEditable=t)}function Yt(e){const t=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;return t?.closest("[data-wp-block-attribute-key]")}function Qt(){const{multiSelect:e,selectBlock:t,selectionChange:n}=i(W),{getBlockParents:s,getBlockSelectionStart:l,isMultiSelecting:r}=o(W);return U(o=>{const{ownerDocument:i}=o,{defaultView:c}=i;function a(i){const a=c.getSelection();if(!a.rangeCount)return;const d=function(e){const{anchorNode:t,anchorOffset:n}=e;return t.nodeType===t.TEXT_NODE||0===n?t:t.childNodes[n-1]}(a),u=function(e){const{focusNode:t,focusOffset:n}=e;return t.nodeType===t.TEXT_NODE||n===t.childNodes.length?t:0===n&&me(e)?null!==(o=t.previousSibling)&&void 0!==o?o:t.parentElement:t.childNodes[n];var o}(a);if(!o.contains(d)||!o.contains(u))return;const f=i.shiftKey&&"mouseup"===i.type;if(a.isCollapsed&&!f){if("true"===o.contentEditable&&!r()){qt(o,!1);let e=d.nodeType===d.ELEMENT_NODE?d:d.parentElement;e=e?.closest("[contenteditable]"),e?.focus()}return}let g=te(d),m=te(u);if(f){const e=l(),t=te(i.target),n=t!==m;(g===m&&a.isCollapsed||!m||n)&&(m=t),g!==e&&(g=e)}if(void 0===g&&void 0===m)return void qt(o,!1);if(g===m)r()?e(g,g):t(g);else{const t=[...s(g),g],o=[...s(m),m],i=function(e,t){let n=0;for(;e[n]===t[n];)n++;return n}(t,o);if(t[i]!==g||o[i]!==m)return void e(t[i],o[i]);const l=Yt(d),r=Yt(u);if(l&&r){var b,p;const e=a.getRangeAt(0),t=Ie({element:l,range:e,__unstableIsEditableTree:!0}),o=Ie({element:r,range:e,__unstableIsEditableTree:!0}),i=null!==(b=t.start)&&void 0!==b?b:t.end,s=null!==(p=o.start)&&void 0!==p?p:o.end;n({start:{clientId:g,attributeKey:l.dataset.wpBlockAttributeKey,offset:i},end:{clientId:m,attributeKey:r.dataset.wpBlockAttributeKey,offset:s}})}else e(g,m)}}return i.addEventListener("selectionchange",a),c.addEventListener("mouseup",a),()=>{i.removeEventListener("selectionchange",a),c.removeEventListener("mouseup",a)}},[e,t,n,s])}function Jt(){const{selectBlock:e}=i(W),{isSelectionEnabled:t,getBlockSelectionStart:n,hasMultiSelection:s}=o(W);return U(o=>{function i(i){if(!t()||0!==i.button)return;const l=n(),r=te(i.target);i.shiftKey?l!==r&&(o.contentEditable=!0,o.focus()):s()&&e(r)}return o.addEventListener("mousedown",i),()=>{o.removeEventListener("mousedown",i)}},[e,t,n,s])}function en(){const{__unstableIsFullySelected:e,getSelectedBlockClientIds:t,getSelectedBlockClientId:n,__unstableIsSelectionMergeable:s,hasMultiSelection:l,getBlockName:r,canInsertBlockType:c,getBlockRootClientId:a,getSelectionStart:d,getSelectionEnd:u,getBlockAttributes:f}=o(W),{replaceBlocks:g,__unstableSplitSelection:k,removeBlocks:v,__unstableDeleteSelection:h,__unstableExpandSelection:I,__unstableMarkAutomaticChange:B}=i(W);return U(o=>{function i(e){"true"===o.contentEditable&&e.preventDefault()}function y(i){if(!i.defaultPrevented)if(l())i.keyCode===m?(o.contentEditable=!1,i.preventDefault(),e()?g(t(),Be(Ae())):k()):i.keyCode===b||i.keyCode===p?(o.contentEditable=!1,i.preventDefault(),e()?v(t()):s()?h(i.keyCode===p):I()):1!==i.key.length||i.metaKey||i.ctrlKey||(o.contentEditable=!1,s()?h(i.keyCode===p):(i.preventDefault(),o.ownerDocument.defaultView.getSelection().removeAllRanges()));else if(i.keyCode===m){if(i.shiftKey||e())return;const t=n(),o=r(t),s=d(),l=u();if(s.attributeKey===l.attributeKey){const e=f(t)[s.attributeKey],n=Ve("from").filter(({type:e})=>"enter"===e),o=Fe(n,t=>t.regExp.test(e));if(o)return g(t,o.transform({content:e})),void B()}if(!Me(o,"splitting",!1)&&!i.__deprecatedOnSplit)return;c(o,a(t))&&(k(),i.preventDefault())}}function C(e){l()&&(o.contentEditable=!1,s()?h():(e.preventDefault(),o.ownerDocument.defaultView.getSelection().removeAllRanges()))}return o.addEventListener("beforeinput",i),o.addEventListener("keydown",y),o.addEventListener("compositionstart",C),()=>{o.removeEventListener("beforeinput",i),o.removeEventListener("keydown",y),o.removeEventListener("compositionstart",C)}},[])}const tn=Symbol("requiresWrapperOnCopy");function nn(e,t,n){let o=t;const[i]=t;if(i){if(n.select(De).getBlockType(i.name)[tn]){const{getBlockRootClientId:e,getBlockName:t,getBlockAttributes:s}=n.select(W),l=e(i.clientId),r=t(l);r&&(o=Be(r,s(l),o))}}const s=ze(o);e.clipboardData.setData("text/plain",function(e){e=e.replace(/<br>/g,"\n");return T(e).trim().replace(/\n\n+/g,"\n\n")}(s)),e.clipboardData.setData("text/html",s)}function on(e,t){const{plainText:n,html:o,files:i}=ne(e);let s=[];if(i.length){const e=Ve("from");s=i.reduce((t,n)=>{const o=Fe(e,e=>"files"===e.type&&e.isMatch([n]));return o&&t.push(o.transform([n])),t},[]).flat()}else s=He({HTML:o,plainText:n,mode:"BLOCKS"});return s}function sn(){const e=Ze(),{getBlocksByClientId:t,getSelectedBlockClientIds:n,hasMultiSelection:s,getSettings:l,getBlockName:r,__unstableIsFullySelected:c,__unstableIsSelectionCollapsed:a,__unstableIsSelectionMergeable:d,__unstableGetSelectedBlocksWithPartialSelection:u,canInsertBlockType:f,getBlockRootClientId:g}=o(W),{flashBlock:m,removeBlocks:b,replaceBlocks:p,__unstableDeleteSelection:k,__unstableExpandSelection:v,__unstableSplitSelection:h}=i(W),I=Ke();return U(o=>{function i(i){if(i.defaultPrevented)return;const B=n();if(0===B.length)return;if(!s()){const{target:e}=i,{ownerDocument:t}=e;if("copy"===i.type||"cut"===i.type?be(t):pe(t)&&!t.activeElement.isContentEditable)return}const{activeElement:y}=i.target.ownerDocument;if(!o.contains(y))return;const C=d(),S=a()||c(),E=!S&&!C;if("copy"===i.type||"cut"===i.type)if(i.preventDefault(),1===B.length&&m(B[0]),E)v();else{let n;if(I(i.type,B),S)n=t(B);else{const[e,o]=u();n=[e,...t(B.slice(1,B.length-1)),o]}nn(i,n,e)}if("cut"===i.type)S&&!E?b(B):(i.target.ownerDocument.activeElement.contentEditable=!1,k());else if("paste"===i.type){const{__experimentalCanUserUseUnfilteredHTML:e}=l();if("true"===i.clipboardData.getData("rich-text"))return;const{plainText:t,html:n,files:o}=ne(i),a=c();let d=[];if(o.length){const e=Ve("from");d=o.reduce((t,n)=>{const o=Fe(e,e=>"files"===e.type&&e.isMatch([n]));return o&&t.push(o.transform([n])),t},[]).flat()}else d=He({HTML:n,plainText:t,mode:a?"BLOCKS":"AUTO"});if("string"==typeof d)return;if(a)return p(B,d,d.length-1,-1),void i.preventDefault();if(!s()&&!Me(r(B[0]),"splitting",!1)&&!i.__deprecatedOnSplit)return;const[u]=B,m=g(u),b=[];for(const i of d)if(f(i.name,m))b.push(i);else{const e=r(m),t=i.name!==e?Re(i,e):[i];if(!t)return;for(const n of t)for(const e of n.innerBlocks)b.push(e)}h(b),i.preventDefault()}}return o.ownerDocument.addEventListener("copy",i),o.ownerDocument.addEventListener("cut",i),o.ownerDocument.addEventListener("paste",i),()=>{o.ownerDocument.removeEventListener("copy",i),o.ownerDocument.removeEventListener("cut",i),o.ownerDocument.removeEventListener("paste",i)}},[])}function ln(){const[e,t,n]=function(){const e=ce.useRef(),t=ce.useRef(),n=ce.useRef(),{hasMultiSelection:s,getSelectedBlockClientId:l,getBlockCount:r}=o(W),{setLastFocus:c}=k(i(W)),{getLastFocus:a}=k(o(W)),d=ce.useRef();function f(t){if(d.current)d.current=null;else if(s())e.current.focus();else if(l())a()?.current?a().current.focus():e.current.querySelector(`[data-block="${l()}"]`).focus();else{const n=e.current.ownerDocument===t.target.ownerDocument?e.current:e.current.ownerDocument.defaultView.frameElement,o=t.target.compareDocumentPosition(n)&t.target.DOCUMENT_POSITION_FOLLOWING,i=u.tabbable.find(e.current);i.length&&(o?i[0]:i[i.length-1]).focus()}}const m=ae.jsx("div",{ref:t,tabIndex:"0",onFocus:f}),b=ae.jsx("div",{ref:n,tabIndex:"0",onFocus:f}),p=U(o=>{function i(e){if(e.defaultPrevented)return;if(e.keyCode!==E)return;const o=e.shiftKey,i=o?"findPrevious":"findNext",s=u.tabbable[i](e.target),l=e.target.closest("[data-block]"),r=l&&s&&(ee(l,s)||Z(l,s));if(g(s)&&r)return;const c=o?t:n;d.current=!0,c.current.focus({preventScroll:!0})}function s(e){c({...a(),current:e.target});const{ownerDocument:t}=o;e.relatedTarget||t.activeElement!==t.body||0!==r()||o.focus()}function l(o){if(o.keyCode!==E)return;if("region"===o.target?.getAttribute("role"))return;if(e.current===o.target)return;const i=o.shiftKey?"findPrevious":"findNext",s=u.tabbable[i](o.target);s!==t.current&&s!==n.current||(o.preventDefault(),s.focus({preventScroll:!0}))}const{ownerDocument:f}=o,{defaultView:m}=f;return m.addEventListener("keydown",l),o.addEventListener("keydown",i),o.addEventListener("focusout",s),()=>{m.removeEventListener("keydown",l),o.removeEventListener("keydown",i),o.removeEventListener("focusout",s)}},[]);return[m,$([e,p]),b]}(),s=o(e=>e(W).hasMultiSelection(),[]);return[e,$([t,sn(),en(),$t(),Qt(),Jt(),Gt(),Zt(),Ut(),U(e=>{if(e.tabIndex=0,s)return e.classList.add("has-multi-selection"),e.setAttribute("aria-label",l("Multiple selected blocks")),()=>{e.classList.remove("has-multi-selection"),e.removeAttribute("aria-label")}},[s])]),n]}const rn=ce.forwardRef(function({children:t,...n},o){const[i,s,l]=ln();return ae.jsxs(ae.Fragment,{children:[i,ae.jsx("div",{...n,ref:$([s,o]),className:e(n.className,"block-editor-writing-flow"),children:t}),l]})});function cn({rootClientId:e}){return o(t=>t(W).canInsertBlockType(Ae(),e))?ae.jsx(N,{rootClientId:e}):ae.jsx(A,{rootClientId:e,className:"block-list-appender__toggle"})}function an({rootClientId:t,CustomAppender:n,className:i,tagName:s="div"}){const l=o(e=>{const{getBlockInsertionPoint:n,isBlockInsertionPointVisible:o,getBlockCount:i}=e(W),s=n();return o()&&t===s?.rootClientId&&0===i(t)},[t]);return ae.jsx(s,{tabIndex:-1,className:e("block-list-appender wp-block",i,{"is-drag-over":l}),contentEditable:!1,"data-block":!0,children:n?ae.jsx(n,{}):ae.jsx(cn,{rootClientId:t})})}const dn=ce.createContext();function un({__unstablePopoverSlot:t,__unstableContentRef:n,operation:s="insert",nearestSide:l="right"}){const{selectBlock:r,hideInsertionPoint:c}=i(W),a=ce.useContext(dn),d=ce.useRef(),{orientation:u,previousClientId:f,nextClientId:g,rootClientId:m,isInserterShown:b,isDistractionFree:p,isZoomOutMode:k}=o(e=>{const{getBlockOrder:t,getBlockListSettings:n,getBlockInsertionPoint:o,isBlockBeingDragged:i,getPreviousBlockClientId:s,getNextBlockClientId:l,getSettings:r,__unstableGetEditorMode:c}=e(W),a=o(),d=t(a.rootClientId);if(!d.length)return{};let u=d[a.index-1],f=d[a.index];for(;i(u);)u=s(u);for(;i(f);)f=l(f);const g=r();return{previousClientId:u,nextClientId:f,orientation:n(a.rootClientId)?.orientation||"vertical",rootClientId:a.rootClientId,isDistractionFree:g.isDistractionFree,isInserterShown:a?.__unstableWithInserter,isZoomOutMode:"zoom-out"===c()}},[]),{getBlockEditingMode:v}=o(W),h=X();const I={start:{opacity:0,scale:0},rest:{opacity:1,scale:1,transition:{delay:b?.5:0,type:"tween"}},hover:{opacity:1,scale:1,transition:{delay:.5,type:"tween"}}},B={start:{scale:h?1:0},rest:{scale:1,transition:{delay:.4,type:"tween"}}};if(p)return null;if(k&&"insert"!==s)return null;const y=e("block-editor-block-list__insertion-point","horizontal"===u||"group"===s?"is-horizontal":"is-vertical");return ae.jsx(Ye,{previousClientId:f,nextClientId:g,__unstablePopoverSlot:t,__unstableContentRef:n,operation:s,nearestSide:l,children:ae.jsxs(Qe.div,{layout:!h,initial:h?"rest":"start",animate:"rest",whileHover:"hover",whileTap:"pressed",exit:"start",ref:d,tabIndex:-1,onClick:function(e){e.target===d.current&&g&&"disabled"!==v(g)&&r(g,-1)},onFocus:function(e){e.target!==d.current&&(a.current=!0)},className:e(y,{"is-with-inserter":b}),onHoverEnd:function(e){e.target!==d.current||a.current||c()},children:[ae.jsx(Qe.div,{variants:I,className:"block-editor-block-list__insertion-point-indicator","data-testid":"block-list-insertion-point-indicator"}),b&&ae.jsx(Qe.div,{variants:B,className:e("block-editor-block-list__insertion-point-inserter"),children:ae.jsx(st,{position:"bottom center",clientId:g,rootClientId:m,__experimentalIsQuick:!0,onToggle:e=>{a.current=e},onSelectOrClose:()=>{a.current=!1}})})]})})}function fn(e){const{insertionPoint:t,isVisible:n,isBlockListEmpty:i}=o(e=>{const{getBlockInsertionPoint:t,isBlockInsertionPointVisible:n,getBlockCount:o}=e(W),i=t();return{insertionPoint:i,isVisible:n(),isBlockListEmpty:0===o(i?.rootClientId)}},[]);return!n||i?null:"replace"===t.operation?ae.jsx(ct,{...e},`${t.rootClientId}-${t.index}`):ae.jsx(un,{operation:t.operation,nearestSide:t.nearestSide,...e})}function gn(){const e=ce.useContext(dn),t=o(e=>e(W).getSettings().isDistractionFree||"zoom-out"===e(W).__unstableGetEditorMode(),[]),{getBlockListSettings:n,getBlockIndex:s,isMultiSelecting:l,getSelectedBlockClientIds:r,getSettings:c,getTemplateLock:a,__unstableIsWithinBlockOverlay:d,getBlockEditingMode:u,getBlockName:f,getBlockAttributes:g,getParentSectionBlock:m}=k(o(W)),{showInsertionPoint:b,hideInsertionPoint:p}=i(W);return U(o=>{if(!t)return o.addEventListener("mousemove",i),()=>{o.removeEventListener("mousemove",i)};function i(t){if(void 0===e||e.current)return;if(t.target.nodeType===t.target.TEXT_NODE)return;if(l())return;if(!t.target.classList.contains("block-editor-block-list__layout"))return void p();let o;if(!t.target.classList.contains("is-root-container")){o=(t.target.getAttribute("data-block")?t.target:t.target.closest("[data-block]")).getAttribute("data-block")}if(a(o)||"disabled"===u(o)||"core/block"===f(o)||o&&g(o).layout?.isManualPlacement)return;const i=n(o),k=i?.orientation||"vertical",v=!!i?.__experimentalCaptureToolbars,h=t.clientY,I=t.clientX;let B=Array.from(t.target.children).find(e=>{const t=e.getBoundingClientRect();return e.classList.contains("wp-block")&&"vertical"===k&&t.top>h||e.classList.contains("wp-block")&&"horizontal"===k&&(R()?t.right<I:t.left>I)});if(!B)return void p();if(!B.id&&(B=B.firstElementChild,!B))return void p();const y=B.id.slice(6);if(!y||d(y)||m(y))return;if(r().includes(y)&&"vertical"===k&&!v&&!c().hasFixedToolbar)return;const C=B.getBoundingClientRect();if("horizontal"===k&&(t.clientY>C.bottom||t.clientY<C.top)||"vertical"===k&&(t.clientX>C.right||t.clientX<C.left))return void p();const S=s(y);0!==S?b(o,S,{__unstableWithInserter:!0}):p()}},[e,n,s,l,b,p,r,t])}const mn=new Set([D,M,L,P,m,b]);function bn(){const e=o(e=>e(W).isTyping(),[]),{stopTyping:t}=i(W);return U(n=>{if(!e)return;const{ownerDocument:o}=n;let i,s;function l(e){const{clientX:n,clientY:o}=e;i&&s&&(i!==n||s!==o)&&t(),i=n,s=o}return o.addEventListener("mousemove",l),()=>{o.removeEventListener("mousemove",l)}},[e,t])}function pn(){const{isTyping:e}=o(e=>{const{isTyping:t}=e(W);return{isTyping:t()}},[]),{startTyping:t,stopTyping:n}=i(W),s=bn(),l=U(o=>{const{ownerDocument:i}=o,{defaultView:s}=i,l=s.getSelection();if(e){let c;function a(e){const{target:t}=e;c=s.setTimeout(()=>{f(t)||n()})}function d(e){const{keyCode:t}=e;t!==O&&t!==E||n()}function u(){l.isCollapsed||n()}return o.addEventListener("focus",a),o.addEventListener("keydown",d),i.addEventListener("selectionchange",u),()=>{s.clearTimeout(c),o.removeEventListener("focus",a),o.removeEventListener("keydown",d),i.removeEventListener("selectionchange",u)}}function r(e){const{type:n,target:i}=e;f(i)&&o.contains(i)&&("keydown"!==n||function(e){const{keyCode:t,shiftKey:n}=e;return!n&&mn.has(t)}(e))&&t()}return o.addEventListener("keypress",r),o.addEventListener("keydown",r),()=>{o.removeEventListener("keypress",r),o.removeEventListener("keydown",r)}},[e,t,n]);return $([s,l])}function kn({children:e}){return ae.jsx("div",{ref:pn(),children:e})}function vn({clientId:t,rootClientId:n="",position:i="top"}){const[s,r]=ce.useState(!1),{sectionRootClientId:c,sectionClientIds:a,insertionPoint:d,blockInsertionPointVisible:u,blockInsertionPoint:f}=o(e=>{const{getInsertionPoint:t,getBlockOrder:n,getSectionRootClientId:o,isBlockInsertionPointVisible:i,getBlockInsertionPoint:s}=k(e(W)),l=o();return{sectionRootClientId:l,sectionClientIds:n(l),blockOrder:n(l),insertionPoint:t(),blockInsertionPoint:s(),blockInsertionPointVisible:i()}},[]),g=X();if(!t)return;let m=!1;if(!(n===c&&a&&a.includes(t)))return null;const b=0===d?.index&&t===a[d.index],p=d&&d.hasOwnProperty("index")&&t===a[d.index-1];return"top"===i&&(m=b||u&&0===f.index&&t===a[f.index]),"bottom"===i&&(m=p||u&&t===a[f.index-1]),ae.jsx(Je,{children:m&&ae.jsx(Qe.div,{as:"button",layout:!g,initial:{height:0},animate:{height:"120px"},exit:{height:0},transition:{type:"tween",duration:.2,ease:[.6,0,.4,1]},className:e("block-editor-block-list__zoom-out-separator",{"is-dragged-over":s}),"data-is-insertion-point":"true",onDragOver:()=>r(!0),onDragLeave:()=>r(!1),children:ae.jsx(Qe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{type:"tween",duration:.1},children:l("Drop pattern.")})})})}const hn=ce.createContext(),In=new WeakMap;function Bn({className:t,...n}){const s=oe("medium"),{isOutlineMode:l,isFocusMode:r,temporarilyEditingAsBlocks:c}=o(e=>{const{getSettings:t,getTemporarilyEditingAsBlocks:n,isTyping:o}=k(e(W)),{outlineMode:i,focusMode:s}=t();return{isOutlineMode:i&&!o(),isFocusMode:s,temporarilyEditingAsBlocks:n()}},[]),a=Ze(),{setBlockVisibility:d}=i(W),u=ie(ce.useCallback(()=>{const e={};In.get(a).forEach(([t,n])=>{e[t]=n}),d(e)},[a]),300,{trailing:!0}),f=ce.useMemo(()=>{const{IntersectionObserver:e}=window;if(e)return new e(e=>{In.get(a)||In.set(a,[]);for(const t of e){const e=t.target.getAttribute("data-block");In.get(a).push([e,t.isIntersecting])}u()})},[]),g=V({ref:$([ke(),gn(),pn()]),className:e("is-root-container",t,{"is-outline-mode":l,"is-focus-mode":r&&s})},n);return ae.jsxs(hn.Provider,{value:f,children:[ae.jsx("div",{...g}),!!c&&ae.jsx(yn,{clientId:c})]})}function yn({clientId:e}){const{stopEditingAsBlocks:t}=k(i(W)),n=o(t=>{const{isBlockSelected:n,hasSelectedInnerBlock:o}=t(W);return n(e)||o(e,!0)},[e]);return ce.useEffect(()=>{n||t(e)},[n,e,t]),null}function Cn(e){return ae.jsx(Xe,{value:$e,children:ae.jsx(Bn,{...e})})}const Sn=[],En=new Set;function xn({placeholder:e,rootClientId:t,renderAppender:n,__experimentalAppenderTagName:i,layout:s=bt}){const l=!1!==n,r=!!n,{order:c,isZoomOut:a,selectedBlocks:d,visibleBlocks:u,shouldRenderAppender:f}=o(e=>{const{getSettings:n,getBlockOrder:o,getSelectedBlockClientId:i,getSelectedBlockClientIds:s,__unstableGetVisibleBlocks:c,getTemplateLock:a,getBlockEditingMode:d,__unstableGetEditorMode:u,isSectionBlock:f}=k(e(W)),g=o(t);if(n().__unstableIsPreviewMode)return{order:g,selectedBlocks:Sn,visibleBlocks:En};const m=i();return{order:g,selectedBlocks:s(),visibleBlocks:c(),isZoomOut:"zoom-out"===u(),shouldRenderAppender:!f(t)&&"disabled"!==d(t)&&!a(t)&&l&&"zoom-out"!==u()&&(r||t===m||!t&&!m&&!g.length)}},[t,l,r]);return ae.jsxs(kt,{value:s,children:[c.map(e=>ae.jsxs(qe,{value:!u.has(e)&&!d.includes(e),children:[a&&ae.jsx(vn,{clientId:e,rootClientId:t,position:"top"}),ae.jsx(Ht,{rootClientId:t,clientId:e}),a&&ae.jsx(vn,{clientId:e,rootClientId:t,position:"bottom"})]},e)),c.length<1&&e,f&&ae.jsx(an,{tagName:i,rootClientId:t,CustomAppender:n})]})}function _n(e){return ae.jsx(qe,{value:!1,children:ae.jsx(xn,{...e})})}const wn={placement:"top-start"},Dn={...wn,flip:!1,shift:!0},Ln={...wn,flip:!0,shift:!1};function Pn(e,t,n,o,i){if(!e||!t)return Dn;const s=n?.scrollTop||0,l=le(t),r=s+e.getBoundingClientRect().top,c=e.ownerDocument.documentElement.clientHeight,a=r+o,d=l.top>a,u=l.height>c-o;return i||!d&&!u?Ln:Dn}function Mn({contentElement:e,clientId:t}){const n=Ct(t),[i,s]=ce.useState(0),{blockIndex:l,isSticky:r}=o(e=>{const{getBlockIndex:n,getBlockAttributes:o}=e(W);return{blockIndex:n(t),isSticky:se(o(t))}},[t]),c=ce.useMemo(()=>{if(e)return F(e)},[e]),[a,d]=ce.useState(()=>Pn(e,n,c,i,r)),u=U(e=>{s(e.offsetHeight)},[]),f=ce.useCallback(()=>d(Pn(e,n,c,i,r)),[e,n,c,i]);return ce.useLayoutEffect(f,[l,f]),ce.useLayoutEffect(()=>{if(!e||!n)return;const t=e?.ownerDocument?.defaultView;let o;t?.addEventHandler?.("resize",f);const i=n?.ownerDocument?.defaultView;return i.ResizeObserver&&(o=new i.ResizeObserver(f),o.observe(n)),()=>{t?.removeEventHandler?.("resize",f),o&&o.disconnect()}},[f,e,n]),{...a,ref:u}}function jn(e){return o(t=>{const{getBlockRootClientId:n,getBlockParents:o,__experimentalGetBlockListSettingsForBlocks:i,isBlockInsertionPointVisible:s,getBlockInsertionPoint:l,getBlockOrder:r,hasMultiSelection:c,getLastMultiSelectedBlockClientId:a}=t(W),d=o(e),u=i(d),f=d.find(e=>u[e]?.__experimentalCaptureToolbars);let g=!1;if(s()){const t=l();g=r(t.rootClientId)[t.index]===e}return{capturingClientId:f,isInsertionPointVisible:g,lastClientId:c()?a():null,rootClientId:n(e)}},[e])}function Tn({clientId:t,__unstableContentRef:n}){const{capturingClientId:o,isInsertionPointVisible:i,lastClientId:s,rootClientId:l}=jn(t),r=Mn({contentElement:n?.current,clientId:t});return ae.jsx(et,{clientId:o||t,bottomClientId:s,className:e("block-editor-block-list__block-side-inserter-popover",{"is-insertion-point-visible":i}),__unstableContentRef:n,...r,children:ae.jsx("div",{className:"block-editor-block-list__empty-block-inserter",children:ae.jsx(st,{position:"bottom right",rootClientId:l,clientId:t,__experimentalIsQuick:!0})})})}function Nn({clientId:t,isTyping:n,__unstableContentRef:o}){const{capturingClientId:s,isInsertionPointVisible:l,lastClientId:r}=jn(t),c=ce.useRef();ce.useEffect(()=>{c.current=void 0},[t]);const{stopTyping:a}=i(W),d=ce.useRef(!1);he("core/block-editor/focus-toolbar",()=>{d.current=!0,a(!0)}),ce.useEffect(()=>{d.current=!1});const u=s||t,f=Mn({contentElement:o?.current,clientId:u});return!n&&ae.jsx(tt,{clientId:u,bottomClientId:r,className:e("block-editor-block-list__block-popover",{"is-insertion-point-visible":l}),resize:!1,...f,children:ae.jsx(lt,{focusOnMount:d.current,__experimentalInitialIndex:c.current,__experimentalOnIndexChange:e=>{c.current=e},variant:"toolbar"})})}function An({clientId:e,__unstableContentRef:t}){const n=o(t=>{const{getBlock:n,getNextBlockClientId:o,getPreviousBlockClientId:i,canRemoveBlock:s,canMoveBlock:l,getSettings:r}=t(W),{__experimentalSetIsInserterOpened:c}=r(),{getBlockType:a}=t(De),{name:d}=n(e),u=a(d),f="core/template-part"===u?.name;let g=!1;const m=o();if(m){const{name:e}=n(m),t=a(e);g="core/template-part"===t?.name}let b=!1;const p=i();if(p){const{name:e}=n(p),t=a(e);b="core/template-part"===t?.name}return{isBlockTemplatePart:f,isNextBlockTemplatePart:g,isPrevBlockTemplatePart:b,canRemove:s(e),canMove:l(e),setIsInserterOpened:c}},[e]),{isBlockTemplatePart:s,isNextBlockTemplatePart:r,isPrevBlockTemplatePart:a,canRemove:d,canMove:u,setIsInserterOpened:f}=n,{removeBlock:g,__unstableSetEditorMode:m,resetZoomLevel:b}=k(i(W)),p=u&&!s;return ae.jsxs(z,{className:"zoom-out-toolbar","aria-label":l("Block tools"),variant:"unstyled",orientation:"vertical",children:[p&&ae.jsx(at,{clientIds:[e],children:e=>ae.jsx(c,{icon:dt,className:"block-selection-button_drag-handle zoom-out-toolbar-button",label:l("Drag"),iconSize:24,size:"compact",tabIndex:"-1",...e})}),!s&&ae.jsx(H,{clientIds:[e],hideDragHandle:!0,isBlockMoverUpButtonDisabled:a,isBlockMoverDownButtonDisabled:r,iconSize:24,size:"compact"}),u&&d&&ae.jsx(rt,{clientId:e,as:K}),!s&&ae.jsx(K,{className:"zoom-out-toolbar-button",icon:ut,label:l("Edit"),onClick:()=>{"function"==typeof f&&f(!1),m("edit"),b(),t.current?.focus()}}),d&&!s&&ae.jsx(K,{className:"zoom-out-toolbar-button",icon:ft,label:l("Delete"),onClick:()=>{g(e),t.current?.focus()}})]})}function Rn({clientId:t,__unstableContentRef:n}){const{capturingClientId:o,isInsertionPointVisible:i,lastClientId:s}=jn(t),l={...Mn({contentElement:n?.current,clientId:t}),placement:"left-start",flip:!1,shift:!0};return ae.jsx(tt,{clientId:o||t,bottomClientId:s,className:e("zoom-out-toolbar-popover",{"is-insertion-point-visible":i}),resize:!1,...l,children:ae.jsx(An,{__unstableContentRef:n,clientId:t})})}function On({onClick:t}){return ae.jsx(c,{variant:"primary",icon:gt,size:"compact",className:e("block-editor-button-pattern-inserter__button","block-editor-block-tools__zoom-out-mode-inserter-button"),onClick:t,label:s("Add pattern","Generic label for pattern inserter button")})}function Vn(){const[e,t]=ce.useState(!1),{hasSelection:n,insertionPoint:s,blockOrder:l,blockInsertionPointVisible:r,setInserterIsOpened:c,sectionRootClientId:a,selectedBlockClientId:d}=o(e=>{const{getSettings:t,getInsertionPoint:n,getBlockOrder:o,getSelectionStart:i,getSelectedBlockClientId:s,getSectionRootClientId:l,isBlockInsertionPointVisible:r}=k(e(W)),c=l();return{hasSelection:!!i().clientId,insertionPoint:n(),blockOrder:o(c),blockInsertionPointVisible:r(),sectionRootClientId:c,setInserterIsOpened:t().__experimentalSetIsInserterOpened,selectedBlockClientId:s()}},[]),{showInsertionPoint:u}=k(i(W));return ce.useEffect(()=>{const e=setTimeout(()=>{t(!0)},500);return()=>{clearTimeout(e)}},[]),e&&n?[void 0,...l].map((e,t)=>{const n=r&&s?.index===t,o=e,i=l[t],f=d===o||d===i;return ae.jsx(Ye,{previousClientId:o,nextClientId:i,children:!n&&f&&ae.jsx(On,{onClick:()=>{c({rootClientId:a,insertionIndex:t,tab:"patterns",category:"all"}),u(a,t,{operation:"insert"})}})},t)}):null}function Fn(e){const{getSelectedBlockClientId:t,getFirstMultiSelectedBlockClientId:n,getSettings:o,__unstableGetEditorMode:i,isTyping:s,isDragging:l}=k(e(W)),r=t()||n(),c=i();return{clientId:r,hasFixedToolbar:o().hasFixedToolbar,isTyping:s(),isZoomOutMode:"zoom-out"===c,isDragging:l()}}function zn({children:e,__unstableContentRef:t,...n}){const{clientId:s,hasFixedToolbar:r,isTyping:c,isZoomOutMode:a,isDragging:d}=o(Fn,[]),u=ve(),{getBlocksByClientId:g,getSelectedBlockClientIds:m,getBlockRootClientId:b,isGroupable:p}=o(W),{getGroupingBlockName:v}=o(De),{showEmptyBlockSideInserter:h,showBlockToolbarPopover:I,showZoomOutToolbar:B}=o(e=>{const{getSelectedBlockClientId:t,getFirstMultiSelectedBlockClientId:n,getBlock:o,getBlockMode:i,getSettings:s,__unstableGetEditorMode:l,isTyping:r}=e(W),c=t()||n(),a=o(c),d=l(),u=!!c&&!!a,f=u&&Ne(a)&&"html"!==i(c),g=c&&!r()&&"edit"===d&&f,m="zoom-out"===d&&"full"===a?.attributes?.align&&!g;return{showEmptyBlockSideInserter:g,showBlockToolbarPopover:!m&&!s().hasFixedToolbar&&!g&&u&&!f,showZoomOutToolbar:m}},[]),{clearSelectedBlock:y,duplicateBlocks:C,removeBlocks:S,replaceBlocks:E,insertAfterBlock:x,insertBeforeBlock:_,selectBlock:w,moveBlocksUp:D,moveBlocksDown:L,expandBlock:P}=k(i(W)),M=ce.useRef();const j=nt(t),T=nt(t);return ae.jsx("div",{...n,onKeyDown:function(e){if(!e.defaultPrevented)if(u("core/block-editor/move-up",e)){const t=m();if(t.length){e.preventDefault();const n=b(t[0]);D(t,n)}}else if(u("core/block-editor/move-down",e)){const t=m();if(t.length){e.preventDefault();const n=b(t[0]);L(t,n)}}else if(u("core/block-editor/duplicate",e)){const t=m();t.length&&(e.preventDefault(),C(t))}else if(u("core/block-editor/remove",e)){const t=m();t.length&&(e.preventDefault(),S(t))}else if(u("core/block-editor/insert-after",e)){const t=m();t.length&&(e.preventDefault(),x(t[t.length-1]))}else if(u("core/block-editor/insert-before",e)){const t=m();t.length&&(e.preventDefault(),_(t[0]))}else if(u("core/block-editor/unselect",e)){if(e.target.closest("[role=toolbar]"))return;const n=m();n.length>1?(e.preventDefault(),w(n[0])):1===n.length&&e.target===M?.current&&(e.preventDefault(),y(),re(t.current)?.focus())}else if(u("core/block-editor/collapse-list-view",e)){if(f(e.target)||f(e.target?.contentWindow?.document?.activeElement))return;e.preventDefault(),P(s)}else if(u("core/block-editor/group",e)){const t=m();if(t.length>1&&p(t)){e.preventDefault();const n=g(t),o=v(),i=Re(n,o);E(t,i),G(l("Selected blocks are grouped."))}}},children:ae.jsxs(dn.Provider,{value:ce.useRef(!1),children:[!c&&!a&&ae.jsx(fn,{__unstableContentRef:t}),h&&ae.jsx(Tn,{__unstableContentRef:t,clientId:s}),I&&ae.jsx(Nn,{__unstableContentRef:t,clientId:s,isTyping:c}),B&&ae.jsx(Rn,{__unstableContentRef:t,clientId:s}),!a&&!r&&ae.jsx(ot.Slot,{name:"block-toolbar",ref:j}),e,ae.jsx(ot.Slot,{name:"__unstable-block-tools-after",ref:T}),a&&!d&&ae.jsx(Vn,{__unstableContentRef:t})]})})}export{_n as B,ht as L,kn as O,mt as P,rn as W,Ct as a,vt as b,yt as c,ln as d,bn as e,zn as f,on as g,Cn as h,Rt as i,pn as j,tn as r,nn as s,sn as u};
