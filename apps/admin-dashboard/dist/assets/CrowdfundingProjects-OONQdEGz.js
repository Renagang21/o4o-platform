import{a3 as $,r as p,j as e,bA as g,P as b,bM as A,w,S as L,cg as R,c2 as _,Y as E}from"./vendor-react-k21L8gyu.js";import{a as C}from"./vendor-query-D5rBm9N_.js";import{B as r,C as n,m as i,s as P,I as U,k as I,l as K,j as S}from"./page-gutenberg-DfBK4wFH.js";import"./wp-block-editor-DM9yXXIa.js";import"./wp-i18n-DQMG9Moe.js";import"./wp-core-CTkjrE6Y.js";import"./wp-blocks-core-m9M-jdYH.js";import"./wp-misc-eJXghOJf.js";import"./wp-data-CiqFlSQ4.js";import"./vendor-ui-BkLtITBR.js";import"./vendor-monaco-cpVGocfO.js";import"./vendor-utils-DQ8F5vJI.js";import"./wp-components-C7vO1IIk.js";const ae=()=>{const x=$(),[h,k]=p.useState(""),[j,M]=p.useState("all"),[l,o]=p.useState(1),N=12,{data:f,isLoading:D}=C({queryKey:["crowdfunding-projects",{search:h,status:j,page:l,limit:N}],queryFn:async()=>{const s={page:l,limit:N,...h&&{search:h},...j!=="all"&&{status:j}},t=new URLSearchParams(Object.entries(s).reduce((d,[u,v])=>(v!==void 0&&(d[u]=String(v)),d),{})).toString();return(await S.api.get(`/v1/crowdfunding-simple/projects?${t}`)).data}}),y=f?.data||[],c=f?.pagination,{data:T}=C({queryKey:["crowdfunding-stats"],queryFn:async()=>(await S.api.get("/v1/crowdfunding-simple/dashboard/stats")).data}),m=T?.data,B=s=>{const t={recruiting:{label:"모집중",variant:"default",color:"bg-blue-500"},in_progress:{label:"진행중",variant:"secondary",color:"bg-yellow-500"},completed:{label:"완료",variant:"outline",color:"bg-green-500"},cancelled:{label:"중단",variant:"destructive",color:"bg-red-500"}},a=t[s]||t.recruiting;return e.jsx(P,{variant:a.variant,children:a.label})},q=(s,t)=>t>0?Math.min(s/t*100,100):0,z=s=>{const t=new Date(s),a=new Date,d=t.getTime()-a.getTime(),u=Math.ceil(d/(1e3*60*60*24));return Math.max(0,u)},F=s=>{s.preventDefault(),o(1)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-modern-text-primary flex items-center gap-2",children:[e.jsx(g,{className:"w-8 h-8 text-modern-primary"}),"크라우드펀딩 프로젝트"]}),e.jsx("p",{className:"text-modern-text-secondary mt-1",children:"제품 개발사와 판매자를 연결하여 비용을 절감하는 B2B 크라우드펀딩"})]}),e.jsxs(r,{onClick:()=>x("/crowdfunding/projects/new"),children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"새 프로젝트"]})]}),m&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(n,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-modern-text-secondary",children:"전체 프로젝트"}),e.jsx("p",{className:"text-2xl font-bold text-modern-text-primary",children:m.totalProjects})]}),e.jsx(g,{className:"w-8 h-8 text-modern-primary opacity-20"})]})})}),e.jsx(n,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-modern-text-secondary",children:"활성 프로젝트"}),e.jsx("p",{className:"text-2xl font-bold text-modern-primary",children:m.activeProjects})]}),e.jsx(A,{className:"w-8 h-8 text-modern-warning opacity-20"})]})})}),e.jsx(n,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-modern-text-secondary",children:"완료 프로젝트"}),e.jsx("p",{className:"text-2xl font-bold text-modern-primary",children:m.completedProjects})]}),e.jsx(P,{className:"w-8 h-8 text-modern-success opacity-20"})]})})}),e.jsx(n,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-modern-text-secondary",children:"성공률"}),e.jsxs("p",{className:"text-2xl font-bold text-modern-text-primary",children:[m.successRate,"%"]})]}),e.jsx(w,{className:"w-8 h-8 text-modern-primary opacity-20"})]})})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("form",{onSubmit:F,className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-modern-text-tertiary w-5 h-5"}),e.jsx(U,{type:"text",placeholder:"프로젝트명, 설명, 개발사명으로 검색...",value:h,onChange:s=>k(s.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-5 h-5 text-modern-text-secondary"}),e.jsxs("select",{value:j,onChange:s=>{M(s.target.value),o(1)},className:"px-4 py-2 border border-modern-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-modern-primary",children:[e.jsx("option",{value:"all",children:"모든 상태"}),e.jsx("option",{value:"recruiting",children:"모집중"}),e.jsx("option",{value:"in_progress",children:"진행중"}),e.jsx("option",{value:"completed",children:"완료"}),e.jsx("option",{value:"cancelled",children:"중단"})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[D?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((s,t)=>e.jsx(n,{className:"animate-pulse",children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-4 bg-modern-bg-tertiary rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-modern-bg-tertiary rounded w-1/2"}),e.jsx("div",{className:"h-20 bg-modern-bg-tertiary rounded"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"h-3 bg-modern-bg-tertiary rounded w-1/4"}),e.jsx("div",{className:"h-3 bg-modern-bg-tertiary rounded w-1/4"})]})]})})},t))}):y.length===0?e.jsx(n,{children:e.jsxs(i,{className:"p-12 text-center",children:[e.jsx(g,{className:"w-16 h-16 text-modern-text-tertiary mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-modern-text-primary mb-2",children:"프로젝트가 없습니다"}),e.jsx("p",{className:"text-modern-text-secondary mb-4",children:"첫 번째 크라우드펀딩 프로젝트를 만들어보세요!"}),e.jsxs(r,{onClick:()=>x("/crowdfunding/projects/new"),children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"새 프로젝트 만들기"]})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:y.map(s=>{const t=q(s.currentParticipantCount,s.targetParticipantCount),a=z(s.endDate),d=s.status==="recruiting"&&a>0;return e.jsxs(n,{className:"hover:shadow-lg transition-shadow cursor-pointer",children:[e.jsx(I,{className:"pb-3",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsx(K,{className:"text-lg line-clamp-2 mb-2",children:s.title}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-modern-text-secondary",children:[e.jsxs("span",{children:["by ",s.creatorName]}),B(s.status)]})]})})}),e.jsx(i,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-modern-text-secondary line-clamp-3",children:s.description}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-modern-text-secondary",children:"진행률"}),e.jsxs("span",{className:"font-medium text-modern-text-primary",children:[s.currentParticipantCount,"/",s.targetParticipantCount," (",Math.round(t),"%)"]})]}),e.jsx("div",{className:"w-full bg-modern-bg-tertiary rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${t>=100?"bg-modern-success":t>=50?"bg-modern-primary":"bg-modern-warning"}`,style:{width:`${t}%`}})})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-modern-text-secondary",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"w-4 h-4"}),e.jsx("span",{children:d?`${a}일 남음`:"종료"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(w,{className:"w-4 h-4"}),e.jsxs("span",{children:[s.currentParticipantCount,"명 참여"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(r,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>x(`/crowdfunding/projects/${s.id}`),children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"상세보기"]}),s.forumLink&&e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>x(s.forumLink),children:"포럼"})]})]})})]},s.id)})}),c&&c.totalPages>1&&e.jsxs("div",{className:"flex justify-center items-center gap-2 mt-8",children:[e.jsx(r,{variant:"outline",size:"sm",disabled:l<=1,onClick:()=>o(s=>Math.max(1,s-1)),children:"이전"}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,c.totalPages)},(s,t)=>{const a=Math.max(1,Math.min(c.totalPages-4,Math.max(1,l-2)))+t;return e.jsx(r,{variant:a===l?"default":"ghost",size:"sm",onClick:()=>o(a),className:"w-8 h-8 p-0",children:a},a)})}),e.jsx(r,{variant:"outline",size:"sm",disabled:l>=c.totalPages,onClick:()=>o(s=>Math.min(c.totalPages,s+1)),children:"다음"})]})]})]})};export{ae as default};
