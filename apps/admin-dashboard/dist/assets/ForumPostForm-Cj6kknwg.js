import{u as e,b as s,r as t,V as r,j as i,A as o,S as a}from"./vendor-react-BQ6HOJoh.js";import{u as d,a as n,b as c}from"./vendor-query-LYSOqK5P.js";import{b as l,B as m,L as p,I as j,S as u,h,i as x,j as b,k as w,T as k,m as y}from"./page-template-editor-C7FodHrK.js";import{ak as v,al as f,am as g,an as N}from"./wp-misc-DS9m4_P2.js";import"./wp-block-editor-a11y-DrduSWFW.js";import"./wp-block-editor-misc-pHCPYvR2.js";import"./wp-block-editor-api-Buev8_QU.js";import"./wp-block-editor-utils-M5qXzE1L.js";import"./wp-block-editor-colors-D38h-Odz.js";import"./wp-blocks-core-6vwQKPfS.js";import"./wp-block-editor-clipboard-Dg0Y1gQ6.js";import"./wp-block-editor-store-B-g1aSix.js";import"./vendor-ui-CrFdsnXa.js";import"./wp-block-editor-dnd-BYoS8-II.js";import"./wp-block-editor-library-BpQvynjE.js";import"./wp-block-editor-menus-BTQ2wZ-f.js";import"./wp-block-editor-keyboard-CeHTtvP5.js";import"./wp-block-editor-typography-Bl_1REQP.js";import"./wp-block-editor-spacing-BD_2CpN7.js";import"./wp-block-editor-core-DL280tSA.js";import"./wp-block-editor-selection-CC4tJpUu.js";import"./wp-block-editor-formats-CLXkimOp.js";import"./wp-block-editor-inline-CpXpUhQU.js";import"./wp-block-editor-ui-B8YE_4QL.js";import"./wp-block-editor-transforms-jLcKa8Hv.js";import"./wp-block-editor-preview-iw2Xu1ib.js";import"./wp-block-editor-global-styles-CV5-K6QF.js";import"./wp-block-editor-borders-BH1devca.js";import"./wp-block-editor-patterns-BXdHo9lm.js";import"./wp-block-editor-navigation-BFSoKzg0.js";import"./wp-block-editor-media-Bg-JiQDT.js";import"./wp-api-BeoadipR.js";import"./wp-i18n-DGPtqsXY.js";import"./wp-core-Y-jV-nrZ.js";import"./vendor-monaco-BxJH8uUv.js";import"./wp-block-editor-upload-BLw1R9wP.js";import"./vendor-utils-D-spY-QM.js";import"./wp-block-editor-templates-o1_wAMb9.js";import"./wp-data-BmtL8k4r.js";import"./wp-components-CeQNCpMW.js";const q=()=>{const q=e(),{id:C}=s(),F=d(),L=!!C,[P,I]=t.useState({title:"",content:"",categoryId:"",status:"published",isPinned:!1,isLocked:!1}),{data:S}=n({queryKey:["forum-categories"],queryFn:async()=>(await l.api.get("/v1/forum/categories")).data}),K=S?.data||[],{data:E,isLoading:Q}=n({queryKey:["forum-post",C],queryFn:async()=>(await l.api.get(`/v1/forum/posts/${C}`)).data.data,enabled:L}),V=c({mutationFn:async e=>(await l.api.post("/v1/forum/posts",e)).data,onSuccess:()=>{r.success("게시글이 작성되었습니다"),F.invalidateQueries({queryKey:["forum-posts"]}),q("/forum")},onError:()=>{r.error("게시글 작성에 실패했습니다")}}),z=c({mutationFn:async e=>(await l.api.put(`/v1/forum/posts/${C}`,e)).data,onSuccess:()=>{r.success("게시글이 수정되었습니다"),F.invalidateQueries({queryKey:["forum-posts"]}),F.invalidateQueries({queryKey:["forum-post",C]}),q("/forum")},onError:()=>{r.error("게시글 수정에 실패했습니다")}});t.useEffect(()=>{E&&I({title:E.title,content:E.content,categoryId:E.category.id,status:E.status,isPinned:E.isPinned,isLocked:E.isLocked})},[E]);const A=(e,s)=>{I(t=>({...t,[e]:s}))};return L&&Q?i.jsx("div",{className:"flex items-center justify-center h-96",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-modern-primary"})}):i.jsxs("div",{className:"max-w-4xl mx-auto",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[i.jsxs(m,{variant:"ghost",size:"sm",onClick:()=>q("/forum"),children:[i.jsx(o,{className:"w-4 h-4 mr-2"}),"게시판 목록"]}),i.jsx("h1",{className:"text-2xl font-bold text-modern-text-primary",children:L?"게시글 수정":"새 게시글 작성"})]}),i.jsxs("form",{onSubmit:e=>{e.preventDefault(),P.title.trim()?P.content.trim()?P.categoryId?L?z.mutate(P):V.mutate(P):r.error("카테고리를 선택하세요"):r.error("내용을 입력하세요"):r.error("제목을 입력하세요")},children:[i.jsxs("div",{className:"space-y-6",children:[i.jsxs(v,{children:[i.jsx(f,{children:i.jsx(g,{children:"게시글 정보"})}),i.jsxs(N,{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx(p,{htmlFor:"title",children:"제목 *"}),i.jsx(j,{id:"title",value:P.title,onChange:e=>A("title",e.target.value),placeholder:"게시글 제목을 입력하세요",required:!0})]}),i.jsxs("div",{children:[i.jsx(p,{htmlFor:"category",children:"카테고리 *"}),i.jsxs(u,{value:P.categoryId,onValueChange:e=>A("categoryId",e),children:[i.jsx(h,{children:i.jsx(x,{placeholder:"카테고리를 선택하세요"})}),i.jsx(b,{children:K.map(e=>i.jsx(w,{value:e.id,children:e.name},e.id))})]})]}),i.jsxs("div",{children:[i.jsx(p,{htmlFor:"content",children:"내용 *"}),i.jsx(k,{id:"content",value:P.content,onChange:e=>A("content",e.target.value),placeholder:"게시글 내용을 입력하세요...",rows:12,required:!0})]})]})]}),i.jsxs(v,{children:[i.jsx(f,{children:i.jsx(g,{children:"게시 옵션"})}),i.jsxs(N,{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx(p,{htmlFor:"status",children:"상태"}),i.jsxs(u,{value:P.status,onValueChange:e=>A("status",e),children:[i.jsx(h,{children:i.jsx(x,{})}),i.jsxs(b,{children:[i.jsx(w,{value:"published",children:"게시"}),i.jsx(w,{value:"draft",children:"초안"})]})]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx(p,{htmlFor:"isPinned",children:"상단 고정"}),i.jsx("p",{className:"text-sm text-modern-text-secondary",children:"게시글을 목록 상단에 고정합니다"})]}),i.jsx(y,{id:"isPinned",checked:P.isPinned,onCheckedChange:e=>A("isPinned",e)})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx(p,{htmlFor:"isLocked",children:"댓글 잠금"}),i.jsx("p",{className:"text-sm text-modern-text-secondary",children:"새 댓글 작성을 차단합니다"})]}),i.jsx(y,{id:"isLocked",checked:P.isLocked,onCheckedChange:e=>A("isLocked",e)})]})]})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[i.jsx(m,{type:"button",variant:"outline",onClick:()=>q("/forum"),children:"취소"}),i.jsxs(m,{type:"submit",disabled:V.isPending||z.isPending,children:[i.jsx(a,{className:"w-4 h-4 mr-2"}),L?"수정하기":"작성하기"]})]})]})]})};export{q as default};
