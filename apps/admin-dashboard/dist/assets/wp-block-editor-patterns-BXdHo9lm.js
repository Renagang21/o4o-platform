import{c as e}from"./vendor-ui-CrFdsnXa.js";import{c as t,e as s,a as i,K as a}from"./wp-blocks-core-6vwQKPfS.js";import{D as l,a5 as n,s as o,a0 as r,H as c,a as d,_ as p,ab as m,W as b,N as u,V as k,u as h,b as x,a8 as v,aD as j}from"./wp-block-editor-misc-pHCPYvR2.js";import"./wp-block-editor-a11y-DrduSWFW.js";import{B as _}from"./wp-block-editor-preview-iw2Xu1ib.js";import{t as g,v as f,w}from"./wp-block-editor-ui-B8YE_4QL.js";import{j as N,r as y}from"./vendor-react-BQ6HOJoh.js";import{U as S,a2 as P,ai as B}from"./wp-block-editor-utils-M5qXzE1L.js";import{at as T,g as M,ab as C,au as D,Z as I,af as z}from"./wp-block-editor-library-BpQvynjE.js";import{T as W,M as $,a as H,f as E}from"./wp-block-editor-menus-BTQ2wZ-f.js";import{T as F}from"./wp-misc-DS9m4_P2.js";import{s as A}from"./wp-block-editor-store-B-g1aSix.js";function L({currentPage:e,numPages:t,changePage:s,totalItems:i}){return N.jsxs(l,{className:"block-editor-patterns__grid-pagination-wrapper",children:[N.jsx(n,{variant:"muted",children:o(r("%s item","%s items",i),i)}),t>1&&N.jsxs(c,{expanded:!1,spacing:3,justify:"flex-start",className:"block-editor-patterns__grid-pagination",children:[N.jsxs(c,{expanded:!1,spacing:1,className:"block-editor-patterns__grid-pagination-previous",children:[N.jsx(d,{variant:"tertiary",onClick:()=>s(1),disabled:1===e,"aria-label":p("First page"),size:"compact",accessibleWhenDisabled:!0,className:"block-editor-patterns__grid-pagination-button",children:N.jsx("span",{children:"«"})}),N.jsx(d,{variant:"tertiary",onClick:()=>s(e-1),disabled:1===e,"aria-label":p("Previous page"),size:"compact",accessibleWhenDisabled:!0,className:"block-editor-patterns__grid-pagination-button",children:N.jsx("span",{children:"‹"})})]}),N.jsx(n,{variant:"muted",children:o(m("%1$s of %2$s","paging"),e,t)}),N.jsxs(c,{expanded:!1,spacing:1,className:"block-editor-patterns__grid-pagination-next",children:[N.jsx(d,{variant:"tertiary",onClick:()=>s(e+1),disabled:e===t,"aria-label":p("Next page"),size:"compact",accessibleWhenDisabled:!0,className:"block-editor-patterns__grid-pagination-button",children:N.jsx("span",{children:"›"})}),N.jsx(d,{variant:"tertiary",onClick:()=>s(t),disabled:e===t,"aria-label":p("Last page"),size:"compact",accessibleWhenDisabled:!0,className:"block-editor-patterns__grid-pagination-button",children:N.jsx("span",{children:"»"})})]})]})]})}const R=({showTooltip:e,title:t,children:s})=>e?N.jsx(W,{text:t,children:s}):N.jsx(N.Fragment,{children:s});function V({id:s,isDraggable:i,pattern:a,onClick:l,onHover:n,showTitle:o=!0,showTooltip:r,category:d}){const[p,m]=y.useState(!1),{blocks:h,viewportWidth:x}=a,v=`block-editor-block-patterns-list__item-description-${S(V)}`,j=y.useMemo(()=>d&&i?(null!=h?h:[]).map(e=>{const s=t(e);return s.attributes.metadata?.categories?.includes(d)&&(s.attributes.metadata.categories=[d]),s}):h,[h,i,d]);return N.jsx(g,{isEnabled:i,blocks:j,pattern:a,children:({draggable:t,onDragStart:i,onDragEnd:d})=>N.jsx("div",{className:"block-editor-block-patterns-list__list-item",draggable:t,onDragStart:e=>{m(!0),i&&(n?.(null),i(e))},onDragEnd:e=>{m(!1),d&&d(e)},children:N.jsx(R,{showTooltip:r&&!a.type!==f.user,title:a.title,children:N.jsxs(b.Item,{render:N.jsx("div",{role:"option","aria-label":a.title,"aria-describedby":a.description?v:void 0,className:e("block-editor-block-patterns-list__item",{"block-editor-block-patterns-list__list-item-synced":a.type===f.user&&!a.syncStatus})}),id:s,onClick:()=>{l(a,h),n?.(null)},onMouseEnter:()=>{p||n?.(a)},onMouseLeave:()=>n?.(null),children:[N.jsx(_,{blocks:h,viewportWidth:x}),o&&N.jsxs(c,{className:"block-editor-patterns__pattern-details",spacing:2,children:[a.type===f.user&&!a.syncStatus&&N.jsx("div",{className:"block-editor-patterns__pattern-icon-wrapper",children:N.jsx(u,{className:"block-editor-patterns__pattern-icon",icon:T})}),(!r||a.type===f.user)&&N.jsx("div",{className:"block-editor-block-patterns-list__item-title",children:a.title})]}),!!a.description&&N.jsx(k,{id:v,children:a.description})]})})})})}function O(){return N.jsx("div",{className:"block-editor-block-patterns-list__item is-placeholder"})}const G=y.forwardRef(function({isDraggable:e,blockPatterns:t,shownPatterns:s,onHover:i,onClickPattern:a,orientation:l,label:n=p("Block patterns"),category:o,showTitle:r=!0,showTitlesAsTooltip:c,pagingProps:d},m){const[u,k]=y.useState(void 0);return y.useEffect(()=>{const e=t.find(e=>s.includes(e))?.name;k(e)},[s,t]),N.jsxs(b,{orientation:l,activeId:u,setActiveId:k,role:"listbox",className:"block-editor-block-patterns-list","aria-label":n,ref:m,children:[t.map(t=>s.includes(t)?N.jsx(V,{id:t.name,pattern:t,onClick:a,onHover:i,isDraggable:e,showTitle:r,showTooltip:c,category:o},t.name):N.jsx(O,{},t.name)),d&&N.jsx(L,{...d})]})});function K(e,t,s){const i=new F(e);return t&&i.remove("is-style-"+t.name),i.add("is-style-"+s.name),i.value}function U(e){return e?.find(e=>e.isDefault)}function Z({clientId:e,onSwitch:l}){const{styles:n,block:o,blockType:r,className:c}=h(t=>{const{getBlock:a}=t(A),l=a(e);if(!l)return{};const n=s(l.name),{getBlockStyles:o}=t(i);return{block:l,blockType:n,styles:o(l.name),className:l.attributes.className||""}},[e]),{updateBlockAttributes:d}=x(A),p=function(e){return e&&0!==e.length?U(e)?e:[{name:"default",label:m("Default","block style"),isDefault:!0},...e]:[]}(n),b=function(e,t){for(const s of new F(t).values()){if(-1===s.indexOf("is-style-"))continue;const t=s.substring(9),i=e?.find(({name:e})=>e===t);if(i)return i}return U(e)}(p,c),u=function(e,s){return y.useMemo(()=>{const i=s?.example,l=s?.name;return i&&l?a(l,{attributes:i.attributes,innerBlocks:i.innerBlocks}):e?t(e):void 0},[s?.example?e?.name:e,s])}(o,r);return{onSelect:t=>{const s=K(c,b,t);d(e,{className:s}),l()},stylesToRender:p,activeStyle:b,genericPreviewBlock:u,className:c}}const q=()=>{};function J({clientId:e,onSwitch:t=q}){const{onSelect:s,stylesToRender:i,activeStyle:a}=Z({clientId:e,onSwitch:t});return i&&0!==i.length?N.jsx(N.Fragment,{children:i.map(e=>{const t=e.label||e.name;return N.jsx($,{icon:a.name===e.name?M:null,onClick:()=>s(e),children:N.jsx(n,{as:"span",limit:18,ellipsizeMode:"tail",truncate:!0,children:t})},e.name)})}):null}function Q({hoveredBlock:e,onSwitch:t}){const{clientId:s}=e;return N.jsx(H,{label:p("Styles"),className:"block-editor-block-switcher__styles__menugroup",children:N.jsx(J,{clientId:s,onSwitch:t})})}function X({genericPreviewBlock:e,style:t,className:i,activeStyle:a}){const l=s(e.name)?.example,n=K(i,a,t),o=y.useMemo(()=>({...e,title:t.label||t.name,description:t.description,initialAttributes:{...e.attributes,className:n+" block-editor-block-styles__block-preview-container"},example:l}),[e,n]);return N.jsx(w,{item:o})}const Y=()=>{};function ee({clientId:t,onSwitch:s=Y,onHoverClassName:i=Y}){const{onSelect:a,stylesToRender:l,activeStyle:n,genericPreviewBlock:o,className:r}=Z({clientId:t,onSwitch:s}),[c,p]=y.useState(null),m=P("medium","<");if(!l||0===l.length)return null;const b=B(p,250),u=e=>{var t;c!==e?(b(e),i(null!==(t=e?.name)&&void 0!==t?t:null)):b.cancel()};return N.jsxs("div",{className:"block-editor-block-styles",children:[N.jsx("div",{className:"block-editor-block-styles__variants",children:l.map(t=>{const s=t.label||t.name;return N.jsx(d,{__next40pxDefaultSize:!0,className:e("block-editor-block-styles__item",{"is-active":n.name===t.name}),variant:"secondary",label:s,onMouseEnter:()=>u(t),onFocus:()=>u(t),onMouseLeave:()=>u(null),onBlur:()=>u(null),onClick:()=>(e=>{a(e),i(null),p(null),b.cancel()})(t),"aria-current":n.name===t.name,children:N.jsx(v,{numberOfLines:1,className:"block-editor-block-styles__item-text",children:s})},t.name)})}),c&&!m&&N.jsx(E,{placement:"left-start",offset:34,focusOnMount:!1,children:N.jsx("div",{className:"block-editor-block-styles__preview-panel",onMouseLeave:()=>u(null),children:N.jsx(X,{activeStyle:n,className:r,genericPreviewBlock:o,style:c})})})]})}const te="carousel",se="grid",ie=({onBlockPatternSelect:e})=>N.jsx("div",{className:"block-editor-block-pattern-setup__actions",children:N.jsx(d,{__next40pxDefaultSize:!0,variant:"primary",onClick:e,children:p("Choose")})}),ae=({handlePrevious:e,handleNext:t,activeSlide:s,totalSlides:i})=>N.jsxs("div",{className:"block-editor-block-pattern-setup__navigation",children:[N.jsx(d,{size:"compact",icon:j()?I:z,label:p("Previous pattern"),onClick:e,disabled:0===s,accessibleWhenDisabled:!0}),N.jsx(d,{size:"compact",icon:j()?z:I,label:p("Next pattern"),onClick:t,disabled:s===i-1,accessibleWhenDisabled:!0})]}),le=({viewMode:e,setViewMode:t,handlePrevious:s,handleNext:i,activeSlide:a,totalSlides:l,onBlockPatternSelect:n})=>{const o=e===te,r=N.jsxs("div",{className:"block-editor-block-pattern-setup__display-controls",children:[N.jsx(d,{size:"compact",icon:C,label:p("Carousel view"),onClick:()=>t(te),isPressed:o}),N.jsx(d,{size:"compact",icon:D,label:p("Grid view"),onClick:()=>t(se),isPressed:e===se})]});return N.jsxs("div",{className:"block-editor-block-pattern-setup__toolbar",children:[o&&N.jsx(ae,{handlePrevious:s,handleNext:i,activeSlide:a,totalSlides:l}),r,o&&N.jsx(ie,{onBlockPatternSelect:n})]})};const ne=({viewMode:e,activeSlide:t,patterns:s,onBlockPatternSelect:i,showTitles:a})=>{const l="block-editor-block-pattern-setup__container";if(e===te){const e=new Map([[t,"active-slide"],[t-1,"previous-slide"],[t+1,"next-slide"]]);return N.jsx("div",{className:"block-editor-block-pattern-setup__carousel",children:N.jsx("div",{className:l,children:N.jsx("div",{className:"carousel-container",children:s.map((s,i)=>N.jsx(re,{active:i===t,className:e.get(i)||"",pattern:s},s.name))})})})}return N.jsx("div",{className:"block-editor-block-pattern-setup__grid",children:N.jsx(b,{role:"listbox",className:l,"aria-label":p("Patterns list"),children:s.map(e=>N.jsx(oe,{pattern:e,onSelect:i,showTitles:a},e.name))})})};function oe({pattern:e,onSelect:t,showTitles:s}){const i="block-editor-block-pattern-setup-list",{blocks:a,description:l,viewportWidth:n=700}=e,o=S(oe,`${i}__item-description`);return N.jsx("div",{className:`${i}__list-item`,children:N.jsxs(b.Item,{render:N.jsx("div",{"aria-describedby":l?o:void 0,"aria-label":e.title,className:`${i}__item`}),id:`${i}__pattern__${e.name}`,role:"option",onClick:()=>t(a),children:[N.jsx(_,{blocks:a,viewportWidth:n}),s&&N.jsx("div",{className:`${i}__item-title`,children:e.title}),!!l&&N.jsx(k,{id:o,children:l})]})})}function re({active:e,className:t,pattern:s,minHeight:i}){const{blocks:a,title:l,description:n}=s,o=S(re,"block-editor-block-pattern-setup-list__item-description");return N.jsxs("div",{"aria-hidden":!e,role:"img",className:`pattern-slide ${t}`,"aria-label":l,"aria-describedby":n?o:void 0,children:[N.jsx(_,{blocks:a,minHeight:i}),!!n&&N.jsx(k,{id:o,children:n})]})}const ce=({clientId:e,blockName:s,filterPatternsFn:i,onBlockPatternSelect:a,initialViewMode:l=te,showTitles:n=!1})=>{const[o,r]=y.useState(l),[c,d]=y.useState(0),{replaceBlock:p}=x(A),m=function(e,t,s){return h(i=>{const{getBlockRootClientId:a,getPatternsByBlockTypes:l,__experimentalGetAllowedPatterns:n}=i(A),o=a(e);return s?n(o).filter(s):l(t,o)},[e,t,s])}(e,s,i);if(!m?.length)return null;const b=a||(s=>{const i=s.map(e=>t(e));p(e,i)});return N.jsx(N.Fragment,{children:N.jsxs("div",{className:`block-editor-block-pattern-setup view-mode-${o}`,children:[N.jsx(ne,{viewMode:o,activeSlide:c,patterns:m,onBlockPatternSelect:b,showTitles:n}),N.jsx(le,{viewMode:o,setViewMode:r,activeSlide:c,totalSlides:m.length,handleNext:()=>{d(e=>Math.min(e+1,m.length-1))},handlePrevious:()=>{d(e=>Math.max(e-1,0))},onBlockPatternSelect:()=>{b(m[c].blocks)}})]})})};export{Q as B,L as P,ee as a,ce as b,G as c};
