import{r as e,V as t,j as s,bK as r,cW as i,bQ as a,bM as o}from"./vendor-react-BQ6HOJoh.js";import{u as c,a as d,b as n}from"./vendor-query-LYSOqK5P.js";import{b as l,B as p,L as m,I as x,T as j,m as u}from"./page-template-editor-C7FodHrK.js";import{az as h,aA as w,aB as y,aC as b,aD as g,aE as v}from"./wp-misc-DS9m4_P2.js";import"./wp-block-editor-a11y-DrduSWFW.js";import"./wp-block-editor-misc-pHCPYvR2.js";import"./wp-block-editor-api-Buev8_QU.js";import"./wp-block-editor-utils-M5qXzE1L.js";import"./wp-block-editor-colors-D38h-Odz.js";import"./wp-blocks-core-6vwQKPfS.js";import"./wp-block-editor-clipboard-Dg0Y1gQ6.js";import"./wp-block-editor-store-B-g1aSix.js";import"./vendor-ui-CrFdsnXa.js";import"./wp-block-editor-dnd-BYoS8-II.js";import"./wp-block-editor-library-BpQvynjE.js";import"./wp-block-editor-menus-BTQ2wZ-f.js";import"./wp-block-editor-keyboard-CeHTtvP5.js";import"./wp-block-editor-typography-Bl_1REQP.js";import"./wp-block-editor-spacing-BD_2CpN7.js";import"./wp-block-editor-core-DL280tSA.js";import"./wp-block-editor-selection-CC4tJpUu.js";import"./wp-block-editor-formats-CLXkimOp.js";import"./wp-block-editor-inline-CpXpUhQU.js";import"./wp-block-editor-ui-B8YE_4QL.js";import"./wp-block-editor-transforms-jLcKa8Hv.js";import"./wp-block-editor-preview-iw2Xu1ib.js";import"./wp-block-editor-global-styles-CV5-K6QF.js";import"./wp-block-editor-borders-BH1devca.js";import"./wp-block-editor-patterns-BXdHo9lm.js";import"./wp-block-editor-navigation-BFSoKzg0.js";import"./wp-block-editor-media-Bg-JiQDT.js";import"./wp-api-BeoadipR.js";import"./wp-i18n-DGPtqsXY.js";import"./wp-core-Y-jV-nrZ.js";import"./vendor-monaco-BxJH8uUv.js";import"./wp-block-editor-upload-BLw1R9wP.js";import"./vendor-utils-D-spY-QM.js";import"./wp-block-editor-templates-o1_wAMb9.js";import"./wp-data-BmtL8k4r.js";import"./wp-components-CeQNCpMW.js";const f=()=>{const f=c(),[k,N]=e.useState(!1),[C,S]=e.useState(null),[F,q]=e.useState({name:"",slug:"",description:"",active:!0}),{data:z=[],isLoading:K}=d({queryKey:["forum-categories"],queryFn:async()=>(await l.api.get("/v1/forum/categories")).data.data}),Q=n({mutationFn:async e=>(await l.api.post("/v1/forum/categories",e)).data,onSuccess:()=>{t.success("카테고리가 생성되었습니다"),f.invalidateQueries({queryKey:["forum-categories"]}),L()}}),$=n({mutationFn:async({id:e,data:t})=>(await l.api.put(`/v1/forum/categories/${e}`,t)).data,onSuccess:()=>{t.success("카테고리가 수정되었습니다"),f.invalidateQueries({queryKey:["forum-categories"]}),L()}}),B=n({mutationFn:async e=>(await l.api.delete(`/v1/forum/categories/${e}`)).data,onSuccess:()=>{t.success("카테고리가 삭제되었습니다"),f.invalidateQueries({queryKey:["forum-categories"]})}}),D=e=>{e?(S(e),q({name:e.name,slug:e.slug,description:e.description,active:e.active})):(S(null),q({name:"",slug:"",description:"",active:!0})),N(!0)},L=()=>{N(!1),S(null),q({name:"",slug:"",description:"",active:!0})};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-modern-text-primary",children:"포럼 카테고리"}),s.jsx("p",{className:"text-modern-text-secondary mt-1",children:"포럼 카테고리를 관리하세요."})]}),s.jsxs(p,{onClick:()=>D(),children:[s.jsx(r,{className:"w-4 h-4 mr-2"}),"새 카테고리"]})]}),s.jsx("div",{className:"wp-card",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-modern-bg-tertiary border-b border-modern-border-primary",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"순서"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"이름"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"설명"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"게시글 수"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"상태"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"작업"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-modern-border-primary",children:K?s.jsx("tr",{children:s.jsx("td",{colSpan:6,className:"px-6 py-12 text-center",children:s.jsx("div",{className:"flex justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-modern-primary"})})})}):0===z.length?s.jsx("tr",{children:s.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-modern-text-secondary",children:"카테고리가 없습니다."})}):z.map(e=>s.jsxs("tr",{className:"hover:bg-modern-bg-hover",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx(i,{className:"w-5 h-5 text-modern-text-tertiary cursor-move"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-modern-text-primary",children:e.name}),s.jsxs("p",{className:"text-xs text-modern-text-secondary",children:["/",e.slug]})]})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("p",{className:"text-sm text-modern-text-secondary truncate max-w-xs",children:e.description||"-"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-modern-text-primary",children:e.postCount}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full "+(e.active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.active?"활성":"비활성"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(p,{variant:"ghost",size:"sm",onClick:()=>D(e),children:s.jsx(a,{className:"w-4 h-4"})}),s.jsx(p,{variant:"ghost",size:"sm",onClick:()=>(e=>{e.postCount>0?t.error("게시글이 있는 카테고리는 삭제할 수 없습니다"):confirm(`"${e.name}" 카테고리를 삭제하시겠습니까?`)&&B.mutate(e.id)})(e),disabled:e.postCount>0,children:s.jsx(o,{className:"w-4 h-4 text-destructive"})})]})})]},e.id))})]})})}),s.jsx(h,{open:k,onOpenChange:N,children:s.jsx(w,{children:s.jsxs("form",{onSubmit:e=>{e.preventDefault(),F.name.trim()?C?$.mutate({id:C.id,data:F}):Q.mutate(F):t.error("카테고리 이름을 입력하세요")},children:[s.jsxs(y,{children:[s.jsx(b,{children:C?"카테고리 수정":"새 카테고리"}),s.jsx(g,{children:"포럼 카테고리 정보를 입력하세요."})]}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{children:[s.jsx(m,{htmlFor:"name",children:"이름 *"}),s.jsx(x,{id:"name",value:F.name,onChange:e=>{q(t=>{return{...t,name:e.target.value,slug:C?t.slug:(s=e.target.value,s.toLowerCase().replace(/[^a-z0-9가-힣]+/g,"-").replace(/^-+|-+$/g,""))};var s})},placeholder:"예: 일반 토론",required:!0})]}),s.jsxs("div",{children:[s.jsx(m,{htmlFor:"slug",children:"Slug"}),s.jsx(x,{id:"slug",value:F.slug,onChange:e=>q(t=>({...t,slug:e.target.value})),placeholder:"예: general-discussion"})]}),s.jsxs("div",{children:[s.jsx(m,{htmlFor:"description",children:"설명"}),s.jsx(j,{id:"description",value:F.description,onChange:e=>q(t=>({...t,description:e.target.value})),placeholder:"카테고리에 대한 설명을 입력하세요...",rows:3})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(m,{htmlFor:"active",children:"활성화"}),s.jsx("p",{className:"text-sm text-modern-text-secondary",children:"비활성화 시 게시글 작성이 불가능합니다"})]}),s.jsx(u,{id:"active",checked:F.active,onCheckedChange:e=>q(t=>({...t,active:e}))})]})]}),s.jsxs(v,{children:[s.jsx(p,{type:"button",variant:"outline",onClick:L,children:"취소"}),s.jsx(p,{type:"submit",disabled:Q.isPending||$.isPending,children:C?"수정":"생성"})]})]})})})]})};export{f as default};
