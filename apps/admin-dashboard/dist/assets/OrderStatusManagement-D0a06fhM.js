import{r as c,j as e,O as Y,J as Z,bB as C,Y as G,X as W,Z as k,cO as _,bv as ee,bV as se,V as D}from"./vendor-react-CMQx0Rxg.js";import{u as te,a as I,b as ae}from"./vendor-query-B9kD0akd.js";import{C as O,m as F,I as h,B as o,w as q,x as L,y as K,z as R,E as B,L as l,T as re,F as P,s as n,j as v}from"./page-gutenberg-Bg9cnlWs.js";import"./wp-all-CpKe89B2.js";import"./vendor-ui-BkLtITBR.js";import"./vendor-monaco-cpVGocfO.js";import"./vendor-utils-DQ8F5vJI.js";const me=()=>{const N=te(),[x,T]=c.useState(""),[m,y]=c.useState("all"),[t,f]=c.useState(null),[A,u]=c.useState(!1),[E,p]=c.useState(!1),[r,i]=c.useState({orderId:"",newStatus:"pending",reason:"",notes:"",trackingNumber:"",estimatedDelivery:""}),{data:$,isLoading:Q}=I({queryKey:["orders",x,m],queryFn:async()=>{const s=new URLSearchParams;return x&&s.append("search",x),m!=="all"&&s.append("status",m),(await v.api.get(`/v1/ecommerce/orders?${s.toString()}`)).data}}),b=$?.data||[],{data:z}=I({queryKey:["order-stats"],queryFn:async()=>(await v.api.get("/v1/ecommerce/orders/stats")).data}),d=z?.data||{},w=ae({mutationFn:async s=>(await v.api.put(`/v1/ecommerce/orders/${s.orderId}/status`,s)).data,onSuccess:()=>{D.success("주문 상태가 변경되었습니다"),N.invalidateQueries({queryKey:["orders"]}),N.invalidateQueries({queryKey:["order-stats"]}),u(!1),i({orderId:"",newStatus:"pending",reason:"",notes:"",trackingNumber:"",estimatedDelivery:""})}}),M=s=>{switch(s){case"pending":return e.jsx(n,{variant:"outline",className:"text-yellow-600 border-yellow-600",children:"대기중"});case"confirmed":return e.jsx(n,{variant:"outline",className:"text-blue-600 border-blue-600",children:"확인됨"});case"processing":return e.jsx(n,{variant:"outline",className:"text-purple-600 border-purple-600",children:"처리중"});case"shipped":return e.jsx(n,{variant:"outline",className:"text-indigo-600 border-indigo-600",children:"배송중"});case"delivered":return e.jsx(n,{variant:"outline",className:"text-green-600 border-green-600",children:"배송완료"});case"completed":return e.jsx(n,{children:"완료"});case"cancelled":return e.jsx(n,{variant:"secondary",children:"취소"});case"refunded":return e.jsx(n,{variant:"destructive",children:"환불"});default:return e.jsx(n,{variant:"outline",children:s})}},S=s=>{switch(s){case"pending":return e.jsx(se,{className:"w-4 h-4 text-yellow-600"});case"confirmed":return e.jsx(k,{className:"w-4 h-4 text-blue-600"});case"processing":return e.jsx(ee,{className:"w-4 h-4 text-purple-600"});case"shipped":return e.jsx(_,{className:"w-4 h-4 text-indigo-600"});case"delivered":return e.jsx(C,{className:"w-4 h-4 text-green-600"});case"completed":return e.jsx(k,{className:"w-4 h-4 text-green-600"});case"cancelled":return e.jsx(W,{className:"w-4 h-4 text-gray-600"});case"refunded":return e.jsx(G,{className:"w-4 h-4 text-red-600"});default:return e.jsx(C,{className:"w-4 h-4"})}},V=s=>{switch(s){case"pending":return["confirmed","cancelled"];case"confirmed":return["processing","cancelled"];case"processing":return["shipped","cancelled"];case"shipped":return["delivered","cancelled"];case"delivered":return["completed","refunded"];case"completed":return["refunded"];case"cancelled":return["refunded"];case"refunded":return[];default:return[]}},H=s=>{f(s),i({orderId:s.id,newStatus:s.status,reason:"",notes:"",trackingNumber:s.trackingNumber||"",estimatedDelivery:s.estimatedDelivery||""}),u(!0)},U=s=>{f(s),p(!0)},J=s=>{if(s.preventDefault(),!r.newStatus){D.error("새로운 상태를 선택하세요");return}w.mutate(r)},j=s=>({pending:"대기중",confirmed:"확인됨",processing:"처리중",shipped:"배송중",delivered:"배송완료",completed:"완료",cancelled:"취소",refunded:"환불"})[s]||s;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-modern-text-primary",children:"주문 상태 관리"}),e.jsx("p",{className:"text-modern-text-secondary mt-1",children:"주문 워크플로우 추적 및 관리"})]})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4",children:[{status:"pending",label:"대기중",count:d.pending||0,color:"text-yellow-600"},{status:"confirmed",label:"확인됨",count:d.confirmed||0,color:"text-blue-600"},{status:"processing",label:"처리중",count:d.processing||0,color:"text-purple-600"},{status:"shipped",label:"배송중",count:d.shipped||0,color:"text-indigo-600"},{status:"delivered",label:"배송완료",count:d.delivered||0,color:"text-green-600"},{status:"completed",label:"완료",count:d.completed||0,color:"text-green-700"},{status:"cancelled",label:"취소",count:d.cancelled||0,color:"text-gray-600"},{status:"refunded",label:"환불",count:d.refunded||0,color:"text-red-600"}].map(({status:s,label:a,count:g,color:X})=>e.jsx(O,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>y(s),children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[S(s),e.jsxs("div",{children:[e.jsx("div",{className:`text-2xl font-bold ${X}`,children:g}),e.jsx("div",{className:"text-xs text-modern-text-secondary",children:a})]})]})})},s))}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(h,{type:"text",placeholder:"주문번호, 고객명으로 검색...",value:x,onChange:s=>T(s.target.value)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("select",{value:m,onChange:s=>y(s.target.value),className:"px-4 py-2 border border-modern-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-modern-primary",children:[e.jsx("option",{value:"all",children:"모든 상태"}),e.jsx("option",{value:"pending",children:"대기중"}),e.jsx("option",{value:"confirmed",children:"확인됨"}),e.jsx("option",{value:"processing",children:"처리중"}),e.jsx("option",{value:"shipped",children:"배송중"}),e.jsx("option",{value:"delivered",children:"배송완료"}),e.jsx("option",{value:"completed",children:"완료"}),e.jsx("option",{value:"cancelled",children:"취소"}),e.jsx("option",{value:"refunded",children:"환불"})]})})]}),e.jsx(O,{children:e.jsx(F,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-modern-bg-tertiary border-b border-modern-border-primary",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"주문 정보"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"고객"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"금액"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"상태"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"주문일"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"작업"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-modern-border-primary",children:Q?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-modern-primary"})})})}):b.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-modern-text-secondary",children:"주문 데이터가 없습니다."})}):b.map(s=>e.jsxs("tr",{className:"hover:bg-modern-bg-hover",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-modern-text-primary",children:s.orderNumber}),e.jsxs("div",{className:"text-sm text-modern-text-secondary",children:[s.items.length,"개 상품"]}),s.trackingNumber&&e.jsxs("div",{className:"text-xs text-modern-text-tertiary",children:["배송: ",s.trackingNumber]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-modern-text-primary",children:s.customerName}),e.jsx("div",{className:"text-sm text-modern-text-secondary",children:s.customerEmail})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:"text-sm font-medium text-modern-text-primary",children:["₩",s.totalAmount.toLocaleString()]})}),e.jsx("td",{className:"px-6 py-4",children:M(s.status)}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-sm text-modern-text-secondary",children:new Date(s.createdAt).toLocaleDateString("ko-KR")})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>U(s),children:e.jsx(Y,{className:"w-4 h-4"})}),e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>H(s),children:e.jsx(Z,{className:"w-4 h-4"})})]})})]},s.id))})]})})})}),e.jsx(q,{open:A,onOpenChange:u,children:e.jsx(L,{className:"max-w-md",children:e.jsxs("form",{onSubmit:J,children:[e.jsxs(K,{children:[e.jsx(R,{children:"주문 상태 변경"}),e.jsxs(B,{children:[t?.orderNumber," - ",t?.customerName]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx("div",{children:e.jsxs(l,{children:["현재 상태: ",j(t?.status||"pending")]})}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"newStatus",children:"새 상태 *"}),e.jsxs("select",{id:"newStatus",value:r.newStatus,onChange:s=>i(a=>({...a,newStatus:s.target.value})),className:"w-full px-3 py-2 border border-modern-border-primary rounded-lg mt-1",required:!0,children:[e.jsx("option",{value:"",children:"상태를 선택하세요"}),V(t?.status||"pending").map(s=>e.jsx("option",{value:s,children:j(s)},s))]})]}),(r.newStatus==="shipped"||r.newStatus==="delivered")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"trackingNumber",children:"운송장 번호"}),e.jsx(h,{id:"trackingNumber",value:r.trackingNumber,onChange:s=>i(a=>({...a,trackingNumber:s.target.value})),placeholder:"운송장 번호를 입력하세요"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"estimatedDelivery",children:"예상 배송일"}),e.jsx(h,{id:"estimatedDelivery",type:"date",value:r.estimatedDelivery,onChange:s=>i(a=>({...a,estimatedDelivery:s.target.value}))})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"reason",children:"변경 사유"}),e.jsx(h,{id:"reason",value:r.reason,onChange:s=>i(a=>({...a,reason:s.target.value})),placeholder:"상태 변경 이유를 입력하세요"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"notes",children:"메모"}),e.jsx(re,{id:"notes",value:r.notes,onChange:s=>i(a=>({...a,notes:s.target.value})),placeholder:"추가 메모를 입력하세요",rows:3})]})]}),e.jsxs(P,{children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>u(!1),children:"취소"}),e.jsx(o,{type:"submit",disabled:w.isPending,children:"상태 변경"})]})]})})}),e.jsx(q,{open:E,onOpenChange:p,children:e.jsxs(L,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(K,{children:[e.jsx(R,{children:"주문 상세"}),e.jsxs(B,{children:[t?.orderNumber," - ",t?.customerName]})]}),t&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"주문 상품"}),e.jsx("div",{className:"space-y-2",children:t.items.map(s=>e.jsxs("div",{className:"flex justify-between p-3 bg-modern-bg-secondary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.productName}),e.jsxs("div",{className:"text-sm text-modern-text-secondary",children:["SKU: ",s.sku," | 수량: ",s.quantity]}),s.variantOptions&&e.jsx("div",{className:"text-xs text-modern-text-tertiary",children:Object.entries(s.variantOptions).map(([a,g])=>`${a}: ${g}`).join(", ")})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-medium",children:["₩",s.totalPrice.toLocaleString()]}),e.jsxs("div",{className:"text-sm text-modern-text-secondary",children:["단가: ₩",s.unitPrice.toLocaleString()]})]})]},s.id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"상태 이력"}),e.jsx("div",{className:"space-y-2",children:t.statusHistory?.map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-modern-bg-secondary rounded-lg",children:[S(s.status),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:j(s.status)}),e.jsx("span",{className:"text-sm text-modern-text-secondary",children:new Date(s.changedAt).toLocaleString("ko-KR")})]}),s.reason&&e.jsxs("div",{className:"text-sm text-modern-text-secondary",children:["사유: ",s.reason]}),s.notes&&e.jsxs("div",{className:"text-sm text-modern-text-tertiary",children:["메모: ",s.notes]})]}),e.jsx("div",{className:"text-sm text-modern-text-secondary",children:s.changedBy})]},s.id))||e.jsx("div",{className:"text-center text-modern-text-secondary py-4",children:"상태 이력이 없습니다."})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"배송 정보"}),e.jsx("div",{className:"p-3 bg-modern-bg-secondary rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-modern-text-secondary",children:"받는 분"}),e.jsx("div",{className:"font-medium",children:t.shippingInfo.recipientName})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-modern-text-secondary",children:"연락처"}),e.jsx("div",{className:"font-medium",children:t.shippingInfo.phone})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-sm text-modern-text-secondary",children:"주소"}),e.jsxs("div",{className:"font-medium",children:["(",t.shippingInfo.postalCode,") ",t.shippingInfo.address]})]}),t.shippingInfo.deliveryRequest&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-sm text-modern-text-secondary",children:"배송 요청사항"}),e.jsx("div",{className:"font-medium",children:t.shippingInfo.deliveryRequest})]})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"결제 정보"}),e.jsx("div",{className:"p-3 bg-modern-bg-secondary rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-modern-text-secondary",children:"결제 방법"}),e.jsx("div",{className:"font-medium",children:t.paymentInfo.method})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-modern-text-secondary",children:"결제 금액"}),e.jsxs("div",{className:"font-medium",children:["₩",t.paymentInfo.amount.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-modern-text-secondary",children:"거래 ID"}),e.jsx("div",{className:"font-medium",children:t.paymentInfo.transactionId})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-modern-text-secondary",children:"결제일시"}),e.jsx("div",{className:"font-medium",children:new Date(t.paymentInfo.paidAt).toLocaleString("ko-KR")})]})]})})]})]}),e.jsx(P,{children:e.jsx(o,{onClick:()=>p(!1),children:"닫기"})})]})})]})};export{me as default};
