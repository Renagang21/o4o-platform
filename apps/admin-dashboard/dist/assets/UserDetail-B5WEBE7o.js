import{a4 as s,a3 as e,r as a,V as r,j as t,a5 as i,bC as c,cb as l,N as n,bL as d,bI as x,c5 as m,bR as o,bK as j}from"./vendor-react-B2e3hjul.js";import{B as h,a as p,b as v,d as g,e as u,C as N,k as y,l as f,m as b,s as w,t as A}from"./page-gutenberg-C_zDdNV3.js";import{a as k}from"./base-Bn37bo7A.js";import{f as S,D as U}from"./vendor-utils-B-KQWpLj.js";import"./vendor-monaco-BxJH8uUv.js";import"./vendor-ui-CrFdsnXa.js";import"./vendor-query-gT6dZ-b7.js";import"./wp-all-B6DO5GFQ.js";import"./index-D29lZukw.js";import"./vendor-socket-CMcZe9fK.js";function C(){const{id:C}=s(),R=e(),[$,L]=a.useState(null),[_,D]=a.useState([]),[E,F]=a.useState(!0);a.useEffect(()=>{C&&V()},[C]);const V=async()=>{try{F(!0);const s=await k.get(`/v1/users/${C}`);s.data.success&&L(s.data.data);const e=await k.get(`/v1/users/${C}/approval-history`);e.data.success&&D(e.data.data)}catch(s){r.error("Failed to load user details"),R("/users")}finally{F(!1)}},B=s=>({super_admin:"bg-purple-500",admin:"bg-red-500",vendor:"bg-blue-500",seller:"bg-green-500",customer:"bg-gray-500",business:"bg-yellow-500",moderator:"bg-indigo-500",partner:"bg-pink-500"}[s]||"bg-gray-500"),M=s=>{switch(s){case"approved":return t.jsx(c,{className:"h-4 w-4 text-green-500"});case"rejected":return t.jsx(l,{className:"h-4 w-4 text-red-500"});default:return t.jsx(j,{className:"h-4 w-4 text-gray-500"})}};return E?t.jsx("div",{className:"p-6",children:t.jsxs("div",{className:"animate-pulse",children:[t.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-6"}),t.jsx("div",{className:"h-64 bg-gray-200 rounded"})]})}):$?t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs(h,{variant:"ghost",onClick:()=>R("/users"),children:[t.jsx(i,{className:"mr-2 h-4 w-4"}),"Back to Users"]}),t.jsx("h1",{className:"text-2xl font-bold",children:$?.name||"Unknown User"})]}),t.jsxs("div",{className:"flex gap-2",children:["pending"===$?.status&&t.jsxs(t.Fragment,{children:[t.jsxs(h,{onClick:async()=>{try{await k.post(`/v1/users/${C}/approve`,{notes:"Approved via admin dashboard"}),r.success("User approved successfully"),V()}catch(s){r.error("Failed to approve user")}},children:[t.jsx(c,{className:"mr-2 h-4 w-4"}),"Approve"]}),t.jsxs(h,{variant:"destructive",onClick:async()=>{try{await k.post(`/v1/users/${C}/reject`,{notes:"Rejected via admin dashboard"}),r.success("User rejected successfully"),V()}catch(s){r.error("Failed to reject user")}},children:[t.jsx(l,{className:"mr-2 h-4 w-4"}),"Reject"]})]}),t.jsxs(h,{variant:"outline",onClick:()=>R(`/users/${C}/edit`),children:[t.jsx(n,{className:"mr-2 h-4 w-4"}),"Edit"]})]})]}),t.jsxs(p,{defaultValue:"overview",className:"w-full",children:[t.jsxs(v,{children:[t.jsx(g,{value:"overview",children:"Overview"}),t.jsx(g,{value:"history",children:"Approval History"}),t.jsx(g,{value:"activity",children:"Activity"})]}),t.jsxs(u,{value:"overview",className:"space-y-6",children:[t.jsxs(N,{children:[t.jsx(y,{children:t.jsx(f,{children:"User Information"})}),t.jsx(b,{className:"space-y-4",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(d,{className:"h-5 w-5 text-gray-400"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Email"}),t.jsx("p",{className:"font-medium",children:$?.email})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(x,{className:"h-5 w-5 text-gray-400"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Status"}),t.jsx(w,{className:`${H=$?.status||"pending",{active:"bg-green-500",approved:"bg-green-500",pending:"bg-yellow-500",rejected:"bg-red-500"}[H]||"bg-gray-500"} text-white`,children:$?.status})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(m,{className:"h-5 w-5 text-gray-400"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Joined"}),t.jsx("p",{className:"font-medium",children:$?S(new Date(Date.now()),"MMM d, yyyy"):""})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(o,{className:"h-5 w-5 text-gray-400"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Last Login"}),t.jsx("p",{className:"font-medium",children:$?.lastLoginAt?U(new Date($?.lastLoginAt),{addSuffix:!0}):"Never"})]})]})]})})]}),t.jsxs(N,{children:[t.jsx(y,{children:t.jsx(f,{children:"Roles & Permissions"})}),t.jsx(b,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Assigned Roles"}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:$?.role?[$.role]:[].map(s=>t.jsx(w,{className:`${B(s)} text-white`,children:s.replace("_"," ")},s))})]}),$?.permissions&&$?.permissions.length>0&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Special Permissions"}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:$?.permissions.map(s=>t.jsx(w,{variant:"outline",children:s},s))})]})]})})]}),t.jsxs(N,{children:[t.jsx(y,{children:t.jsx(f,{children:"Account Status"})}),t.jsx(b,{children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Email Verified"}),t.jsx("p",{className:"text-2xl font-bold",children:$?.isEmailVerified?"✓":"✗"})]}),t.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Account Active"}),t.jsx("p",{className:"text-2xl font-bold",children:$?.isActive?"✓":"✗"})]}),t.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Login Attempts"}),t.jsx("p",{className:"text-2xl font-bold",children:$?.loginAttempts||0})]})]})})]})]}),t.jsx(u,{value:"history",className:"space-y-4",children:t.jsxs(N,{children:[t.jsxs(y,{children:[t.jsx(f,{children:"Approval History"}),t.jsx(A,{children:"Timeline of all approval actions for this user"})]}),t.jsx(b,{children:0===_.length?t.jsx("p",{className:"text-center text-gray-500 py-8",children:"No approval history found"}):t.jsx("div",{className:"space-y-4",children:_.map(s=>t.jsxs("div",{className:"flex items-start gap-4 p-4 border rounded-lg",children:[t.jsx("div",{className:"mt-1",children:M(s.action)}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsxs("p",{className:"font-medium",children:["approved"===s.action&&"Approved","rejected"===s.action&&"Rejected","status_changed"===s.action&&"Status Changed"]}),t.jsxs("span",{className:"text-sm text-gray-500",children:["by ",s.admin?.fullName||s.admin?.email||"System"]})]}),s.notes&&t.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s.notes}),t.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[t.jsxs("span",{children:[s.previous_status," → ",s.new_status]}),t.jsx("span",{children:U(new Date(s.created_at),{addSuffix:!0})})]})]})]},s.id))})})]})}),t.jsx(u,{value:"activity",children:t.jsxs(N,{children:[t.jsxs(y,{children:[t.jsx(f,{children:"Recent Activity"}),t.jsx(A,{children:"User's recent actions and system events"})]}),t.jsx(b,{children:t.jsx("p",{className:"text-center text-gray-500 py-8",children:"Activity tracking coming soon"})})]})})]})]}):t.jsx("div",{className:"p-6",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-500",children:"User not found"}),t.jsx(h,{onClick:()=>R("/users"),className:"mt-4",children:"Back to Users"})]})});var H}export{C as default};
