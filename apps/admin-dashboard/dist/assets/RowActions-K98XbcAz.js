import{r as e,j as s,bS as t}from"./vendor-react-BqkIXTmC.js";import{a}from"./index-C056IMV_.js";import{B as l}from"./page-template-editor-DmUXhR56.js";import{c as i}from"./vendor-ui-CrFdsnXa.js";function n({items:s,idField:t="id",actions:l}){const[i,n]=e.useState(new Set),[c,o]=e.useState(!1),{success:r,error:d}=a(),u=e.useMemo(()=>0!==s.length&&s.every(e=>i.has(String(e[t]))),[s,i,t]),m=e.useMemo(()=>0!==s.length&&(s.some(e=>i.has(String(e[t])))&&!u),[s,i,t,u]),h=e.useCallback(()=>{if(u)n(new Set);else{const e=new Set(s.map(e=>String(e[t])));n(e)}},[s,t,u]),p=e.useCallback(e=>{n(s=>{const t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},[]),x=e.useCallback(()=>{n(new Set)},[]),b=e.useCallback(async e=>{const s=l.find(s=>s.value===e);if(s)if(0!==i.size){if(s.confirmMessage){if(!window.confirm(s.confirmMessage.replace("{count}",String(i.size))))return}o(!0);try{await s.action(Array.from(i)),r(`${s.label} applied to ${i.size} item(s)`),x()}catch(t){d(`Failed to apply ${s.label}: ${t instanceof Error?t.message:"Unknown error"}`)}finally{o(!1)}}else d("No items selected");else d("Invalid action selected")},[l,i,r,d,x]);return{selectedIds:i,selectedCount:i.size,isAllSelected:u,isSomeSelected:m,isProcessing:c,toggleAll:h,toggleItem:p,clearSelection:x,executeBulkAction:b,isSelected:e=>i.has(e)}}const c=({actions:t,selectedCount:a,onActionExecute:i,isProcessing:n=!1,position:c="top"})=>{const[o,r]=e.useState("");return s.jsx("div",{className:`tablenav ${c}`,children:s.jsxs("div",{className:"alignleft actions bulkactions",children:[s.jsx("label",{htmlFor:`bulk-action-selector-${c}`,className:"screen-reader-text",children:"Select bulk action"}),s.jsxs("select",{id:`bulk-action-selector-${c}`,name:"action",value:o,onChange:e=>r(e.target.value),disabled:n,children:[s.jsx("option",{value:"",children:"Bulk actions"}),t.map(e=>s.jsx("option",{value:e.value,children:e.label},e.value))]}),s.jsx(l,{className:"button action",onClick:()=>{o&&(i(o),r(""))},disabled:!o||0===a||n,children:n?"Processing...":"Apply"}),a>0&&s.jsxs("span",{className:"selected-count",children:[a," item",1!==a?"s":""," selected"]})]})})},o=({actions:a,visible:l=!1})=>{const[n,c]=e.useState(l),o=e.useRef(null);return e.useEffect(()=>{c(l)},[l]),s.jsx("div",{ref:o,className:i("row-actions",!n&&"hidden"),children:a.map((e,l)=>{const n=l===a.length-1;return e.href?s.jsxs("span",{children:[s.jsx(t,{to:e.href,className:i("row-action-link",e.isDelete&&"text-red-600 hover:text-red-800",e.isDisabled&&"opacity-50 cursor-not-allowed",e.className),onClick:e.isDisabled?e=>e.preventDefault():void 0,children:e.label}),!n&&s.jsx("span",{className:"text-gray-400 mx-1",children:"|"})]},l):s.jsxs("span",{children:[s.jsx("button",{onClick:e.onClick,disabled:e.isDisabled,className:i("row-action-button",e.isDelete&&"text-red-600 hover:text-red-800",e.isDisabled&&"opacity-50 cursor-not-allowed",e.className),children:e.label}),!n&&s.jsx("span",{className:"text-gray-400 mx-1",children:"|"})]},l)})})};export{c as B,o as R,n as u};
