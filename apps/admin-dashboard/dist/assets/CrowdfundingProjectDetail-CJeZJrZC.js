import{b as e,u as s,V as t,j as a,di as r,A as i,bQ as n,d$ as c,cM as d,bF as l,bV as o,bU as m,b_ as p,cm as x,cw as j}from"./vendor-react-BQ6HOJoh.js";import{u as h,a as u,b as w}from"./vendor-query-LYSOqK5P.js";import{b,B as N}from"./page-template-editor-C7FodHrK.js";import{ak as y,al as f,am as g,an as v,av as k}from"./wp-misc-DS9m4_P2.js";import{S as C}from"./separator-bCTRPw3p.js";import"./wp-block-editor-a11y-DrduSWFW.js";import"./wp-block-editor-misc-pHCPYvR2.js";import"./wp-block-editor-api-Buev8_QU.js";import"./wp-block-editor-utils-M5qXzE1L.js";import"./wp-block-editor-colors-D38h-Odz.js";import"./wp-blocks-core-6vwQKPfS.js";import"./wp-block-editor-clipboard-Dg0Y1gQ6.js";import"./wp-block-editor-store-B-g1aSix.js";import"./vendor-ui-CrFdsnXa.js";import"./wp-block-editor-dnd-BYoS8-II.js";import"./wp-block-editor-library-BpQvynjE.js";import"./wp-block-editor-menus-BTQ2wZ-f.js";import"./wp-block-editor-keyboard-CeHTtvP5.js";import"./wp-block-editor-typography-Bl_1REQP.js";import"./wp-block-editor-spacing-BD_2CpN7.js";import"./wp-block-editor-core-DL280tSA.js";import"./wp-block-editor-selection-CC4tJpUu.js";import"./wp-block-editor-formats-CLXkimOp.js";import"./wp-block-editor-inline-CpXpUhQU.js";import"./wp-block-editor-ui-B8YE_4QL.js";import"./wp-block-editor-transforms-jLcKa8Hv.js";import"./wp-block-editor-preview-iw2Xu1ib.js";import"./wp-block-editor-global-styles-CV5-K6QF.js";import"./wp-block-editor-borders-BH1devca.js";import"./wp-block-editor-patterns-BXdHo9lm.js";import"./wp-block-editor-navigation-BFSoKzg0.js";import"./wp-block-editor-media-Bg-JiQDT.js";import"./wp-api-BeoadipR.js";import"./wp-i18n-DGPtqsXY.js";import"./wp-core-Y-jV-nrZ.js";import"./vendor-monaco-BxJH8uUv.js";import"./wp-block-editor-upload-BLw1R9wP.js";import"./vendor-utils-D-spY-QM.js";import"./wp-block-editor-templates-o1_wAMb9.js";import"./wp-data-BmtL8k4r.js";import"./wp-components-CeQNCpMW.js";const q=()=>{const{id:q}=e(),P=s(),D=h(),{data:$,isLoading:K}=u({queryKey:["crowdfunding-project",q],queryFn:async()=>(await b.api.get(`/v1/crowdfunding-simple/projects/${q}`)).data,enabled:!!q}),F=$?.data,{data:A}=u({queryKey:["crowdfunding-participation",q],queryFn:async()=>(await b.api.get(`/v1/crowdfunding-simple/projects/${q}/participation-status`)).data,enabled:!!q}),M=A?.data,Q=w({mutationFn:async()=>(await b.api.post(`/v1/crowdfunding-simple/projects/${q}/join`)).data,onSuccess:()=>{t.success("프로젝트에 참여했습니다!"),D.invalidateQueries({queryKey:["crowdfunding-project",q]}),D.invalidateQueries({queryKey:["crowdfunding-participation",q]})},onError:e=>{t.error(e.response?.data?.error||"참여에 실패했습니다.")}}),L=w({mutationFn:async()=>(await b.api.post(`/v1/crowdfunding-simple/projects/${q}/cancel`)).data,onSuccess:()=>{t.success("참여를 취소했습니다."),D.invalidateQueries({queryKey:["crowdfunding-project",q]}),D.invalidateQueries({queryKey:["crowdfunding-participation",q]})},onError:e=>{t.error(e.response?.data?.error||"취소에 실패했습니다.")}});if(K)return a.jsx("div",{className:"flex items-center justify-center h-96",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-modern-primary"})});if(!F)return a.jsxs("div",{className:"text-center py-12",children:[a.jsx(r,{className:"w-16 h-16 text-modern-text-tertiary mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-modern-text-primary mb-2",children:"프로젝트를 찾을 수 없습니다"}),a.jsx("p",{className:"text-modern-text-secondary mb-4",children:"요청하신 프로젝트가 존재하지 않거나 삭제되었습니다."}),a.jsx(N,{onClick:()=>P("/crowdfunding/projects"),children:"프로젝트 목록으로"})]});const S=e=>new Date(e).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"}),z=(E=F.currentParticipantCount,(B=F.targetParticipantCount)>0?Math.min(E/B*100,100):0);var E,B;const T=(e=>{const s=new Date(e),t=new Date,a=s.getTime()-t.getTime(),r=Math.ceil(a/864e5);return Math.max(0,r)})(F.endDate),U="recruiting"===F.status&&T>0,V="joined"===M?.status,_=U&&!V;return a.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs(N,{variant:"ghost",size:"sm",onClick:()=>P("/crowdfunding/projects"),children:[a.jsx(i,{className:"w-4 h-4 mr-2"}),"프로젝트 목록"]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs(N,{variant:"outline",size:"sm",onClick:()=>P(`/crowdfunding/projects/${q}/edit`),children:[a.jsx(n,{className:"w-4 h-4 mr-2"}),"수정"]})})]}),a.jsxs(y,{children:[a.jsx(f,{className:"pb-4",children:a.jsx("div",{className:"flex items-start justify-between",children:a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(g,{className:"text-2xl",children:F.title}),(e=>{const s={recruiting:{label:"모집중",variant:"default",icon:j},in_progress:{label:"진행중",variant:"secondary",icon:x},completed:{label:"완료",variant:"outline",icon:o},cancelled:{label:"중단",variant:"destructive",icon:r}},t=s[e]||s.recruiting,i=t.icon;return a.jsxs(k,{variant:t.variant,className:"flex items-center gap-1",children:[a.jsx(i,{className:"w-3 h-3"}),t.label]})})(F.status)]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-modern-text-secondary",children:[a.jsxs("span",{children:["개발사: ",F.creatorName]}),a.jsx("span",{children:"•"}),a.jsxs("span",{children:["등록일: ",S(F.createdAt)]})]})]})})}),a.jsx(v,{children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold mb-3",children:"프로젝트 설명"}),a.jsx("div",{className:"prose prose-sm max-w-none text-modern-text-secondary whitespace-pre-wrap",children:F.description})]}),F.participants&&F.participants.length>0&&a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-3",children:["참여 매장 (",F.participants.length,"개)"]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:F.participants.map(e=>a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-modern-bg-tertiary rounded-lg",children:[a.jsx("div",{className:"w-10 h-10 bg-modern-primary text-white rounded-full flex items-center justify-center text-sm font-medium",children:e.vendorName?.charAt(0)||"U"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-modern-text-primary",children:e.vendorName}),a.jsxs("p",{className:"text-xs text-modern-text-secondary",children:[S(e.joinedAt)," 참여"]})]})]},e.id))})]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs(y,{children:[a.jsx(f,{className:"pb-3",children:a.jsxs(g,{className:"text-lg flex items-center gap-2",children:[a.jsx(c,{className:"w-5 h-5 text-modern-primary"}),"진행 현황"]})}),a.jsxs(v,{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-modern-text-secondary",children:"참여 진행률"}),a.jsxs("span",{className:"font-medium text-modern-text-primary",children:[Math.round(z),"%"]})]}),a.jsx("div",{className:"w-full bg-modern-bg-tertiary rounded-full h-3",children:a.jsx("div",{className:"h-3 rounded-full transition-all duration-300 "+(z>=100?"bg-modern-success":z>=50?"bg-modern-primary":"bg-modern-warning"),style:{width:`${z}%`}})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-modern-text-primary",children:F.currentParticipantCount}),a.jsx("p",{className:"text-xs text-modern-text-secondary",children:"현재 참여"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-modern-text-primary",children:F.targetParticipantCount}),a.jsx("p",{className:"text-xs text-modern-text-secondary",children:"목표 참여"})]})]}),a.jsx(C,{}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(d,{className:"w-4 h-4 text-modern-text-tertiary"}),a.jsx("span",{className:"text-modern-text-secondary",children:"남은 기간"})]}),a.jsx("span",{className:"font-medium text-modern-text-primary",children:U?`${T}일`:"종료됨"})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(l,{className:"w-4 h-4 text-modern-text-tertiary"}),a.jsx("span",{className:"text-modern-text-secondary",children:"참여 매장"})]}),a.jsxs("span",{className:"font-medium text-modern-text-primary",children:[F.currentParticipantCount,"개"]})]})]})]})]}),a.jsx(y,{children:a.jsx(v,{className:"p-4",children:V?a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2 text-modern-success",children:[a.jsx(o,{className:"w-5 h-5"}),a.jsx("span",{className:"font-medium",children:"참여 중"})]}),a.jsx(N,{variant:"outline",className:"w-full",onClick:()=>L.mutate(),disabled:L.isPending,children:L.isPending?"처리 중...":"참여 취소"})]}):_?a.jsx(N,{className:"w-full",onClick:()=>Q.mutate(),disabled:Q.isPending,children:Q.isPending?"처리 중...":"프로젝트 참여하기"}):a.jsx("div",{className:"text-center space-y-2",children:a.jsxs("div",{className:"flex items-center justify-center gap-2 text-modern-text-secondary",children:[a.jsx(m,{className:"w-5 h-5"}),a.jsx("span",{className:"text-sm",children:"completed"===F.status?"완료된 프로젝트입니다":"cancelled"===F.status?"중단된 프로젝트입니다":"참여 기간이 종료되었습니다"})]})})})}),F.forumLink&&a.jsx(y,{children:a.jsx(v,{className:"p-4",children:a.jsxs(N,{variant:"outline",className:"w-full",onClick:()=>P(F.forumLink),children:[a.jsx(p,{className:"w-4 h-4 mr-2"}),"포럼에서 토론하기"]})})}),a.jsxs(y,{children:[a.jsx(f,{className:"pb-3",children:a.jsx(g,{className:"text-lg",children:"프로젝트 기간"})}),a.jsxs(v,{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-modern-text-secondary",children:"시작일"}),a.jsx("span",{className:"text-modern-text-primary",children:S(F.startDate)})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-modern-text-secondary",children:"종료일"}),a.jsx("span",{className:"text-modern-text-primary",children:S(F.endDate)})]})]})]})]})]})})]})]})};export{q as default};
