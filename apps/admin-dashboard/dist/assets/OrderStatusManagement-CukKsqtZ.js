import{r as e,j as s,E as t,bQ as r,cf as a,bU as d,bf as i,bV as n,dj as l,c9 as c,cw as o,V as m}from"./vendor-react-BQ6HOJoh.js";import{u as x,a as p,b as h}from"./vendor-query-LYSOqK5P.js";import{I as u,B as j,L as v,T as g,b as N}from"./page-template-editor-C7FodHrK.js";import{ak as y,an as b,az as f,aA as w,aB as k,aC as S,aD as C,aE as I,av as D}from"./wp-misc-DS9m4_P2.js";import"./wp-block-editor-a11y-DrduSWFW.js";import"./wp-block-editor-misc-pHCPYvR2.js";import"./wp-block-editor-api-Buev8_QU.js";import"./wp-block-editor-utils-M5qXzE1L.js";import"./wp-block-editor-colors-D38h-Odz.js";import"./wp-blocks-core-6vwQKPfS.js";import"./wp-block-editor-clipboard-Dg0Y1gQ6.js";import"./wp-block-editor-store-B-g1aSix.js";import"./vendor-ui-CrFdsnXa.js";import"./wp-block-editor-dnd-BYoS8-II.js";import"./wp-block-editor-library-BpQvynjE.js";import"./wp-block-editor-menus-BTQ2wZ-f.js";import"./wp-block-editor-keyboard-CeHTtvP5.js";import"./wp-block-editor-typography-Bl_1REQP.js";import"./wp-block-editor-spacing-BD_2CpN7.js";import"./wp-block-editor-core-DL280tSA.js";import"./wp-block-editor-selection-CC4tJpUu.js";import"./wp-block-editor-formats-CLXkimOp.js";import"./wp-block-editor-inline-CpXpUhQU.js";import"./wp-block-editor-ui-B8YE_4QL.js";import"./wp-block-editor-transforms-jLcKa8Hv.js";import"./wp-block-editor-preview-iw2Xu1ib.js";import"./wp-block-editor-global-styles-CV5-K6QF.js";import"./wp-block-editor-borders-BH1devca.js";import"./wp-block-editor-patterns-BXdHo9lm.js";import"./wp-block-editor-navigation-BFSoKzg0.js";import"./wp-block-editor-media-Bg-JiQDT.js";import"./wp-api-BeoadipR.js";import"./wp-i18n-DGPtqsXY.js";import"./wp-core-Y-jV-nrZ.js";import"./vendor-monaco-BxJH8uUv.js";import"./wp-block-editor-upload-BLw1R9wP.js";import"./vendor-utils-D-spY-QM.js";import"./wp-block-editor-templates-o1_wAMb9.js";import"./wp-data-BmtL8k4r.js";import"./wp-components-CeQNCpMW.js";const q=()=>{const q=x(),[F,L]=e.useState(""),[K,A]=e.useState("all"),[R,O]=e.useState(null),[$,z]=e.useState(!1),[B,E]=e.useState(!1),[P,Q]=e.useState({orderId:"",newStatus:"pending",reason:"",notes:"",trackingNumber:"",estimatedDelivery:""}),{data:U,isLoading:H}=p({queryKey:["orders",F,K],queryFn:async()=>{const e=new URLSearchParams;F&&e.append("search",F),"all"!==K&&e.append("status",K);return(await N.api.get(`/v1/ecommerce/orders?${e.toString()}`)).data}}),V=U?.data||[],{data:G}=p({queryKey:["order-stats"],queryFn:async()=>(await N.api.get("/v1/ecommerce/orders/stats")).data}),T=G?.data||{},J=h({mutationFn:async e=>(await N.api.put(`/v1/ecommerce/orders/${e.orderId}/status`,e)).data,onSuccess:()=>{m.success("주문 상태가 변경되었습니다"),q.invalidateQueries({queryKey:["orders"]}),q.invalidateQueries({queryKey:["order-stats"]}),z(!1),Q({orderId:"",newStatus:"pending",reason:"",notes:"",trackingNumber:"",estimatedDelivery:""})}}),M=e=>{switch(e){case"pending":return s.jsx(D,{variant:"outline",className:"text-yellow-600 border-yellow-600",children:"대기중"});case"confirmed":return s.jsx(D,{variant:"outline",className:"text-blue-600 border-blue-600",children:"확인됨"});case"processing":return s.jsx(D,{variant:"outline",className:"text-purple-600 border-purple-600",children:"처리중"});case"shipped":return s.jsx(D,{variant:"outline",className:"text-indigo-600 border-indigo-600",children:"배송중"});case"delivered":return s.jsx(D,{variant:"outline",className:"text-green-600 border-green-600",children:"배송완료"});case"completed":return s.jsx(D,{children:"완료"});case"cancelled":return s.jsx(D,{variant:"secondary",children:"취소"});case"refunded":return s.jsx(D,{variant:"destructive",children:"환불"});default:return s.jsx(D,{variant:"outline",children:e})}},W=e=>{switch(e){case"pending":return s.jsx(o,{className:"w-4 h-4 text-yellow-600"});case"confirmed":return s.jsx(n,{className:"w-4 h-4 text-blue-600"});case"processing":return s.jsx(c,{className:"w-4 h-4 text-purple-600"});case"shipped":return s.jsx(l,{className:"w-4 h-4 text-indigo-600"});case"delivered":return s.jsx(a,{className:"w-4 h-4 text-green-600"});case"completed":return s.jsx(n,{className:"w-4 h-4 text-green-600"});case"cancelled":return s.jsx(i,{className:"w-4 h-4 text-gray-600"});case"refunded":return s.jsx(d,{className:"w-4 h-4 text-red-600"});default:return s.jsx(a,{className:"w-4 h-4"})}},X=e=>({pending:"대기중",confirmed:"확인됨",processing:"처리중",shipped:"배송중",delivered:"배송완료",completed:"완료",cancelled:"취소",refunded:"환불"}[e]||e);return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-modern-text-primary",children:"주문 상태 관리"}),s.jsx("p",{className:"text-modern-text-secondary mt-1",children:"주문 워크플로우 추적 및 관리"})]})}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4",children:[{status:"pending",label:"대기중",count:T.pending||0,color:"text-yellow-600"},{status:"confirmed",label:"확인됨",count:T.confirmed||0,color:"text-blue-600"},{status:"processing",label:"처리중",count:T.processing||0,color:"text-purple-600"},{status:"shipped",label:"배송중",count:T.shipped||0,color:"text-indigo-600"},{status:"delivered",label:"배송완료",count:T.delivered||0,color:"text-green-600"},{status:"completed",label:"완료",count:T.completed||0,color:"text-green-700"},{status:"cancelled",label:"취소",count:T.cancelled||0,color:"text-gray-600"},{status:"refunded",label:"환불",count:T.refunded||0,color:"text-red-600"}].map(({status:e,label:t,count:r,color:a})=>s.jsx(y,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>A(e),children:s.jsx(b,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[W(e),s.jsxs("div",{children:[s.jsx("div",{className:`text-2xl font-bold ${a}`,children:r}),s.jsx("div",{className:"text-xs text-modern-text-secondary",children:t})]})]})})},e))}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx(u,{type:"text",placeholder:"주문번호, 고객명으로 검색...",value:F,onChange:e=>L(e.target.value)})}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("select",{value:K,onChange:e=>A(e.target.value),className:"px-4 py-2 border border-modern-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-modern-primary",children:[s.jsx("option",{value:"all",children:"모든 상태"}),s.jsx("option",{value:"pending",children:"대기중"}),s.jsx("option",{value:"confirmed",children:"확인됨"}),s.jsx("option",{value:"processing",children:"처리중"}),s.jsx("option",{value:"shipped",children:"배송중"}),s.jsx("option",{value:"delivered",children:"배송완료"}),s.jsx("option",{value:"completed",children:"완료"}),s.jsx("option",{value:"cancelled",children:"취소"}),s.jsx("option",{value:"refunded",children:"환불"})]})})]}),s.jsx(y,{children:s.jsx(b,{className:"p-0",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-modern-bg-tertiary border-b border-modern-border-primary",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"주문 정보"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"고객"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"금액"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"상태"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"주문일"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"작업"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-modern-border-primary",children:H?s.jsx("tr",{children:s.jsx("td",{colSpan:6,className:"px-6 py-12 text-center",children:s.jsx("div",{className:"flex justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-modern-primary"})})})}):0===V.length?s.jsx("tr",{children:s.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-modern-text-secondary",children:"주문 데이터가 없습니다."})}):V.map(e=>s.jsxs("tr",{className:"hover:bg-modern-bg-hover",children:[s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-modern-text-primary",children:e.orderNumber}),s.jsxs("div",{className:"text-sm text-modern-text-secondary",children:[e.items.length,"개 상품"]}),e.trackingNumber&&s.jsxs("div",{className:"text-xs text-modern-text-tertiary",children:["배송: ",e.trackingNumber]})]})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-modern-text-primary",children:e.customerName}),s.jsx("div",{className:"text-sm text-modern-text-secondary",children:e.customerEmail})]})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("span",{className:"text-sm font-medium text-modern-text-primary",children:["₩",e.totalAmount.toLocaleString()]})}),s.jsx("td",{className:"px-6 py-4",children:M(e.status)}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:"text-sm text-modern-text-secondary",children:new Date(e.createdAt).toLocaleDateString("ko-KR")})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(j,{variant:"ghost",size:"sm",onClick:()=>(e=>{O(e),E(!0)})(e),children:s.jsx(t,{className:"w-4 h-4"})}),s.jsx(j,{variant:"ghost",size:"sm",onClick:()=>(e=>{O(e),Q({orderId:e.id,newStatus:e.status,reason:"",notes:"",trackingNumber:e.trackingNumber||"",estimatedDelivery:e.estimatedDelivery||""}),z(!0)})(e),children:s.jsx(r,{className:"w-4 h-4"})})]})})]},e.id))})]})})})}),s.jsx(f,{open:$,onOpenChange:z,children:s.jsx(w,{className:"max-w-md",children:s.jsxs("form",{onSubmit:e=>{e.preventDefault(),P.newStatus?J.mutate(P):m.error("새로운 상태를 선택하세요")},children:[s.jsxs(k,{children:[s.jsx(S,{children:"주문 상태 변경"}),s.jsxs(C,{children:[R?.orderNumber," - ",R?.customerName]})]}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsx("div",{children:s.jsxs(v,{children:["현재 상태: ",X(R?.status||"pending")]})}),s.jsxs("div",{children:[s.jsx(v,{htmlFor:"newStatus",children:"새 상태 *"}),s.jsxs("select",{id:"newStatus",value:P.newStatus,onChange:e=>Q(s=>({...s,newStatus:e.target.value})),className:"w-full px-3 py-2 border border-modern-border-primary rounded-lg mt-1",required:!0,children:[s.jsx("option",{value:"",children:"상태를 선택하세요"}),(e=>{switch(e){case"pending":return["confirmed","cancelled"];case"confirmed":return["processing","cancelled"];case"processing":return["shipped","cancelled"];case"shipped":return["delivered","cancelled"];case"delivered":return["completed","refunded"];case"completed":case"cancelled":return["refunded"];default:return[]}})(R?.status||"pending").map(e=>s.jsx("option",{value:e,children:X(e)},e))]})]}),("shipped"===P.newStatus||"delivered"===P.newStatus)&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx(v,{htmlFor:"trackingNumber",children:"운송장 번호"}),s.jsx(u,{id:"trackingNumber",value:P.trackingNumber,onChange:e=>Q(s=>({...s,trackingNumber:e.target.value})),placeholder:"운송장 번호를 입력하세요"})]}),s.jsxs("div",{children:[s.jsx(v,{htmlFor:"estimatedDelivery",children:"예상 배송일"}),s.jsx(u,{id:"estimatedDelivery",type:"date",value:P.estimatedDelivery,onChange:e=>Q(s=>({...s,estimatedDelivery:e.target.value}))})]})]}),s.jsxs("div",{children:[s.jsx(v,{htmlFor:"reason",children:"변경 사유"}),s.jsx(u,{id:"reason",value:P.reason,onChange:e=>Q(s=>({...s,reason:e.target.value})),placeholder:"상태 변경 이유를 입력하세요"})]}),s.jsxs("div",{children:[s.jsx(v,{htmlFor:"notes",children:"메모"}),s.jsx(g,{id:"notes",value:P.notes,onChange:e=>Q(s=>({...s,notes:e.target.value})),placeholder:"추가 메모를 입력하세요",rows:3})]})]}),s.jsxs(I,{children:[s.jsx(j,{type:"button",variant:"outline",onClick:()=>z(!1),children:"취소"}),s.jsx(j,{type:"submit",disabled:J.isPending,children:"상태 변경"})]})]})})}),s.jsx(f,{open:B,onOpenChange:E,children:s.jsxs(w,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[s.jsxs(k,{children:[s.jsx(S,{children:"주문 상세"}),s.jsxs(C,{children:[R?.orderNumber," - ",R?.customerName]})]}),R&&s.jsxs("div",{className:"space-y-6 py-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium mb-3",children:"주문 상품"}),s.jsx("div",{className:"space-y-2",children:R.items.map(e=>s.jsxs("div",{className:"flex justify-between p-3 bg-modern-bg-secondary rounded-lg",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:e.productName}),s.jsxs("div",{className:"text-sm text-modern-text-secondary",children:["SKU: ",e.sku," | 수량: ",e.quantity]}),e.variantOptions&&s.jsx("div",{className:"text-xs text-modern-text-tertiary",children:Object.entries(e.variantOptions).map(([e,s])=>`${e}: ${s}`).join(", ")})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"font-medium",children:["₩",e.totalPrice.toLocaleString()]}),s.jsxs("div",{className:"text-sm text-modern-text-secondary",children:["단가: ₩",e.unitPrice.toLocaleString()]})]})]},e.id))})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium mb-3",children:"상태 이력"}),s.jsx("div",{className:"space-y-2",children:R.statusHistory?.map(e=>s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-modern-bg-secondary rounded-lg",children:[W(e.status),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium",children:X(e.status)}),s.jsx("span",{className:"text-sm text-modern-text-secondary",children:new Date(e.changedAt).toLocaleString("ko-KR")})]}),e.reason&&s.jsxs("div",{className:"text-sm text-modern-text-secondary",children:["사유: ",e.reason]}),e.notes&&s.jsxs("div",{className:"text-sm text-modern-text-tertiary",children:["메모: ",e.notes]})]}),s.jsx("div",{className:"text-sm text-modern-text-secondary",children:e.changedBy})]},e.id))||s.jsx("div",{className:"text-center text-modern-text-secondary py-4",children:"상태 이력이 없습니다."})})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium mb-3",children:"배송 정보"}),s.jsx("div",{className:"p-3 bg-modern-bg-secondary rounded-lg",children:s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-modern-text-secondary",children:"받는 분"}),s.jsx("div",{className:"font-medium",children:R.shippingInfo.recipientName})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-modern-text-secondary",children:"연락처"}),s.jsx("div",{className:"font-medium",children:R.shippingInfo.phone})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("div",{className:"text-sm text-modern-text-secondary",children:"주소"}),s.jsxs("div",{className:"font-medium",children:["(",R.shippingInfo.postalCode,") ",R.shippingInfo.address]})]}),R.shippingInfo.deliveryRequest&&s.jsxs("div",{className:"col-span-2",children:[s.jsx("div",{className:"text-sm text-modern-text-secondary",children:"배송 요청사항"}),s.jsx("div",{className:"font-medium",children:R.shippingInfo.deliveryRequest})]})]})})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium mb-3",children:"결제 정보"}),s.jsx("div",{className:"p-3 bg-modern-bg-secondary rounded-lg",children:s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-modern-text-secondary",children:"결제 방법"}),s.jsx("div",{className:"font-medium",children:R.paymentInfo.method})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-modern-text-secondary",children:"결제 금액"}),s.jsxs("div",{className:"font-medium",children:["₩",R.paymentInfo.amount.toLocaleString()]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-modern-text-secondary",children:"거래 ID"}),s.jsx("div",{className:"font-medium",children:R.paymentInfo.transactionId})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-modern-text-secondary",children:"결제일시"}),s.jsx("div",{className:"font-medium",children:new Date(R.paymentInfo.paidAt).toLocaleString("ko-KR")})]})]})})]})]}),s.jsx(I,{children:s.jsx(j,{onClick:()=>E(!1),children:"닫기"})})]})})]})};export{q as default};
