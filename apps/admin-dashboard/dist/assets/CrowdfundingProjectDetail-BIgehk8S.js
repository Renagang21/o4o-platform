import{b as e,u as s,V as a,j as t,cG as r,A as n,bc as i,dm as c,c8 as d,b1 as l,bh as m,bg as o,bm as x,bK as p,bU as j}from"./vendor-react-BoWgD0Bu.js";import{u as h,a as u,b as N}from"./vendor-query-CbBSyLUF.js";import{b as f,B as y}from"./page-template-editor-CWJwXWLM.js";import{cy as g,cz as v,cA as w,cB as b,cJ as k}from"./wp-misc-fiKRzvVp.js";import{S as C}from"./separator-FqAhJAUw.js";import"./vendor-monaco-BxJH8uUv.js";import"./vendor-ui-CrFdsnXa.js";import"./vendor-utils-C9jLuAcl.js";import"./wp-foundation-BzBJX52f.js";import"./wp-block-editor-main-y2nlPlta.js";import"./wp-i18n-BPC8WmOV.js";import"./wp-block-editor-store-PPID3vJI.js";import"./wp-block-editor-utils-C52tDze8.js";import"./wp-components-CKWj6dcl.js";const q=()=>{const{id:q}=e(),P=s(),K=h(),{data:D,isLoading:$}=u({queryKey:["crowdfunding-project",q],queryFn:async()=>(await f.api.get(`/v1/crowdfunding-simple/projects/${q}`)).data,enabled:!!q}),A=D?.data,{data:F}=u({queryKey:["crowdfunding-participation",q],queryFn:async()=>(await f.api.get(`/v1/crowdfunding-simple/projects/${q}/participation-status`)).data,enabled:!!q}),L=F?.data,M=N({mutationFn:async()=>(await f.api.post(`/v1/crowdfunding-simple/projects/${q}/join`)).data,onSuccess:()=>{a.success("프로젝트에 참여했습니다!"),K.invalidateQueries({queryKey:["crowdfunding-project",q]}),K.invalidateQueries({queryKey:["crowdfunding-participation",q]})},onError:e=>{a.error(e.response?.data?.error||"참여에 실패했습니다.")}}),Q=N({mutationFn:async()=>(await f.api.post(`/v1/crowdfunding-simple/projects/${q}/cancel`)).data,onSuccess:()=>{a.success("참여를 취소했습니다."),K.invalidateQueries({queryKey:["crowdfunding-project",q]}),K.invalidateQueries({queryKey:["crowdfunding-participation",q]})},onError:e=>{a.error(e.response?.data?.error||"취소에 실패했습니다.")}});if($)return t.jsx("div",{className:"flex items-center justify-center h-96",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-modern-primary"})});if(!A)return t.jsxs("div",{className:"text-center py-12",children:[t.jsx(r,{className:"w-16 h-16 text-modern-text-tertiary mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-semibold text-modern-text-primary mb-2",children:"프로젝트를 찾을 수 없습니다"}),t.jsx("p",{className:"text-modern-text-secondary mb-4",children:"요청하신 프로젝트가 존재하지 않거나 삭제되었습니다."}),t.jsx(y,{onClick:()=>P("/crowdfunding/projects"),children:"프로젝트 목록으로"})]});const S=e=>new Date(e).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"}),z=(B=A.currentParticipantCount,(E=A.targetParticipantCount)>0?Math.min(B/E*100,100):0);var B,E;const T=(e=>{const s=new Date(e),a=new Date,t=s.getTime()-a.getTime(),r=Math.ceil(t/864e5);return Math.max(0,r)})(A.endDate),U="recruiting"===A.status&&T>0,G="joined"===L?.status,J=U&&!G;return t.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs(y,{variant:"ghost",size:"sm",onClick:()=>P("/crowdfunding/projects"),children:[t.jsx(n,{className:"w-4 h-4 mr-2"}),"프로젝트 목록"]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs(y,{variant:"outline",size:"sm",onClick:()=>P(`/crowdfunding/projects/${q}/edit`),children:[t.jsx(i,{className:"w-4 h-4 mr-2"}),"수정"]})})]}),t.jsxs(g,{children:[t.jsx(v,{className:"pb-4",children:t.jsx("div",{className:"flex items-start justify-between",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx(w,{className:"text-2xl",children:A.title}),(e=>{const s={recruiting:{label:"모집중",variant:"default",icon:j},in_progress:{label:"진행중",variant:"secondary",icon:p},completed:{label:"완료",variant:"outline",icon:m},cancelled:{label:"중단",variant:"destructive",icon:r}},a=s[e]||s.recruiting,n=a.icon;return t.jsxs(k,{variant:a.variant,className:"flex items-center gap-1",children:[t.jsx(n,{className:"w-3 h-3"}),a.label]})})(A.status)]}),t.jsxs("div",{className:"flex items-center gap-4 text-sm text-modern-text-secondary",children:[t.jsxs("span",{children:["개발사: ",A.creatorName]}),t.jsx("span",{children:"•"}),t.jsxs("span",{children:["등록일: ",S(A.createdAt)]})]})]})})}),t.jsx(b,{children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[t.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold mb-3",children:"프로젝트 설명"}),t.jsx("div",{className:"prose prose-sm max-w-none text-modern-text-secondary whitespace-pre-wrap",children:A.description})]}),A.participants&&A.participants.length>0&&t.jsxs("div",{children:[t.jsxs("h3",{className:"text-lg font-semibold mb-3",children:["참여 매장 (",A.participants.length,"개)"]}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:A.participants.map(e=>t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-modern-bg-tertiary rounded-lg",children:[t.jsx("div",{className:"w-10 h-10 bg-modern-primary text-white rounded-full flex items-center justify-center text-sm font-medium",children:e.vendorName?.charAt(0)||"U"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-modern-text-primary",children:e.vendorName}),t.jsxs("p",{className:"text-xs text-modern-text-secondary",children:[S(e.joinedAt)," 참여"]})]})]},e.id))})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs(g,{children:[t.jsx(v,{className:"pb-3",children:t.jsxs(w,{className:"text-lg flex items-center gap-2",children:[t.jsx(c,{className:"w-5 h-5 text-modern-primary"}),"진행 현황"]})}),t.jsxs(b,{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-modern-text-secondary",children:"참여 진행률"}),t.jsxs("span",{className:"font-medium text-modern-text-primary",children:[Math.round(z),"%"]})]}),t.jsx("div",{className:"w-full bg-modern-bg-tertiary rounded-full h-3",children:t.jsx("div",{className:"h-3 rounded-full transition-all duration-300 "+(z>=100?"bg-modern-success":z>=50?"bg-modern-primary":"bg-modern-warning"),style:{width:`${z}%`}})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-2xl font-bold text-modern-text-primary",children:A.currentParticipantCount}),t.jsx("p",{className:"text-xs text-modern-text-secondary",children:"현재 참여"})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-2xl font-bold text-modern-text-primary",children:A.targetParticipantCount}),t.jsx("p",{className:"text-xs text-modern-text-secondary",children:"목표 참여"})]})]}),t.jsx(C,{}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(d,{className:"w-4 h-4 text-modern-text-tertiary"}),t.jsx("span",{className:"text-modern-text-secondary",children:"남은 기간"})]}),t.jsx("span",{className:"font-medium text-modern-text-primary",children:U?`${T}일`:"종료됨"})]}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(l,{className:"w-4 h-4 text-modern-text-tertiary"}),t.jsx("span",{className:"text-modern-text-secondary",children:"참여 매장"})]}),t.jsxs("span",{className:"font-medium text-modern-text-primary",children:[A.currentParticipantCount,"개"]})]})]})]})]}),t.jsx(g,{children:t.jsx(b,{className:"p-4",children:G?t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-center gap-2 text-modern-success",children:[t.jsx(m,{className:"w-5 h-5"}),t.jsx("span",{className:"font-medium",children:"참여 중"})]}),t.jsx(y,{variant:"outline",className:"w-full",onClick:()=>Q.mutate(),disabled:Q.isPending,children:Q.isPending?"처리 중...":"참여 취소"})]}):J?t.jsx(y,{className:"w-full",onClick:()=>M.mutate(),disabled:M.isPending,children:M.isPending?"처리 중...":"프로젝트 참여하기"}):t.jsx("div",{className:"text-center space-y-2",children:t.jsxs("div",{className:"flex items-center justify-center gap-2 text-modern-text-secondary",children:[t.jsx(o,{className:"w-5 h-5"}),t.jsx("span",{className:"text-sm",children:"completed"===A.status?"완료된 프로젝트입니다":"cancelled"===A.status?"중단된 프로젝트입니다":"참여 기간이 종료되었습니다"})]})})})}),A.forumLink&&t.jsx(g,{children:t.jsx(b,{className:"p-4",children:t.jsxs(y,{variant:"outline",className:"w-full",onClick:()=>P(A.forumLink),children:[t.jsx(x,{className:"w-4 h-4 mr-2"}),"포럼에서 토론하기"]})})}),t.jsxs(g,{children:[t.jsx(v,{className:"pb-3",children:t.jsx(w,{className:"text-lg",children:"프로젝트 기간"})}),t.jsxs(b,{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-modern-text-secondary",children:"시작일"}),t.jsx("span",{className:"text-modern-text-primary",children:S(A.startDate)})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-modern-text-secondary",children:"종료일"}),t.jsx("span",{className:"text-modern-text-primary",children:S(A.endDate)})]})]})]})]})]})})]})]})};export{q as default};
