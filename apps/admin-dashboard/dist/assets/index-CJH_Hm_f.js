import{r as e,j as s,c7 as t,c8 as r,c9 as a,a3 as l,bP as n,V as o}from"./vendor-react-Bb0TGSr4.js";import{c as i,I as c,B as d,s as u,j as m}from"./page-gutenberg-CGPrHM9_.js";import{u as h,a as p,b}from"./vendor-query-BEO_OofR.js";import{u as g,B as x,R as j}from"./RowActions-DHIOOolb.js";import{C as y}from"./checkbox-bN53xhY0.js";import{u as f,S as w}from"./ScreenMeta-RflcFWOV.js";import"./vendor-monaco-BxJH8uUv.js";import"./vendor-ui-CrFdsnXa.js";import"./vendor-utils-B-KQWpLj.js";import"./wp-foundation-Ht0JG6Uo.js";import"./wp-components-CoD93iDH.js";import"./index--Zslr9cr.js";import"./vendor-socket-CMcZe9fK.js";const N=e.forwardRef(({className:e,...r},a)=>s.jsx(t,{ref:a,className:i("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...r}));N.displayName=t.displayName;const k=e.forwardRef(({className:e,...t},a)=>s.jsx(r,{ref:a,className:i("aspect-square h-full w-full",e),...t}));k.displayName=r.displayName;const v=e.forwardRef(({className:e,...t},r)=>s.jsx(a,{ref:r,className:i("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));v.displayName=a.displayName;const A=({columns:e,data:t,idField:r="id",isAllSelected:a,isSomeSelected:l,onToggleAll:n,onToggleItem:o,isSelected:i,onRowClick:c,rowActions:d,emptyMessage:u="No items found"})=>s.jsxs("table",{className:"wp-list-table widefat fixed striped",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsxs("td",{className:"manage-column column-cb check-column",children:[s.jsx("label",{className:"screen-reader-text",htmlFor:"cb-select-all",children:"Select All"}),s.jsx(y,{id:"cb-select-all",checked:a,indeterminate:l,onCheckedChange:n})]}),e.map(e=>s.jsx("th",{scope:"col",className:`manage-column column-${e.key}${e.sortable?" sortable":""}`,children:e.sortable?s.jsxs("a",{href:"#",children:[s.jsx("span",{children:e.label}),s.jsx("span",{className:"sorting-indicator"})]}):e.label},e.key))]})}),s.jsx("tbody",{children:0===t.length?s.jsx("tr",{children:s.jsx("td",{colSpan:e.length+1,className:"colspanchange",children:u})}):t.map((t,a)=>{const l=String(t[r]),n=i(l);return s.jsxs("tr",{className:`${n?"selected":""} ${a%2==0?"alternate":""}`,children:[s.jsxs("th",{scope:"row",className:"check-column",children:[s.jsxs("label",{className:"screen-reader-text",htmlFor:`cb-select-${l}`,children:["Select ",t.title||t.name||`Item ${l}`]}),s.jsx(y,{id:`cb-select-${l}`,checked:n,onCheckedChange:()=>o(l),onClick:e=>e.stopPropagation()})]}),e.map(r=>s.jsxs("td",{className:`column-${r.key}`,onClick:()=>c?.(t),style:{cursor:c?"pointer":"default"},children:[r.render?r.render(t):t[r.key],r.key===e[0].key&&d&&s.jsx("div",{className:"row-actions",children:d(t)})]},r.key))]},l)})}),s.jsx("tfoot",{children:s.jsxs("tr",{children:[s.jsxs("td",{className:"manage-column column-cb check-column",children:[s.jsx("label",{className:"screen-reader-text",htmlFor:"cb-select-all-2",children:"Select All"}),s.jsx(y,{id:"cb-select-all-2",checked:a,indeterminate:l,onCheckedChange:n})]}),e.map(e=>s.jsx("th",{scope:"col",className:`manage-column column-${e.key}`,children:e.label},e.key))]})})]}),S=()=>(f([{id:"overview",title:"Overview",content:"\n        <p>This screen lists all the existing users for your site. Each user has one of five defined roles as set by the site admin: Site Administrator, Editor, Author, Contributor, or Subscriber. Users with roles other than Administrator will see fewer options when they are logged in, based on their role.</p>\n        <p>To add a new user for your site, click the Add New button at the top of the screen or Add New in the Users menu section.</p>\n      "},{id:"user-roles",title:"User Roles",content:"\n        <p>WordPress uses a concept of Roles, designed to give the site owner the ability to control what users can and cannot do within the site.</p>\n        <p><strong>The default roles are:</strong></p>\n        <ul>\n          <li><strong>Administrator</strong> - Complete access to all administration features</li>\n          <li><strong>Editor</strong> - Can publish and manage posts including those of other users</li>\n          <li><strong>Author</strong> - Can publish and manage their own posts</li>\n          <li><strong>Contributor</strong> - Can write and manage their own posts but cannot publish them</li>\n          <li><strong>Subscriber</strong> - Can only manage their profile</li>\n        </ul>\n      "},{id:"actions",title:"Available Actions",content:"\n        <p>Hovering over a row in the users list will display action links that allow you to manage users. You can perform the following actions:</p>\n        <ul>\n          <li><strong>Edit</strong> takes you to the editable profile screen for that user. You can also reach that screen by clicking on the username.</li>\n          <li><strong>Delete</strong> brings you to the Delete Users screen for confirmation, where you can permanently remove a user from your site and delete or attribute their content to another user.</li>\n          <li><strong>View</strong> takes you to their author archive page.</li>\n          <li><strong>Send password reset</strong> sends an email to the user with a link to reset their password.</li>\n        </ul>\n      "},{id:"bulk-actions",title:"Bulk Actions",content:"\n        <p>You can perform bulk actions on multiple users at once:</p>\n        <ul>\n          <li><strong>Delete</strong> - Remove multiple users at once</li>\n          <li><strong>Change role to...</strong> - Update the role for multiple users simultaneously</li>\n          <li><strong>Send password reset</strong> - Send password reset emails to multiple users</li>\n        </ul>\n        <p>Select the users you want to act on using the checkboxes, then select the action from the Bulk actions menu and click Apply.</p>\n      "}],{title:"For more information:",content:'\n      <p><a href="https://wordpress.org/support/article/users-screen/" target="_blank">Documentation on Managing Users</a></p>\n      <p><a href="https://wordpress.org/support/article/roles-and-capabilities/" target="_blank">Roles and Capabilities</a></p>\n      <p><a href="https://wordpress.org/support/" target="_blank">Support Forums</a></p>\n    '}),null),C=()=>{const t=l(),r=h(),[a,i]=e.useState(""),[y,f]=e.useState("all"),{data:C=[],isLoading:$,error:F}=p({queryKey:["users",y,a],queryFn:async()=>{const e=new URLSearchParams;"all"!==y&&e.set("role",y),a&&e.set("search",a);const s=await m.api.get(`/users?${e}`);return s.data?.data?.users?s.data.data.users:Array.isArray(s.data)?s.data:[]}}),E=b({mutationFn:async e=>{await Promise.all(e.map(e=>m.api.delete(`/users/${e}`)))},onSuccess:()=>{r.invalidateQueries({queryKey:["users"]}),o.success("Selected users deleted successfully")},onError:()=>{o.error("Failed to delete some users")}}),P=b({mutationFn:async({ids:e,role:s})=>{await Promise.all(e.map(e=>m.api.patch(`/users/${e}`,{role:s})))},onSuccess:()=>{r.invalidateQueries({queryKey:["users"]}),o.success("User roles updated successfully")},onError:()=>{o.error("Failed to update some users")}}),R=b({mutationFn:async e=>{await Promise.all(e.map(e=>m.api.post(`/users/${e}/send-password-reset`)))},onSuccess:()=>{o.success("Password reset emails sent successfully")},onError:()=>{o.error("Failed to send some emails")}}),U=[{value:"delete",label:"Delete",action:async e=>{await E.mutateAsync(e)},confirmMessage:"Are you sure you want to delete {count} user(s)? This cannot be undone.",isDestructive:!0},{value:"role-subscriber",label:"Change role to Subscriber",action:async e=>{await P.mutateAsync({ids:e,role:"subscriber"})}},{value:"role-contributor",label:"Change role to Contributor",action:async e=>{await P.mutateAsync({ids:e,role:"contributor"})}},{value:"role-author",label:"Change role to Author",action:async e=>{await P.mutateAsync({ids:e,role:"author"})}},{value:"role-editor",label:"Change role to Editor",action:async e=>{await P.mutateAsync({ids:e,role:"editor"})}},{value:"send-password-reset",label:"Send password reset",action:async e=>{await R.mutateAsync(e)},confirmMessage:"Send password reset email to {count} user(s)?"}],{selectedCount:D,isAllSelected:T,isSomeSelected:q,isProcessing:M,toggleAll:B,toggleItem:I,executeBulkAction:K,isSelected:L}=g({items:C,idField:"id",actions:U}),V=[{key:"username",label:"Username",sortable:!0,render:e=>s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(N,{className:"h-8 w-8",children:[s.jsx(k,{src:e.avatar,alt:e.name}),s.jsx(v,{children:e.name?.substring(0,2).toUpperCase()})]}),s.jsx("div",{children:s.jsx(n,{to:`/users/${e.id}/edit`,className:"font-medium text-blue-600 hover:text-blue-800",children:e.name})})]})},{key:"name",label:"Name",render:e=>e.name},{key:"email",label:"Email",render:e=>s.jsx("a",{href:`mailto:${e.email}`,className:"text-blue-600 hover:text-blue-800",children:e.email})},{key:"role",label:"Role",render:e=>s.jsx(u,{variant:"secondary",children:e.role})},{key:"posts",label:"Posts",render:e=>s.jsx("div",{className:"text-center",children:s.jsx("a",{href:`/posts?author=${e.id}`,className:"text-blue-600 hover:text-blue-800",children:e.posts||0})})}],Y={all:C.length,administrator:C.filter(e=>"administrator"===e.role).length,editor:C.filter(e=>"editor"===e.role).length,author:C.filter(e=>"author"===e.role).length,contributor:C.filter(e=>"contributor"===e.role).length,subscriber:C.filter(e=>"subscriber"===e.role).length};return s.jsxs("div",{className:"wrap",children:[s.jsx(S,{}),s.jsx(w,{}),s.jsx("h1",{className:"wp-heading-inline",children:"Users"}),s.jsx(n,{to:"/users/add",className:"page-title-action",children:"Add New"}),s.jsx("hr",{className:"wp-header-end"}),s.jsxs("ul",{className:"subsubsub",children:[s.jsxs("li",{className:"all",children:[s.jsxs("a",{href:"#",className:"all"===y?"current":"",onClick:()=>f("all"),children:["All ",s.jsxs("span",{className:"count",children:["(",Y.all,")"]})]})," |"]}),s.jsxs("li",{className:"administrator",children:[s.jsxs("a",{href:"#",className:"administrator"===y?"current":"",onClick:()=>f("administrator"),children:["Administrator ",s.jsxs("span",{className:"count",children:["(",Y.administrator,")"]})]})," |"]}),s.jsxs("li",{className:"editor",children:[s.jsxs("a",{href:"#",className:"editor"===y?"current":"",onClick:()=>f("editor"),children:["Editor ",s.jsxs("span",{className:"count",children:["(",Y.editor,")"]})]})," |"]}),s.jsxs("li",{className:"author",children:[s.jsxs("a",{href:"#",className:"author"===y?"current":"",onClick:()=>f("author"),children:["Author ",s.jsxs("span",{className:"count",children:["(",Y.author,")"]})]})," |"]}),s.jsxs("li",{className:"contributor",children:[s.jsxs("a",{href:"#",className:"contributor"===y?"current":"",onClick:()=>f("contributor"),children:["Contributor ",s.jsxs("span",{className:"count",children:["(",Y.contributor,")"]})]})," |"]}),s.jsx("li",{className:"subscriber",children:s.jsxs("a",{href:"#",className:"subscriber"===y?"current":"",onClick:()=>f("subscriber"),children:["Subscriber ",s.jsxs("span",{className:"count",children:["(",Y.subscriber,")"]})]})})]}),s.jsxs("div",{className:"search-box",children:[s.jsx(c,{type:"search",placeholder:"Search users...",value:a,onChange:e=>i(e.target.value),className:"w-[300px]"}),s.jsx(d,{variant:"secondary",children:"Search Users"})]}),s.jsx(x,{actions:U,selectedCount:D,onActionExecute:K,isProcessing:M,position:"top"}),$?s.jsx("div",{className:"text-center py-8",children:"Loading users..."}):F?s.jsx("div",{className:"text-center py-8 text-red-600",children:"Error loading users"}):s.jsx(A,{columns:V,data:C,idField:"id",isAllSelected:T,isSomeSelected:q,onToggleAll:B,onToggleItem:I,isSelected:L,rowActions:e=>{const r=[{label:"Edit",onClick:()=>t(`/users/${e.id}/edit`)},{label:"Delete",onClick:async()=>{confirm(`Delete user ${e.name}?`)&&await E.mutateAsync([e.id])},className:"text-red-600"},{label:"View",onClick:()=>t(`/users/${e.id}`)},{label:"Send password reset",onClick:async()=>{await R.mutateAsync([e.id])}}];return s.jsx(j,{actions:r})},emptyMessage:"No users found"}),s.jsx(x,{actions:U,selectedCount:D,onActionExecute:K,isProcessing:M,position:"bottom"})]})};function $(){return s.jsx(C,{})}export{$ as default};
