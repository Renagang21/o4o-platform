import{a3 as e,r as a,j as s,U as o,X as r,V as i,b_ as m,b$ as d}from"./vendor-react-40ZmJ4HC.js";import{M as l}from"./MediaLibrary-DLtJsJ1i.js";import{B as t,j as n}from"./page-gutenberg-CxDN_6a_.js";import"./checkbox-EQenI04E.js";import"./vendor-query-DJJ0FlEA.js";import"./vendor-ui-CrFdsnXa.js";import"./vendor-utils-EdRAegAf.js";import"./wp-all-BeSh6B1c.js";const p=()=>{const m=e(),[d,l]=a.useState([]),[p,u]=a.useState(!1),[c,N]=a.useState(!1),b=a.useCallback(e=>{e.preventDefault(),e.stopPropagation(),N(!1);const a=e.dataTransfer.files;a&&a.length>0&&f(a)},[]),h=a.useCallback(e=>{e.preventDefault(),e.stopPropagation(),N(!0)},[]),v=a.useCallback(e=>{e.preventDefault(),e.stopPropagation(),N(!1)},[]),f=e=>{const a=Array.from(e).map(e=>({file:e,id:`${Date.now()}-${Math.random()}`,status:"pending",progress:0,preview:e.type.startsWith("image/")?URL.createObjectURL(e):void 0}));l(e=>[...e,...a])},x=async e=>{try{l(a=>a.map(a=>a.id===e.id?{...a,status:"uploading",progress:10}:a));const a=new FormData;a.append("file",e.file),a.append("title",e.file.name.replace(/\.[^/.]+$/,""));const s=setInterval(()=>{l(a=>a.map(a=>a.id===e.id&&"uploading"===a.status?{...a,progress:Math.min(a.progress+10,90)}:a))},200),o=await n.api.post("/media/upload",a,{headers:{"Content-Type":"multipart/form-data"}});return clearInterval(s),l(a=>a.map(a=>a.id===e.id?{...a,status:"success",progress:100}:a)),o.data}catch(a){throw l(a=>a.map(a=>a.id===e.id?{...a,status:"error",error:"업로드 실패"}:a)),a}},g=()=>{const e=document.createElement("input");e.type="file",e.multiple=!0,e.accept="image/*,video/*,audio/*,application/pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx",e.onchange=e=>{const a=e.target.files;a&&f(a)},e.click()};return s.jsxDEV("div",{className:"wp-admin-content",children:s.jsxDEV("div",{className:"wrap",children:[s.jsxDEV("h1",{className:"wp-heading-inline",children:"새 미디어 추가"},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:175,columnNumber:9},void 0),s.jsxDEV("div",{className:"mt-6",children:0===d.length?s.jsxDEV("div",{className:"border-4 border-dashed rounded-lg p-12 text-center transition-colors "+(c?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"),onDrop:b,onDragOver:h,onDragLeave:v,onClick:g,style:{cursor:"pointer"},children:[s.jsxDEV(o,{className:"w-16 h-16 mx-auto text-gray-400 mb-4"},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:191,columnNumber:15},void 0),s.jsxDEV("h3",{className:"text-xl font-medium text-gray-700 mb-2",children:"파일을 여기에 드래그하거나 클릭하여 선택하세요"},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:192,columnNumber:15},void 0),s.jsxDEV("p",{className:"text-sm text-gray-500",children:"최대 업로드 파일 크기: 100MB"},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:195,columnNumber:15},void 0),s.jsxDEV(t,{variant:"outline",className:"mt-4",onClick:e=>{e.stopPropagation(),g()},children:"파일 선택"},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:198,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:179,columnNumber:13},void 0):s.jsxDEV("div",{className:"space-y-4",children:[s.jsxDEV("div",{className:"flex justify-between items-center mb-4",children:[s.jsxDEV("h3",{className:"text-lg font-medium",children:[d.length,"개 파일 선택됨"]},void 0,!0,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:212,columnNumber:17},void 0),s.jsxDEV("div",{className:"space-x-2",children:[s.jsxDEV(t,{variant:"outline",onClick:g,children:"파일 추가"},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:216,columnNumber:19},void 0),s.jsxDEV(t,{onClick:async()=>{u(!0);const e=d.filter(e=>"pending"===e.status);let a=0,s=0;for(const r of e)try{await x(r),a++}catch(o){s++}u(!1),a>0&&(i.success(`${a}개 파일이 업로드되었습니다`),0===s&&setTimeout(()=>{m("/media/library")},1500)),s>0&&i.error(`${s}개 파일 업로드에 실패했습니다`)},disabled:p||d.every(e=>"pending"!==e.status),children:"업로드 시작"},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:222,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:215,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:211,columnNumber:15},void 0),s.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(e=>s.jsxDEV("div",{className:"border rounded-lg p-4 "+("error"===e.status?"border-red-300 bg-red-50":"border-gray-200"),children:[s.jsxDEV("div",{className:"flex items-start justify-between mb-2",children:[s.jsxDEV("div",{className:"flex-1 min-w-0",children:[s.jsxDEV("p",{className:"font-medium text-sm truncate",children:e.file.name},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:243,columnNumber:25},void 0),s.jsxDEV("p",{className:"text-xs text-gray-500",children:[(e.file.size/1024/1024).toFixed(2)," MB"]},void 0,!0,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:246,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:242,columnNumber:23},void 0),"pending"===e.status&&s.jsxDEV("button",{onClick:()=>{return a=e.id,void l(e=>{const s=e.filter(e=>e.id!==a),o=e.find(e=>e.id===a);return o?.preview&&URL.revokeObjectURL(o.preview),s});var a},className:"ml-2 text-gray-400 hover:text-gray-600",children:s.jsxDEV(r,{className:"w-4 h-4"},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:255,columnNumber:27},void 0)},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:251,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:241,columnNumber:21},void 0),e.preview&&s.jsxDEV("img",{src:e.preview,alt:"",className:"w-full h-32 object-cover rounded mb-2"},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:261,columnNumber:23},void 0),"uploading"===e.status&&s.jsxDEV("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsxDEV("div",{className:"bg-blue-600 h-2 rounded-full transition-all",style:{width:`${e.progress}%`}},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:270,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:269,columnNumber:23},void 0),"success"===e.status&&s.jsxDEV("div",{className:"text-green-600 text-sm",children:"✓ 업로드 완료"},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:278,columnNumber:23},void 0),"error"===e.status&&s.jsxDEV("div",{className:"text-red-600 text-sm",children:e.error||"업로드 실패"},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:284,columnNumber:23},void 0)]},e.id,!0,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:233,columnNumber:19},void 0))},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:231,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:210,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:177,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:174,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/MediaNew.tsx",lineNumber:173,columnNumber:5},void 0)},u=()=>s.jsxDEV(m,{children:[s.jsxDEV(d,{path:"/",element:s.jsxDEV(l,{},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/Media.tsx",lineNumber:9,columnNumber:32},void 0)},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/Media.tsx",lineNumber:9,columnNumber:7},void 0),s.jsxDEV(d,{path:"/library",element:s.jsxDEV(l,{},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/Media.tsx",lineNumber:10,columnNumber:39},void 0)},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/Media.tsx",lineNumber:10,columnNumber:7},void 0),s.jsxDEV(d,{path:"/new",element:s.jsxDEV(p,{},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/Media.tsx",lineNumber:11,columnNumber:35},void 0)},void 0,!1,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/Media.tsx",lineNumber:11,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/user/o4o-platform/apps/admin-dashboard/src/pages/media/Media.tsx",lineNumber:8,columnNumber:5},void 0);export{u as default};
//# sourceMappingURL=Media-nRS5EP0F.js.map
