import{r as m,V as r,j as e,bT as l,N as L,x as N,S as Q,F as R,bZ as T,bX as D,O as H,J as K,z,c1 as B,c2 as h,c0 as U}from"./vendor-react-CMQx0Rxg.js";import{u as V,a as _,b as p}from"./vendor-query-B9kD0akd.js";import{a as c}from"./base-DwMpWFax.js";import{f as g,k as j}from"./vendor-utils-DQ8F5vJI.js";import{P as v}from"./PageForm-BBT1tzZG.js";import"./wp-all-CpKe89B2.js";import"./vendor-ui-BkLtITBR.js";import"./vendor-monaco-cpVGocfO.js";import"./main-CP4Dt9TU.js";import"./page-gutenberg-Bg9cnlWs.js";import"./vendor-socket-Ch6lN7-G.js";const J=()=>{const[d,w]=m.useState(""),[x,k]=m.useState("all"),[a,n]=m.useState([]),[i,y]=m.useState(""),u=V(),{data:b,isLoading:S}=_({queryKey:["pages",x,d],queryFn:async()=>{const s=new URLSearchParams;return x!=="all"&&s.append("status",x),d&&s.append("search",d),(await c.get(`/admin/pages?${s}`)).data}}),C=p({mutationFn:async s=>{await c.delete(`/admin/pages/${s}`)},onSuccess:()=>{u.invalidateQueries({queryKey:["pages"]}),r.success("페이지가 삭제되었습니다")},onError:()=>{r.error("페이지 삭제에 실패했습니다")}}),$=p({mutationFn:async s=>(await c.post(`/admin/pages/${s}/clone`)).data,onSuccess:()=>{u.invalidateQueries({queryKey:["pages"]}),r.success("페이지가 복제되었습니다")},onError:()=>{r.error("페이지 복제에 실패했습니다")}}),A=p({mutationFn:async({action:s,ids:t})=>{s==="delete"?await c.delete("/admin/pages/bulk",{data:{ids:t}}):(s==="publish"||s==="draft")&&await c.patch("/admin/pages/bulk",{ids:t,status:s})},onSuccess:()=>{u.invalidateQueries({queryKey:["pages"]}),r.success("일괄 작업이 완료되었습니다"),n([]),y("")},onError:()=>{r.error("일괄 작업에 실패했습니다")}}),o=b?.pages||[],f=b?.total||0,M=s=>({published:"bg-green-100 text-green-800",draft:"bg-gray-100 text-gray-800",private:"bg-purple-100 text-purple-800",archived:"bg-red-100 text-red-800",scheduled:"bg-blue-100 text-blue-800"})[s]||"bg-gray-100 text-gray-800",P=s=>({published:"게시됨",draft:"임시저장",private:"비공개",archived:"보관됨",scheduled:"예약됨"})[s]||s,F=()=>{!i||a.length===0||i==="delete"&&!confirm("선택한 페이지를 삭제하시겠습니까?")||A.mutate({action:i,ids:a})},q=s=>{n(s?o.map(t=>t.id):[])};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"페이지 관리"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"웹사이트의 정적 페이지를 관리합니다"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(l,{to:"/pages/pattern-builder",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center space-x-2",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsx("span",{children:"패턴 빌더"})]}),e.jsxs(l,{to:"/pages/new",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[e.jsx(N,{className:"w-4 h-4"}),e.jsx("span",{children:"새 페이지"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",value:d,onChange:s=>w(s.target.value),placeholder:"페이지 검색...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),e.jsxs("select",{value:x,onChange:s=>k(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"모든 상태"}),e.jsx("option",{value:"published",children:"게시됨"}),e.jsx("option",{value:"draft",children:"임시저장"}),e.jsx("option",{value:"private",children:"비공개"}),e.jsx("option",{value:"scheduled",children:"예약됨"}),e.jsx("option",{value:"archived",children:"보관됨"})]})]}),a.length>0&&e.jsxs("div",{className:"mt-4 flex items-center space-x-3",children:[e.jsxs("select",{value:i,onChange:s=>y(s.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm",children:[e.jsx("option",{value:"",children:"일괄 작업"}),e.jsx("option",{value:"publish",children:"게시"}),e.jsx("option",{value:"draft",children:"임시저장으로 변경"}),e.jsx("option",{value:"delete",children:"삭제"})]}),e.jsx("button",{onClick:F,disabled:!i,className:"px-3 py-1 bg-gray-600 text-white rounded-md text-sm hover:bg-gray-700 disabled:bg-gray-400",children:"적용"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[a.length,"개 선택됨"]})]})]}),S?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):o.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(R,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"페이지가 없습니다"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"첫 번째 페이지를 만들어보세요"}),e.jsxs(l,{to:"/pages/new",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 inline-flex items-center",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"새 페이지 만들기"]})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-12 px-6 py-3",children:e.jsx("input",{type:"checkbox",checked:a.length===o.length,onChange:s=>q(s.target.checked),className:"rounded border-gray-300"})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"제목"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"작성자"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상태"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"조회수"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"날짜"}),e.jsx("th",{className:"relative px-6 py-3",children:e.jsx("span",{className:"sr-only",children:"액션"})})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"checkbox",checked:a.includes(s.id),onChange:t=>{t.target.checked?n([...a,s.id]):n(a.filter(E=>E!==s.id))},className:"rounded border-gray-300"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex items-start",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(l,{to:`/pages/${s.id}/edit`,className:"text-sm font-medium text-gray-900 hover:text-blue-600 truncate",children:s.title}),s.isHomepage&&e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:[e.jsx(T,{className:"w-3 h-3 mr-1"}),"홈"]})]}),s.parent&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["상위: ",s.parent.title]}),e.jsxs("div",{className:"flex items-center space-x-3 mt-1",children:[e.jsx("a",{href:`/${s.slug}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-gray-500 hover:text-blue-600",children:"보기"}),e.jsx(l,{to:`/pages/${s.id}/edit`,className:"text-xs text-gray-500 hover:text-blue-600",children:"편집"}),e.jsx("button",{onClick:()=>$.mutate(s.id),className:"text-xs text-gray-500 hover:text-blue-600",children:"복제"})]})]})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(D,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsx("div",{className:"text-sm text-gray-900",children:s.author.name})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${M(s.status)}`,children:P(s.status)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.views.toLocaleString()}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:s.publishedAt?g(new Date(s.publishedAt),"yyyy-MM-dd",{locale:j}):"-"}),e.jsx("div",{className:"text-xs text-gray-500",children:s.status==="scheduled"&&s.scheduledAt?`예약: ${g(new Date(s.scheduledAt),"MM/dd HH:mm",{locale:j})}`:`수정: ${g(new Date(s.updatedAt),"MM/dd",{locale:j})}`})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx("a",{href:`/${s.slug}`,target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-gray-600",title:"보기",children:e.jsx(H,{className:"w-4 h-4"})}),e.jsx(l,{to:`/pages/${s.id}/edit`,className:"text-gray-400 hover:text-gray-600",title:"편집",children:e.jsx(K,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{confirm("이 페이지를 삭제하시겠습니까?")&&C.mutate(s.id)},className:"text-gray-400 hover:text-red-600",title:"삭제",children:e.jsx(z,{className:"w-4 h-4"})})]})})]},s.id))})]}),f>20&&e.jsxs("div",{className:"bg-gray-50 px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"이전"}),e.jsx("button",{className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"다음"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["총 ",e.jsx("span",{className:"font-medium",children:f}),"개 페이지"]})}),e.jsx("div",{children:e.jsx("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination"})})]})]})]})]})},re=()=>e.jsxs(B,{children:[e.jsx(h,{path:"/",element:e.jsx(J,{})}),e.jsx(h,{path:"/new",element:e.jsx(v,{})}),e.jsx(h,{path:"/:id/edit",element:e.jsx(v,{})}),e.jsx(h,{path:"*",element:e.jsx(U,{to:"/",replace:!0})})]});export{re as default};
