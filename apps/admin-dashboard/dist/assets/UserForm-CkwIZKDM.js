import{b as s,u as e,r,cd as a,V as t,j as i,A as o,S as l}from"./vendor-react-DqgGMt48.js";import{a as d,o as c,_ as m,b as n,s as p,l as j}from"./vendor-forms-C37T2hdA.js";import{B as u,L as x,I as h,S as v,h as b,i as w,j as N,k}from"./page-template-editor-5uesjTWI.js";import{C as g}from"./checkbox-CSkas4J8.js";import{cF as f,cG as y,cH as C,cR as S,cI as F}from"./wp-misc-DyLrwF9p.js";import{a as U}from"./base-DqX9aL5V.js";import"./vendor-monaco-BxJH8uUv.js";import"./vendor-ui-CrFdsnXa.js";import"./vendor-query-D_c3FRkE.js";import"./vendor-utils-C9jLuAcl.js";import"./wp-blocks-core-65VcejHr.js";import"./wp-block-editor-misc-Bvzg-2Jv.js";import"./wp-core-BVMytgUH.js";import"./wp-block-editor-api-MRWBPx9C.js";import"./wp-block-editor-store-BOagVFfu.js";import"./wp-block-editor-clipboard-D5sqncpm.js";import"./wp-i18n-BuBz6Sgx.js";import"./wp-block-editor-global-styles-DFEUywv4.js";import"./wp-block-editor-typography-D5fCIzVQ.js";import"./wp-components-Uj2D7Nfy.js";import"./wp-block-editor-spacing-CY2h70rf.js";import"./wp-block-editor-menus-CucXu4UM.js";import"./wp-block-editor-core-BF86nm2P.js";import"./wp-block-editor-utils-BmaAXcuk.js";import"./wp-block-editor-colors-60WWD1Za.js";import"./wp-block-editor-a11y-BVzCbFSD.js";import"./wp-block-editor-preview-WXXja22U.js";import"./wp-block-editor-borders-C-QIiBvP.js";import"./wp-block-editor-formats--rvRJrSX.js";import"./wp-block-editor-selection-DBFjOmhH.js";import"./wp-block-editor-inline-CtEBI-J7.js";import"./wp-block-editor-ui-DwG3jajt.js";import"./wp-block-editor-transforms-Bg08EtRt.js";import"./wp-block-editor-patterns-DIcm1rGW.js";import"./wp-block-editor-navigation-ufXSM7dn.js";import"./wp-block-editor-dnd-yPphmZPp.js";import"./wp-block-editor-media-CatADaW3.js";import"./wp-api-COhbxmzY.js";import"./wp-block-editor-keyboard-3DDntAoE.js";import"./wp-block-editor-templates-C6YLNdWR.js";import"./wp-data-CL-okzN5.js";import"./index-CqU4KnuF.js";import"./vendor-socket-CMcZe9fK.js";const A=c({email:p().email("Invalid email address"),password:p().min(6,"Password must be at least 6 characters").optional().or(j("")),firstName:p().optional(),lastName:p().optional(),roles:n(p()).min(1,"At least one role is required"),status:m(["active","pending","approved","rejected"])});function P(){const{id:c}=s(),m=e(),[n,p]=r.useState(!1),j=!!c,{register:P,handleSubmit:V,setValue:B,watch:E,formState:{errors:R}}=a({resolver:d(A),defaultValues:{email:"",password:"",firstName:"",lastName:"",roles:["customer"],status:"pending"}}),q=E("roles");r.useEffect(()=>{j&&I()},[c]);const I=async()=>{try{p(!0);const s=await U.get(`/v1/users/${c}`);if(s.data.success){const e=s.data.data;B("email",e.email),B("firstName",e.firstName||""),B("lastName",e.lastName||""),B("roles",e.roles),B("status",e.status)}}catch(s){t.error("Failed to load user"),m("/users")}finally{p(!1)}},L=s=>{const e=q||[];e.includes(s)?e.length>1&&B("roles",e.filter(e=>e!==s)):B("roles",[...e,s])};return i.jsxs("div",{className:"p-6",children:[i.jsx("div",{className:"mb-6",children:i.jsxs(u,{variant:"ghost",onClick:()=>m("/users"),children:[i.jsx(o,{className:"mr-2 h-4 w-4"}),"Back to Users"]})}),i.jsx("form",{onSubmit:V(async s=>{try{p(!0);const e={...s,role:s.roles[0]};j?(e.password||delete e.password,await U.put(`/v1/users/${c}`,e),t.success("User updated successfully")):(await U.post("/v1/users",e),t.success("User created successfully")),m("/users")}catch(e){t.error(e.response?.data?.error||"Failed to save user")}finally{p(!1)}}),children:i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[i.jsx("div",{className:"lg:col-span-2",children:i.jsxs(f,{children:[i.jsxs(y,{children:[i.jsx(C,{children:j?"Edit User":"Add New User"}),i.jsx(S,{children:j?"Update user information":"Create a new user account"})]}),i.jsxs(F,{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx(x,{htmlFor:"firstName",children:"First Name"}),i.jsx(h,{id:"firstName",...P("firstName"),placeholder:"John"}),R.firstName&&i.jsx("p",{className:"text-sm text-red-500 mt-1",children:R.firstName.message})]}),i.jsxs("div",{children:[i.jsx(x,{htmlFor:"lastName",children:"Last Name"}),i.jsx(h,{id:"lastName",...P("lastName"),placeholder:"Doe"}),R.lastName&&i.jsx("p",{className:"text-sm text-red-500 mt-1",children:R.lastName.message})]})]}),i.jsxs("div",{children:[i.jsx(x,{htmlFor:"email",children:"Email"}),i.jsx(h,{id:"email",type:"email",...P("email"),placeholder:"john.doe@example.com",disabled:j}),R.email&&i.jsx("p",{className:"text-sm text-red-500 mt-1",children:R.email.message})]}),i.jsxs("div",{children:[i.jsxs(x,{htmlFor:"password",children:["Password ",j&&"(leave blank to keep current)"]}),i.jsx(h,{id:"password",type:"password",...P("password"),placeholder:j?"Leave blank to keep current":"Enter password"}),R.password&&i.jsx("p",{className:"text-sm text-red-500 mt-1",children:R.password.message})]}),i.jsxs("div",{children:[i.jsx(x,{htmlFor:"status",children:"Status"}),i.jsxs(v,{value:E("status"),onValueChange:s=>B("status",s),children:[i.jsx(b,{children:i.jsx(w,{placeholder:"Select status"})}),i.jsxs(N,{children:[i.jsx(k,{value:"active",children:"Active"}),i.jsx(k,{value:"pending",children:"Pending"}),i.jsx(k,{value:"approved",children:"Approved"}),i.jsx(k,{value:"rejected",children:"Rejected"})]})]}),R.status&&i.jsx("p",{className:"text-sm text-red-500 mt-1",children:R.status.message})]})]})]})}),i.jsxs("div",{children:[i.jsxs(f,{children:[i.jsxs(y,{children:[i.jsx(C,{children:"User Roles"}),i.jsx(S,{children:"Select one or more roles for this user"})]}),i.jsxs(F,{children:[i.jsx("div",{className:"space-y-3",children:[{value:"super_admin",label:"Super Admin",description:"Full system access"},{value:"admin",label:"Admin",description:"Administrative access"},{value:"vendor",label:"Vendor",description:"Vendor/supplier access"},{value:"seller",label:"Seller",description:"Can sell products"},{value:"customer",label:"Customer",description:"Regular user"},{value:"business",label:"Business",description:"Business account"},{value:"moderator",label:"Moderator",description:"Content moderation"},{value:"partner",label:"Partner",description:"Partner access"}].map(s=>i.jsxs("div",{className:"flex items-start space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>L(s.value),children:[i.jsx(g,{checked:q?.includes(s.value)||!1,onCheckedChange:()=>L(s.value),onClick:s=>s.stopPropagation()}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"font-medium",children:s.label}),i.jsx("div",{className:"text-sm text-gray-600",children:s.description})]})]},s.value))}),R.roles&&i.jsx("p",{className:"text-sm text-red-500 mt-2",children:R.roles.message})]})]}),i.jsxs("div",{className:"mt-6 flex gap-3",children:[i.jsxs(u,{type:"submit",className:"flex-1",disabled:n,children:[i.jsx(l,{className:"mr-2 h-4 w-4"}),n?"Saving...":j?"Update User":"Create User"]}),i.jsx(u,{type:"button",variant:"outline",onClick:()=>m("/users"),disabled:n,children:"Cancel"})]})]})]})})]})}export{P as default};
