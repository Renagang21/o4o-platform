const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CrpOq9wV.js","assets/vendor-react-BZRIq8oW.js","assets/wp-block-editor-C14Ds6es.js","assets/wp-blocks-CnCGET8b.js","assets/wp-core-BctBwZpo.js","assets/wp-i18n-Niz9RVma.js","assets/wp-element-CB9_H0_F.js","assets/vendor-ui-BkLtITBR.js","assets/vendor-monaco-cpVGocfO.js","assets/index-DNjFcNVa.js","assets/index-DiDgbLNG.js","assets/wp-components-CLkQS2qf.js"])))=>i.map(i=>d[i]);
import{r as l,j as e,C as Se,a as $e,b as ht,c as xt,V as se,u as gt,X as ue,S as re,G,L as K,I as ne,U as ft,A as Oe,d as Ve,e as He,R as pt,M as bt,T as X,f as qe,g as vt,h as Ge,P as Je,i as We,Q as ve,k as yt,l as jt,m as wt,n as Nt,o as Ke,p as le,q as kt,F as ye,s as Ct,H as St,t as Tt,v as Bt,w as de,x as Q,y as je,z as Pt,E as Rt,B as xe,D as Et,J as ge,K as Re,N as te,O as Ee,W as Dt,Y as Qe,Z as It,_ as Lt,$ as Mt,a0 as At}from"./vendor-react-BZRIq8oW.js";import{t as _t,c as I}from"./vendor-ui-BkLtITBR.js";import{u as zt,a as Ft,b as Ut}from"./vendor-query-GrNIwsDq.js";import{a as Ye,f as $t}from"./vendor-utils-DQ8F5vJI.js";import{B as Ot,a as Vt,W as Ht,O as qt,b as Gt,c as Jt}from"./wp-block-editor-C14Ds6es.js";import{p as Xe,c as fe,s as De}from"./wp-blocks-CnCGET8b.js";import{P as Wt}from"./wp-components-CLkQS2qf.js";const Kt="modulepreload",Qt=function(s){return"/"+s},Ie={},pe=function(t,n,o){let r=Promise.resolve();if(n&&n.length>0){let h=function(x){return Promise.all(x.map(v=>Promise.resolve(v).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),p=f?.nonce||f?.getAttribute("nonce");r=h(n.map(x=>{if(x=Qt(x),x in Ie)return;Ie[x]=!0;const v=x.endsWith(".css"),b=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${b}`))return;const c=document.createElement("link");if(c.rel=v?"stylesheet":Kt,v||(c.as="script"),c.crossOrigin="",c.href=x,p&&c.setAttribute("nonce",p),document.head.appendChild(c),v)return new Promise((u,m)=>{c.addEventListener("load",u),c.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${x}`)))})}))}function d(f){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=f,window.dispatchEvent(p),!p.defaultPrevented)throw f}return r.then(f=>{for(const p of f||[])p.status==="rejected"&&d(p.reason);return t().catch(d)})};class Yt{constructor(t){this.baseURL=t,this.api=Ye.create({baseURL:this.baseURL,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(n=>{let o=localStorage.getItem("accessToken")||localStorage.getItem("authToken");if(!o){const r=localStorage.getItem("auth-storage");if(r)try{const d=JSON.parse(r);d.state?.token&&(o=d.state.token)}catch{}}return o&&(n.headers.Authorization=`Bearer ${o}`),n})}async login(t){return(await this.api.post("/auth/login",t)).data}async logout(){await this.api.post("/auth/logout")}async checkSession(){try{return(await this.api.get("/accounts/sso/check")).data}catch{return{isAuthenticated:!1}}}}const Xt=()=>{const s="https://api.neture.co.kr/api/v1";if(typeof window>"u")return s;try{if(globalThis.import?.meta?.env?.VITE_API_URL)return globalThis.import.meta.env.VITE_API_URL}catch{}return window.__API_URL__?window.__API_URL__:s},Le=new Yt(Xt());class Zt{constructor(t){this.refreshPromise=null,this.currentToken=null,this.baseURL=t,this.api=Ye.create({baseURL:this.baseURL,headers:{"Content-Type":"application/json"},withCredentials:!0}),this.api.interceptors.response.use(n=>n,async n=>{const o=n.config;if(n.response?.status===401&&!o._retry){if(o._retry=!0,this.refreshPromise){if(await this.refreshPromise)return this.api.request(o);throw n}this.refreshPromise=this.refreshToken();const r=await this.refreshPromise;if(this.refreshPromise=null,r)return this.api.request(o)}return Promise.reject(n)})}async login(t){const n=await this.api.post("/auth/v2/login",t);return n.data.token&&(this.currentToken=n.data.token),n.data}async register(t){return(await this.api.post("/auth/v2/register",t)).data}async logout(){try{await this.api.post("/auth/v2/logout")}catch(t){console.error("Logout error:",t)}finally{this.currentToken=null}}async logoutAll(){await this.api.post("/auth/v2/logout-all"),this.currentToken=null}async refreshToken(){try{return(await this.api.post("/auth/v2/refresh")).data.success}catch{return!1}}async getCurrentUser(){try{return(await this.api.get("/auth/v2/me")).data.user}catch{return null}}getApiUrl(){return this.baseURL}getAccessToken(){return this.currentToken}setupSessionSync(){typeof window>"u"||window.addEventListener("storage",t=>{t.key==="auth-logout"?window.location.reload():t.key==="auth-login"&&this.refreshToken()})}broadcastAuthChange(t){if(typeof window>"u")return;const n=`auth-${t}`;localStorage.setItem(n,Date.now().toString()),setTimeout(()=>localStorage.removeItem(n),100)}async loginWithSync(t){const n=await this.login(t);return this.broadcastAuthChange("login"),n}async logoutWithSync(){await this.logout(),this.broadcastAuthChange("logout")}}const es=new Zt(typeof window<"u"&&window.location.hostname==="localhost"?"http://localhost:4000/api/v1":"/api/v1");typeof window<"u"&&es.setupSessionSync();class ts{constructor(t){this.checkInterval=null,this.handleStorageEvent=n=>{n.key==="sso:logout"?this.handleLogout():n.key==="sso:login"&&this.checkSession()},this.config={checkInterval:3e4,...t}}initialize(t){this.onSessionChange=t,typeof window<"u"&&window.addEventListener("storage",this.handleStorageEvent),this.startSessionMonitoring(),this.checkSession()}destroy(){typeof window<"u"&&window.removeEventListener("storage",this.handleStorageEvent),this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)}startSessionMonitoring(){this.checkInterval&&clearInterval(this.checkInterval),this.checkInterval=setInterval(()=>{this.checkSession()},this.config.checkInterval)}async checkSession(){try{const t=await fetch(`${this.config.apiUrl}/auth/v2/me`,{credentials:"include",headers:{"Content-Type":"application/json"}});if(t.ok){const o=(await t.json()).user;return this.onSessionChange?.(o),o}else return this.onSessionChange?.(null),null}catch(t){return console.error("Session check error:",t),this.onSessionChange?.(null),null}}broadcastLogin(){typeof window<"u"&&(localStorage.setItem("sso:login",Date.now().toString()),localStorage.removeItem("sso:login"))}broadcastLogout(){typeof window<"u"&&(localStorage.setItem("sso:logout",Date.now().toString()),localStorage.removeItem("sso:logout"))}handleLogout(){this.onSessionChange?.(null),this.config.domain&&(window.location.href="/login")}getSessionId(){if(typeof document>"u")return null;const t=document.cookie.match(/sessionId=([^;]+)/);return t?t[1]:null}hasSession(){return!!this.getSessionId()}}new ts({apiUrl:typeof window<"u"&&window.location.hostname==="localhost"?"http://localhost:4000/api/v1":"/api/v1"});function ss(s,t="KRW",n="ko-KR"){const o=typeof s=="string"?parseFloat(s):s;return isNaN(o)?"₩0":new Intl.NumberFormat(n,{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0}).format(o)}function as(s,t="medium",n="ko-KR"){const o=typeof s=="string"||typeof s=="number"?new Date(s):s;if(isNaN(o.getTime()))return"";const r={};switch(t){case"short":r.year="numeric",r.month="2-digit",r.day="2-digit";break;case"medium":r.year="numeric",r.month="long",r.day="numeric";break;case"long":r.year="numeric",r.month="long",r.day="numeric",r.weekday="long";break;case"full":r.year="numeric",r.month="long",r.day="numeric",r.weekday="long",r.hour="2-digit",r.minute="2-digit";break}return new Intl.DateTimeFormat(n,r).format(o)}const aa=ss,ra=as;function B(...s){return _t(I(s))}const W=l.forwardRef(({className:s,...t},n)=>e.jsx("div",{ref:n,className:B("rounded-lg border bg-card text-card-foreground shadow-sm",s),...t}));W.displayName="Card";const rs=l.forwardRef(({className:s,...t},n)=>e.jsx("div",{ref:n,className:B("flex flex-col space-y-1.5 p-6",s),...t}));rs.displayName="CardHeader";const ns=l.forwardRef(({className:s,...t},n)=>e.jsx("h3",{ref:n,className:B("text-2xl font-semibold leading-none tracking-tight",s),...t}));ns.displayName="CardTitle";const os=l.forwardRef(({className:s,...t},n)=>e.jsx("p",{ref:n,className:B("text-sm text-muted-foreground",s),...t}));os.displayName="CardDescription";const ls=l.forwardRef(({className:s,...t},n)=>e.jsx("div",{ref:n,className:B("p-6 pt-0",s),...t}));ls.displayName="CardContent";const is=l.forwardRef(({className:s,...t},n)=>e.jsx("div",{ref:n,className:B("flex items-center p-6 pt-0",s),...t}));is.displayName="CardFooter";const Me=s=>typeof s=="boolean"?`${s}`:s===0?"0":s,Ae=I,me=(s,t)=>n=>{var o;if(t?.variants==null)return Ae(s,n?.class,n?.className);const{variants:r,defaultVariants:d}=t,f=Object.keys(r).map(x=>{const v=n?.[x],b=d?.[x];if(v===null)return null;const c=Me(v)||Me(b);return r[x][c]}),p=n&&Object.entries(n).reduce((x,v)=>{let[b,c]=v;return c===void 0||(x[b]=c),x},{}),h=t==null||(o=t.compoundVariants)===null||o===void 0?void 0:o.reduce((x,v)=>{let{class:b,className:c,...u}=v;return Object.entries(u).every(m=>{let[j,w]=m;return Array.isArray(w)?w.includes({...d,...p}[j]):{...d,...p}[j]===w})?[...x,b,c]:x},[]);return Ae(s,f,h,n?.class,n?.className)},cs=me("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 transform active:scale-95",{variants:{variant:{default:"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-md hover:from-blue-700 hover:to-blue-800 hover:shadow-lg focus-visible:ring-blue-500",destructive:"bg-gradient-to-r from-red-600 to-red-700 text-white shadow-md hover:from-red-700 hover:to-red-800 hover:shadow-lg focus-visible:ring-red-500",outline:"border-2 border-gray-300 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-400 focus-visible:ring-gray-500",secondary:"bg-gradient-to-r from-gray-100 to-gray-200 text-gray-800 shadow-sm hover:from-gray-200 hover:to-gray-300 focus-visible:ring-gray-500",ghost:"text-gray-600 hover:bg-gray-100 hover:text-gray-900 focus-visible:ring-gray-500",link:"text-blue-600 underline-offset-4 hover:underline hover:text-blue-800 focus-visible:ring-blue-500",primary:"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-md hover:from-blue-700 hover:to-blue-800 hover:shadow-lg transform hover:-translate-y-0.5 focus-visible:ring-blue-500",success:"bg-gradient-to-r from-green-600 to-green-700 text-white shadow-md hover:from-green-700 hover:to-green-800 hover:shadow-lg focus-visible:ring-green-500"},size:{default:"h-10 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-12 rounded-md px-8 text-base",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),E=l.forwardRef(({className:s,variant:t,size:n,...o},r)=>e.jsx("button",{className:B(cs({variant:t,size:n,className:s})),ref:r,...o}));E.displayName="Button";const Z=l.createContext(null),ds=l.createContext(null),be=({open:s,defaultOpen:t=!1,onOpenChange:n,children:o})=>{const[r,d]=l.useState(t),f=s??r,p=h=>{s===void 0&&d(h),n?.(h)};return e.jsx(Z.Provider,{value:{open:f,onOpenChange:p},children:e.jsx("div",{className:"relative inline-block text-left",children:o})})},ie=l.forwardRef(({onClick:s,...t},n)=>{const o=l.useContext(Z);if(!o)throw new Error("DropdownMenuTrigger must be used within DropdownMenu");return e.jsx("button",{ref:n,onClick:r=>{s?.(r),o.onOpenChange(!o.open)},"aria-expanded":o.open,"aria-haspopup":"true",...t})}),ce=l.forwardRef(({className:s,sideOffset:t=4,children:n,...o})=>{const r=l.useContext(Z);if(!r)throw new Error("DropdownMenuContent must be used within DropdownMenu");const d=l.useRef(null);return l.useEffect(()=>{const f=p=>{d.current&&!d.current.contains(p.target)&&r.onOpenChange(!1)};if(r.open)return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[r]),r.open?e.jsx("div",{ref:d,className:B("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","animate-in fade-in-0 zoom-in-95",s),style:{marginTop:`${t}px`},...o,children:n}):null}),H=l.forwardRef(({className:s,inset:t,disabled:n,onClick:o,...r},d)=>{const f=l.useContext(Z);return e.jsx("div",{ref:d,className:B("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors","hover:bg-accent hover:text-accent-foreground","focus:bg-accent focus:text-accent-foreground",n&&"pointer-events-none opacity-50",t&&"pl-8",s),onClick:p=>{n||(o?.(p),f?.onOpenChange(!1))},role:"menuitem","aria-disabled":n,...r})}),us=l.forwardRef(({className:s,children:t,checked:n,onCheckedChange:o,disabled:r,onClick:d,...f},p)=>e.jsxs("div",{ref:p,className:B("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors","hover:bg-accent hover:text-accent-foreground","focus:bg-accent focus:text-accent-foreground",r&&"pointer-events-none opacity-50",s),onClick:h=>{r||(d?.(h),o?.(!n))},role:"menuitemcheckbox","aria-checked":n,"aria-disabled":r,...f,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:n&&e.jsx(Se,{className:"h-4 w-4"})}),t]})),ms=l.forwardRef(({className:s,children:t,value:n,disabled:o,onClick:r,...d},f)=>{const p=l.useContext(ds),h=p?.value===n;return e.jsxs("div",{ref:f,className:B("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors","hover:bg-accent hover:text-accent-foreground","focus:bg-accent focus:text-accent-foreground",o&&"pointer-events-none opacity-50",s),onClick:x=>{o||(r?.(x),p?.onValueChange(n))},role:"menuitemradio","aria-checked":h,"aria-disabled":o,...d,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h&&e.jsx($e,{className:"h-2 w-2 fill-current"})}),t]})}),hs=l.forwardRef(({className:s,inset:t,...n},o)=>e.jsx("div",{ref:o,className:B("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",s),...n})),xs=l.forwardRef(({className:s,...t},n)=>e.jsx("div",{ref:n,className:B("-mx-1 my-1 h-px bg-muted",s),role:"separator",...t})),gs=l.forwardRef(({className:s,inset:t,children:n,disabled:o,...r},d)=>{const f=l.useContext(Z);if(!f)throw new Error("DropdownMenuSubTrigger must be used within DropdownMenuSub");return e.jsxs("div",{ref:d,className:B("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none","hover:bg-accent","data-[state=open]:bg-accent",o&&"pointer-events-none opacity-50",t&&"pl-8",s),onClick:()=>!o&&f.onOpenChange(!f.open),"data-state":f.open?"open":"closed",...r,children:[n,e.jsx(ht,{className:"ml-auto h-4 w-4"})]})}),fs=l.forwardRef(({className:s,children:t,...n},o)=>{const r=l.useContext(Z);if(!r)throw new Error("DropdownMenuSubContent must be used within DropdownMenuSub");return r.open?e.jsx("div",{ref:o,className:B("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg","absolute left-full top-0 ml-1","animate-in fade-in-0 zoom-in-95",s),...n,children:t}):null});ie.displayName="DropdownMenuTrigger";ce.displayName="DropdownMenuContent";H.displayName="DropdownMenuItem";us.displayName="DropdownMenuCheckboxItem";ms.displayName="DropdownMenuRadioItem";hs.displayName="DropdownMenuLabel";xs.displayName="DropdownMenuSeparator";fs.displayName="DropdownMenuSubContent";gs.displayName="DropdownMenuSubTrigger";const U=l.forwardRef(({className:s,type:t,...n},o)=>e.jsx("input",{type:t,className:B("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:o,...n}));U.displayName="Input";const ps=me("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function V({className:s,variant:t,...n}){return e.jsx("div",{className:B(ps({variant:t}),s),...n})}const bs=me("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),D=l.forwardRef(({className:s,...t},n)=>e.jsx("label",{ref:n,className:B(bs(),s),...t}));D.displayName="Label";const oe=l.createContext(null),_e=({value:s,defaultValue:t="",onValueChange:n,children:o})=>{const[r,d]=l.useState(t),[f,p]=l.useState(!1),h=s??r,x=v=>{s===void 0&&d(v),n?.(v),p(!1)};return e.jsx(oe.Provider,{value:{value:h,onValueChange:x,open:f,setOpen:p},children:o})},ze=({placeholder:s})=>{const t=l.useContext(oe);if(!t)throw new Error("SelectValue must be used within Select");return e.jsx("span",{children:t.value||s})},we=l.forwardRef(({className:s,children:t,...n})=>{const o=l.useContext(oe);if(!o)throw new Error("SelectTrigger must be used within Select");const r=l.useRef(null);return l.useEffect(()=>{const d=f=>{if(r.current&&!r.current.contains(f.target)){const p=document.getElementById("select-content");p&&!p.contains(f.target)&&o.setOpen(!1)}};if(o.open)return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[o]),e.jsxs("button",{ref:r,onClick:()=>o.setOpen(!o.open),className:B("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...n,children:[t,e.jsx(xt,{className:"h-4 w-4 opacity-50"})]})}),Ne=l.forwardRef(({className:s,children:t,position:n="popper",...o},r)=>{const d=l.useContext(oe);if(!d)throw new Error("SelectContent must be used within Select");return d.open?e.jsx("div",{id:"select-content",ref:r,className:B("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md","animate-in fade-in-0 zoom-in-95",n==="popper"&&"mt-1",s),...o,children:e.jsx("div",{className:B("p-1 overflow-auto max-h-[300px]",n==="popper"&&"min-w-full"),children:t})}):null}),vs=l.forwardRef(({className:s,...t},n)=>e.jsx("div",{ref:n,className:B("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...t})),q=l.forwardRef(({className:s,children:t,value:n,...o},r)=>{const d=l.useContext(oe);if(!d)throw new Error("SelectItem must be used within Select");const f=d.value===n;return e.jsxs("div",{ref:r,onClick:()=>d.onValueChange(n),className:B("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none","hover:bg-accent hover:text-accent-foreground","data-[disabled]:pointer-events-none data-[disabled]:opacity-50",f&&"bg-accent text-accent-foreground",s),...o,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:f&&e.jsx(Se,{className:"h-4 w-4"})}),t]})}),ys=l.forwardRef(({className:s,...t},n)=>e.jsx("div",{ref:n,className:B("-mx-1 my-1 h-px bg-muted",s),...t}));we.displayName="SelectTrigger";Ne.displayName="SelectContent";vs.displayName="SelectLabel";q.displayName="SelectItem";ys.displayName="SelectSeparator";const Te=l.createContext(null),Be=l.forwardRef(({value:s,defaultValue:t="",onValueChange:n,className:o,children:r,...d},f)=>{const[p,h]=l.useState(t),x=s??p,v=b=>{s||h(b),n?.(b)};return e.jsx(Te.Provider,{value:{value:x,onValueChange:v},children:e.jsx("div",{ref:f,className:o,...d,children:r})})}),Pe=l.forwardRef(({className:s,...t},n)=>e.jsx("div",{ref:n,role:"tablist",className:B("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...t})),Y=l.forwardRef(({className:s,value:t,children:n,...o},r)=>{const d=l.useContext(Te);if(!d)throw new Error("TabsTrigger must be used within Tabs");const f=d.value===t;return e.jsx("button",{ref:r,role:"tab","aria-selected":f,"data-state":f?"active":"inactive",onClick:()=>d.onValueChange(t),className:B("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","disabled:pointer-events-none disabled:opacity-50",f&&"bg-background text-foreground shadow-sm",s),...o,children:n})}),ae=l.forwardRef(({className:s,value:t,children:n,...o},r)=>{const d=l.useContext(Te);if(!d)throw new Error("TabsContent must be used within Tabs");return d.value===t?e.jsx("div",{ref:r,role:"tabpanel",className:B("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...o,children:n}):null});Be.displayName="Tabs";Pe.displayName="TabsList";Y.displayName="TabsTrigger";ae.displayName="TabsContent";const he=l.forwardRef(({className:s,...t},n)=>e.jsx("textarea",{className:B("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:n,...t}));he.displayName="Textarea";function js(s,t){const[n,o]=l.useState(s);return l.useEffect(()=>{const r=setTimeout(()=>{o(s)},t);return()=>{clearTimeout(r)}},[s,t]),n}function ws(s,t={}){const{saveInterval:n=t.interval||3e4,debounceDelay:o=1e3,enableLocalStorage:r=!0,enableCloudSave:d=!0,onSave:f,onRestore:p,storageKey:h=t.postId?`wordpress-editor-autosave-${t.postType||"post"}-${t.postId}`:"wordpress-editor-autosave",onSaveSuccess:x}=t,[v,b]=l.useState({isSaving:!1,lastSavedAt:null,hasUnsavedChanges:!1,error:null,backupExists:!1}),[c,u]=l.useState(s||null),m=js(c,o),j=l.useRef(void 0),w=l.useRef(!1);l.useEffect(()=>{if(r){const g=localStorage.getItem(h);b(k=>({...k,backupExists:!!g}))}},[r,h]);const C=l.useCallback(g=>{if(r)try{const k={content:g,timestamp:new Date().toISOString(),version:"1.0"};localStorage.setItem(h,JSON.stringify(k))}catch(k){if(k instanceof DOMException&&k.name==="QuotaExceededError")try{localStorage.removeItem(h+"-old"),localStorage.setItem(h+"-old",localStorage.getItem(h)||""),localStorage.setItem(h,JSON.stringify(g))}catch{}}},[r,h]),R=l.useCallback(async g=>{if(!(!d||!f)){b(k=>({...k,isSaving:!0,error:null}));try{await f(g),b(k=>({...k,isSaving:!1,lastSavedAt:new Date,hasUnsavedChanges:!1})),x&&x(),r&&(localStorage.removeItem(h),b(k=>({...k,backupExists:!1})))}catch(k){const _=k instanceof Error?k.message:"Unknown error";b(O=>({...O,isSaving:!1,error:_})),C(g),se.error("Failed to save to cloud. Local backup created.")}}},[d,f,r,h,C,x]),L=l.useCallback(async(g=c,k=!1)=>{!g||w.current||(C(g),(k||!j.current)&&await R(g))},[c,C,R]),$=l.useCallback(g=>{w.current||(u(g),b(k=>({...k,hasUnsavedChanges:!0})))},[]);l.useEffect(()=>{!m||w.current||L(m)},[m,L]),l.useEffect(()=>{if(!d||!v.hasUnsavedChanges)return;const g=setInterval(()=>{v.hasUnsavedChanges&&c&&L(c,!0)},n);return()=>clearInterval(g)},[d,v.hasUnsavedChanges,c,L,n]);const y=l.useCallback(async()=>{w.current=!0;try{if(p){const g=await p();if(g)return u(g),b(k=>({...k,hasUnsavedChanges:!1,lastSavedAt:new Date})),w.current=!1,g}if(r){const g=localStorage.getItem(h);if(g){const{content:k,timestamp:_}=JSON.parse(g);return u(k),se.success(`Restored from backup (${new Date(_).toLocaleString()})`),w.current=!1,k}}}catch{se.error("Failed to restore backup")}finally{w.current=!1}return null},[p,r,h]),P=l.useCallback(()=>{r&&(localStorage.removeItem(h),localStorage.removeItem(h+"-old"),t.postId&&(localStorage.removeItem(`page-${t.postId}-draft`),localStorage.removeItem(`post-${t.postId}-draft`)),b(g=>({...g,backupExists:!1,hasUnsavedChanges:!1})),w.current=!0,setTimeout(()=>{w.current=!1},100))},[r,h,t.postId]);return l.useEffect(()=>{const g=k=>{if(v.hasUnsavedChanges){const _="You have unsaved changes. Are you sure you want to leave?";return k.preventDefault(),k.returnValue=_,_}};return window.addEventListener("beforeunload",g),()=>window.removeEventListener("beforeunload",g)},[v.hasUnsavedChanges]),l.useEffect(()=>{const g=()=>{document.hidden&&v.hasUnsavedChanges&&c&&L(c,!0)};return document.addEventListener("visibilitychange",g),()=>document.removeEventListener("visibilitychange",g)},[v.hasUnsavedChanges,c,L]),{...v,updateContent:$,save:()=>L(c,!0),restoreFromBackup:y,clearBackup:P,lastSaved:v.lastSavedAt,savedInLocalStorage:v.backupExists,recoverFromLocalStorage:y,clearLocalStorage:P}}const Ns=({_isOpen:s,onClose:t,onSelect:n,allowMultiple:o=!1,acceptedTypes:r=["image/*"]})=>{const[d,f]=l.useState("grid"),[p,h]=l.useState(""),[x,v]=l.useState([]),[b,c]=l.useState("library"),u=zt(),{data:m=[],isLoading:j}=Ft({queryKey:["media",p],queryFn:async()=>{const g=new URLSearchParams;return p&&g.append("search",p),(await Le.api.get(`/media?${g}`)).data},enabled:s}),w=Ut({mutationFn:async g=>{const k=new FormData;return g.forEach(O=>{k.append("files",O)}),(await Le.api.post("/media/upload",k,{headers:{"Content-Type":"multipart/form-data"}})).data},onSuccess:()=>{se.success("파일이 업로드되었습니다"),u.invalidateQueries({queryKey:["media"]}),c("library")},onError:()=>{se.error("파일 업로드에 실패했습니다")}}),C=l.useCallback(g=>{w.mutate(g)},[w]),{getRootProps:R,getInputProps:L,isDragActive:$}=gt({onDrop:C,accept:r.reduce((g,k)=>({...g,[k]:[]}),{}),multiple:!0}),y=g=>{o?v(k=>k.includes(g.id)?k.filter(_=>_!==g.id):[...k,g.id]):(n(g),t())},P=()=>{const g=m.filter(k=>x.includes(k.id));g.length>0&&(g.forEach(k=>n(k)),t())};return s?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-6xl h-[80vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"미디어 라이브러리"}),e.jsx("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(ue,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex border-b",children:[e.jsx("button",{onClick:()=>c("library"),className:I("px-6 py-3 font-medium transition-colors",b==="library"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"),children:"미디어 라이브러리"}),e.jsx("button",{onClick:()=>c("upload"),className:I("px-6 py-3 font-medium transition-colors",b==="upload"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"),children:"파일 업로드"})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:b==="library"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(re,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx(U,{type:"search",placeholder:"미디어 검색...",value:p,onChange:g=>h(g.target.value),className:"pl-10 w-64"})]}),e.jsxs("div",{className:"flex items-center gap-1 border rounded-lg",children:[e.jsx("button",{onClick:()=>f("grid"),className:I("p-2 transition-colors",d==="grid"?"bg-gray-100":"hover:bg-gray-50"),children:e.jsx(G,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>f("list"),className:I("p-2 transition-colors",d==="list"?"bg-gray-100":"hover:bg-gray-50"),children:e.jsx(K,{className:"w-4 h-4"})})]})]}),o&&x.length>0&&e.jsxs(E,{onClick:P,children:[x.length,"개 선택 완료"]})]}),e.jsx("div",{className:"p-4 overflow-y-auto h-full",children:j?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):m.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[e.jsx(ne,{className:"w-16 h-16 mb-4"}),e.jsx("p",{children:"미디어가 없습니다"})]}):d==="grid"?e.jsx("div",{className:"grid grid-cols-6 gap-4",children:m.map(g=>e.jsxs("div",{onClick:()=>y(g),className:I("relative aspect-square rounded-lg overflow-hidden cursor-pointer group","border-2 transition-all hover:shadow-lg",x.includes(g.id)?"border-blue-600":"border-gray-200 hover:border-gray-300"),children:[e.jsx("img",{src:g.thumbnailUrl||g.url,alt:g.alt||g.filename,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-opacity",children:x.includes(g.id)&&e.jsx("div",{className:"absolute top-2 right-2 w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center",children:e.jsx(Se,{className:"w-4 h-4 text-white"})})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-2 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("p",{className:"text-xs text-white truncate",children:g.filename})})]},g.id))}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2",children:"파일"}),e.jsx("th",{className:"text-left py-2",children:"파일명"}),e.jsx("th",{className:"text-left py-2",children:"업로드 일시"}),e.jsx("th",{className:"text-left py-2",children:"크기"})]})}),e.jsx("tbody",{children:m.map(g=>e.jsxs("tr",{onClick:()=>y(g),className:I("border-b cursor-pointer hover:bg-gray-50",x.includes(g.id)&&"bg-blue-50"),children:[e.jsx("td",{className:"py-2",children:e.jsx("img",{src:g.thumbnailUrl||g.url,alt:g.alt||g.filename,className:"w-10 h-10 object-cover rounded"})}),e.jsx("td",{className:"py-2",children:g.filename}),e.jsx("td",{className:"py-2 text-sm text-gray-600",children:$t(new Date(g.uploadedAt),"yyyy-MM-dd HH:mm")}),e.jsxs("td",{className:"py-2 text-sm text-gray-600",children:[(g.size/1024/1024).toFixed(2)," MB"]})]},g.id))})]})})]}):e.jsxs("div",{className:"p-8 h-full flex items-center justify-center",children:[e.jsxs("div",{...R(),className:I("w-full max-w-2xl h-64 border-2 border-dashed rounded-lg","flex flex-col items-center justify-center cursor-pointer","transition-colors",$?"border-blue-600 bg-blue-50":"border-gray-300 hover:border-gray-400"),children:[e.jsx("input",{...L()}),e.jsx(ft,{className:"w-12 h-12 text-gray-400 mb-4"}),$?e.jsx("p",{className:"text-lg text-blue-600",children:"파일을 여기에 놓으세요"}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-lg text-gray-600 mb-2",children:"파일을 드래그하거나 클릭하여 업로드"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["지원 형식: ",r.join(", ")]})]})]}),w.isPending&&e.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})})]})})]})}):null},ks=({settings:s,onChange:t})=>{const n=[{value:"left",icon:Oe,label:"왼쪽"},{value:"center",icon:Ve,label:"가운데"},{value:"right",icon:He,label:"오른쪽"},{value:"wide",icon:pt,label:"넓게"},{value:"full",icon:bt,label:"전체 너비"}],o=[{value:"thumbnail",label:"썸네일 (150x150)"},{value:"medium",label:"중간 (300x300)"},{value:"large",label:"크게 (1024x1024)"},{value:"full",label:"원본 크기"}];return e.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-sm font-medium mb-2 block",children:"정렬"}),e.jsx("div",{className:"flex gap-1",children:n.map(r=>{const d=r.icon;return e.jsx("button",{onClick:()=>t({...s,alignment:r.value}),className:I("p-2 rounded transition-colors",s.alignment===r.value?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-100"),title:r.label,children:e.jsx(d,{className:"w-4 h-4"})},r.value)})})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-sm font-medium mb-2 block",children:"이미지 크기"}),e.jsx("select",{value:s.size||"large",onChange:r=>t({...s,size:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:o.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]}),s.size==="full"&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(D,{htmlFor:"width",className:"text-sm",children:"너비"}),e.jsx(U,{id:"width",type:"number",value:s.width||"",onChange:r=>t({...s,width:parseInt(r.target.value)||void 0}),placeholder:"px"})]}),e.jsxs("div",{children:[e.jsx(D,{htmlFor:"height",className:"text-sm",children:"높이"}),e.jsx(U,{id:"height",type:"number",value:s.height||"",onChange:r=>t({...s,height:parseInt(r.target.value)||void 0}),placeholder:"px"})]})]}),e.jsxs("div",{children:[e.jsxs(D,{htmlFor:"alt",className:"text-sm font-medium mb-1 block",children:[e.jsx(X,{className:"w-3 h-3 inline mr-1"}),"대체 텍스트"]}),e.jsx(U,{id:"alt",value:s.alt||"",onChange:r=>t({...s,alt:r.target.value}),placeholder:"이미지 설명"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"접근성을 위해 이미지를 설명하세요"})]}),e.jsxs("div",{children:[e.jsx(D,{htmlFor:"caption",className:"text-sm font-medium mb-1 block",children:"캡션"}),e.jsx(he,{id:"caption",value:s.caption||"",onChange:r=>t({...s,caption:r.target.value}),placeholder:"이미지 캡션 (선택사항)",rows:2})]}),e.jsxs("div",{children:[e.jsxs(D,{htmlFor:"link",className:"text-sm font-medium mb-1 block",children:[e.jsx(qe,{className:"w-3 h-3 inline mr-1"}),"링크 URL"]}),e.jsx(U,{id:"link",type:"url",value:s.link||"",onChange:r=>t({...s,link:r.target.value}),placeholder:"https://example.com"}),s.link&&e.jsx("div",{className:"mt-2",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s.linkTarget==="_blank",onChange:r=>t({...s,linkTarget:r.target.checked?"_blank":"_self"}),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"새 탭에서 열기"})]})})]})]})},Cs=({settings:s,onChange:t})=>{const n=[1,2,3,4,5,6];return e.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsxs(D,{className:"text-sm font-medium mb-2 block",children:[e.jsx(G,{className:"w-3 h-3 inline mr-1"}),"컬럼 수"]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:n.map(o=>e.jsxs("button",{onClick:()=>t({...s,columns:o}),className:I("p-2 rounded transition-colors text-sm",s.columns===o?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-100 border border-gray-300"),children:[o,"열"]},o))})]}),e.jsxs("div",{children:[e.jsxs(D,{className:"text-sm font-medium mb-2 block",children:[e.jsx(vt,{className:"w-3 h-3 inline mr-1"}),"이미지 표시"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>t({...s,imageCrop:!0}),className:I("flex-1 p-2 rounded transition-colors text-sm",s.imageCrop?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-100 border border-gray-300"),children:"자르기"}),e.jsx("button",{onClick:()=>t({...s,imageCrop:!1}),className:I("flex-1 p-2 rounded transition-colors text-sm",s.imageCrop?"bg-white text-gray-600 hover:bg-gray-100 border border-gray-300":"bg-blue-600 text-white"),children:"전체 표시"})]})]}),e.jsxs("div",{children:[e.jsxs(D,{className:"text-sm font-medium mb-2 block",children:[e.jsx(qe,{className:"w-3 h-3 inline mr-1"}),"이미지 클릭 시"]}),e.jsxs("select",{value:s.linkTo||"none",onChange:o=>t({...s,linkTo:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"none",children:"링크 없음"}),e.jsx("option",{value:"media",children:"미디어 파일"}),e.jsx("option",{value:"attachment",children:"첨부 페이지"})]})]}),s.images&&s.images.length>0&&e.jsxs("div",{children:[e.jsx(D,{className:"text-sm font-medium mb-2 block",children:"이미지 관리"}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:s.images.map((o,r)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white rounded border",children:[e.jsx("img",{src:o.thumbnailUrl||o.url,alt:o.alt||"",className:"w-10 h-10 object-cover rounded"}),e.jsx("span",{className:"flex-1 text-sm truncate",children:o.alt||`이미지 ${r+1}`}),e.jsx("button",{onClick:()=>{const d=s.images.filter((f,p)=>p!==r);t({...s,images:d})},className:"text-red-600 hover:text-red-700 text-sm",children:"제거"})]},r))})]})]})},Ss=({settings:s,onChange:t})=>{const n=[{value:"left",icon:Oe,label:"왼쪽"},{value:"center",icon:Ve,label:"가운데"},{value:"right",icon:He,label:"오른쪽"}],o=[{color:"rgba(0, 0, 0, 0.5)",label:"블랙 50%"},{color:"rgba(0, 0, 0, 0.7)",label:"블랙 70%"},{color:"rgba(255, 255, 255, 0.5)",label:"화이트 50%"},{color:"rgba(0, 51, 102, 0.7)",label:"네이비 70%"},{color:"rgba(0, 0, 0, 0)",label:"투명"}];return e.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsxs(D,{htmlFor:"title",className:"text-sm font-medium mb-1 block",children:[e.jsx(X,{className:"w-3 h-3 inline mr-1"}),"제목"]}),e.jsx(U,{id:"title",value:s.title||"",onChange:r=>t({...s,title:r.target.value}),placeholder:"Cover 제목"})]}),e.jsxs("div",{children:[e.jsx(D,{htmlFor:"text",className:"text-sm font-medium mb-1 block",children:"부제목"}),e.jsx(he,{id:"text",value:s.text||"",onChange:r=>t({...s,text:r.target.value}),placeholder:"Cover 부제목 텍스트",rows:2})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-sm font-medium mb-2 block",children:"콘텐츠 정렬"}),e.jsx("div",{className:"flex gap-1",children:n.map(r=>{const d=r.icon;return e.jsx("button",{onClick:()=>t({...s,contentAlign:r.value}),className:I("p-2 rounded transition-colors",s.contentAlign===r.value?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-100"),title:r.label,children:e.jsx(d,{className:"w-4 h-4"})},r.value)})})]}),e.jsxs("div",{children:[e.jsxs(D,{htmlFor:"minHeight",className:"text-sm font-medium mb-1 block",children:[e.jsx(Ge,{className:"w-3 h-3 inline mr-1"}),"최소 높이"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"range",min:"100",max:"800",value:s.minHeight||300,onChange:r=>t({...s,minHeight:parseInt(r.target.value)}),className:"flex-1"}),e.jsxs("span",{className:"text-sm w-16 text-right",children:[s.minHeight||300,"px"]})]})]}),e.jsxs("div",{children:[e.jsxs(D,{className:"text-sm font-medium mb-2 block",children:[e.jsx(Je,{className:"w-3 h-3 inline mr-1"}),"오버레이 색상"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"grid grid-cols-2 gap-2",children:o.map(r=>e.jsxs("button",{onClick:()=>t({...s,overlayColor:r.color}),className:I("p-2 rounded border-2 text-sm transition-colors",s.overlayColor===r.color?"border-blue-600":"border-gray-300 hover:border-gray-400"),children:[e.jsx("div",{className:"w-full h-8 rounded mb-1",style:{backgroundColor:r.color,border:"1px solid #e5e7eb"}}),e.jsx("span",{className:"text-xs",children:r.label})]},r.color))}),e.jsxs("div",{children:[e.jsx(D,{htmlFor:"customColor",className:"text-xs text-gray-600",children:"커스텀 색상"}),e.jsx(U,{id:"customColor",type:"text",value:s.overlayColor||"",onChange:r=>t({...s,overlayColor:r.target.value}),placeholder:"rgba(0, 0, 0, 0.5)",className:"mt-1"})]})]})]})]})},Ts=({settings:s,onChange:t})=>{const n=[{bg:"#007cba",text:"#ffffff",label:"파란색"},{bg:"#28a745",text:"#ffffff",label:"초록색"},{bg:"#dc3545",text:"#ffffff",label:"빨간색"},{bg:"#ffc107",text:"#000000",label:"노란색"},{bg:"#6c757d",text:"#ffffff",label:"회색"},{bg:"#000000",text:"#ffffff",label:"검정색"}];return e.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsxs(D,{htmlFor:"text",className:"text-sm font-medium mb-1 block",children:[e.jsx(X,{className:"w-3 h-3 inline mr-1"}),"버튼 텍스트"]}),e.jsx(U,{id:"text",value:s.text||"",onChange:o=>t({...s,text:o.target.value}),placeholder:"버튼 텍스트"})]}),e.jsxs("div",{children:[e.jsxs(D,{htmlFor:"url",className:"text-sm font-medium mb-1 block",children:[e.jsx(We,{className:"w-3 h-3 inline mr-1"}),"링크 URL"]}),e.jsx(U,{id:"url",type:"url",value:s.url||"",onChange:o=>t({...s,url:o.target.value}),placeholder:"https://example.com"}),e.jsx("div",{className:"mt-2",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s.target==="_blank",onChange:o=>t({...s,target:o.target.checked?"_blank":"_self"}),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"새 탭에서 열기"})]})})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-sm font-medium mb-2 block",children:"버튼 스타일"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>t({...s,style:"fill"}),className:I("flex-1 p-2 rounded transition-colors text-sm",s.style==="fill"?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-100 border border-gray-300"),children:"채우기"}),e.jsx("button",{onClick:()=>t({...s,style:"outline"}),className:I("flex-1 p-2 rounded transition-colors text-sm",s.style==="outline"?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-100 border border-gray-300"),children:"윤곽선"})]})]}),e.jsxs("div",{children:[e.jsxs(D,{className:"text-sm font-medium mb-2 block",children:[e.jsx(Je,{className:"w-3 h-3 inline mr-1"}),"색상"]}),e.jsx("div",{className:"grid grid-cols-3 gap-2 mb-2",children:n.map(o=>e.jsx("button",{onClick:()=>t({...s,backgroundColor:o.bg,textColor:o.text}),className:I("p-2 rounded border-2 transition-colors",s.backgroundColor===o.bg?"border-blue-600":"border-gray-300 hover:border-gray-400"),children:e.jsx("div",{className:"w-full h-6 rounded flex items-center justify-center text-xs font-medium",style:{backgroundColor:o.bg,color:o.text},children:o.label})},o.bg))}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(D,{htmlFor:"bgColor",className:"text-xs text-gray-600",children:"배경색"}),e.jsx(U,{id:"bgColor",type:"color",value:s.backgroundColor||"#007cba",onChange:o=>t({...s,backgroundColor:o.target.value}),className:"mt-1 h-8"})]}),e.jsxs("div",{children:[e.jsx(D,{htmlFor:"textColor",className:"text-xs text-gray-600",children:"텍스트색"}),e.jsx(U,{id:"textColor",type:"color",value:s.textColor||"#ffffff",onChange:o=>t({...s,textColor:o.target.value}),className:"mt-1 h-8"})]})]})]}),e.jsxs("div",{children:[e.jsxs(D,{htmlFor:"borderRadius",className:"text-sm font-medium mb-1 block",children:[e.jsx($e,{className:"w-3 h-3 inline mr-1"}),"모서리 둥글기"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"range",min:"0",max:"50",value:s.borderRadius||4,onChange:o=>t({...s,borderRadius:parseInt(o.target.value)}),className:"flex-1"}),e.jsxs("span",{className:"text-sm w-12 text-right",children:[s.borderRadius||4,"px"]})]})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-sm font-medium mb-2 block",children:"미리보기"}),e.jsx("div",{className:"p-4 bg-white rounded border flex justify-center",children:e.jsx("button",{className:I("px-4 py-2 rounded transition-colors",s.style==="fill"&&"text-white",s.style==="outline"&&"border-2"),style:{backgroundColor:s.style==="fill"?s.backgroundColor:"transparent",color:s.style==="fill"?s.textColor:s.backgroundColor,borderColor:s.style==="outline"?s.backgroundColor:"transparent",borderRadius:`${s.borderRadius}px`},children:s.text||"버튼"})})]})]})},Bs=[{id:"uagb/advanced-heading",name:"Advanced Heading",icon:X,category:"text"},{id:"uagb/info-box",name:"Info Box",icon:ye,category:"layout"},{id:"uagb/testimonial",name:"Testimonial",icon:ve,category:"text"},{id:"uagb/team",name:"Team",icon:Ct,category:"layout"},{id:"uagb/social-share",name:"Social Share",icon:St,category:"social"},{id:"uagb/google-map",name:"Google Map",icon:Tt,category:"embed"},{id:"uagb/icon-list",name:"Icon List",icon:K,category:"text"},{id:"uagb/price-list",name:"Price List",icon:Bt,category:"layout"},{id:"uagb/post-carousel",name:"Post Carousel",icon:G,category:"layout"},{id:"uagb/table-of-contents",name:"Table of Contents",icon:K,category:"text"},{id:"uagb/timeline",name:"Timeline",icon:ye,category:"layout"},{id:"uagb/blockquote",name:"Blockquote",icon:ve,category:"text"},{id:"uagb/call-to-action",name:"Call To Action",icon:de,category:"layout"},{id:"uagb/columns",name:"Advanced Columns",icon:Ke,category:"layout"},{id:"uagb/section",name:"Section",icon:le,category:"layout"}],Ps=[{id:"o4o/cpt-acf-loop",name:"CPT/ACF Loop",icon:K,category:"o4o"}],Rs=[{id:"core/paragraph",name:"Paragraph",icon:X,category:"text"},{id:"core/heading",name:"Heading",icon:X,category:"text"},{id:"core/list",name:"List",icon:K,category:"text"},{id:"core/quote",name:"Quote",icon:ve,category:"text"},{id:"core/code",name:"Code",icon:yt,category:"text"},{id:"core/table",name:"Table",icon:jt,category:"text"},{id:"core/image",name:"Image",icon:ne,category:"media"},{id:"core/gallery",name:"Gallery",icon:G,category:"media"},{id:"core/video",name:"Video",icon:wt,category:"media"},{id:"core/audio",name:"Audio",icon:Nt,category:"media"},{id:"core/cover",name:"Cover",icon:ne,category:"media"},{id:"core/columns",name:"Columns",icon:Ke,category:"design"},{id:"core/group",name:"Group",icon:le,category:"design"},{id:"core/button",name:"Button",icon:kt,category:"design"},{id:"core/spacer",name:"Spacer",icon:le,category:"design"},{id:"core/separator",name:"Separator",icon:le,category:"design"}],Es=s=>{if(!s||!s.trim())return[];const t=/<!-- wp:([a-z0-9-]+\/[a-z0-9-]+)(\s+({[^}]*}))?\s*-->([\s\S]*?)<!-- \/wp:\1 -->/g,n=[...s.matchAll(t)];return n.length>0?n.map((o,r)=>{const d=o[1],f=o[3],p=o[4].trim();let h={};if(f)try{h=JSON.parse(f)}catch{}let x={};switch(d){case"core/paragraph":const v=p.match(/<p>(.*?)<\/p>/s);x={text:v?v[1]:p};break;case"core/heading":const b=p.match(/<h(\d)>(.*?)<\/h\d>/s);b&&(x={text:b[2],level:parseInt(b[1])});break;case"core/list":x={items:[...p.matchAll(/<li>(.*?)<\/li>/gs)].map(R=>R[1])};break;case"core/quote":const u=p.match(/<blockquote[^>]*><p>(.*?)<\/p>(?:<cite>(.*?)<\/cite>)?<\/blockquote>/s);u&&(x={text:u[1],citation:u[2]});break;case"core/image":const m=p.match(/<img[^>]+src="([^"]+)"[^>]*alt="([^"]*)"[^>]*>/),j=p.match(/<figcaption>(.*?)<\/figcaption>/);m&&(x={url:m[1],alt:m[2],caption:j?j[1]:void 0});break;case"o4o/cpt-acf-loop":const w=p.match(/data-block='([^']+)'/);if(w)try{x=JSON.parse(w[1])}catch{}break;default:const C=p.match(/data-block='([^']+)'/);if(C)try{x=JSON.parse(C[1])}catch{x={raw:p}}else x={raw:p}}return{id:`block-${Date.now()}-${r}`,type:d,content:x,attributes:h}}):[{id:`block-${Date.now()}`,type:"core/paragraph",content:{text:s.replace(/<[^>]*>/g,"")},attributes:{}}]},Ds=s=>s.map(t=>{const n=t.type,o=t.attributes||{},r=t.content;let d=`<!-- wp:${n}`;switch(Object.keys(o).length>0&&(d+=` ${JSON.stringify(o)}`),d+=` -->
`,t.type){case"core/paragraph":d+=`<p>${r.text||""}</p>`;break;case"core/heading":const f=r.level||2;d+=`<h${f}>${r.text||""}</h${f}>`;break;case"core/list":d+=`<ul>${(r.items||[]).map(p=>`<li>${p}</li>`).join(`
`)}</ul>`;break;case"core/quote":d+=`<blockquote class="wp-block-quote"><p>${r.text||""}</p>`,r.citation&&(d+=`<cite>${r.citation}</cite>`),d+="</blockquote>";break;case"core/image":d+=`<figure class="wp-block-image"><img src="${r.url||""}" alt="${r.alt||""}"/>`,r.caption&&(d+=`<figcaption>${r.caption}</figcaption>`),d+="</figure>";break;case"o4o/cpt-acf-loop":d+=`<div class="wp-block-o4o-cpt-acf-loop" data-block='${JSON.stringify(r)}'></div>`;break;default:d+=`<div class="wp-block-${n.replace("/","-")}" data-block='${JSON.stringify(r)}'></div>`}return d+=`
<!-- /wp:${n} -->
`,d}).join(`
`),na=({initialBlocks:s=[],onChange:t,content:n,onContentChange:o})=>{const[r,d]=l.useState(()=>n?Es(n):s),[f,p]=l.useState(!1),[h,x]=l.useState(null),[v,b]=l.useState("all"),[c,u]=l.useState(!1),[m,j]=l.useState(null),[w,C]=l.useState(!1),R=[...Rs,...Bs,...Ps],L=["all","text","media","design","layout","social","embed","o4o"],$=v==="all"?R:R.filter(a=>a.category===v),y=a=>{d(a),t?.(a),o?.(Ds(a))},P=a=>{const S={id:`block-${Date.now()}`,type:a,content:g(a),attributes:{}},i=[...r,S];y(i),p(!1)},g=a=>{switch(a){case"core/paragraph":return{text:"Start writing or type / to choose a block"};case"core/heading":return{text:"Heading",level:2};case"uagb/advanced-heading":return{text:"Advanced Heading",level:2,alignment:"center"};case"core/image":return{url:"",alt:"",caption:"",alignment:"center",size:"large"};case"core/gallery":return{images:[],columns:3,imageCrop:!0,linkTo:"none"};case"core/video":return{url:"",autoplay:!1,loop:!1,muted:!1,controls:!0};case"core/cover":return{url:"",overlayColor:"rgba(0, 0, 0, 0.5)",minHeight:300,contentAlign:"center",title:"Cover Title",text:"Cover subtitle text"};case"core/columns":return{columns:[{id:`col-${Date.now()}-1`,content:[],width:50},{id:`col-${Date.now()}-2`,content:[],width:50}]};case"core/button":return{text:"Click me",url:"#",target:"_self",style:"fill",backgroundColor:"#007cba",textColor:"#ffffff",borderRadius:4};case"core/spacer":return{height:100};case"core/separator":return{style:"default",color:"#cccccc"};case"core/code":return{content:"// Your code here",language:"javascript"};case"core/table":return{head:[["Column 1","Column 2","Column 3"]],body:[["Row 1 Cell 1","Row 1 Cell 2","Row 1 Cell 3"],["Row 2 Cell 1","Row 2 Cell 2","Row 2 Cell 3"]],foot:[]};case"core/group":return{blocks:[],backgroundColor:"",padding:20};default:return{}}},k=a=>{const S=r.filter(i=>i.id!==a);y(S)},_=a=>{const S=r.findIndex(i=>i.id===a);if(S!==-1){const N={...r[S],id:`block-${Date.now()}`},M=[...r.slice(0,S+1),N,...r.slice(S+1)];y(M)}},O=a=>{const S=R.find(i=>i.id===a.type)?.icon||ye;return e.jsxs("div",{className:I("group relative border-2 rounded-lg p-4 mb-4 transition-all",h===a.id?"border-modern-primary bg-modern-primary-alpha":"border-transparent hover:border-modern-border-primary"),onClick:()=>x(a.id),children:[e.jsx("div",{className:"absolute -top-4 left-1/2 transform -translate-x-1/2 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsxs("div",{className:"flex items-center gap-1 bg-modern-bg-card border border-modern-border-primary rounded-lg shadow-modern-shadow p-1",children:[e.jsx("button",{className:"p-1 hover:bg-modern-bg-hover rounded",children:e.jsx(Ge,{className:"w-4 h-4 text-modern-text-secondary"})}),e.jsx("button",{onClick:i=>{i.stopPropagation(),_(a.id)},className:"p-1 hover:bg-modern-bg-hover rounded",children:e.jsx(je,{className:"w-4 h-4 text-modern-text-secondary"})}),e.jsx("button",{onClick:i=>{i.stopPropagation(),k(a.id)},className:"p-1 hover:bg-modern-bg-hover rounded",children:e.jsx(Pt,{className:"w-4 h-4 text-modern-error"})}),e.jsx("button",{className:"p-1 hover:bg-modern-bg-hover rounded",children:e.jsx(Rt,{className:"w-4 h-4 text-modern-text-secondary"})})]})}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-modern-bg-tertiary rounded flex items-center justify-center",children:e.jsx(S,{className:"w-4 h-4 text-modern-text-secondary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs text-modern-text-tertiary mb-1",children:R.find(i=>i.id===a.type)?.name}),a.type.includes("heading")&&e.jsx("h2",{className:"text-2xl font-bold text-modern-text-primary",children:a.content.text}),a.type.includes("paragraph")&&e.jsx("p",{className:"text-modern-text-primary",children:a.content.text}),a.type==="core/image"&&e.jsxs("div",{className:"space-y-2",children:[a.content.url?e.jsxs("div",{className:I("relative",a.content.alignment==="left"&&"mr-auto",a.content.alignment==="center"&&"mx-auto",a.content.alignment==="right"&&"ml-auto",a.content.size==="thumbnail"&&"max-w-[150px]",a.content.size==="medium"&&"max-w-[300px]",a.content.size==="large"&&"max-w-[1024px]",a.content.size==="full"&&"max-w-full"),children:[e.jsx("img",{src:a.content.url,alt:a.content.alt||"",className:"w-full h-auto rounded"}),a.content.caption&&e.jsx("p",{className:"text-sm text-gray-600 mt-2 text-center",children:a.content.caption})]}):e.jsx("button",{onClick:i=>{i.stopPropagation(),j(()=>N=>{const M={...a,content:{...a.content,url:N.url,alt:N.alt||N.filename,width:N.width,height:N.height}},A=r.map(T=>T.id===a.id?M:T);y(A),u(!1)}),u(!0)},className:"w-full h-32 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center hover:border-modern-primary hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ne,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-600",children:"미디어 선택"})]})}),h===a.id&&a.content.url&&e.jsx("button",{onClick:i=>{i.stopPropagation(),C(!0)},className:"absolute top-2 right-2 p-1 bg-white rounded shadow hover:bg-gray-100",children:e.jsx(xe,{className:"w-4 h-4"})})]}),a.type==="core/gallery"&&e.jsxs("div",{className:"space-y-2",children:[a.content.images&&a.content.images.length>0?e.jsx("div",{className:I("grid gap-2",a.content.columns===1&&"grid-cols-1",a.content.columns===2&&"grid-cols-2",a.content.columns===3&&"grid-cols-3",a.content.columns===4&&"grid-cols-4",a.content.columns===5&&"grid-cols-5",a.content.columns===6&&"grid-cols-6"),children:a.content.images.map((i,N)=>e.jsx("div",{className:"relative aspect-square",children:e.jsx("img",{src:i.url||i.thumbnailUrl,alt:i.alt||"",className:I("w-full h-full rounded",a.content.imageCrop?"object-cover":"object-contain")})},N))}):e.jsx("button",{onClick:i=>{i.stopPropagation(),j(()=>N=>{const M={...a,content:{...a.content,images:[...a.content.images||[],{id:N.id,url:N.url,thumbnailUrl:N.thumbnailUrl,alt:N.alt||N.filename}]}},A=r.map(T=>T.id===a.id?M:T);y(A)}),u(!0)},className:"w-full h-32 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center hover:border-modern-primary hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"text-center",children:[e.jsx(G,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-600",children:"갤러리 이미지 추가"})]})}),h===a.id&&a.content.images?.length>0&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:i=>{i.stopPropagation(),j(()=>N=>{const M={...a,content:{...a.content,images:[...a.content.images,{id:N.id,url:N.url,thumbnailUrl:N.thumbnailUrl,alt:N.alt||N.filename}]}},A=r.map(T=>T.id===a.id?M:T);y(A)}),u(!0)},className:"px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50",children:"이미지 추가"}),e.jsx("button",{onClick:i=>{i.stopPropagation(),C(!0)},className:"p-1 border border-gray-300 rounded hover:bg-gray-50",children:e.jsx(xe,{className:"w-4 h-4"})})]})]}),a.type==="core/cover"&&e.jsxs("div",{className:"relative rounded-lg overflow-hidden",style:{minHeight:a.content.minHeight||300},children:[a.content.url?e.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:`url(${a.content.url})`},children:e.jsx("div",{className:"absolute inset-0",style:{backgroundColor:a.content.overlayColor}})}):e.jsx("div",{className:"absolute inset-0",style:{backgroundColor:a.content.overlayColor||"#000"}}),e.jsxs("div",{className:I("relative z-10 h-full flex flex-col justify-center p-8 text-white",a.content.contentAlign==="left"&&"items-start text-left",a.content.contentAlign==="center"&&"items-center text-center",a.content.contentAlign==="right"&&"items-end text-right"),children:[e.jsx("h2",{className:"text-3xl font-bold mb-2",children:a.content.title}),e.jsx("p",{className:"text-lg",children:a.content.text})]}),!a.content.url&&e.jsx("button",{onClick:i=>{i.stopPropagation(),j(()=>N=>{const M={...a,content:{...a.content,url:N.url}},A=r.map(T=>T.id===a.id?M:T);y(A),u(!1)}),u(!0)},className:"absolute top-4 right-4 p-2 bg-white rounded shadow hover:bg-gray-100",children:e.jsx(ne,{className:"w-4 h-4"})}),h===a.id&&e.jsx("button",{onClick:i=>{i.stopPropagation(),C(!0)},className:"absolute top-4 left-4 p-1 bg-white rounded shadow hover:bg-gray-100",children:e.jsx(xe,{className:"w-4 h-4"})})]}),a.type==="core/button"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("a",{href:a.content.url,target:a.content.target,className:I("inline-flex items-center px-4 py-2 rounded transition-colors",a.content.style==="fill"&&"text-white",a.content.style==="outline"&&"border-2"),style:{backgroundColor:a.content.style==="fill"?a.content.backgroundColor:"transparent",color:a.content.style==="fill"?a.content.textColor:a.content.backgroundColor,borderColor:a.content.style==="outline"?a.content.backgroundColor:"transparent",borderRadius:`${a.content.borderRadius}px`},children:a.content.text}),e.jsx(We,{className:"w-4 h-4 text-gray-400"})]}),a.type==="core/spacer"&&e.jsx("div",{className:"relative border-2 border-dashed border-gray-300 rounded",style:{height:a.content.height},children:e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500",children:e.jsxs("span",{className:"text-sm",children:[a.content.height,"px"]})})}),a.type==="core/separator"&&e.jsx("div",{className:"py-4",children:e.jsx("hr",{className:I(a.content.style==="wide"&&"w-full",a.content.style==="default"&&"w-24 mx-auto",a.content.style==="dots"&&"border-dotted"),style:{borderColor:a.content.color}})}),a.type==="core/code"&&e.jsx("pre",{className:"bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto",children:e.jsx("code",{className:`language-${a.content.language}`,children:a.content.content})}),a.type==="core/table"&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full border-collapse",children:[a.content.head.length>0&&e.jsx("thead",{children:a.content.head.map((i,N)=>e.jsx("tr",{children:i.map((M,A)=>e.jsx("th",{className:"border border-gray-300 px-4 py-2 bg-gray-100 font-semibold",children:M},A))},N))}),e.jsx("tbody",{children:a.content.body.map((i,N)=>e.jsx("tr",{children:i.map((M,A)=>e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:M},A))},N))})]})}),a.type==="core/video"&&e.jsx("div",{className:"space-y-2",children:a.content.url?e.jsx("video",{src:a.content.url,controls:a.content.controls,autoPlay:a.content.autoplay,loop:a.content.loop,muted:a.content.muted,className:"w-full rounded"}):e.jsx("button",{onClick:i=>{i.stopPropagation(),j(()=>N=>{const M={...a,content:{...a.content,url:N.url}},A=r.map(T=>T.id===a.id?M:T);y(A),u(!1)}),u(!0)},className:"w-full h-32 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center hover:border-modern-primary hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Et,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-600",children:"비디오 선택"})]})})}),a.type==="core/columns"&&e.jsx("div",{className:"grid gap-4",style:{gridTemplateColumns:a.content.columns.map(i=>`${i.width}%`).join(" ")},children:a.content.columns.map((i,N)=>e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded p-4 min-h-[100px]",children:e.jsxs("div",{className:"text-sm text-gray-500 mb-2",children:["Column ",N+1]})},i.id))}),a.type==="core/group"&&e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded min-h-[100px]",style:{backgroundColor:a.content.backgroundColor,padding:`${a.content.padding}px`},children:e.jsx("div",{className:"text-sm text-gray-500",children:"Group Block"})})]})]})]},a.id)};return e.jsxs("div",{className:"gutenberg-editor bg-modern-bg-card rounded-lg",children:[e.jsx("div",{className:"border-b border-modern-border-primary p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-modern-text-primary",children:"Block Editor"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-3 py-1.5 text-sm border border-modern-border-primary rounded hover:bg-modern-bg-hover",children:"Preview"}),e.jsx("button",{className:"px-3 py-1.5 text-sm bg-modern-primary text-white rounded hover:bg-modern-primary-hover",children:"Update"})]})]})}),e.jsxs("div",{className:"p-8 min-h-[400px]",children:[r.map(O),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>p(!f),className:I("w-full py-4 border-2 border-dashed rounded-lg transition-all","hover:border-modern-primary hover:bg-modern-primary-alpha","flex items-center justify-center gap-2",f?"border-modern-primary bg-modern-primary-alpha":"border-modern-border-secondary"),children:[e.jsx(Q,{className:"w-5 h-5 text-modern-text-secondary"}),e.jsx("span",{className:"text-modern-text-secondary",children:"Add block"})]}),f&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-modern-bg-card border border-modern-border-primary rounded-lg shadow-modern-shadow-xl z-50",children:e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"flex items-center gap-2 mb-4 pb-4 border-b border-modern-border-primary",children:L.map(a=>e.jsx("button",{onClick:()=>b(a),className:I("px-3 py-1.5 text-sm rounded transition-colors capitalize",v===a?"bg-modern-primary text-white":"text-modern-text-secondary hover:bg-modern-bg-hover"),children:a},a))}),e.jsx("div",{className:"grid grid-cols-3 gap-2 max-h-96 overflow-y-auto",children:$.map(a=>{const S=a.icon;return e.jsxs("button",{onClick:()=>P(a.id),className:"flex flex-col items-center gap-2 p-4 border border-modern-border-primary rounded-lg hover:border-modern-primary hover:bg-modern-bg-hover transition-all",children:[e.jsx(S,{className:"w-6 h-6 text-modern-text-secondary"}),e.jsx("span",{className:"text-xs text-modern-text-secondary text-center",children:a.name})]},a.id)})})]})})]})]}),e.jsx(Ns,{_isOpen:c,onClose:()=>{u(!1),j(null)},onSelect:a=>{m&&m(a)},allowMultiple:r.find(a=>a.id===h)?.type==="core/gallery"}),w&&h&&e.jsxs("div",{className:"fixed inset-y-0 right-0 w-80 bg-white shadow-xl z-40",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h3",{className:"font-semibold",children:"블록 설정"}),e.jsx("button",{onClick:()=>C(!1),className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(ue,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"p-4 overflow-y-auto h-full",children:[r.find(a=>a.id===h)?.type==="core/image"&&e.jsx(ks,{settings:r.find(a=>a.id===h)?.content||{},onChange:a=>{const S=r.map(i=>i.id===h?{...i,content:{...i.content,...a}}:i);y(S)}}),r.find(a=>a.id===h)?.type==="core/gallery"&&e.jsx(Cs,{settings:r.find(a=>a.id===h)?.content||{},onChange:a=>{const S=r.map(i=>i.id===h?{...i,content:{...i.content,...a}}:i);y(S)}}),r.find(a=>a.id===h)?.type==="core/cover"&&e.jsx(Ss,{settings:r.find(a=>a.id===h)?.content||{},onChange:a=>{const S=r.map(i=>i.id===h?{...i,content:{...i.content,...a}}:i);y(S)}}),r.find(a=>a.id===h)?.type==="core/button"&&e.jsx(Ts,{settings:r.find(a=>a.id===h)?.content||{},onChange:a=>{const S=r.map(i=>i.id===h?{...i,content:{...i.content,...a}}:i);y(S)}})]})]})]})},ee=l.createContext(null),Ze=({open:s,defaultOpen:t=!1,onOpenChange:n,children:o})=>{const[r,d]=l.useState(t),f=s??r,p=h=>{s===void 0&&d(h),n?.(h)};return e.jsx(ee.Provider,{value:{open:f,onOpenChange:p},children:o})},Is=l.forwardRef(({onClick:s,...t},n)=>{const o=l.useContext(ee);if(!o)throw new Error("DialogTrigger must be used within Dialog");return e.jsx("button",{ref:n,onClick:r=>{s?.(r),o.onOpenChange(!0)},...t})}),et=({children:s})=>{const t=l.useContext(ee);if(!t)throw new Error("DialogPortal must be used within Dialog");return t.open?e.jsx(e.Fragment,{children:s}):null},tt=l.forwardRef(({onClick:s,...t},n)=>{const o=l.useContext(ee);if(!o)throw new Error("DialogClose must be used within Dialog");return e.jsx("button",{ref:n,onClick:r=>{s?.(r),o.onOpenChange(!1)},...t})}),st=l.forwardRef(({className:s,onClick:t,...n},o)=>{const r=l.useContext(ee);if(!r)throw new Error("DialogOverlay must be used within Dialog");return e.jsx("div",{ref:o,className:B("fixed inset-0 z-[100000] bg-black/80",s),onClick:d=>{t?.(d),d.target===d.currentTarget&&r.onOpenChange(!1)},...n})}),at=l.forwardRef(({className:s,children:t,...n},o)=>{const r=l.useContext(ee);if(!r)throw new Error("DialogContent must be used within Dialog");return l.useEffect(()=>{if(r.open){const d=f=>{f.key==="Escape"&&r.onOpenChange(!1)};return document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)}},[r]),e.jsxs(et,{children:[e.jsx(st,{}),e.jsxs("div",{ref:o,className:B("fixed left-[50%] top-[50%] z-[100001] grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg sm:rounded-lg",s),...n,children:[t,e.jsxs(tt,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[e.jsx(ue,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}),rt=({className:s,...t})=>e.jsx("div",{className:B("flex flex-col space-y-1.5 text-center sm:text-left",s),...t}),nt=({className:s,...t})=>e.jsx("div",{className:B("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t}),ot=l.forwardRef(({className:s,...t},n)=>e.jsx("h2",{ref:n,className:B("text-lg font-semibold leading-none tracking-tight",s),...t})),lt=l.forwardRef(({className:s,...t},n)=>e.jsx("p",{ref:n,className:B("text-sm text-muted-foreground",s),...t}));Ze.displayName="Dialog";Is.displayName="DialogTrigger";et.displayName="DialogPortal";tt.displayName="DialogClose";st.displayName="DialogOverlay";at.displayName="DialogContent";rt.displayName="DialogHeader";nt.displayName="DialogFooter";ot.displayName="DialogTitle";lt.displayName="DialogDescription";const Ls=l.forwardRef(({className:s,value:t=0,max:n=100,...o},r)=>{const d=Math.min(Math.max(0,t/n*100),100);return e.jsx("div",{ref:r,role:"progressbar","aria-valuemin":0,"aria-valuemax":n,"aria-valuenow":t,className:B("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...o,children:e.jsx("div",{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-d}%)`}})})});Ls.displayName="Progress";const Ms=me("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),ke=l.forwardRef(({className:s,variant:t,...n},o)=>e.jsx("div",{ref:o,role:"alert",className:B(Ms({variant:t}),s),...n}));ke.displayName="Alert";const As=l.forwardRef(({className:s,...t},n)=>e.jsx("h5",{ref:n,className:B("mb-1 font-medium leading-none tracking-tight",s),...t}));As.displayName="AlertTitle";const Ce=l.forwardRef(({className:s,...t},n)=>e.jsx("div",{ref:n,className:B("text-sm [&_p]:leading-relaxed",s),...t}));Ce.displayName="AlertDescription";const _s=({onInsertBlock:s,onEditBlock:t,onCreateNew:n,compact:o=!1})=>{const[r,d]=l.useState([]),[f,p]=l.useState(!0),[h,x]=l.useState(""),[v,b]=l.useState("all"),[c,u]=l.useState("grid"),[m,j]=l.useState([]),[w,C]=l.useState(1),[R,L]=l.useState(1),$=async(a=1,S="",i="all")=>{p(!0);try{const N=new URLSearchParams({page:a.toString(),per_page:o?"8":"12",search:S,status:"active",order:"DESC",orderby:"usageCount"});i!=="all"&&N.append("category",i);const M=await fetch(`/api/reusable-blocks?${N}`,{credentials:"include"});if(!M.ok)throw new Error("Failed to fetch blocks");const A=await M.json(),T=parseInt(M.headers.get("X-WP-TotalPages")||"1");d(A),L(T)}catch{}finally{p(!1)}},y=async()=>{try{const a=await fetch("/api/reusable-blocks/categories",{credentials:"include"});if(a.ok){const S=await a.json();j(S)}}catch{}};l.useEffect(()=>{$(w,h,v)},[w,h,v]),l.useEffect(()=>{y()},[]);const P=a=>{s&&s(a)},g=async a=>{try{(await fetch(`/api/reusable-blocks/${a}/duplicate`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({})})).ok&&$(w,h,v)}catch{}},k=async a=>{if(confirm("Are you sure you want to delete this reusable block?"))try{(await fetch(`/api/reusable-blocks/${a}`,{method:"DELETE",credentials:"include"})).ok&&$(w,h,v)}catch{}},_=a=>e.jsxs(W,{className:"group relative overflow-hidden",children:[e.jsxs("div",{className:"aspect-video bg-gray-50 border-b overflow-hidden",children:[a.preview?.screenshot?e.jsx("img",{src:a.preview.screenshot,alt:a.title,className:"w-full h-full object-cover"}):a.preview?.html?e.jsx("div",{className:"w-full h-full p-2 text-xs overflow-hidden",dangerouslySetInnerHTML:{__html:a.preview.html}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:e.jsx(G,{className:"h-8 w-8"})}),e.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[e.jsx(E,{size:"sm",onClick:()=>P(a),className:"bg-blue-600 hover:bg-blue-700",children:"Insert"}),a.isEditable&&t&&e.jsx(E,{size:"sm",variant:"outline",onClick:()=>t(a.id),children:e.jsx(ge,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsx("h3",{className:"font-medium text-sm line-clamp-2",children:a.title}),e.jsxs(be,{children:[e.jsx(ie,{children:e.jsx(E,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 opacity-0 group-hover:opacity-100",children:"•••"})}),e.jsxs(ce,{align:"end",children:[e.jsxs(H,{onClick:()=>P(a),children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Insert Block"]}),e.jsxs(H,{onClick:()=>g(a.id),children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"Duplicate"]}),a.isEditable&&t&&e.jsxs(H,{onClick:()=>t(a.id),children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Edit"]}),a.author.id==="current-user-id"&&e.jsxs(H,{onClick:()=>k(a.id),className:"text-red-600",children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]}),a.description&&e.jsx("p",{className:"text-xs text-gray-600 mb-2 line-clamp-2",children:a.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[a.category&&e.jsx(V,{variant:"secondary",className:"text-xs",children:a.category}),a.isGlobal&&e.jsxs(V,{variant:"outline",className:"text-xs",children:[e.jsx(de,{className:"h-3 w-3 mr-1"}),"Global"]})]}),e.jsxs("span",{children:[a.usageCount," uses"]})]}),a.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[a.tags.slice(0,3).map(S=>e.jsx(V,{variant:"outline",className:"text-xs",children:S},S)),a.tags.length>3&&e.jsxs(V,{variant:"outline",className:"text-xs",children:["+",a.tags.length-3]})]})]})]},a.id),O=a=>e.jsx(W,{className:"p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-12 bg-gray-100 rounded border overflow-hidden flex-shrink-0",children:a.preview?.screenshot?e.jsx("img",{src:a.preview.screenshot,alt:a.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:e.jsx(G,{className:"h-4 w-4"})})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"font-medium text-sm truncate",children:a.title}),a.description&&e.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-1",children:a.description}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.category&&e.jsx(V,{variant:"secondary",className:"text-xs",children:a.category}),e.jsxs("span",{className:"text-xs text-gray-500",children:[a.usageCount," uses"]}),e.jsxs("span",{className:"text-xs text-gray-500",children:["by ",a.author.name]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(E,{size:"sm",onClick:()=>P(a),children:"Insert"}),e.jsxs(be,{children:[e.jsx(ie,{children:e.jsx(E,{variant:"ghost",size:"sm",children:"•••"})}),e.jsxs(ce,{align:"end",children:[e.jsxs(H,{onClick:()=>g(a.id),children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"Duplicate"]}),a.isEditable&&t&&e.jsxs(H,{onClick:()=>t(a.id),children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Edit"]}),a.author.id==="current-user-id"&&e.jsxs(H,{onClick:()=>k(a.id),className:"text-red-600",children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]})]})})]})},a.id);return o?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(re,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx(U,{placeholder:"Search reusable blocks...",value:h,onChange:a=>x(a.target.value),className:"pl-10"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:f?Array.from({length:4}).map((a,S)=>e.jsx("div",{className:"aspect-video bg-gray-100 rounded animate-pulse"},S)):r.length===0?e.jsx("div",{className:"col-span-2 text-center py-8 text-gray-500",children:"No reusable blocks found"}):r.map(_)}),n&&e.jsxs(E,{onClick:n,className:"w-full",variant:"outline",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Create New Block"]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Reusable Blocks"}),e.jsx("p",{className:"text-gray-600",children:"Browse and manage your reusable block library"})]}),n&&e.jsxs(E,{onClick:n,children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Create New Block"]})]}),e.jsx(W,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsxs("div",{className:"relative",children:[e.jsx(re,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx(U,{placeholder:"Search reusable blocks...",value:h,onChange:a=>x(a.target.value),className:"pl-10 w-64"})]}),e.jsxs(be,{children:[e.jsx(ie,{children:e.jsxs(E,{variant:"outline",children:["Category: ",v==="all"?"All":v]})}),e.jsxs(ce,{children:[e.jsx(H,{onClick:()=>b("all"),children:"All Categories"}),m.map(a=>e.jsx(H,{onClick:()=>b(a),children:a},a))]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{variant:c==="grid"?"default":"outline",size:"sm",onClick:()=>u("grid"),children:e.jsx(G,{className:"h-4 w-4"})}),e.jsx(E,{variant:c==="list"?"default":"outline",size:"sm",onClick:()=>u("list"),children:e.jsx(K,{className:"h-4 w-4"})})]})]})}),e.jsxs(Be,{defaultValue:"all",className:"space-y-4",children:[e.jsxs(Pe,{children:[e.jsx(Y,{value:"all",children:"All Blocks"}),e.jsx(Y,{value:"mine",children:"My Blocks"}),e.jsx(Y,{value:"global",children:"Global Blocks"})]}),e.jsxs(ae,{value:"all",className:"space-y-4",children:[f?e.jsx("div",{className:`grid ${c==="grid"?"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4":"gap-3"}`,children:Array.from({length:8}).map((a,S)=>e.jsx("div",{className:c==="grid"?"aspect-video bg-gray-100 rounded animate-pulse":"h-20 bg-gray-100 rounded animate-pulse"},S))}):r.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(G,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"No reusable blocks found"}),n&&e.jsxs(E,{onClick:n,children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Create Your First Block"]})]}):e.jsx("div",{className:c==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4":"space-y-3",children:c==="grid"?r.map(_):r.map(O)}),R>1&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Page ",w," of ",R]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{variant:"outline",disabled:w===1,onClick:()=>C(w-1),children:"Previous"}),e.jsx(E,{variant:"outline",disabled:w===R,onClick:()=>C(w+1),children:"Next"})]})]})]}),e.jsx(ae,{value:"mine",children:e.jsx("p",{className:"text-gray-500",children:"Your personal reusable blocks"})}),e.jsx(ae,{value:"global",children:e.jsx("p",{className:"text-gray-500",children:"Blocks shared across the organization"})})]})]})},it=()=>{const[s,t]=l.useState(!1),[n,o]=l.useState(null),r=l.useCallback(async b=>{t(!0),o(null);try{const c=await fetch("/api/reusable-blocks",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(b)});if(!c.ok){const m=await c.json();throw new Error(m.error||"Failed to save reusable block")}return await c.json()}catch(c){const u=c instanceof Error?c.message:"Unknown error occurred";return o(u),null}finally{t(!1)}},[]),d=l.useCallback(async b=>{t(!0),o(null);try{const c=await fetch(`/api/reusable-blocks/${b}`,{credentials:"include"});if(!c.ok){const j=await c.json();throw new Error(j.error||"Failed to fetch reusable block")}const u=await c.json();return Array.isArray(u.content)?u.content:Xe(u.content)}catch(c){const u=c instanceof Error?c.message:"Unknown error occurred";return o(u),null}finally{t(!1)}},[]),f=l.useCallback(async b=>{t(!0),o(null);try{const c=await fetch(`/api/reusable-blocks/${b}/duplicate`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({})});if(!c.ok){const m=await c.json();throw new Error(m.error||"Failed to duplicate reusable block")}return await c.json()}catch(c){const u=c instanceof Error?c.message:"Unknown error occurred";return o(u),null}finally{t(!1)}},[]),p=l.useCallback(async b=>{t(!0),o(null);try{const c=await fetch(`/api/reusable-blocks/${b}`,{method:"DELETE",credentials:"include"});if(!c.ok){const u=await c.json();throw new Error(u.error||"Failed to delete reusable block")}return!0}catch(c){const u=c instanceof Error?c.message:"Unknown error occurred";return o(u),!1}finally{t(!1)}},[]),h=l.useCallback(async(b,c)=>{t(!0),o(null);try{const u=await fetch(`/api/reusable-blocks/${b}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(c)});if(!u.ok){const j=await u.json();throw new Error(j.error||"Failed to update reusable block")}return await u.json()}catch(u){const m=u instanceof Error?u.message:"Unknown error occurred";return o(m),null}finally{t(!1)}},[]),x=l.useCallback(b=>{const c=b.map(w=>w.name||"unknown").join(", "),u=`Reusable Block (${c})`,m=w=>w.map(C=>C.attributes?.content?C.attributes.content.replace(/<[^>]*>/g,""):C.innerBlocks?.length?m(C.innerBlocks):"").filter(Boolean).join(" ").slice(0,200),j=m(b);return{title:u,description:j||void 0,content:b,category:"general",tags:[],visibility:"private",isGlobal:!1,metadata:{version:"1.0.0",compatibility:["wordpress-6.0+"],keywords:c.split(", "),difficulty:"beginner"}}},[]),v=l.useCallback(b=>{const c=[];return(!b.title||b.title.trim().length===0)&&c.push("Title is required"),b.title&&b.title.length>255&&c.push("Title must be less than 255 characters"),(!b.content||!Array.isArray(b.content)||b.content.length===0)&&c.push("Block content is required"),b.description&&b.description.length>1e3&&c.push("Description must be less than 1000 characters"),b.category&&b.category.length>100&&c.push("Category must be less than 100 characters"),b.tags&&b.tags.length>10&&c.push("Maximum 10 tags allowed"),b.tags&&b.tags.filter(m=>m.length>50).length>0&&c.push("Each tag must be less than 50 characters"),b.visibility&&!["private","public","organization"].includes(b.visibility)&&c.push("Invalid visibility setting"),{valid:c.length===0,errors:c}},[]);return{loading:s,error:n,saveAsReusableBlock:r,insertReusableBlock:d,duplicateReusableBlock:f,deleteReusableBlock:p,updateReusableBlock:h,convertBlocksToReusable:x,validateBlockData:v}},zs=({isOpen:s,onClose:t,selectedBlocks:n,onSaved:o})=>{const{saveAsReusableBlock:r,convertBlocksToReusable:d,validateBlockData:f,loading:p,error:h}=it(),[x,v]=l.useState({title:"",description:"",category:"",tags:[],visibility:"private",isGlobal:!1}),[b,c]=l.useState(""),[u,m]=l.useState([]),[j,w]=l.useState([]);l.useEffect(()=>{if(s&&n.length>0){const y=d(n);v({title:y.title,description:y.description||"",category:y.category||"",tags:y.tags||[],visibility:y.visibility||"private",isGlobal:y.isGlobal||!1})}},[s,n,d]),l.useEffect(()=>{s&&(async()=>{try{const P=await fetch("/api/reusable-blocks/categories",{credentials:"include"});if(P.ok){const g=await P.json();w(g)}}catch{}})()},[s]);const C=async()=>{const y={title:x.title,description:x.description||void 0,content:n,category:x.category||void 0,tags:x.tags,visibility:x.visibility,isGlobal:x.isGlobal,metadata:{version:"1.0.0",compatibility:["wordpress-6.0+"],keywords:x.tags,difficulty:"beginner"}},P=f(y);if(!P.valid){m(P.errors);return}m([]);try{const g=await r(y);g&&(o?.(g),t(),v({title:"",description:"",category:"",tags:[],visibility:"private",isGlobal:!1}))}catch{}},R=()=>{const y=b.trim();y&&!x.tags.includes(y)&&x.tags.length<10&&(v(P=>({...P,tags:[...P.tags,y]})),c(""))},L=y=>{v(P=>({...P,tags:P.tags.filter(g=>g!==y)}))},$=y=>{y.key==="Enter"&&(y.preventDefault(),R())};return e.jsx(Ze,{open:s,onOpenChange:t,children:e.jsxs(at,{className:"sm:max-w-md",children:[e.jsxs(rt,{children:[e.jsx(ot,{children:"Save as Reusable Block"}),e.jsx(lt,{children:"Save the selected blocks as a reusable block that can be used across your site."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(D,{htmlFor:"title",children:"Title *"}),e.jsx(U,{id:"title",value:x.title,onChange:y=>v(P=>({...P,title:y.target.value})),placeholder:"Enter block title...",maxLength:255})]}),e.jsxs("div",{children:[e.jsx(D,{htmlFor:"description",children:"Description"}),e.jsx(he,{id:"description",value:x.description,onChange:y=>v(P=>({...P,description:y.target.value})),placeholder:"Describe what this block does...",rows:3,maxLength:1e3}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[x.description.length,"/1000 characters"]})]}),e.jsxs("div",{children:[e.jsx(D,{htmlFor:"category",children:"Category"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_e,{value:x.category,onValueChange:y=>v(P=>({...P,category:y})),children:[e.jsx(we,{className:"flex-1",children:e.jsx(ze,{placeholder:"Select or create category..."})}),e.jsxs(Ne,{children:[e.jsx(q,{value:"general",children:"General"}),e.jsx(q,{value:"layout",children:"Layout"}),e.jsx(q,{value:"content",children:"Content"}),e.jsx(q,{value:"media",children:"Media"}),e.jsx(q,{value:"widgets",children:"Widgets"}),j.map(y=>e.jsx(q,{value:y,children:y},y))]})]}),e.jsx(U,{placeholder:"Or type new category",value:x.category,onChange:y=>v(P=>({...P,category:y.target.value})),className:"flex-1",maxLength:100})]})]}),e.jsxs("div",{children:[e.jsx(D,{children:"Tags"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(U,{placeholder:"Add tags...",value:b,onChange:y=>c(y.target.value),onKeyPress:$,maxLength:50,disabled:x.tags.length>=10}),e.jsx(E,{type:"button",variant:"outline",size:"sm",onClick:R,disabled:!b.trim()||x.tags.includes(b.trim())||x.tags.length>=10,children:e.jsx(Q,{className:"h-4 w-4"})})]}),x.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:x.tags.map(y=>e.jsxs(V,{variant:"secondary",className:"flex items-center gap-1",children:[y,e.jsx("button",{type:"button",onClick:()=>L(y),className:"ml-1 text-gray-500 hover:text-red-500",children:e.jsx(ue,{className:"h-3 w-3"})})]},y))}),e.jsxs("div",{className:"text-xs text-gray-500",children:[x.tags.length,"/10 tags"]})]})]}),e.jsxs("div",{children:[e.jsx(D,{htmlFor:"visibility",children:"Visibility"}),e.jsxs(_e,{value:x.visibility,onValueChange:y=>v(P=>({...P,visibility:y})),children:[e.jsx(we,{children:e.jsx(ze,{})}),e.jsxs(Ne,{children:[e.jsx(q,{value:"private",children:"Private (Only me)"}),e.jsx(q,{value:"organization",children:"Organization (Team members)"}),e.jsx(q,{value:"public",children:"Public (Everyone)"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-md",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Blocks to save:"})," ",n.length," block",n.length!==1?"s":""]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:n.map(y=>y.name||"unknown").join(", ")})]}),(u.length>0||h)&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:e.jsxs("div",{className:"text-sm text-red-800",children:[h&&e.jsx("div",{className:"mb-2",children:h}),u.map((y,P)=>e.jsxs("div",{children:["• ",y]},P))]})})]}),e.jsxs(nt,{children:[e.jsx(E,{variant:"outline",onClick:t,disabled:p,children:"Cancel"}),e.jsx(E,{onClick:C,disabled:p||!x.title.trim(),children:p?"Saving...":"Save Block"})]})]})})},ct=l.forwardRef(({className:s,children:t,orientation:n="vertical",...o},r)=>e.jsx("div",{ref:r,className:B("relative overflow-auto",{"overflow-y-auto overflow-x-hidden":n==="vertical","overflow-x-auto overflow-y-hidden":n==="horizontal","overflow-auto":n==="both"},"scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100","hover:scrollbar-thumb-gray-400",s),...o,children:t}));ct.displayName="ScrollArea";function F({className:s,...t}){return e.jsx("div",{className:B("animate-pulse rounded-md bg-gray-200",s),...t})}const Fs=({onInsertPattern:s,onPreviewPattern:t,compact:n=!1,selectedCategory:o="all"})=>{const[r,d]=l.useState([]),[f,p]=l.useState([]),[h,x]=l.useState(!0),[v,b]=l.useState(""),[c,u]=l.useState(o),[m,j]=l.useState("grid"),[w,C]=l.useState(1),[R,L]=l.useState(1),[$,y]=l.useState(null),P=async(i=1,N="",M="all")=>{x(!0);try{const A=new URLSearchParams({page:i.toString(),per_page:n?"12":"24",search:N,orderby:"featured",order:"DESC"});M!=="all"&&A.append("category",M);const T=await fetch(`/api/block-patterns?${A}`);if(!T.ok)throw new Error("Failed to fetch patterns");const z=await T.json(),J=parseInt(T.headers.get("X-WP-TotalPages")||"1");d(z),L(J)}catch{}finally{x(!1)}},g=async()=>{try{const i=await fetch("/api/block-patterns/categories");if(i.ok){const N=await i.json();p(N)}}catch{}};l.useEffect(()=>{g()},[]),l.useEffect(()=>{P(w,v,c)},[w,v,c]);const k=i=>{s&&s(i)},_=i=>{t&&t(i)},O=i=>e.jsxs(W,{className:`group relative overflow-hidden cursor-pointer transition-all ${$===i.id?"ring-2 ring-blue-500":""}`,onMouseEnter:()=>y(i.id),onMouseLeave:()=>y(null),onClick:()=>k(i),children:[e.jsxs("div",{className:"aspect-[4/3] bg-gray-50 border-b overflow-hidden relative",children:[i.preview?.screenshot?e.jsx("img",{src:i.preview.screenshot,alt:i.title,className:"w-full h-full object-cover"}):i.preview?.html?e.jsx("div",{className:"w-full h-full p-4 overflow-hidden",children:e.jsx("div",{className:"transform scale-50 origin-top-left w-[200%] h-[200%]",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:i.preview.html}})})}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(te,{className:"h-12 w-12 text-gray-300"})}),e.jsxs("div",{className:"absolute top-2 left-2 flex gap-1",children:[i.featured&&e.jsxs(V,{className:"bg-yellow-500 text-white",children:[e.jsx(de,{className:"h-3 w-3 mr-1 fill-current"}),"Featured"]}),i.isPremium&&e.jsx(V,{className:"bg-purple-500 text-white",children:"Pro"}),i.source==="core"&&e.jsx(V,{variant:"secondary",children:"Core"})]}),e.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[e.jsx(E,{size:"sm",onClick:N=>{N.stopPropagation(),k(i)},className:"bg-blue-600 hover:bg-blue-700",children:"Insert Pattern"}),t&&e.jsx(E,{size:"sm",variant:"outline",onClick:N=>{N.stopPropagation(),_(i)},className:"text-white border-white hover:bg-white/20",children:e.jsx(Ee,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-medium text-sm mb-1",children:i.title}),i.description&&e.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:i.description}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{variant:"outline",className:"text-xs",children:f.find(N=>N.id===i.category)?.name||i.category}),i.usageCount>0&&e.jsxs("span",{className:"text-xs text-gray-500",children:[i.usageCount," uses"]})]}),e.jsxs("span",{className:"text-xs text-gray-400",children:["by ",i.author.name]})]}),i.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:i.tags.slice(0,3).map(N=>e.jsxs("span",{className:"text-xs text-gray-500",children:["#",N]},N))})]})]},i.id),a=i=>e.jsx(W,{className:"p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>k(i),children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-20 h-16 bg-gray-100 rounded border overflow-hidden flex-shrink-0",children:i.preview?.screenshot?e.jsx("img",{src:i.preview.screenshot,alt:i.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(te,{className:"h-6 w-6 text-gray-400"})})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("h3",{className:"font-medium text-sm flex items-center gap-2",children:[i.title,i.featured&&e.jsx(de,{className:"h-3 w-3 text-yellow-500 fill-current"}),i.isPremium&&e.jsx(V,{className:"text-xs bg-purple-500 text-white",children:"Pro"})]}),i.description&&e.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-1",children:i.description}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx(V,{variant:"outline",className:"text-xs",children:f.find(N=>N.id===i.category)?.name||i.category}),e.jsxs("span",{className:"text-xs text-gray-500",children:[i.usageCount," uses"]}),e.jsxs("span",{className:"text-xs text-gray-500",children:["by ",i.author.name]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(E,{size:"sm",onClick:N=>{N.stopPropagation(),k(i)},children:"Insert"}),t&&e.jsx(E,{size:"sm",variant:"ghost",onClick:N=>{N.stopPropagation(),_(i)},children:e.jsx(Ee,{className:"h-4 w-4"})})]})]})})]})},i.id),S=()=>e.jsx("div",{className:m==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4":"space-y-3",children:Array.from({length:6}).map((i,N)=>e.jsxs(W,{className:"overflow-hidden",children:[e.jsx(F,{className:m==="grid"?"h-48":"h-20"}),e.jsxs("div",{className:"p-4 space-y-2",children:[e.jsx(F,{className:"h-4 w-3/4"}),e.jsx(F,{className:"h-3 w-full"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{className:"h-5 w-16"}),e.jsx(F,{className:"h-5 w-16"})]})]})]},N))});return n?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(re,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx(U,{placeholder:"Search patterns...",value:v,onChange:i=>b(i.target.value),className:"pl-10"})]}),e.jsx(ct,{className:"w-full",children:e.jsxs("div",{className:"flex gap-2 pb-2",children:[e.jsx(E,{variant:c==="all"?"default":"outline",size:"sm",onClick:()=>u("all"),children:"All"}),f.map(i=>e.jsxs(E,{variant:c===i.id?"default":"outline",size:"sm",onClick:()=>u(i.id),children:[i.name," (",i.count,")"]},i.id))]})}),e.jsx("div",{className:"space-y-3",children:h?S():r.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(te,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No patterns found"})]}):e.jsx("div",{className:"grid grid-cols-2 gap-3",children:r.slice(0,6).map(O)})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Block Patterns"}),e.jsx("p",{className:"text-gray-600",children:"Pre-designed block layouts to speed up your workflow"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{variant:m==="grid"?"default":"outline",size:"sm",onClick:()=>j("grid"),children:e.jsx(G,{className:"h-4 w-4"})}),e.jsx(E,{variant:m==="list"?"default":"outline",size:"sm",onClick:()=>j("list"),children:e.jsx(K,{className:"h-4 w-4"})})]})]}),e.jsx(W,{className:"p-4",children:e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(re,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx(U,{placeholder:"Search patterns...",value:v,onChange:i=>b(i.target.value),className:"pl-10"})]})})}),e.jsxs(Be,{value:c,onValueChange:u,children:[e.jsxs(Pe,{className:"w-full justify-start overflow-x-auto",children:[e.jsxs(Y,{value:"all",children:["All Patterns",f.length>0&&e.jsxs("span",{className:"ml-2 text-xs",children:["(",f.reduce((i,N)=>i+N.count,0),")"]})]}),f.map(i=>e.jsxs(Y,{value:i.id,children:[i.name,e.jsxs("span",{className:"ml-2 text-xs",children:["(",i.count,")"]})]},i.id))]}),e.jsx(ae,{value:c,className:"mt-6",children:h?S():r.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx(te,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No patterns found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your search or filter criteria"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:m==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4":"space-y-3",children:m==="grid"?r.map(O):r.map(a)}),R>1&&e.jsxs("div",{className:"flex items-center justify-between mt-8",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Page ",w," of ",R]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{variant:"outline",disabled:w===1,onClick:()=>C(w-1),children:"Previous"}),e.jsx(E,{variant:"outline",disabled:w===R,onClick:()=>C(w+1),children:"Next"})]})]})]})})]})]})},Us=()=>`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,dt=s=>s.map(t=>({name:t.name,attributes:t.attributes,innerBlocks:t.innerBlocks?dt(t.innerBlocks):void 0,innerHTML:t.innerHTML})),Fe=s=>{const t=n=>{const o={name:n.name,attributes:n.attributes||{},innerBlocks:[],innerHTML:n.innerHTML||""};return n.innerBlocks&&n.innerBlocks.length>0&&(o.innerBlocks=n.innerBlocks.map(t)),o.clientId=Us(),o};return s.content.map(t)},$s=()=>{const[s,t]=l.useState(!1),[n,o]=l.useState(null),r=l.useCallback(async c=>{t(!0),o(null);try{const u=await fetch(`/api/block-patterns/${c}`);if(!u.ok){const w=await u.json();throw new Error(w.error||"Failed to fetch block pattern")}const m=await u.json();return Fe(m)}catch(u){const m=u instanceof Error?u.message:"Unknown error occurred";return o(m),null}finally{t(!1)}},[]),d=l.useCallback(async c=>{t(!0),o(null);try{const u=await fetch("/api/block-patterns",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(c)});if(!u.ok){const j=await u.json();throw new Error(j.error||"Failed to create block pattern")}return await u.json()}catch(u){const m=u instanceof Error?u.message:"Unknown error occurred";return o(m),null}finally{t(!1)}},[]),f=l.useCallback(async c=>{t(!0),o(null);try{const u=await fetch(`/api/block-patterns/${c}/duplicate`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({})});if(!u.ok){const j=await u.json();throw new Error(j.error||"Failed to duplicate block pattern")}return await u.json()}catch(u){const m=u instanceof Error?u.message:"Unknown error occurred";return o(m),null}finally{t(!1)}},[]),p=l.useCallback(async c=>{t(!0),o(null);try{const u=await fetch(`/api/block-patterns/${c}`,{method:"DELETE",credentials:"include"});if(!u.ok){const m=await u.json();throw new Error(m.error||"Failed to delete block pattern")}return!0}catch(u){const m=u instanceof Error?u.message:"Unknown error occurred";return o(m),!1}finally{t(!1)}},[]),h=l.useCallback(async(c,u)=>{t(!0),o(null);try{const m=await fetch(`/api/block-patterns/${c}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(u)});if(!m.ok){const w=await m.json();throw new Error(w.error||"Failed to update block pattern")}return await m.json()}catch(m){const j=m instanceof Error?m.message:"Unknown error occurred";return o(j),null}finally{t(!1)}},[]),x=l.useCallback(c=>{const u=c.map(C=>({name:C.name,attributes:C.attributes,innerBlocks:C.innerBlocks?dt(C.innerBlocks):void 0,innerHTML:C.innerHTML})),m=c.map(C=>C.name);let j="general";return m.includes("core/navigation")||m.includes("core/site-logo")?j="header":m.includes("core/heading")&&m.includes("core/buttons")?j="hero":m.includes("core/columns")&&m.length>3?j="features":(m.includes("core/quote")||m.includes("core/testimonial"))&&(j="testimonials"),{title:`Custom ${j.charAt(0).toUpperCase()+j.slice(1)} Pattern`,description:`A custom ${j} pattern created from selected blocks`,content:u,category:j,tags:[],visibility:"private",metadata:{blockTypes:m,createdFrom:"editor"}}},[]),v=l.useCallback((c,u)=>!c.dependencies||c.dependencies.length===0?!0:(c.metadata?.blockTypes||[]).every(j=>u.includes(j)),[]),b=l.useCallback((c,u)=>{if(c.colorScheme&&c.colorScheme.length>0&&c.colorScheme.forEach((m,j)=>{u.style.setProperty(`--pattern-color-${j+1}`,m)}),c.typography&&(c.typography.fontFamily&&(u.style.fontFamily=c.typography.fontFamily),c.typography.fontSize&&(u.style.fontSize=c.typography.fontSize),c.typography.lineHeight&&(u.style.lineHeight=c.typography.lineHeight),c.typography.fontWeight&&(u.style.fontWeight=c.typography.fontWeight)),c.preview?.css){const m=document.createElement("style");m.textContent=c.preview.css,u.appendChild(m)}},[]);return{loading:s,error:n,insertBlockPattern:r,createBlockPattern:d,duplicateBlockPattern:f,deleteBlockPattern:p,updateBlockPattern:h,convertBlocksToPattern:x,transformPatternToBlocks:Fe,validatePatternCompatibility:v,applyPatternStyles:b}},Os=`
  /* Group Block Styles */
  .o4o-group-block {
    box-sizing: border-box;
  }
  
  .o4o-group-block.flex {
    display: flex;
  }
  
  .o4o-group-block.grid {
    display: grid;
  }
  
  /* Columns Block Styles */
  .o4o-columns-block {
    display: flex;
    width: 100%;
    box-sizing: border-box;
  }
  
  .o4o-column-block {
    box-sizing: border-box;
    flex-grow: 0;
    flex-shrink: 0;
  }
  
  @media (max-width: 768px) {
    .o4o-columns-block.stack-on-mobile {
      flex-direction: column !important;
    }
    
    .o4o-columns-block.stack-on-mobile .o4o-column-block {
      flex-basis: 100% !important;
      margin-bottom: 20px;
    }
  }
  
  /* Cover Block Styles */
  .o4o-cover-block {
    position: relative;
    overflow: hidden;
    box-sizing: border-box;
  }
  
  .o4o-cover-block.is-dark {
    color: #ffffff;
  }
  
  .o4o-cover-block.is-light {
    color: #000000;
  }
  
  .o4o-cover-block__overlay {
    transition: opacity 0.3s ease;
  }
  
  .o4o-cover-block__content {
    text-align: center;
  }
  
  /* InnerBlocks Styles */
  .block-editor-inner-blocks {
    height: 100%;
  }
  
  .block-editor-inner-blocks .block-editor-block-list__layout {
    height: 100%;
  }
  
  /* Block Appender Styles */
  .block-list-appender {
    margin-top: 20px;
  }
  
  .block-editor-button-block-appender {
    width: 100%;
    justify-content: center;
    padding: 12px;
    border: 2px dashed #ddd;
    color: #555;
    transition: all 0.2s ease;
  }
  
  .block-editor-button-block-appender:hover {
    border-color: #007cba;
    color: #007cba;
    background-color: rgba(0, 124, 186, 0.04);
  }
`;function Vs(){(window.wp?.domReady||(t=>{document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t):t()}))(()=>{const t=document.createElement("style");t.textContent=Os,document.head.appendChild(t)})}const ut={"o4o/group":()=>pe(()=>import("./index-CrpOq9wV.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])),"o4o/columns":()=>pe(()=>import("./index-DNjFcNVa.js"),__vite__mapDeps([9,1,2,3,4,5,6,7,8])),"o4o/cover":()=>pe(()=>import("./index-DiDgbLNG.js"),__vite__mapDeps([10,1,2,3,4,5,6,7,8,11]))},Ue=new Set;async function mt(s){if(Ue.has(s))return;const t=ut[s];if(t)try{await t(),Ue.add(s)}catch{}}async function Hs(s){const t=/<!-- wp:(\S+)/g,n=new Set;let o;for(;(o=t.exec(s))!==null;)n.add(o[1]);const r=Array.from(n).map(d=>mt(d));await Promise.all(r)}function qs(){if(typeof window<"u"&&window.wp?.data){const{subscribe:s}=window.wp.data;if(!s)return;let t=new Set;s(()=>{const n=window.wp?.data?.select;if(!n)return;const o=n("core/block-editor")?.getBlocks;if(!o)return;const r=o();if(!r)return;const d=new Set,f=p=>{p.forEach(h=>{d.add(h.name),h.innerBlocks?.length>0&&f(h.innerBlocks)})};f(r),d.forEach(p=>{!t.has(p)&&ut[p]&&mt(p)}),t=d})}}function Gs(s={}){const{enableMonitoring:t=!0,warnThreshold:n={blockCount:100,renderTime:100,memoryUsage:50*1024*1024,fps:30},onPerformanceIssue:o}=s,[r,d]=l.useState({blockCount:0,renderTime:0,memoryUsage:0,fps:60,lagSpikes:0}),f=l.useRef(0),p=l.useRef(performance.now()),h=l.useRef([]),x=l.useRef(void 0),v=l.useCallback(()=>{const m=performance.now(),j=m-p.current;if(j>0){const w=1e3/j;h.current.push(w),h.current.length>60&&h.current.shift();const C=h.current.reduce((R,L)=>R+L,0)/h.current.length;j>33&&d(R=>({...R,lagSpikes:R.lagSpikes+1})),d(R=>({...R,fps:Math.round(C)}))}p.current=m,f.current++,t&&(x.current=requestAnimationFrame(v))},[t]),b=l.useCallback(async()=>{if("memory"in performance&&performance.memory){const m=performance.memory;d(j=>({...j,memoryUsage:m.usedJSHeapSize}))}},[]),c=l.useCallback(()=>{if(typeof window<"u"&&window.wp?.data){const{getBlocks:m}=window.wp.data.select("core/block-editor"),j=m();if(j){let w=0;const C=R=>{R.forEach(L=>{w++,L.innerBlocks?.length>0&&C(L.innerBlocks)})};C(j),d(R=>({...R,blockCount:w}))}}},[]),u=l.useCallback(m=>{const j=performance.now();m(),requestAnimationFrame(()=>{const w=performance.now()-j;d(C=>({...C,renderTime:w}))})},[]);return l.useEffect(()=>{if(!t)return;const m=[];n.blockCount&&r.blockCount>n.blockCount&&m.push(`High block count: ${r.blockCount}`),n.renderTime&&r.renderTime>n.renderTime&&m.push(`Slow render: ${r.renderTime.toFixed(2)}ms`),n.memoryUsage&&r.memoryUsage>n.memoryUsage&&m.push(`High memory usage: ${(r.memoryUsage/1024/1024).toFixed(2)}MB`),n.fps&&r.fps<n.fps&&m.push(`Low FPS: ${r.fps}`),m.length>0&&o&&o(r)},[r,n,o,t]),l.useEffect(()=>{if(!t)return;v();const m=setInterval(()=>{b(),c()},1e3);return()=>{x.current&&cancelAnimationFrame(x.current),clearInterval(m)}},[t,v,b,c]),{metrics:r,measureRenderTime:u,resetMetrics:()=>{d({blockCount:0,renderTime:0,memoryUsage:0,fps:60,lagSpikes:0}),h.current=[]}}}const Js=({showSidebar:s=!0})=>e.jsxs("div",{className:"flex h-full",children:[e.jsxs("div",{className:"flex-1 p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 p-2 border rounded",children:[e.jsx(F,{className:"h-8 w-8"}),e.jsx(F,{className:"h-8 w-8"}),e.jsx(F,{className:"h-8 w-8"}),e.jsx("div",{className:"flex-1"}),e.jsx(F,{className:"h-8 w-24"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(F,{className:"h-12 w-2/3"}),e.jsx(F,{className:"h-4 w-full"}),e.jsx(F,{className:"h-4 w-full"}),e.jsx(F,{className:"h-4 w-3/4"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[e.jsx(F,{className:"h-32"}),e.jsx(F,{className:"h-32"})]})]})]}),s&&e.jsxs("div",{className:"w-80 border-l p-4 space-y-4",children:[e.jsx(F,{className:"h-8 w-full"}),e.jsx(F,{className:"h-12 w-full"}),e.jsx(F,{className:"h-12 w-full"}),e.jsx(F,{className:"h-12 w-full"})]})]}),Ws=({isSaving:s,lastSavedAt:t,hasError:n})=>{if(s)return e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(Dt,{className:"h-3 w-3 animate-spin"}),e.jsx("span",{children:"Saving..."})]});if(n)return e.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-600",children:[e.jsx(Qe,{className:"h-3 w-3"}),e.jsx("span",{children:"Save failed"})]});if(t){const o=Ks(t);return e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[e.jsx(It,{className:"h-3 w-3"}),e.jsxs("span",{children:["Saved ",o]})]})}return null};function Ks(s){const t=Math.floor((new Date().getTime()-s.getTime())/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:`${Math.floor(t/86400)}d ago`}const oa=({initialContent:s="",onChange:t,settings:n={},showReusableBlocks:o=!0})=>{const[r,d]=l.useState([]),[f]=l.useState([]),[p,h]=l.useState(!1),[x,v]=l.useState(!1),[b,c]=l.useState(!1),[u,m]=l.useState(!0),j=l.useRef(null),{insertReusableBlock:w,loading:C}=it(),{insertBlockPattern:R,loading:L}=$s(),{metrics:$,measureRenderTime:y}=Gs({onPerformanceIssue:T=>{T.blockCount>100}}),{isSaving:P,lastSavedAt:g,backupExists:k,updateContent:_,restoreFromBackup:O}=ws(r,{onSave:async T=>{t&&t(De(T),T)},saveInterval:3e4,debounceDelay:1e3}),a={alignWide:!0,availableTemplates:[],allowedBlockTypes:!0,disableCustomColors:!1,disableCustomFontSizes:!1,disableCustomGradients:!1,enableCustomSpacing:!0,isRTL:!1,mediaUpload:T=>{},__experimentalBlockPatterns:[],__experimentalSetIsInserterOpened:()=>{},...n};l.useEffect(()=>{(async()=>{m(!0);try{if(Vs(),qs(),s&&await Hs(s),k&&!s&&window.confirm("Found unsaved changes. Would you like to restore them?")){const J=await O();if(J){d(J),m(!1);return}}}catch{}finally{m(!1)}})()},[]),l.useEffect(()=>{if(s)try{const T=Xe(s);if(T.length>0)d(T);else{const z=fe("core/paragraph",{content:s});d([z])}}catch{const z=fe("core/paragraph");d([z])}else{const T=fe("core/paragraph");d([T])}},[s]);const S=T=>{y(()=>{if(d(T),_(T),t)try{const z=De(T);t(z,T)}catch{}})},i=async T=>{try{const z=await w(T.id);if(z&&z.length>0){const J=[...r,...z];S(J),h(!1)}}catch{}},N=async T=>{try{const z=await R(T.id);if(z&&z.length>0){const J=[...r,...z];S(J),c(!1)}}catch{}},M=()=>{f.length>0&&v(!0)},A=()=>{};return u?e.jsx(Js,{showSidebar:!0}):e.jsxs("div",{className:"wordpress-block-editor",ref:j,children:[$.blockCount>100&&e.jsxs(ke,{className:"mb-4",children:[e.jsx(Qe,{className:"h-4 w-4"}),e.jsxs(Ce,{children:["High block count (",$.blockCount," blocks) may affect performance. Consider splitting content into multiple pages."]})]}),k&&e.jsx(ke,{className:"mb-4",children:e.jsxs(Ce,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Found unsaved changes from your last session."}),e.jsxs(E,{size:"sm",variant:"outline",onClick:O,children:[e.jsx(Lt,{className:"h-4 w-4 mr-2"}),"Restore"]})]})}),e.jsx(Wt,{children:e.jsxs(Ot,{value:r,onInput:S,onChange:S,settings:a,useSubRegistry:!1,children:[e.jsx("div",{className:"block-editor-toolbar",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Vt,{}),e.jsx(Ws,{isSaving:P,lastSavedAt:g,hasError:!1})]}),o&&e.jsxs("div",{className:"flex items-center gap-2",children:[f.length>0&&e.jsxs(E,{size:"sm",variant:"outline",onClick:M,disabled:C,children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Save as Reusable"]}),e.jsxs(E,{size:"sm",variant:"outline",onClick:()=>h(!0),children:[e.jsx(At,{className:"h-4 w-4 mr-2"}),"Reusable Blocks"]}),e.jsxs(E,{size:"sm",variant:"outline",onClick:()=>c(!0),disabled:L,children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Block Patterns"]})]})]})}),e.jsx("div",{className:"block-editor-content",children:e.jsx(Ht,{children:e.jsx(qt,{children:e.jsx(Gt,{className:"block-editor-block-list"})})})}),e.jsx("div",{className:"block-editor-inspector",children:e.jsx(Jt,{})})]})}),p&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Reusable Blocks"}),e.jsx(E,{variant:"ghost",size:"sm",onClick:()=>h(!1),children:"×"})]}),e.jsx("div",{className:"p-4 overflow-auto max-h-[calc(90vh-120px)]",children:e.jsx(_s,{onInsertBlock:i,compact:!1})})]})}),e.jsx(zs,{isOpen:x,onClose:()=>v(!1),selectedBlocks:f,onSaved:A}),b&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-6xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Block Patterns"}),e.jsx(E,{variant:"ghost",size:"sm",onClick:()=>c(!1),children:"×"})]}),e.jsx("div",{className:"p-4 overflow-auto max-h-[calc(90vh-120px)]",children:e.jsx(Fs,{onInsertPattern:N,compact:!1})})]})}),e.jsx("style",{children:`
        .wordpress-block-editor {
          display: flex;
          flex-direction: column;
          height: 100%;
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen-Sans, Ubuntu, Cantarell, 'Helvetica Neue', sans-serif;
        }

        .block-editor-toolbar {
          background: #fff;
          border-bottom: 1px solid #e0e0e0;
          padding: 8px 16px;
          position: sticky;
          top: 0;
          z-index: 20;
        }

        .block-editor-content {
          flex: 1;
          overflow: auto;
          padding: 16px;
          background: #fff;
        }

        .block-editor-inspector {
          width: 280px;
          background: #f8f9fa;
          border-left: 1px solid #e0e0e0;
          overflow: auto;
        }

        /* WordPress Block Editor Styles */
        :global(.block-editor-block-list__layout) {
          max-width: 840px;
          margin: 0 auto;
        }

        :global(.block-editor-block-list__block) {
          margin: 28px 0;
        }

        :global(.block-editor-block-list__block.is-selected) {
          outline: 1px solid #007cba;
          outline-offset: -1px;
        }

        :global(.block-editor-block-list__block.is-hovered) {
          outline: 1px solid #007cba;
          outline-offset: -1px;
          outline-style: dashed;
        }

        /* Block Toolbar Styles */
        :global(.block-editor-block-toolbar) {
          background: #fff;
          border: 1px solid #e0e0e0;
          border-radius: 4px;
          box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
        }

        /* Popover Styles */
        :global(.components-popover) {
          z-index: 1000000;
        }

        :global(.components-popover__content) {
          background: #fff;
          border: 1px solid #e0e0e0;
          border-radius: 4px;
          box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
        }

        /* Inspector Styles */
        :global(.block-editor-block-inspector) {
          padding: 16px;
        }

        :global(.block-editor-block-inspector .components-panel) {
          border: none;
          margin-bottom: 16px;
        }

        :global(.block-editor-block-inspector .components-panel__header) {
          background: #f8f9fa;
          border-bottom: 1px solid #e0e0e0;
          padding: 8px 16px;
          font-weight: 600;
        }

        :global(.block-editor-block-inspector .components-panel__body) {
          padding: 16px;
        }
      `})]})};export{Yt as A,E as B,W as C,be as D,lt as E,nt as F,na as G,aa as H,U as I,ke as J,Ce as K,D as L,cs as M,As as N,ct as O,Ls as P,is as Q,_s as R,_e as S,he as T,oa as W,pe as _,Be as a,Pe as b,B as c,Y as d,ae as e,we as f,ze as g,Ne as h,q as i,Le as j,rs as k,ns as l,ls as m,ie as n,ce as o,hs as p,xs as q,H as r,V as s,os as t,ra as u,ws as v,Ze as w,at as x,rt as y,ot as z};
