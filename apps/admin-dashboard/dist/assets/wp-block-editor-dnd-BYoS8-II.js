import{a6 as e,a7 as t,F as n,S as o,x as r,t as a,a8 as i,X as s,a9 as l,aa as c,ab as d,ac as u,ad as g}from"./wp-block-editor-utils-M5qXzE1L.js";import{r as p,j as f,e as m}from"./vendor-react-BQ6HOJoh.js";import{aK as b,g as v,a as k,aL as h,N as x,_ as D,aM as C,a2 as I,O as w,s as B,B as y,a0 as E,u as j,b as _,c as N,aD as T,aG as L,aN as S,o as R,aO as M,H as O,a8 as P,aP as A,aQ as z}from"./wp-block-editor-misc-pHCPYvR2.js";import{c as Y}from"./wp-block-editor-colors-D38h-Odz.js";import{c as $,u as W,f as H,T as X,a as Z}from"./wp-block-editor-api-Buev8_QU.js";import{c as V}from"./vendor-ui-CrFdsnXa.js";import"./wp-block-editor-a11y-DrduSWFW.js";import{m as q,u as F,i as K,k as U,n as G,o as J,q as Q,r as ee,s as te,v as ne,w as oe}from"./wp-block-editor-library-BpQvynjE.js";import{s as re}from"./wp-block-editor-store-B-g1aSix.js";import{f as ae,N as ie,d as se,m as le}from"./wp-block-editor-menus-BTQ2wZ-f.js";import{a as ce,f as de,B as ue,z as ge,y as pe,c as fe,t as me}from"./wp-blocks-core-6vwQKPfS.js";import{a as be}from"./wp-block-editor-core-DL280tSA.js";function ve({onDragStart:t,onDragMove:n,onDragEnd:o}){const[r,a]=p.useState(!1),i=p.useRef({onDragStart:t,onDragMove:n,onDragEnd:o});e(()=>{i.current.onDragStart=t,i.current.onDragMove=n,i.current.onDragEnd=o},[t,n,o]);const s=p.useCallback(e=>i.current.onDragMove&&i.current.onDragMove(e),[]),l=p.useCallback(e=>{i.current.onDragEnd&&i.current.onDragEnd(e),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",l),a(!1)},[]),c=p.useCallback(e=>{i.current.onDragStart&&i.current.onDragStart(e),document.addEventListener("mousemove",s),document.addEventListener("mouseup",l),a(!0)},[]);return p.useEffect(()=>()=>{r&&(document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",l))},[r]),{startDrag:c,endDrag:l,isDragging:r}}function ke({dropZoneElement:e,isDisabled:o,onDrop:r,onDragStart:a,onDragEnter:i,onDragLeave:s,onDragEnd:l,onDragOver:c}){const d=t(r),u=t(a),g=t(i),p=t(s),f=t(l),m=t(c);return n(t=>{if(o)return;const n=null!=e?e:t;let b=!1;const{ownerDocument:v}=n;function k(e){b||(b=!0,v.addEventListener("dragend",I),v.addEventListener("mousemove",I),a&&u(e))}function h(e){e.preventDefault(),n.contains(e.relatedTarget)||i&&g(e)}function x(e){!e.defaultPrevented&&c&&m(e),e.preventDefault()}function D(e){(function(e){const{defaultView:t}=v;if(!(e&&t&&e instanceof t.HTMLElement&&n.contains(e)))return!1;let o=e;do{if(o.dataset.isDropZone)return o===n}while(o=o.parentElement);return!1})(e.relatedTarget)||s&&p(e)}function C(e){e.defaultPrevented||(e.preventDefault(),e.dataTransfer&&e.dataTransfer.files.length,r&&d(e),I(e))}function I(e){b&&(b=!1,v.removeEventListener("dragend",I),v.removeEventListener("mousemove",I),l&&f(e))}return n.setAttribute("data-is-drop-zone","true"),n.addEventListener("drop",C),n.addEventListener("dragenter",h),n.addEventListener("dragover",x),n.addEventListener("dragleave",D),v.addEventListener("dragenter",k),()=>{n.removeAttribute("data-is-drop-zone"),n.removeEventListener("drop",C),n.removeEventListener("dragenter",h),n.removeEventListener("dragover",x),n.removeEventListener("dragleave",D),v.removeEventListener("dragend",I),v.removeEventListener("mousemove",I),v.removeEventListener("dragenter",k)}},[o,e])}const he=p.memo(function({disabled:e=!1,isBorderless:t=!1}){return f.jsx(b,{"aria-hidden":"true",className:"components-input-control__backdrop",disabled:e,isBorderless:t})}),xe=$((e,t)=>{const{renderContent:n,renderToggle:a,className:i,contentClassName:s,expandOnMobile:l,headerTitle:c,focusOnMount:d,popoverProps:u,onClose:g,onToggle:m,style:b,open:k,defaultOpen:h,position:x,variant:D}=W(e,"Dropdown");void 0!==x&&v("`position` prop in wp.components.Dropdown",{since:"6.2",alternative:"`popoverProps.placement` prop",hint:"Note that the `position` prop will override any values passed through the `popoverProps.placement` prop."});const[C,I]=p.useState(null),w=p.useRef(),[B,y]=o({defaultValue:h,value:k,onChange:m});function E(){g?.(),y(!1)}const j={isOpen:!!B,onToggle:()=>y(!B),onClose:E},_=!!(u?.anchor||u?.anchorRef||u?.getAnchorRect||u?.anchorRect);return f.jsxs("div",{className:i,ref:r([w,t,I]),tabIndex:-1,style:b,children:[a(j),B&&f.jsx(ae,{position:x,onClose:E,onFocusOutside:function(){if(!w.current)return;const{ownerDocument:e}=w.current,t=e?.activeElement?.closest('[role="dialog"]');w.current.contains(e.activeElement)||t&&!t.contains(w.current)||E()},expandOnMobile:l,headerTitle:c,focusOnMount:d,offset:13,anchor:_?void 0:C,variant:D,...u,className:V("components-dropdown__content",u?.className,s),children:n(j)})]})},"Dropdown"),De=({paddingSize:e="small"})=>{if("none"===e)return;const t={small:a(2),medium:a(4)};return m("padding:",t[e]||t.small,";","")},Ce=Y("div",{target:"eovvns30"})("margin-left:",a(-2),";margin-right:",a(-2),";&:first-of-type{margin-top:",a(-2),";}&:last-of-type{margin-bottom:",a(-2),";}",De,";");const Ie=$(function(e,t){const{paddingSize:n="small",...o}=W(e,"DropdownContentWrapper");return f.jsx(Ce,{...o,paddingSize:n,ref:t})},"DropdownContentWrapper");function we(e={},t={}){const n={...e,...t};return t.className&&e.className&&(n.className=V(t.className,e.className)),n}function Be(e){return"function"==typeof e}const ye=H(function(e){const{children:t,className:n,controls:o,icon:r=q,label:a,popoverProps:i,toggleProps:s,menuProps:l,disableOpenOnArrowDown:c=!1,text:d,noIcons:u,open:g,defaultOpen:p,onToggle:m,variant:b}=W(e,"DropdownMenu");if(!o?.length&&!Be(t))return null;let v;o?.length&&(v=o,Array.isArray(v[0])||(v=[o]));const h=we({className:"components-dropdown-menu__popover",variant:b},i);return f.jsx(xe,{className:n,popoverProps:h,renderToggle:({isOpen:e,onToggle:t})=>{var n;const{as:o=k,...i}=null!=s?s:{},l=we({className:V("components-dropdown-menu__toggle",{"is-opened":e})},i);return f.jsx(o,{...l,icon:r,onClick:e=>{t(),l.onClick&&l.onClick(e)},onKeyDown:n=>{(n=>{c||e||"ArrowDown"!==n.code||(n.preventDefault(),t())})(n),l.onKeyDown&&l.onKeyDown(n)},"aria-haspopup":"true","aria-expanded":e,label:a,text:d,showTooltip:null===(n=s?.showTooltip)||void 0===n||n,children:l.children})},renderContent:e=>{const n=we({"aria-label":a,className:V("components-dropdown-menu__menu",{"no-icons":u})},l);return f.jsxs(ie,{...n,role:"menu",children:[Be(t)?t(e):null,v?.flatMap((t,n)=>t.map((t,o)=>f.jsx(k,{onClick:n=>{n.stopPropagation(),e.onClose(),t.onClick&&t.onClick()},className:V("components-dropdown-menu__menu-item",{"has-separator":n>0&&0===o,"is-active":t.isActive,"is-icon-only":!t.title}),icon:t.icon,label:t.label,"aria-checked":"menuitemcheckbox"===t.role||"menuitemradio"===t.role?t.isActive:void 0,role:"menuitemcheckbox"===t.role||"menuitemradio"===t.role?t.role:"menuitem",accessibleWhenDisabled:!0,disabled:t.isDisabled,children:t.title},[n,o].join())))]})},open:g,defaultOpen:p,onToggle:m})},"DropdownMenu"),Ee="is-dragging-components-draggable";function je({children:e,onDragStart:t,onDragOver:n,onDragEnd:o,appendToOwnerDocument:r=!1,cloneClassname:a,elementId:s,transferData:l,__experimentalTransferDataType:c="text",__experimentalDragComponent:d}){const u=p.useRef(null),g=p.useRef(()=>{});return p.useEffect(()=>()=>{g.current()},[]),f.jsxs(f.Fragment,{children:[e({onDraggableStart:function(e){const{ownerDocument:o}=e.target;e.dataTransfer.setData(c,JSON.stringify(l));const d=o.createElement("div");d.style.top="0",d.style.left="0";const p=o.createElement("div");"function"==typeof e.dataTransfer.setDragImage&&(p.classList.add("components-draggable__invisible-drag-image"),o.body.appendChild(p),e.dataTransfer.setDragImage(p,0,0)),d.classList.add("components-draggable__clone"),a&&d.classList.add(a);let f=0,m=0;if(u.current){f=e.clientX,m=e.clientY,d.style.transform=`translate( ${f}px, ${m}px )`;const t=o.createElement("div");t.innerHTML=u.current.innerHTML,d.appendChild(t),o.body.appendChild(d)}else{const e=o.getElementById(s),t=e.getBoundingClientRect(),n=e.parentNode,a=t.top,i=t.left;d.style.width=`${t.width+0}px`;const l=e.cloneNode(!0);l.id=`clone-${s}`,f=i-0,m=a-0,d.style.transform=`translate( ${f}px, ${m}px )`,Array.from(l.querySelectorAll("iframe")).forEach(e=>e.parentNode?.removeChild(e)),d.appendChild(l),r?o.body.appendChild(d):n?.appendChild(d)}let b=e.clientX,v=e.clientY;const k=i(function(e){if(b===e.clientX&&v===e.clientY)return;const t=f+e.clientX-b,o=m+e.clientY-v;d.style.transform=`translate( ${t}px, ${o}px )`,b=e.clientX,v=e.clientY,f=t,m=o,n&&n(e)},16);o.addEventListener("dragover",k),o.body.classList.add(Ee),t&&t(e),g.current=()=>{d&&d.parentNode&&d.parentNode.removeChild(d),p&&p.parentNode&&p.parentNode.removeChild(p),o.body.classList.remove(Ee),o.removeEventListener("dragover",k)}},onDraggableEnd:function(e){e.preventDefault(),g.current(),o&&o(e)}}),d&&f.jsx("div",{className:"components-draggable-drag-component-root",style:{display:"none"},ref:u,children:d})]})}function _e({className:e,label:t,onFilesDrop:n,onHTMLDrop:o,onDrop:r,...a}){const[i,s]=p.useState(),[l,c]=p.useState(),[d,u]=p.useState(),g=ke({onDrop(e){const t=e.dataTransfer?h(e.dataTransfer):[],a=e.dataTransfer?.getData("text/html");a&&o?o(a):t.length&&n?n(t):r&&r(e)},onDragStart(e){s(!0);let t="default";e.dataTransfer?.types.includes("text/html")?t="html":(e.dataTransfer?.types.includes("Files")||(e.dataTransfer?h(e.dataTransfer):[]).length>0)&&(t="file"),u(t)},onDragEnd(){c(!1),s(!1),u(void 0)},onDragEnter(){c(!0)},onDragLeave(){c(!1)}}),m=V("components-drop-zone",e,{"is-active":(i||l)&&("file"===d&&n||"html"===d&&o||"default"===d&&r),"is-dragging-over-document":i,"is-dragging-over-element":l,[`is-dragging-${d}`]:!!d});return f.jsx("div",{...a,ref:g,className:m,children:f.jsx("div",{className:"components-drop-zone__content",children:f.jsxs("div",{className:"components-drop-zone__content-inner",children:[f.jsx(x,{icon:F,className:"components-drop-zone__content-icon"}),f.jsx("span",{className:"components-drop-zone__content-text",children:t||D("Drop files to upload")})]})})})}const Ne=p.forwardRef(function(e,t){return p.useContext(X)?f.jsx(C,{ref:t,...e.toggleProps,children:t=>f.jsx(ye,{...e,popoverProps:{...e.popoverProps},toggleProps:t})}):f.jsx(ye,{...e})});function Te({count:e,icon:t,isPattern:n,fadeWhenDisabled:o}){const r=n&&D("Pattern");return f.jsx("div",{className:"block-editor-block-draggable-chip-wrapper",children:f.jsx("div",{className:"block-editor-block-draggable-chip","data-testid":"block-draggable-chip",children:f.jsxs(I,{justify:"center",className:"block-editor-block-draggable-chip__content",children:[f.jsx(w,{children:t?f.jsx(y,{icon:t}):r||B(E("%d block","%d blocks",e),e)}),f.jsx(w,{children:f.jsx(y,{icon:K})}),o&&f.jsx(w,{className:"block-editor-block-draggable-chip__disabled",children:f.jsx("span",{className:"block-editor-block-draggable-chip__disabled-icon"})})]})})})}const Le={hide:{opacity:0,scaleY:.75},show:{opacity:1,scaleY:1},exit:{opacity:0,scaleY:.9}};function Se({__unstablePopoverSlot:e,__unstableContentRef:t}){const{clientId:n}=j(e=>{const{getBlockOrder:t,getBlockInsertionPoint:n}=e(re),o=n(),r=t(o.rootClientId);return r.length?{clientId:r[o.index]}:{}},[]),o=s();return f.jsx(se,{clientId:n,__unstablePopoverSlot:e,__unstableContentRef:t,className:"block-editor-block-popover__drop-zone",children:f.jsx(le.div,{"data-testid":"block-popover-drop-zone",initial:o?Le.show:Le.hide,animate:Le.show,exit:o?Le.show:Le.exit,className:"block-editor-block-popover__drop-zone-foreground"})})}function Re(e,t,n,o,r,a,i,s,l){return c=>{const{srcRootClientId:d,srcClientIds:u,type:g,blocks:p}=function(e){let t={srcRootClientId:null,srcClientIds:null,srcIndex:null,type:null,blocks:null};if(!e.dataTransfer)return t;try{t=Object.assign(t,JSON.parse(e.dataTransfer.getData("wp-blocks")))}catch(n){return t}return t}(c);if("inserter"===g){i();const e=p.map(e=>fe(e));a(e,!0,null)}if("block"===g){const i=n(u[0]);if(d===e&&i===t)return;if(u.includes(e)||o(u).some(t=>t===e))return;if("group"===s){const e=u.map(e=>l(e));return void a(e,!0,null,u)}const c=d===e,g=u.length;r(u,d,c&&i<t?t-g:t)}}}function Me(e,t,n={}){const{operation:o="insert",nearestSide:r="right"}=n,{canInsertBlockType:a,getBlockIndex:i,getClientIdsOfDescendants:s,getBlockOrder:l,getBlocksByClientId:c,getSettings:d,getBlock:u}=j(re),{getGroupingBlockName:g}=j(ce),{insertBlocks:f,moveBlocksToPosition:m,updateBlockAttributes:b,clearSelectedBlock:v,replaceBlocks:k,removeBlocks:x}=_(re),D=Z(),C=p.useCallback((n,i=!0,s=0,c=[])=>{Array.isArray(n)||(n=[n]);const d=l(e)[t];if("replace"===o)k(d,n,void 0,s);else if("group"===o){const t=u(d);"left"===r?n.push(t):n.unshift(t);const o=n.map(e=>de(e.name,e.attributes,e.innerBlocks)),i=n.every(e=>"core/image"===e.name),l=a("core/gallery",e),p=de(i&&l?"core/gallery":g(),{layout:{type:"flex",flexWrap:i&&l?null:"nowrap"}},o);k([d,...c],p,void 0,s)}else f(n,t,e,i,s)},[l,e,t,o,k,u,r,a,g,f]),I=p.useCallback((n,r,a)=>{if("replace"===o){const o=c(n),r=l(e)[t];D.batch(()=>{x(n,!1),k(r,o,void 0,0)})}else m(n,r,e,a)},[o,l,c,m,D,x,k,t,e]),w=Re(e,t,i,s,I,C,v,o,u),B=function(e,t,n,o,r){return a=>{if(!t().mediaUpload)return;const i=ge(pe("from"),t=>"files"===t.type&&o(t.blockName,e)&&t.isMatch(a));if(i){const e=i.transform(a,n);r(e)}}}(e,d,b,a,C),y=function(e){return t=>{const n=ue({HTML:t,mode:"BLOCKS"});n.length&&e(n)}}(C);return e=>{const t=h(e.dataTransfer),n=e.dataTransfer.getData("text/html");n?y(n):t.length?B(t):w(e)}}function Oe(e,t,n,o){let r=!0;if(t){const e=t?.map(({name:e})=>e);r=n.every(t=>e?.includes(t))}const a=n.map(t=>e(t)).every(e=>{const[t]=e?.parent||[];return!t||t===o});return r&&a}function Pe(e,t){const{defaultView:n}=t;return!!(n&&e instanceof n.HTMLElement&&e.dataset.isInsertionPoint)}function Ae({dropZoneElement:e,rootClientId:t="",parentClientId:n="",isDisabled:o=!1}={}){const r=Z(),[a,i]=p.useState({index:null,operation:"insert"}),{getBlockType:s,getBlockVariations:g,getGroupingBlockName:f}=j(ce),{canInsertBlockType:m,getBlockListSettings:b,getBlocks:v,getBlockIndex:k,getDraggedBlockClientIds:h,getBlockNamesByClientId:x,getAllowedBlocks:D,isDragging:C,isGroupable:I,isZoomOutMode:w,getSectionRootClientId:B}=N(j(re)),{showInsertionPoint:y,hideInsertionPoint:E,startDragging:L,stopDragging:S}=N(_(re)),R=Me("before"===a.operation||"after"===a.operation?n:t,a.index,{operation:a.operation,nearestSide:a.nearestSide}),M=l(p.useCallback((o,a)=>{C()||L();const l=D(t),p=x([t])[0],E=x(h());if(!Oe(s,l,E,p))return;const j=B();if(w()&&j!==t)return;const _=v(t);if(0===_.length)return void r.batch(()=>{i({index:0,operation:"insert"}),y(t,0,{operation:"insert"})});const N=function(e,t,n="vertical",o={}){const r="horizontal"===n?["left","right"]:["top","bottom"];let a=0,i="before",s=1/0,l=null,g="right";const{dropZoneElement:p,parentBlockOrientation:f,rootBlockIndex:m=0}=o;if(p&&"horizontal"!==f){const e=p.getBoundingClientRect(),[n,o]=c(t,e,["top","bottom"]);if(e.height>120&&n<30){if("top"===o)return[m,"before"];if("bottom"===o)return[m+1,"after"]}}const b=T();if(p&&"horizontal"===f){const e=p.getBoundingClientRect(),[n,o]=c(t,e,["left","right"]);if(e.width>120&&n<30){if(b&&"right"===o||!b&&"left"===o)return[m,"before"];if(b&&"left"===o||!b&&"right"===o)return[m+1,"after"]}}e.forEach(({isUnmodifiedDefaultBlock:e,getBoundingClientRect:o,blockIndex:p,blockOrientation:f})=>{const m=o();let[v,k]=c(t,m,r);const[h,x]=c(t,m,["left","right"]),D=d(t,m);e&&D?v=0:"vertical"===n&&"horizontal"!==f&&(D&&h<30||!D&&u(t,m))&&(l=p,g=x),v<s&&(i="bottom"===k||!b&&"right"===k||b&&"left"===k?"after":"before",s=v,a=p)});const v=a+("after"===i?1:-1),k=!!e[a]?.isUnmodifiedDefaultBlock,h=!!e[v]?.isUnmodifiedDefaultBlock;if(null!==l)return[l,"group",g];if(!k&&!h)return["after"===i?a+1:a,"insert"];return[k?a:v,"replace"]}(_.map(e=>{const t=e.clientId;return{isUnmodifiedDefaultBlock:me(e),getBoundingClientRect:()=>a.getElementById(`block-${t}`).getBoundingClientRect(),blockIndex:k(t),blockOrientation:b(t)?.orientation}}),{x:o.clientX,y:o.clientY},b(t)?.orientation,{dropZoneElement:e,parentBlockOrientation:n?b(n)?.orientation:void 0,rootBlockIndex:k(t)}),[S,R,M]=N;if(!w()||"insert"===R){if("group"===R){const e=_[S],n=[e.name,...E].every(e=>"core/image"===e),o=m("core/gallery",t),r=I([e.clientId,h()]),a=g(f(),"block"),i=a&&a.find(({name:e})=>"group-row"===e);if(n&&!o&&(!r||!i))return;if(!(n||r&&i))return}r.batch(()=>{i({index:S,operation:R,nearestSide:M});const e=["before","after"].includes(R)?n:t;y(e,S,{operation:R,nearestSide:M})})}},[C,D,t,x,h,s,B,w,v,b,e,n,k,r,L,y,m,I,g,f]),200);return ke({dropZoneElement:e,isDisabled:o,onDrop:R,onDragOver(e){M(e,e.currentTarget.ownerDocument)},onDragLeave(e){const{ownerDocument:t}=e.currentTarget;Pe(e.relatedTarget,t)||Pe(e.target,t)||(M.cancel(),E())},onDragEnd(){M.cancel(),S(),E()}})}const ze=({appendToOwnerDocument:e,children:t,clientIds:n,cloneClassname:o,elementId:r,onDragStart:a,onDragEnd:s,fadeWhenDisabled:l=!1,dragComponent:c})=>{const{srcRootClientId:d,isDraggable:u,icon:g,visibleInserter:m,getBlockType:b}=j(e=>{const{canMoveBlocks:t,getBlockRootClientId:o,getBlockName:r,getBlockAttributes:a,isBlockInsertionPointVisible:i}=e(re),{getBlockType:s,getActiveBlockVariation:l}=e(ce),c=o(n[0]),d=r(n[0]),u=l(d,a(n[0]));return{srcRootClientId:c,isDraggable:t(n),icon:u?.icon||s(d)?.icon,visibleInserter:i(),getBlockType:s}},[n]),v=p.useRef(!1),[k,h,x]=function(){const e=p.useRef(null),t=p.useRef(null),n=p.useRef(null),o=p.useRef(null);return p.useEffect(()=>()=>{o.current&&(clearInterval(o.current),o.current=null)},[]),[p.useCallback(r=>{e.current=r.clientY,n.current=L(r.target),o.current=setInterval(()=>{if(n.current&&t.current){const e=n.current.scrollTop+t.current;n.current.scroll({top:e})}},25)},[]),p.useCallback(o=>{if(!n.current)return;const r=n.current.offsetHeight,a=e.current-n.current.offsetTop,i=o.clientY-n.current.offsetTop;if(o.clientY>a){const e=Math.max(r-a-50,0),n=Math.max(i-a-50,0),o=0===e||0===n?0:n/e;t.current=25*o}else if(o.clientY<a){const e=Math.max(a-50,0),n=Math.max(a-i-50,0),o=0===e||0===n?0:n/e;t.current=-25*o}else t.current=0},[]),()=>{e.current=null,n.current=null,o.current&&(clearInterval(o.current),o.current=null)}]}(),{getAllowedBlocks:D,getBlockNamesByClientId:C,getBlockRootClientId:I}=j(re),{startDraggingBlocks:w,stopDraggingBlocks:B}=_(re);p.useEffect(()=>()=>{v.current&&B()},[]);const y=be(n[0]),E=y?.closest("body");if(p.useEffect(()=>{if(!E||!l)return;const e=i(e=>{if(!e.target.closest("[data-block]"))return;const t=C(n),o=e.target.closest("[data-block]").getAttribute("data-block"),r=D(o),a=C([o])[0];let i;if(0===r?.length){const e=I(o),n=C([e])[0],r=D(e);i=Oe(b,r,t,n)}else i=Oe(b,r,t,a);i||m?window?.document?.body?.classList?.remove("block-draggable-invalid-drag-token"):window?.document?.body?.classList?.add("block-draggable-invalid-drag-token")},200);return E.addEventListener("dragover",e),()=>{E.removeEventListener("dragover",e)}},[n,E,l,D,C,I,b,m]),!u)return t({draggable:!1});const N={type:"block",srcClientIds:n,srcRootClientId:d};return f.jsx(je,{appendToOwnerDocument:e,cloneClassname:o,__experimentalTransferDataType:"wp-blocks",transferData:N,onDragStart:e=>{window.requestAnimationFrame(()=>{w(n),v.current=!0,k(e),a&&a()})},onDragOver:h,onDragEnd:()=>{B(),v.current=!1,x(),s&&s()},__experimentalDragComponent:void 0!==c?c:f.jsx(Te,{count:n.length,icon:g,fadeWhenDisabled:!0}),elementId:r,children:({onDraggableStart:e,onDraggableEnd:n})=>t({draggable:!0,onDragStart:e,onDragEnd:n})})};function Ye({draggedBlockClientId:e,listViewRef:t,blockDropTarget:n}){const o=S(e),r=R({clientId:e,context:"list-view"}),{rootClientId:a,clientId:i,dropPosition:s}=n||{},[l,c]=p.useMemo(()=>{if(!t.current)return[];return[a?t.current.querySelector(`[data-block="${a}"]`):void 0,i?t.current.querySelector(`[data-block="${i}"]`):void 0]},[t,a,i]),d=c||l,u=T(),g=p.useCallback((e,t)=>{if(!d)return 0;let n=d.offsetWidth;const o=L(d,"horizontal"),r=d.ownerDocument,a=o===r.body||o===r.documentElement;if(o&&!a){const r=o.getBoundingClientRect(),a=T()?r.right-e.right:e.left-r.left,i=o.clientWidth;if(i<n+a&&(n=i-a),!u&&e.left+t<r.left)return n-=r.left-e.left,n;if(u&&e.right-t>r.right)return n-=e.right-r.right,n}return n-t},[u,d]),m=p.useMemo(()=>{if(!d)return{};const e=d.getBoundingClientRect();return{width:g(e,0)}},[g,d]),b=p.useMemo(()=>{if(!d)return{};const e=L(d),t=d.ownerDocument,n=e===t.body||e===t.documentElement;if(e&&!n){const t=e.getBoundingClientRect(),n=d.getBoundingClientRect(),o=u?t.right-n.right:n.left-t.left;if(!u&&t.left>n.left)return{transform:`translateX( ${o}px )`};if(u&&t.right<n.right)return{transform:`translateX( ${-1*o}px )`}}return{}},[u,d]),v=p.useMemo(()=>{if(!l)return 1;const e=parseInt(l.getAttribute("aria-level"),10);return e?e+1:1},[l]),k=p.useMemo(()=>!!d&&d.classList.contains("is-branch-selected"),[d]),h=p.useMemo(()=>{if(d&&("top"===s||"bottom"===s||"inside"===s))return{contextElement:d,getBoundingClientRect(){const e=d.getBoundingClientRect();let t=e.left,n=0;const o=L(d,"horizontal"),r=d.ownerDocument,a=o===r.body||o===r.documentElement;if(o&&!a){const e=o.getBoundingClientRect(),n=u?o.offsetWidth-o.clientWidth:0;t<e.left+n&&(t=e.left+n)}n="top"===s?e.top-2*e.height:e.top;const i=g(e,0),l=e.height;return new window.DOMRect(t,n,i,l)}}},[d,s,g,u]);return d?f.jsx(ae,{animate:!1,anchor:h,focusOnMount:!1,className:"block-editor-list-view-drop-indicator--preview",variant:"unstyled",flip:!1,resize:!0,children:f.jsx("div",{style:m,className:V("block-editor-list-view-drop-indicator__line",{"block-editor-list-view-drop-indicator__line--darker":k}),children:f.jsxs("div",{className:"block-editor-list-view-leaf","aria-level":v,children:[f.jsxs("div",{className:V("block-editor-list-view-block-select-button","block-editor-list-view-block-contents"),style:b,children:[f.jsx(M,{onClick:()=>{}}),f.jsx(y,{icon:o?.icon,showColors:!0,context:"list-view"}),f.jsx(O,{alignment:"center",className:"block-editor-list-view-block-select-button__label-wrapper",justify:"flex-start",spacing:1,children:f.jsx("span",{className:"block-editor-list-view-block-select-button__title",children:f.jsx(P,{ellipsizeMode:"auto",children:r})})})]}),f.jsx("div",{className:"block-editor-list-view-block__menu-cell"})]})})}):null}const $e=24;function We(e,t){const n=e[t+1];return n&&n.isDraggedBlock?We(e,t+1):n}const He=["top","bottom"];function Xe(e,t,n=!1){let o,r,a,i,s;for(let p=0;p<e.length;p++){const n=e[p];if(n.isDraggedBlock)continue;const l=n.element.getBoundingClientRect(),[u,g]=c(t,l,He),f=d(t,l);if(void 0===a||u<a||f){a=u;const t=e.indexOf(n),c=e[t-1];if("top"===g&&c&&c.rootClientId===n.rootClientId&&!c.isDraggedBlock?(r=c,o="bottom",i=c.element.getBoundingClientRect(),s=t-1):(r=n,o=g,i=l,s=t),f)break}}if(!r)return;const l=function(e,t){const n=[];let o=e;for(;o;)n.push({...o}),o=t.find(e=>e.clientId===o.rootClientId);return n}(r,e),u="bottom"===o;if(u&&r.canInsertDraggedBlocksAsChild&&(r.innerBlockCount>0&&r.isExpanded||function(e,t,n=1,o=!1){const r=o?t.right-n*$e:t.left+n*$e;return(o?e.x<r-$e:e.x>r+$e)&&e.y<t.bottom}(t,i,l.length,n))){const e=r.isExpanded?0:r.innerBlockCount||0;return{rootClientId:r.clientId,clientId:r.clientId,blockIndex:e,dropPosition:"inside"}}if(u&&r.rootClientId&&function(e,t,n=1,o=!1){const r=o?t.right-n*$e:t.left+n*$e;return o?e.x>r:e.x<r}(t,i,l.length,n)){const a=We(e,s),c=r.nestingLevel,d=a?a.nestingLevel:1;if(c&&d){const u=function(e,t,n=1,o=!1){const r=o?t.right-n*$e:t.left+n*$e,a=o?r-e.x:e.x-r,i=Math.round(a/$e);return Math.abs(i)}(t,i,l.length,n),g=Math.max(Math.min(u,c-d),0);if(l[g]){let t=r.blockIndex;if(l[g].nestingLevel===a?.nestingLevel)t=a?.blockIndex;else for(let n=s;n>=0;n--){const o=e[n];if(o.rootClientId===l[g].rootClientId){t=o.blockIndex+1;break}}return{rootClientId:l[g].rootClientId,clientId:r.clientId,blockIndex:t,dropPosition:o}}}}if(!r.canInsertDraggedBlocksAsSibling)return;const g=u?1:0;return{rootClientId:r.rootClientId,clientId:r.clientId,blockIndex:r.blockIndex+g,dropPosition:o}}const Ze={leading:!1,trailing:!0};function Ve({dropZoneElement:e,expandedState:t,setExpandedState:n}){const{getBlockRootClientId:o,getBlockIndex:r,getBlockCount:a,getDraggedBlockClientIds:i,canInsertBlocks:s}=j(re),[c,d]=p.useState(),{rootClientId:u,blockIndex:f}=c||{},m=Me(u,f),b=T(),v=g(u),k=p.useCallback((e,t)=>{const{rootClientId:o}=t||{};o&&("inside"!==t?.dropPosition||e[o]||n({type:"expand",clientIds:[o]}))},[n]),h=l(k,500,Ze);p.useEffect(()=>{"inside"===c?.dropPosition&&v===c?.rootClientId?h(t,c):h.cancel()},[t,v,c,h]);const x=i(),D=l(p.useCallback((e,t)=>{const n={x:e.clientX,y:e.clientY},i=!!x?.length,l=Xe(Array.from(t.querySelectorAll("[data-block]")).map(e=>{const t=e.dataset.block,n="true"===e.dataset.expanded,l=e.classList.contains("is-dragging"),c=parseInt(e.getAttribute("aria-level"),10),d=o(t);return{clientId:t,isExpanded:n,rootClientId:d,blockIndex:r(t),element:e,nestingLevel:c||void 0,isDraggedBlock:!!i&&l,innerBlockCount:a(t),canInsertDraggedBlocksAsSibling:!i||s(x,d),canInsertDraggedBlocksAsChild:!i||s(x,t)}}),n,b);l&&d(l)},[s,x,a,r,o,b]),50);return{ref:ke({dropZoneElement:e,onDrop(e){D.cancel(),c&&m(e),d(void 0)},onDragLeave(){D.cancel(),d(null)},onDragOver(e){D(e,e.currentTarget)},onDragEnd(){D.cancel(),d(void 0)}}),target:c}}function qe({isEnabled:e,onToggle:t,isOpen:n,innerRef:o,...r}){return f.jsx(k,{__next40pxDefaultSize:!0,...r,ref:o,icon:U,"aria-expanded":n,"aria-haspopup":"true",onClick:e?t:void 0,label:D("List view"),className:"block-editor-block-navigation","aria-disabled":!e})}const Fe=p.forwardRef(function({isDisabled:e,...t},n){v("wp.blockEditor.BlockNavigationDropdown",{since:"6.1",alternative:"wp.components.Dropdown and wp.blockEditor.ListView"});const o=j(e=>!!e(re).getBlockCount(),[])&&!e;return f.jsx(xe,{contentClassName:"block-editor-block-navigation__popover",popoverProps:{placement:"bottom-start"},renderToggle:({isOpen:e,onToggle:r})=>f.jsx(qe,{...t,innerRef:n,isOpen:e,onToggle:r,isEnabled:o}),renderContent:()=>f.jsxs("div",{className:"block-editor-block-navigation__container",children:[f.jsx("p",{className:"block-editor-block-navigation__label",children:D("List view")}),f.jsx(A,{})]})})}),Ke={0:oe,1:ne,2:te,3:ee,4:Q,5:J,6:G};function Ue({level:e}){return Ke[e]?f.jsx(z,{icon:Ke[e]}):null}const Ge=[1,2,3,4,5,6],Je={className:"block-library-heading-level-dropdown"};function Qe({options:e=Ge,value:t,onChange:n}){const o=e.filter(e=>0===e||Ge.includes(e)).sort((e,t)=>e-t);return f.jsx(Ne,{popoverProps:Je,icon:f.jsx(Ue,{level:t}),label:D("Change level"),controls:o.map(e=>{const o=e===t;return{icon:f.jsx(Ue,{level:e}),title:0===e?D("Paragraph"):B(D("Heading %d"),e),isActive:o,onClick(){n(e)},role:"menuitemradio"}})})}export{Se as B,ye as D,Qe as H,Ye as L,he as M,Ne as T,xe as a,Ie as b,ze as c,_e as d,Ae as e,Ve as f,ke as g,Fe as h,je as i,Te as j,ve as u};
