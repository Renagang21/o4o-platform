import{u as e,r as s,j as t,bk as r,bf as o,V as i,cE as a,cF as l}from"./vendor-react-BQ6HOJoh.js";import{M as p}from"./MediaLibrary-D_cKJq2X.js";import{B as d,b as c}from"./page-template-editor-C7FodHrK.js";import"./wp-block-editor-a11y-DrduSWFW.js";import"./wp-block-editor-misc-pHCPYvR2.js";import"./wp-block-editor-api-Buev8_QU.js";import"./wp-block-editor-utils-M5qXzE1L.js";import"./wp-block-editor-colors-D38h-Odz.js";import"./wp-blocks-core-6vwQKPfS.js";import"./wp-block-editor-clipboard-Dg0Y1gQ6.js";import"./wp-misc-DS9m4_P2.js";import"./vendor-ui-CrFdsnXa.js";import"./vendor-query-LYSOqK5P.js";import"./vendor-utils-D-spY-QM.js";import"./wp-core-Y-jV-nrZ.js";import"./wp-block-editor-keyboard-CeHTtvP5.js";import"./wp-data-BmtL8k4r.js";import"./wp-block-editor-store-B-g1aSix.js";import"./wp-block-editor-dnd-BYoS8-II.js";import"./wp-block-editor-library-BpQvynjE.js";import"./wp-block-editor-menus-BTQ2wZ-f.js";import"./wp-block-editor-typography-Bl_1REQP.js";import"./wp-block-editor-spacing-BD_2CpN7.js";import"./wp-block-editor-core-DL280tSA.js";import"./wp-block-editor-selection-CC4tJpUu.js";import"./wp-block-editor-formats-CLXkimOp.js";import"./wp-block-editor-inline-CpXpUhQU.js";import"./wp-block-editor-ui-B8YE_4QL.js";import"./wp-block-editor-transforms-jLcKa8Hv.js";import"./wp-block-editor-preview-iw2Xu1ib.js";import"./wp-block-editor-global-styles-CV5-K6QF.js";import"./wp-block-editor-borders-BH1devca.js";import"./wp-block-editor-patterns-BXdHo9lm.js";import"./wp-block-editor-navigation-BFSoKzg0.js";import"./wp-block-editor-media-Bg-JiQDT.js";import"./wp-api-BeoadipR.js";import"./wp-i18n-DGPtqsXY.js";import"./vendor-monaco-BxJH8uUv.js";import"./wp-block-editor-upload-BLw1R9wP.js";import"./wp-block-editor-templates-o1_wAMb9.js";import"./wp-components-CeQNCpMW.js";import"./checkbox-BfnqKnJs.js";const n=()=>{const a=e(),[l,p]=s.useState([]),[n,m]=s.useState(!1),[j,b]=s.useState(!1),u=s.useCallback(e=>{e.preventDefault(),e.stopPropagation(),b(!1);const s=e.dataTransfer.files;s&&s.length>0&&w(s)},[]),x=s.useCallback(e=>{e.preventDefault(),e.stopPropagation(),b(!0)},[]),g=s.useCallback(e=>{e.preventDefault(),e.stopPropagation(),b(!1)},[]),w=e=>{const s=Array.from(e).map(e=>({file:e,id:`${Date.now()}-${Math.random()}`,status:"pending",progress:0,preview:e.type.startsWith("image/")?URL.createObjectURL(e):void 0}));p(e=>[...e,...s])},h=async e=>{try{p(s=>s.map(s=>s.id===e.id?{...s,status:"uploading",progress:10}:s));const s=new FormData;s.append("file",e.file),s.append("title",e.file.name.replace(/\.[^/.]+$/,""));const t=setInterval(()=>{p(s=>s.map(s=>s.id===e.id&&"uploading"===s.status?{...s,progress:Math.min(s.progress+10,90)}:s))},200),r=await c.api.post("/media/upload",s,{headers:{"Content-Type":"multipart/form-data"}});return clearInterval(t),p(s=>s.map(s=>s.id===e.id?{...s,status:"success",progress:100}:s)),r.data}catch(s){throw p(s=>s.map(s=>s.id===e.id?{...s,status:"error",error:"업로드 실패"}:s)),s}},v=()=>{const e=document.createElement("input");e.type="file",e.multiple=!0,e.accept="image/*,video/*,audio/*,application/pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx",e.onchange=e=>{const s=e.target.files;s&&w(s)},e.click()};return t.jsx("div",{className:"wp-admin-content",children:t.jsxs("div",{className:"wrap",children:[t.jsx("h1",{className:"wp-heading-inline",children:"새 미디어 추가"}),t.jsx("div",{className:"mt-6",children:0===l.length?t.jsxs("div",{className:"border-4 border-dashed rounded-lg p-12 text-center transition-colors "+(j?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"),onDrop:u,onDragOver:x,onDragLeave:g,onClick:v,style:{cursor:"pointer"},children:[t.jsx(r,{className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),t.jsx("h3",{className:"text-xl font-medium text-gray-700 mb-2",children:"파일을 여기에 드래그하거나 클릭하여 선택하세요"}),t.jsx("p",{className:"text-sm text-gray-500",children:"최대 업로드 파일 크기: 100MB"}),t.jsx(d,{variant:"outline",className:"mt-4",onClick:e=>{e.stopPropagation(),v()},children:"파일 선택"})]}):t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsxs("h3",{className:"text-lg font-medium",children:[l.length,"개 파일 선택됨"]}),t.jsxs("div",{className:"space-x-2",children:[t.jsx(d,{variant:"outline",onClick:v,children:"파일 추가"}),t.jsx(d,{onClick:async()=>{m(!0);const e=l.filter(e=>"pending"===e.status);let s=0,t=0;for(const o of e)try{await h(o),s++}catch(r){t++}m(!1),s>0&&(i.success(`${s}개 파일이 업로드되었습니다`),0===t&&setTimeout(()=>{a("/media/library")},1500)),t>0&&i.error(`${t}개 파일 업로드에 실패했습니다`)},disabled:n||l.every(e=>"pending"!==e.status),children:"업로드 시작"})]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(e=>t.jsxs("div",{className:"border rounded-lg p-4 "+("error"===e.status?"border-red-300 bg-red-50":"border-gray-200"),children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"font-medium text-sm truncate",children:e.file.name}),t.jsxs("p",{className:"text-xs text-gray-500",children:[(e.file.size/1024/1024).toFixed(2)," MB"]})]}),"pending"===e.status&&t.jsx("button",{onClick:()=>{return s=e.id,void p(e=>{const t=e.filter(e=>e.id!==s),r=e.find(e=>e.id===s);return r?.preview&&URL.revokeObjectURL(r.preview),t});var s},className:"ml-2 text-gray-400 hover:text-gray-600",children:t.jsx(o,{className:"w-4 h-4"})})]}),e.preview&&t.jsx("img",{src:e.preview,alt:"",className:"w-full h-32 object-cover rounded mb-2"}),"uploading"===e.status&&t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all",style:{width:`${e.progress}%`}})}),"success"===e.status&&t.jsx("div",{className:"text-green-600 text-sm",children:"✓ 업로드 완료"}),"error"===e.status&&t.jsx("div",{className:"text-red-600 text-sm",children:e.error||"업로드 실패"})]},e.id))})]})})]})})},m=()=>t.jsxs(a,{children:[t.jsx(l,{path:"/",element:t.jsx(p,{})}),t.jsx(l,{path:"/library",element:t.jsx(p,{})}),t.jsx(l,{path:"/new",element:t.jsx(n,{})})]});export{m as default};
