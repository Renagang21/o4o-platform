import{u as e,r as s,j as t,cD as a,aE as l,cm as r,bD as n,bG as i,E as d,bn as c,cG as o,bh as x,cH as p,bx as m,bU as h}from"./vendor-react-BoWgD0Bu.js";import{u,a as g,b as j}from"./useOrders-DdRBtptx.js";import{n as b}from"./page-template-editor-CWJwXWLM.js";import{C as y,E as v}from"./vendor-utils-C9jLuAcl.js";import"./vendor-monaco-BxJH8uUv.js";import"./vendor-query-CbBSyLUF.js";import"./ecommerceApi-D0afJ9ty.js";import"./unified-client-bojksyyO.js";import"./index-Bu1ofPbL.js";import"./wp-misc-fiKRzvVp.js";import"./vendor-ui-CrFdsnXa.js";import"./wp-foundation-BzBJX52f.js";import"./wp-block-editor-main-y2nlPlta.js";import"./wp-i18n-BPC8WmOV.js";import"./wp-block-editor-store-PPID3vJI.js";import"./wp-block-editor-utils-C52tDze8.js";import"./wp-components-CKWj6dcl.js";import"./vendor-socket-CMcZe9fK.js";const N=()=>{const N=e(),[f,w]=s.useState(1),[k,C]=s.useState({}),[_,S]=s.useState(""),[M,$]=s.useState([]),[A,D]=s.useState(!1),[E,H]=s.useState(""),{data:I,isLoading:G}=u(f,20,{...k,search:_}),W=g(),q=j(),L=I?.data||[],O=Math.ceil((I?.total||0)/20),P={pending:{bg:"bg-yellow-100",text:"text-yellow-800",icon:t.jsx(h,{className:"w-4 h-4"})},processing:{bg:"bg-blue-100",text:"text-blue-800",icon:t.jsx(m,{className:"w-4 h-4"})},shipped:{bg:"bg-purple-100",text:"text-purple-800",icon:t.jsx(p,{className:"w-4 h-4"})},completed:{bg:"bg-green-100",text:"text-green-800",icon:t.jsx(x,{className:"w-4 h-4"})},cancelled:{bg:"bg-gray-100",text:"text-gray-800",icon:t.jsx(o,{className:"w-4 h-4"})},refunded:{bg:"bg-red-100",text:"text-red-800",icon:t.jsx(c,{className:"w-4 h-4"})}},U=e=>({pending:"대기중",processing:"처리중",shipped:"배송중",completed:"완료",cancelled:"취소됨",refunded:"환불됨"}[e]||e);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"주문 관리"}),t.jsxs("p",{className:"text-gray-600 mt-1",children:["총 ",I?.total||0,"개의 주문이 있습니다"]})]}),t.jsx("div",{className:"flex gap-3",children:t.jsxs("button",{onClick:()=>{W.mutate({action:"export",orderIds:M.length>0?M:[]})},className:"flex items-center px-4 py-2 border rounded-lg hover:bg-gray-50",children:[t.jsx(a,{className:"w-4 h-4 mr-2"}),"내보내기"]})})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("form",{onSubmit:e=>{e.preventDefault(),w(1)},className:"flex-1 max-w-md",children:t.jsxs("div",{className:"relative",children:[t.jsx(l,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),t.jsx("input",{type:"text",value:_,onChange:e=>S(e.target.value),placeholder:"주문번호, 고객명, 이메일로 검색...",className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),t.jsxs("button",{onClick:()=>D(!A),className:"flex items-center px-4 py-2 border rounded-lg hover:bg-gray-50 ml-4",children:[t.jsx(r,{className:"w-4 h-4 mr-2"}),"필터"]})]}),t.jsxs("div",{className:"flex gap-2 mb-4 overflow-x-auto",children:[t.jsxs("button",{onClick:()=>C({}),className:"px-4 py-2 rounded-lg whitespace-nowrap "+(k.status?"bg-gray-100 hover:bg-gray-200":"bg-blue-600 text-white"),children:["전체 (",I?.total||0,")"]}),["pending","processing","shipped","completed","cancelled","refunded"].map(e=>{const s=P[e];return t.jsxs("button",{onClick:()=>C({...k,status:e}),className:"px-4 py-2 rounded-lg whitespace-nowrap flex items-center gap-2 "+(k.status===e?"bg-blue-600 text-white":"bg-gray-100 hover:bg-gray-200"),children:[s.icon,U(e)]},e)})]}),A&&t.jsxs("div",{className:"border-t pt-4 grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"주문 상태"}),t.jsxs("select",{value:k.status||"",onChange:e=>C({...k,status:e.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"전체 상태"}),t.jsx("option",{value:"pending",children:"대기중"}),t.jsx("option",{value:"processing",children:"처리중"}),t.jsx("option",{value:"shipped",children:"배송중"}),t.jsx("option",{value:"completed",children:"완료"}),t.jsx("option",{value:"cancelled",children:"취소됨"}),t.jsx("option",{value:"refunded",children:"환불됨"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"검색 기간"}),t.jsxs("select",{className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"전체 기간"}),t.jsx("option",{value:"today",children:"오늘"}),t.jsx("option",{value:"week",children:"이번 주"}),t.jsx("option",{value:"month",children:"이번 달"})]})]})]})]}),M.length>0&&t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-center justify-between",children:[t.jsxs("p",{className:"text-blue-800",children:[M.length,"개의 주문이 선택되었습니다"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("select",{value:E,onChange:e=>H(e.target.value),className:"border rounded px-3 py-1",children:[t.jsx("option",{value:"",children:"일괄 작업 선택"}),t.jsx("option",{value:"status_processing",children:"처리중으로 변경"}),t.jsx("option",{value:"status_shipped",children:"배송중으로 변경"}),t.jsx("option",{value:"status_completed",children:"완료로 변경"}),t.jsx("option",{value:"export",children:"선택 항목 내보내기"}),t.jsx("option",{value:"delete",children:"삭제"})]}),t.jsx("button",{onClick:async()=>{if(!E||0===M.length)return;if("delete"===E&&!window.confirm(`정말로 ${M.length}개의 주문을 삭제하시겠습니까?`))return;const e=E.startsWith("status_")?"update_status":E;await W.mutateAsync({action:e,orderIds:M,data:E.startsWith("status_")?{status:E.replace("status_","")}:void 0}),$([]),H("")},disabled:!E,className:"px-4 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:"적용"})]})]}),G?t.jsx("div",{className:"text-center py-12",children:t.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):0===L.length?t.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-12 text-center",children:[t.jsx(n,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"주문이 없습니다"}),t.jsx("p",{className:"text-gray-500",children:"아직 주문이 없습니다."})]}):t.jsx("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left",children:t.jsx("input",{type:"checkbox",checked:M.length===L.length,onChange:e=>{e.target.checked?$(L.map(e=>e.id)):$([])},className:"rounded"})}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"주문번호"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"일시"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상태"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"고객"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"결제"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"총액"}),t.jsx("th",{className:"relative px-6 py-3",children:t.jsx("span",{className:"sr-only",children:"작업"})})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:L.map(e=>{const s=P[e.status]||P.pending;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4",children:t.jsx("input",{type:"checkbox",checked:M.includes(e.id),onChange:s=>{s.target.checked?$([...M,e.id]):$(M.filter(s=>s!==e.id))},className:"rounded"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("a",{href:`#/orders/${e.id}`,onClick:s=>{s.preventDefault(),N(`/orders/${e.id}`)},className:"text-blue-600 hover:text-blue-800 font-medium",children:["#",e.orderNumber]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:y(new Date(e.createdAt),"yyyy-MM-dd HH:mm",{locale:v})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium ${s.bg} ${s.text}`,children:[s.icon,U(e.status)]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.customerName||"게스트"}),t.jsx("div",{className:"text-sm text-gray-500",children:e.customerEmail})]})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(i,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{className:"text-sm text-gray-900",children:(a=e.paymentMethod||"",{card:"신용카드",bank_transfer:"계좌이체",virtual_account:"가상계좌",phone:"휴대폰결제",kakao_pay:"카카오페이",naver_pay:"네이버페이",toss:"토스"}[a]||a)})]}),"completed"===e.paymentStatus?t.jsx("span",{className:"text-xs text-green-600",children:"결제완료"}):t.jsx("span",{className:"text-xs text-red-600",children:"미결제"})]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:b(e.total)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx("button",{onClick:()=>N(`/orders/${e.id}`),className:"text-gray-400 hover:text-gray-600",title:"주문 상세보기",children:t.jsx(d,{className:"w-4 h-4"})}),t.jsxs("select",{value:e.status,onChange:s=>(async(e,s)=>{await q.mutateAsync({orderId:e,status:s,note:`상태가 ${s}로 변경되었습니다.`})})(e.id,s.target.value),className:"text-sm border rounded px-2 py-1",onClick:e=>e.stopPropagation(),children:[t.jsx("option",{value:"pending",children:"대기중"}),t.jsx("option",{value:"processing",children:"처리중"}),t.jsx("option",{value:"shipped",children:"배송중"}),t.jsx("option",{value:"completed",children:"완료"}),t.jsx("option",{value:"cancelled",children:"취소"}),t.jsx("option",{value:"refunded",children:"환불"})]})]})})]},e.id);var a})})]})}),O>1&&t.jsx("div",{className:"flex justify-center",children:t.jsxs("nav",{className:"flex space-x-2",children:[t.jsx("button",{onClick:()=>w(Math.max(1,f-1)),disabled:1===f,className:"px-3 py-2 border rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"이전"}),Array.from({length:Math.min(O,5)},(e,s)=>{const a=f>3?f-2+s:s+1;return a>O?null:t.jsx("button",{onClick:()=>w(a),className:"px-3 py-2 border rounded-lg "+(f===a?"bg-blue-600 text-white":"hover:bg-gray-50"),children:a},a)}),t.jsx("button",{onClick:()=>w(Math.min(O,f+1)),disabled:f===O,className:"px-3 py-2 border rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"다음"})]})})]})};export{N as default};
