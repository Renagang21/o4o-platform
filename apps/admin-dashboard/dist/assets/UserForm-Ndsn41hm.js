import{a2 as P,a1 as R,r as b,cf as L,V as u,j as e,a3 as B,$ as I}from"./vendor-react-CMQx0Rxg.js";import{a as D,o as T,_,b as $,s as i,l as q}from"./vendor-forms-D9n_UdA4.js";import{B as j,C,k as w,l as y,t as S,m as k,L as d,I as p,S as H,f as J,g as M,h as z,i as x}from"./page-gutenberg-Bg9cnlWs.js";import{C as G}from"./checkbox-DK2sx4k6.js";import{a as v}from"./base-C2JKQxKM.js";import"./wp-all-CpKe89B2.js";import"./vendor-ui-BkLtITBR.js";import"./vendor-monaco-cpVGocfO.js";import"./vendor-query-B9kD0akd.js";import"./vendor-utils-DQ8F5vJI.js";import"./main-CHvD777f.js";import"./vendor-socket-Ch6lN7-G.js";const K=T({email:i().email("Invalid email address"),password:i().min(6,"Password must be at least 6 characters").optional().or(q("")),firstName:i().optional(),lastName:i().optional(),roles:$(i()).min(1,"At least one role is required"),status:_(["active","pending","approved","rejected"])});function ie(){const{id:c}=P(),o=R(),[h,n]=b.useState(!1),t=!!c,{register:m,handleSubmit:U,setValue:l,watch:f,formState:{errors:r}}=L({resolver:D(K),defaultValues:{email:"",password:"",firstName:"",lastName:"",roles:["customer"],status:"pending"}}),g=f("roles");b.useEffect(()=>{t&&F()},[c]);const F=async()=>{try{n(!0);const s=await v.get(`/v1/users/${c}`);if(s.data.success){const a=s.data.data;l("email",a.email),l("firstName",a.firstName||""),l("lastName",a.lastName||""),l("roles",a.roles),l("status",a.status)}}catch{u.error("Failed to load user"),o("/users")}finally{n(!1)}},A=async s=>{try{n(!0);const a={...s,role:s.roles[0]};t?(a.password||delete a.password,await v.put(`/v1/users/${c}`,a),u.success("User updated successfully")):(await v.post("/v1/users",a),u.success("User created successfully")),o("/users")}catch(a){u.error(a.response?.data?.error||"Failed to save user")}finally{n(!1)}},N=s=>{const a=g||[];a.includes(s)?a.length>1&&l("roles",a.filter(E=>E!==s)):l("roles",[...a,s])},V=[{value:"super_admin",label:"Super Admin",description:"Full system access"},{value:"admin",label:"Admin",description:"Administrative access"},{value:"vendor",label:"Vendor",description:"Vendor/supplier access"},{value:"seller",label:"Seller",description:"Can sell products"},{value:"customer",label:"Customer",description:"Regular user"},{value:"business",label:"Business",description:"Business account"},{value:"moderator",label:"Moderator",description:"Content moderation"},{value:"partner",label:"Partner",description:"Partner access"}];return e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(j,{variant:"ghost",onClick:()=>o("/users"),children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Back to Users"]})}),e.jsx("form",{onSubmit:U(A),children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(C,{children:[e.jsxs(w,{children:[e.jsx(y,{children:t?"Edit User":"Add New User"}),e.jsx(S,{children:t?"Update user information":"Create a new user account"})]}),e.jsxs(k,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"firstName",children:"First Name"}),e.jsx(p,{id:"firstName",...m("firstName"),placeholder:"John"}),r.firstName&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.firstName.message})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"lastName",children:"Last Name"}),e.jsx(p,{id:"lastName",...m("lastName"),placeholder:"Doe"}),r.lastName&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.lastName.message})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"email",children:"Email"}),e.jsx(p,{id:"email",type:"email",...m("email"),placeholder:"john.doe@example.com",disabled:t}),r.email&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.email.message})]}),e.jsxs("div",{children:[e.jsxs(d,{htmlFor:"password",children:["Password ",t&&"(leave blank to keep current)"]}),e.jsx(p,{id:"password",type:"password",...m("password"),placeholder:t?"Leave blank to keep current":"Enter password"}),r.password&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.password.message})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"status",children:"Status"}),e.jsxs(H,{value:f("status"),onValueChange:s=>l("status",s),children:[e.jsx(J,{children:e.jsx(M,{placeholder:"Select status"})}),e.jsxs(z,{children:[e.jsx(x,{value:"active",children:"Active"}),e.jsx(x,{value:"pending",children:"Pending"}),e.jsx(x,{value:"approved",children:"Approved"}),e.jsx(x,{value:"rejected",children:"Rejected"})]})]}),r.status&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.status.message})]})]})]})}),e.jsxs("div",{children:[e.jsxs(C,{children:[e.jsxs(w,{children:[e.jsx(y,{children:"User Roles"}),e.jsx(S,{children:"Select one or more roles for this user"})]}),e.jsxs(k,{children:[e.jsx("div",{className:"space-y-3",children:V.map(s=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>N(s.value),children:[e.jsx(G,{checked:g?.includes(s.value)||!1,onCheckedChange:()=>N(s.value),onClick:a=>a.stopPropagation()}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:s.label}),e.jsx("div",{className:"text-sm text-gray-600",children:s.description})]})]},s.value))}),r.roles&&e.jsx("p",{className:"text-sm text-red-500 mt-2",children:r.roles.message})]})]}),e.jsxs("div",{className:"mt-6 flex gap-3",children:[e.jsxs(j,{type:"submit",className:"flex-1",disabled:h,children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),h?"Saving...":t?"Update User":"Create User"]}),e.jsx(j,{type:"button",variant:"outline",onClick:()=>o("/users"),disabled:h,children:"Cancel"})]})]})]})})]})}export{ie as default};
