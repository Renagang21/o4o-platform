import{u as e,r as s,j as t,b6 as a,cJ as i,bK as r,bg as c,b1 as n,aE as l,c8 as d,bc as o,b7 as x,b8 as m,V as p}from"./vendor-react-BoWgD0Bu.js";import{B as u,n as h}from"./page-template-editor-CWJwXWLM.js";import{cy as j,cB as g,cJ as v}from"./wp-misc-fiKRzvVp.js";import{a as N}from"./api-DhTH7TNi.js";import"./vendor-monaco-BxJH8uUv.js";import"./vendor-ui-CrFdsnXa.js";import"./vendor-query-CbBSyLUF.js";import"./vendor-utils-C9jLuAcl.js";import"./wp-foundation-BzBJX52f.js";import"./wp-block-editor-main-y2nlPlta.js";import"./wp-i18n-BPC8WmOV.js";import"./wp-block-editor-store-PPID3vJI.js";import"./wp-block-editor-utils-C52tDze8.js";import"./wp-components-CKWj6dcl.js";const f=()=>{const f=e(),[w,y]=s.useState([]),[b,C]=s.useState(!0),[S,k]=s.useState(""),[O,D]=s.useState("all"),[L,A]=s.useState(1),[P,I]=s.useState(1),U=async()=>{try{C(!0);const e=new URLSearchParams({page:L.toString(),limit:"20",..."all"!==O&&{status:O}}),s=await N.get(`/v1/coupons?${e}`);y(s.data.data||[]),I(s.data.pagination?.totalPages||1)}catch(e){p.error("Failed to load coupons"),y([{id:"1",code:"WELCOME10",description:"Welcome discount for new customers",discountType:"percent",discountValue:10,minOrderAmount:5e4,usageLimitPerCoupon:100,usageLimitPerCustomer:1,usedCount:23,status:"active",freeShipping:!1,individualUseOnly:!0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"2",code:"SAVE5000",description:"Fixed discount coupon",discountType:"fixed_cart",discountValue:5e3,minOrderAmount:3e4,maxDiscountAmount:5e3,usageLimitPerCoupon:50,usageLimitPerCustomer:2,usedCount:12,status:"active",freeShipping:!0,individualUseOnly:!1,validUntil:new Date(Date.now()+2592e6).toISOString(),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"3",code:"EXPIRED20",description:"Expired promotional coupon",discountType:"percent",discountValue:20,usageLimitPerCoupon:10,usageLimitPerCustomer:1,usedCount:10,status:"expired",freeShipping:!1,individualUseOnly:!0,validUntil:new Date(Date.now()-864e6).toISOString(),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()}])}finally{C(!1)}};s.useEffect(()=>{U()},[L,O]);const E={total:w.length,active:w.filter(e=>"active"===e.status).length,expired:w.filter(e=>"expired"===e.status).length,totalUsage:w.reduce((e,s)=>e+s.usedCount,0)},V=w.filter(e=>e.code.toLowerCase().includes(S.toLowerCase())||e.description?.toLowerCase().includes(S.toLowerCase())),$=e=>{switch(e.discountType){case"percent":return`${e.discountValue}%`;case"fixed_cart":case"fixed_product":return h(e.discountValue);default:return e.discountValue}},_=e=>{switch(e){case"active":return t.jsx(v,{className:"bg-green-100 text-green-800",children:"Active"});case"expired":return t.jsx(v,{className:"bg-red-100 text-red-800",children:"Expired"});case"inactive":return t.jsx(v,{className:"bg-gray-100 text-gray-800",children:"Inactive"});default:return t.jsx(v,{children:e})}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"쿠폰 관리"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"할인 쿠폰을 생성하고 관리하세요"})]}),t.jsx("div",{className:"flex gap-3",children:t.jsxs(u,{onClick:()=>f("/ecommerce/coupons/new"),children:[t.jsx(a,{className:"w-4 h-4 mr-2"}),"새 쿠폰"]})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsx(j,{children:t.jsx(g,{className:"p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"전체 쿠폰"}),t.jsx("p",{className:"text-2xl font-bold",children:E.total})]}),t.jsx(i,{className:"w-8 h-8 text-blue-500"})]})})}),t.jsx(j,{children:t.jsx(g,{className:"p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"활성 쿠폰"}),t.jsx("p",{className:"text-2xl font-bold text-green-600",children:E.active})]}),t.jsx(r,{className:"w-8 h-8 text-green-500"})]})})}),t.jsx(j,{children:t.jsx(g,{className:"p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"만료된 쿠폰"}),t.jsx("p",{className:"text-2xl font-bold text-red-600",children:E.expired})]}),t.jsx(c,{className:"w-8 h-8 text-red-500"})]})})}),t.jsx(j,{children:t.jsx(g,{className:"p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"총 사용 횟수"}),t.jsx("p",{className:"text-2xl font-bold",children:E.totalUsage})]}),t.jsx(n,{className:"w-8 h-8 text-purple-500"})]})})})]}),t.jsx(j,{children:t.jsx(g,{className:"p-4",children:t.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[t.jsx("div",{className:"flex-1",children:t.jsxs("div",{className:"relative",children:[t.jsx(l,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),t.jsx("input",{type:"text",placeholder:"쿠폰 코드 또는 설명 검색...",value:S,onChange:e=>k(e.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),t.jsxs("select",{value:O,onChange:e=>D(e.target.value),className:"px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"all",children:"모든 상태"}),t.jsx("option",{value:"active",children:"활성"}),t.jsx("option",{value:"inactive",children:"비활성"}),t.jsx("option",{value:"expired",children:"만료됨"})]})]})})}),t.jsx(j,{children:t.jsx(g,{className:"p-0",children:b?t.jsx("div",{className:"p-8 text-center",children:t.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):0===V.length?t.jsxs("div",{className:"p-8 text-center",children:[t.jsx(i,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500",children:"쿠폰이 없습니다"}),t.jsx(u,{className:"mt-4",onClick:()=>f("/ecommerce/coupons/new"),children:"첫 쿠폰 만들기"})]}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-b",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"쿠폰 코드"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"할인"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"사용 현황"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"유효 기간"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상태"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"작업"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:V.map(e=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.code}),e.description&&t.jsx("div",{className:"text-sm text-gray-500",children:e.description})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium",children:$(e)}),e.minOrderAmount&&t.jsxs("div",{className:"text-xs text-gray-500",children:["최소 ",h(e.minOrderAmount)]})]})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[t.jsxs("div",{className:"text-sm",children:[e.usedCount," / ",e.usageLimitPerCoupon||"∞"]}),t.jsxs("div",{className:"text-xs text-gray-500",children:["고객당 ",e.usageLimitPerCustomer,"회"]})]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.validUntil?t.jsxs("div",{className:"text-sm",children:[t.jsx(d,{className:"w-4 h-4 inline mr-1"}),new Date(e.validUntil).toLocaleDateString()]}):t.jsx("span",{className:"text-sm text-gray-500",children:"무제한"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:_(e.status)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(u,{size:"sm",variant:"ghost",onClick:()=>f(`/ecommerce/coupons/${e.id}/edit`),children:t.jsx(o,{className:"w-4 h-4"})}),t.jsx(u,{size:"sm",variant:"ghost",onClick:()=>(async e=>{try{const s=`${e.code}_COPY_${Date.now()}`;await N.post("/v1/coupons",{...e,id:void 0,code:s,usedCount:0}),p.success("Coupon duplicated successfully"),U()}catch(s){p.error("Failed to duplicate coupon")}})(e),children:t.jsx(x,{className:"w-4 h-4"})}),t.jsx(u,{size:"sm",variant:"ghost",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this coupon?"))try{await N.delete(`/v1/coupons/${e}`),p.success("Coupon deleted successfully"),U()}catch(s){p.error("Failed to delete coupon")}})(e.id),className:"text-red-600 hover:text-red-700",children:t.jsx(m,{className:"w-4 h-4"})})]})})]},e.id))})]})})})}),P>1&&t.jsxs("div",{className:"flex justify-center gap-2",children:[t.jsx(u,{variant:"outline",onClick:()=>A(e=>Math.max(1,e-1)),disabled:1===L,children:"이전"}),t.jsxs("span",{className:"flex items-center px-4",children:[L," / ",P]}),t.jsx(u,{variant:"outline",onClick:()=>A(e=>Math.min(P,e+1)),disabled:L===P,children:"다음"})]})]})};export{f as default};
