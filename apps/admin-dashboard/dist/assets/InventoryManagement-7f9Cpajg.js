import{r as e,j as t,c8 as s,bg as r,c_ as a,bQ as n,E as i,V as o}from"./vendor-react-BQ6HOJoh.js";import{u as d,a as l,b as c}from"./vendor-query-LYSOqK5P.js";import{B as x,I as m,L as p,T as j,b as h}from"./page-template-editor-C7FodHrK.js";import{ak as u,al as y,am as v,an as b,az as N,aA as f,aB as g,aC as w,aD as k,aE as S,av as q}from"./wp-misc-DS9m4_P2.js";import"./wp-block-editor-a11y-DrduSWFW.js";import"./wp-block-editor-misc-pHCPYvR2.js";import"./wp-block-editor-api-Buev8_QU.js";import"./wp-block-editor-utils-M5qXzE1L.js";import"./wp-block-editor-colors-D38h-Odz.js";import"./wp-blocks-core-6vwQKPfS.js";import"./wp-block-editor-clipboard-Dg0Y1gQ6.js";import"./wp-block-editor-store-B-g1aSix.js";import"./vendor-ui-CrFdsnXa.js";import"./wp-block-editor-dnd-BYoS8-II.js";import"./wp-block-editor-library-BpQvynjE.js";import"./wp-block-editor-menus-BTQ2wZ-f.js";import"./wp-block-editor-keyboard-CeHTtvP5.js";import"./wp-block-editor-typography-Bl_1REQP.js";import"./wp-block-editor-spacing-BD_2CpN7.js";import"./wp-block-editor-core-DL280tSA.js";import"./wp-block-editor-selection-CC4tJpUu.js";import"./wp-block-editor-formats-CLXkimOp.js";import"./wp-block-editor-inline-CpXpUhQU.js";import"./wp-block-editor-ui-B8YE_4QL.js";import"./wp-block-editor-transforms-jLcKa8Hv.js";import"./wp-block-editor-preview-iw2Xu1ib.js";import"./wp-block-editor-global-styles-CV5-K6QF.js";import"./wp-block-editor-borders-BH1devca.js";import"./wp-block-editor-patterns-BXdHo9lm.js";import"./wp-block-editor-navigation-BFSoKzg0.js";import"./wp-block-editor-media-Bg-JiQDT.js";import"./wp-api-BeoadipR.js";import"./wp-i18n-DGPtqsXY.js";import"./wp-core-Y-jV-nrZ.js";import"./vendor-monaco-BxJH8uUv.js";import"./wp-block-editor-upload-BLw1R9wP.js";import"./vendor-utils-D-spY-QM.js";import"./wp-block-editor-templates-o1_wAMb9.js";import"./wp-data-BmtL8k4r.js";import"./wp-components-CeQNCpMW.js";const C=()=>{const C=d(),[I,F]=e.useState(""),[_,K]=e.useState("all"),[P,O]=e.useState(null),[L,$]=e.useState(!1),[z,D]=e.useState(!1),[A,B]=e.useState({inventoryItemId:"",type:"increase",quantity:0,reason:"",notes:""}),{data:E,isLoading:Q}=l({queryKey:["inventory",I,_],queryFn:async()=>{const e=new URLSearchParams;I&&e.append("search",I),"all"!==_&&e.append("status",_);return(await h.api.get(`/v1/inventory?${e.toString()}`)).data}}),U=E?.data||[],{data:R}=l({queryKey:["stock-movements",P?.id],queryFn:async()=>{if(!P?.id)return{data:[]};return(await h.api.get(`/v1/inventory/${P.id}/movements`)).data},enabled:!!P?.id&&z}),V=R?.data||[],{data:G}=l({queryKey:["inventory-stats"],queryFn:async()=>(await h.api.get("/v1/inventory/stats")).data}),H=G?.data||{},T=c({mutationFn:async e=>(await h.api.post("/v1/inventory/adjust",e)).data,onSuccess:()=>{o.success("재고가 조정되었습니다"),C.invalidateQueries({queryKey:["inventory"]}),C.invalidateQueries({queryKey:["inventory-stats"]}),$(!1),B({inventoryItemId:"",type:"increase",quantity:0,reason:"",notes:""})}}),J=c({mutationFn:async e=>(await h.api.post("/v1/inventory/bulk-reorder",{itemIds:e})).data,onSuccess:()=>{o.success("대량 재주문이 요청되었습니다")}}),M=U.filter(e=>e.currentStock<=e.reorderPoint&&"discontinued"!==e.status);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-modern-text-primary",children:"재고 관리"}),t.jsx("p",{className:"text-modern-text-secondary mt-1",children:"실시간 재고 추적 및 관리"})]}),t.jsx("div",{className:"flex gap-2",children:M.length>0&&t.jsxs(x,{variant:"outline",onClick:()=>J.mutate(M.map(e=>e.id)),disabled:J.isPending,children:[t.jsx(s,{className:"w-4 h-4 mr-2"}),"부족 재고 재주문 (",M.length,")"]})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs(u,{children:[t.jsx(y,{className:"pb-2",children:t.jsx(v,{className:"text-sm font-medium text-modern-text-secondary",children:"총 상품 수"})}),t.jsxs(b,{children:[t.jsx("div",{className:"text-2xl font-bold text-modern-text-primary",children:H.totalItems||0}),t.jsx("p",{className:"text-xs text-modern-text-tertiary mt-1",children:"활성 상품 기준"})]})]}),t.jsxs(u,{children:[t.jsx(y,{className:"pb-2",children:t.jsx(v,{className:"text-sm font-medium text-modern-text-secondary",children:"부족 재고"})}),t.jsxs(b,{children:[t.jsx("div",{className:"text-2xl font-bold text-orange-600",children:H.lowStockItems||0}),t.jsx("p",{className:"text-xs text-modern-text-tertiary mt-1",children:"재주문 필요"})]})]}),t.jsxs(u,{children:[t.jsx(y,{className:"pb-2",children:t.jsx(v,{className:"text-sm font-medium text-modern-text-secondary",children:"품절 상품"})}),t.jsxs(b,{children:[t.jsx("div",{className:"text-2xl font-bold text-red-600",children:H.outOfStockItems||0}),t.jsx("p",{className:"text-xs text-modern-text-tertiary mt-1",children:"즉시 보충 필요"})]})]}),t.jsxs(u,{children:[t.jsx(y,{className:"pb-2",children:t.jsx(v,{className:"text-sm font-medium text-modern-text-secondary",children:"총 재고 가치"})}),t.jsxs(b,{children:[t.jsxs("div",{className:"text-2xl font-bold text-modern-text-primary",children:["₩",(H.totalValue||0).toLocaleString()]}),t.jsx("p",{className:"text-xs text-modern-text-tertiary mt-1",children:"원가 기준"})]})]})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[t.jsx("div",{className:"flex-1",children:t.jsxs("div",{className:"relative",children:[t.jsx(r,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-modern-text-tertiary w-5 h-5"}),t.jsx(m,{type:"text",placeholder:"상품명, SKU로 검색...",value:I,onChange:e=>F(e.target.value),className:"pl-10"})]})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(a,{className:"w-5 h-5 text-modern-text-secondary"}),t.jsxs("select",{value:_,onChange:e=>K(e.target.value),className:"px-4 py-2 border border-modern-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-modern-primary",children:[t.jsx("option",{value:"all",children:"모든 상태"}),t.jsx("option",{value:"in_stock",children:"정상 재고"}),t.jsx("option",{value:"low_stock",children:"부족 재고"}),t.jsx("option",{value:"out_of_stock",children:"품절"}),t.jsx("option",{value:"discontinued",children:"단종"})]})]})]}),t.jsx(u,{children:t.jsx(b,{className:"p-0",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-modern-bg-tertiary border-b border-modern-border-primary",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"상품 정보"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"현재 재고"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"예약 재고"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"재주문점"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"상태"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"위치"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"작업"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-modern-border-primary",children:Q?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-6 py-12 text-center",children:t.jsx("div",{className:"flex justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-modern-primary"})})})}):0===U.length?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-6 py-12 text-center text-modern-text-secondary",children:"재고 데이터가 없습니다."})}):U.map(e=>{return t.jsxs("tr",{className:"hover:bg-modern-bg-hover",children:[t.jsx("td",{className:"px-6 py-4",children:t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium text-modern-text-primary",children:e.productName}),t.jsxs("div",{className:"text-sm text-modern-text-secondary",children:["SKU: ",e.sku]}),e.variantOptions&&t.jsx("div",{className:"text-xs text-modern-text-tertiary",children:Object.entries(e.variantOptions).map(([e,t])=>`${e}: ${t}`).join(", ")})]})}),t.jsx("td",{className:"px-6 py-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-medium text-modern-text-primary",children:e.currentStock}),e.currentStock<=e.reorderPoint&&t.jsx(s,{className:"w-4 h-4 text-orange-500"})]})}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("span",{className:"text-sm text-modern-text-secondary",children:e.reservedStock})}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("span",{className:"text-sm text-modern-text-secondary",children:e.reorderPoint})}),t.jsx("td",{className:"px-6 py-4",children:(r=e.status,a=e.currentStock,o=e.reorderPoint,"out_of_stock"===r||0===a?t.jsx(q,{variant:"destructive",children:"품절"}):"low_stock"===r||a<=o?t.jsx(q,{variant:"outline",className:"text-orange-600 border-orange-600",children:"부족"}):"discontinued"===r?t.jsx(q,{variant:"secondary",children:"단종"}):t.jsx(q,{children:"정상"}))}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("span",{className:"text-sm text-modern-text-secondary",children:e.location||"-"})}),t.jsx("td",{className:"px-6 py-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(x,{variant:"ghost",size:"sm",onClick:()=>(e=>{O(e),B({inventoryItemId:e.id,type:"increase",quantity:0,reason:"",notes:""}),$(!0)})(e),children:t.jsx(n,{className:"w-4 h-4"})}),t.jsx(x,{variant:"ghost",size:"sm",onClick:()=>(e=>{O(e),D(!0)})(e),children:t.jsx(i,{className:"w-4 h-4"})})]})})]},e.id);var r,a,o})})]})})})}),t.jsx(N,{open:L,onOpenChange:$,children:t.jsx(f,{children:t.jsxs("form",{onSubmit:e=>{e.preventDefault(),A.quantity&&A.reason?T.mutate(A):o.error("수량과 사유를 입력하세요")},children:[t.jsxs(g,{children:[t.jsx(w,{children:"재고 조정"}),t.jsxs(k,{children:[P?.productName," - ",P?.sku]})]}),t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsx("div",{children:t.jsxs(p,{children:["현재 재고: ",P?.currentStock,"개"]})}),t.jsxs("div",{children:[t.jsx(p,{htmlFor:"type",children:"조정 유형"}),t.jsxs("select",{id:"type",value:A.type,onChange:e=>B(t=>({...t,type:e.target.value})),className:"w-full px-3 py-2 border border-modern-border-primary rounded-lg mt-1",children:[t.jsx("option",{value:"increase",children:"증가"}),t.jsx("option",{value:"decrease",children:"감소"}),t.jsx("option",{value:"set",children:"절대값 설정"})]})]}),t.jsxs("div",{children:[t.jsx(p,{htmlFor:"quantity",children:"수량"}),t.jsx(m,{id:"quantity",type:"number",min:"0",value:A.quantity,onChange:e=>B(t=>({...t,quantity:parseInt(e.target.value)||0})),required:!0})]}),t.jsxs("div",{children:[t.jsx(p,{htmlFor:"reason",children:"조정 사유 *"}),t.jsxs("select",{id:"reason",value:A.reason,onChange:e=>B(t=>({...t,reason:e.target.value})),className:"w-full px-3 py-2 border border-modern-border-primary rounded-lg mt-1",required:!0,children:[t.jsx("option",{value:"",children:"사유를 선택하세요"}),t.jsx("option",{value:"manual_count",children:"실사 조정"}),t.jsx("option",{value:"damaged",children:"손상품 처리"}),t.jsx("option",{value:"expired",children:"유통기한 만료"}),t.jsx("option",{value:"returned",children:"반품 처리"}),t.jsx("option",{value:"promotional",children:"판촉 사용"}),t.jsx("option",{value:"theft",children:"분실/도난"}),t.jsx("option",{value:"other",children:"기타"})]})]}),t.jsxs("div",{children:[t.jsx(p,{htmlFor:"notes",children:"메모"}),t.jsx(j,{id:"notes",value:A.notes,onChange:e=>B(t=>({...t,notes:e.target.value})),placeholder:"추가 설명을 입력하세요...",rows:3})]})]}),t.jsxs(S,{children:[t.jsx(x,{type:"button",variant:"outline",onClick:()=>$(!1),children:"취소"}),t.jsx(x,{type:"submit",disabled:T.isPending,children:"조정하기"})]})]})})}),t.jsx(N,{open:z,onOpenChange:D,children:t.jsxs(f,{className:"max-w-4xl",children:[t.jsxs(g,{children:[t.jsx(w,{children:"입출고 이력"}),t.jsxs(k,{children:[P?.productName," - ",P?.sku]})]}),t.jsx("div",{className:"max-h-96 overflow-y-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-modern-bg-tertiary sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-modern-text-secondary",children:"일시"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-modern-text-secondary",children:"유형"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-modern-text-secondary",children:"수량"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-modern-text-secondary",children:"잔여"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-modern-text-secondary",children:"사유"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-modern-text-secondary",children:"참조"})]})}),t.jsx("tbody",{children:V.map(e=>{const s=(e=>{switch(e){case"in":return{label:"입고",color:"text-green-600"};case"out":return{label:"출고",color:"text-red-600"};case"adjustment":return{label:"조정",color:"text-blue-600"};case"reserved":return{label:"예약",color:"text-orange-600"};case"unreserved":return{label:"예약해제",color:"text-purple-600"};default:return{label:e,color:"text-gray-600"}}})(e.type);return t.jsxs("tr",{className:"border-b border-modern-border-primary",children:[t.jsx("td",{className:"px-4 py-2 text-sm",children:new Date(e.createdAt).toLocaleString("ko-KR")}),t.jsx("td",{className:"px-4 py-2",children:t.jsx("span",{className:`text-sm font-medium ${s.color}`,children:s.label})}),t.jsxs("td",{className:"px-4 py-2 text-sm",children:["out"===e.type||"adjustment"===e.type?"-":"+",e.quantity]}),t.jsx("td",{className:"px-4 py-2 text-sm",children:e.remainingStock}),t.jsx("td",{className:"px-4 py-2 text-sm",children:e.reason}),t.jsx("td",{className:"px-4 py-2 text-sm",children:e.reference||"-"})]},e.id)})})]})}),t.jsx(S,{children:t.jsx(x,{onClick:()=>D(!1),children:"닫기"})})]})})]})};export{C as default};
