const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vendor-react-Bb0TGSr4.js","assets/vendor-monaco-BxJH8uUv.js","assets/vendor-ui-CrFdsnXa.js","assets/vendor-utils-B-KQWpLj.js","assets/block-group-BascGEu1.js","assets/block-columns-DWjg4ArH.js"])))=>i.map(i=>d[i]);
import{r as e,j as t,a as s,b as a,c as r,d as n,V as l,u as o,X as i,S as c,e as d,L as m,I as u,U as h,A as x,f as g,g as p,R as b,h as f,T as v,i as y,k as j,l as w,m as N,n as k,Q as C,o as S,p as E,q as T,s as R,C as P,t as I,v as B,F as D,w as _,H as L,x as A,y as $,z,P as F,B as O,D as U,E as M,J as H,K as V,N as q,O as J,W as G,Y as W,Z as K,_ as Q,$ as Y,a0 as X,a1 as Z,a2 as ee}from"./vendor-react-Bb0TGSr4.js";import{t as te,c as se}from"./vendor-ui-CrFdsnXa.js";import{u as ae,a as re,b as ne}from"./vendor-query-BEO_OofR.js";import{a as le,f as oe}from"./vendor-utils-B-KQWpLj.js";import{p as ie,c as ce,B as de,a as me,W as ue,O as he,b as xe,d as ge,s as pe}from"./wp-foundation-Ht0JG6Uo.js";import{P as be}from"./wp-components-CoD93iDH.js";const fe={},ve=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),s=e?.nonce||e?.getAttribute("nonce");r=t.map(e=>{if((e=function(e){return"/"+e}(e))in fe)return;fe[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,s&&r.setAttribute("nonce",s),document.head.appendChild(r),t?new Promise((t,s)=>{r.addEventListener("load",t),r.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${e}`)))}):void 0}),a=Promise.all(r.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))}var r;function n(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return a.then(t=>{for(const e of t||[])"rejected"===e.status&&n(e.reason);return e().catch(n)})};class ye{constructor(e){this.baseURL=e,this.api=le.create({baseURL:this.baseURL,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(e=>{let t=localStorage.getItem("accessToken")||localStorage.getItem("authToken");if(!t){const e=localStorage.getItem("auth-storage");if(e)try{const s=JSON.parse(e);s.state?.token&&(t=s.state.token)}catch{}}return t&&(e.headers.Authorization=`Bearer ${t}`),e})}async login(e){return(await this.api.post("/auth/login",e)).data}async logout(){await this.api.post("/auth/logout")}async checkSession(){try{return(await this.api.get("/accounts/sso/check")).data}catch(e){return{isAuthenticated:!1}}}}const je=new ye((()=>{const e="https://api.neture.co.kr/api/v1";if("undefined"==typeof window)return e;try{if(globalThis.import?.meta?.env?.VITE_API_URL)return globalThis.import.meta.env.VITE_API_URL}catch{}return window.__API_URL__?window.__API_URL__:e})());const we=new class{constructor(e){this.refreshPromise=null,this.currentToken=null,this.baseURL=e,this.api=le.create({baseURL:this.baseURL,headers:{"Content-Type":"application/json"},withCredentials:!0}),this.api.interceptors.response.use(e=>e,async e=>{const t=e.config;if(401===e.response?.status&&!t._retry){if(t._retry=!0,this.refreshPromise){if(await this.refreshPromise)return this.api.request(t);throw e}this.refreshPromise=this.refreshToken();const s=await this.refreshPromise;if(this.refreshPromise=null,s)return this.api.request(t)}return Promise.reject(e)})}async login(e){const t=await this.api.post("/auth/v2/login",e);return t.data.token&&(this.currentToken=t.data.token),t.data}async register(e){return(await this.api.post("/auth/v2/register",e)).data}async logout(){try{await this.api.post("/auth/v2/logout")}catch(e){}finally{this.currentToken=null}}async logoutAll(){await this.api.post("/auth/v2/logout-all"),this.currentToken=null}async refreshToken(){try{return(await this.api.post("/auth/v2/refresh")).data.success}catch(e){return!1}}async getCurrentUser(){try{return(await this.api.get("/auth/v2/me")).data.user}catch(e){return null}}getApiUrl(){return this.baseURL}getAccessToken(){return this.currentToken}setupSessionSync(){"undefined"!=typeof window&&window.addEventListener("storage",e=>{"auth-logout"===e.key?window.location.reload():"auth-login"===e.key&&this.refreshToken()})}broadcastAuthChange(e){if("undefined"==typeof window)return;const t=`auth-${e}`;localStorage.setItem(t,Date.now().toString()),setTimeout(()=>localStorage.removeItem(t),100)}async loginWithSync(e){const t=await this.login(e);return this.broadcastAuthChange("login"),t}async logoutWithSync(){await this.logout(),this.broadcastAuthChange("logout")}}("undefined"!=typeof window&&"localhost"===window.location.hostname?"http://localhost:4000/api/v1":"/api/v1");"undefined"!=typeof window&&we.setupSessionSync();new class{constructor(e){this.checkInterval=null,this.handleStorageEvent=e=>{"sso:logout"===e.key?this.handleLogout():"sso:login"===e.key&&this.checkSession()},this.config={checkInterval:3e4,...e}}initialize(e){this.onSessionChange=e,"undefined"!=typeof window&&window.addEventListener("storage",this.handleStorageEvent),this.startSessionMonitoring(),this.checkSession()}destroy(){"undefined"!=typeof window&&window.removeEventListener("storage",this.handleStorageEvent),this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)}startSessionMonitoring(){this.checkInterval&&clearInterval(this.checkInterval),this.checkInterval=setInterval(()=>{this.checkSession()},this.config.checkInterval)}async checkSession(){try{const e=await fetch(`${this.config.apiUrl}/auth/v2/me`,{credentials:"include",headers:{"Content-Type":"application/json"}});if(e.ok){const t=(await e.json()).user;return this.onSessionChange?.(t),t}return this.onSessionChange?.(null),null}catch(e){return this.onSessionChange?.(null),null}}broadcastLogin(){"undefined"!=typeof window&&(localStorage.setItem("sso:login",Date.now().toString()),localStorage.removeItem("sso:login"))}broadcastLogout(){"undefined"!=typeof window&&(localStorage.setItem("sso:logout",Date.now().toString()),localStorage.removeItem("sso:logout"))}handleLogout(){this.onSessionChange?.(null),this.config.domain&&(window.location.href="/login")}getSessionId(){if("undefined"==typeof document)return null;const e=document.cookie.match(/sessionId=([^;]+)/);return e?e[1]:null}hasSession(){return!!this.getSessionId()}}({apiUrl:"undefined"!=typeof window&&"localhost"===window.location.hostname?"http://localhost:4000/api/v1":"/api/v1"});const Ne=function(e,t="KRW",s="ko-KR"){const a="string"==typeof e?parseFloat(e):e;return isNaN(a)?"₩0":new Intl.NumberFormat(s,{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0}).format(a)},ke=function(e,t="medium",s="ko-KR"){const a="string"==typeof e||"number"==typeof e?new Date(e):e;if(isNaN(a.getTime()))return"";const r={};switch(t){case"short":r.year="numeric",r.month="2-digit",r.day="2-digit";break;case"medium":r.year="numeric",r.month="long",r.day="numeric";break;case"long":r.year="numeric",r.month="long",r.day="numeric",r.weekday="long";break;case"full":r.year="numeric",r.month="long",r.day="numeric",r.weekday="long",r.hour="2-digit",r.minute="2-digit"}return new Intl.DateTimeFormat(s,r).format(a)};function Ce(...e){return te(se(e))}const Se=e.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:Ce("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));Se.displayName="Card";const Ee=e.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:Ce("flex flex-col space-y-1.5 p-6",e),...s}));Ee.displayName="CardHeader";const Te=e.forwardRef(({className:e,...s},a)=>t.jsx("h3",{ref:a,className:Ce("text-2xl font-semibold leading-none tracking-tight",e),...s}));Te.displayName="CardTitle";const Re=e.forwardRef(({className:e,...s},a)=>t.jsx("p",{ref:a,className:Ce("text-sm text-muted-foreground",e),...s}));Re.displayName="CardDescription";const Pe=e.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:Ce("p-6 pt-0",e),...s}));Pe.displayName="CardContent";const Ie=e.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:Ce("flex items-center p-6 pt-0",e),...s}));Ie.displayName="CardFooter";const Be=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,De=se,_e=(e,t)=>s=>{var a;if(null==(null==t?void 0:t.variants))return De(e,null==s?void 0:s.class,null==s?void 0:s.className);const{variants:r,defaultVariants:n}=t,l=Object.keys(r).map(e=>{const t=null==s?void 0:s[e],a=null==n?void 0:n[e];if(null===t)return null;const l=Be(t)||Be(a);return r[e][l]}),o=s&&Object.entries(s).reduce((e,t)=>{let[s,a]=t;return void 0===a||(e[s]=a),e},{}),i=null==t||null===(a=t.compoundVariants)||void 0===a?void 0:a.reduce((e,t)=>{let{class:s,className:a,...r}=t;return Object.entries(r).every(e=>{let[t,s]=e;return Array.isArray(s)?s.includes({...n,...o}[t]):{...n,...o}[t]===s})?[...e,s,a]:e},[]);return De(e,l,i,null==s?void 0:s.class,null==s?void 0:s.className)},Le=_e("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 transform active:scale-95",{variants:{variant:{default:"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-md hover:from-blue-700 hover:to-blue-800 hover:shadow-lg focus-visible:ring-blue-500",destructive:"bg-gradient-to-r from-red-600 to-red-700 text-white shadow-md hover:from-red-700 hover:to-red-800 hover:shadow-lg focus-visible:ring-red-500",outline:"border-2 border-gray-300 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-400 focus-visible:ring-gray-500",secondary:"bg-gradient-to-r from-gray-100 to-gray-200 text-gray-800 shadow-sm hover:from-gray-200 hover:to-gray-300 focus-visible:ring-gray-500",ghost:"text-gray-600 hover:bg-gray-100 hover:text-gray-900 focus-visible:ring-gray-500",link:"text-blue-600 underline-offset-4 hover:underline hover:text-blue-800 focus-visible:ring-blue-500",primary:"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-md hover:from-blue-700 hover:to-blue-800 hover:shadow-lg transform hover:-translate-y-0.5 focus-visible:ring-blue-500",success:"bg-gradient-to-r from-green-600 to-green-700 text-white shadow-md hover:from-green-700 hover:to-green-800 hover:shadow-lg focus-visible:ring-green-500"},size:{default:"h-10 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-12 rounded-md px-8 text-base",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Ae=e.forwardRef(({className:e,variant:s,size:a,...r},n)=>t.jsx("button",{className:Ce(Le({variant:s,size:a,className:e})),ref:n,...r}));Ae.displayName="Button";const $e=e.createContext(null),ze=e.createContext(null),Fe=({open:s,defaultOpen:a=!1,onOpenChange:r,children:n})=>{const[l,o]=e.useState(a),i=s??l;return t.jsx($e.Provider,{value:{open:i,onOpenChange:e=>{void 0===s&&o(e),r?.(e)}},children:t.jsx("div",{className:"relative inline-block text-left",children:n})})},Oe=e.forwardRef(({onClick:s,...a},r)=>{const n=e.useContext($e);if(!n)throw new Error("DropdownMenuTrigger must be used within DropdownMenu");return t.jsx("button",{ref:r,onClick:e=>{s?.(e),n.onOpenChange(!n.open)},"aria-expanded":n.open,"aria-haspopup":"true",...a})}),Ue=e.forwardRef(({className:s,sideOffset:a=4,children:r,...n})=>{const l=e.useContext($e);if(!l)throw new Error("DropdownMenuContent must be used within DropdownMenu");const o=e.useRef(null);return e.useEffect(()=>{const e=e=>{o.current&&!o.current.contains(e.target)&&l.onOpenChange(!1)};if(l.open)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[l]),l.open?t.jsx("div",{ref:o,className:Ce("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","animate-in fade-in-0 zoom-in-95",s),style:{marginTop:`${a}px`},...n,children:r}):null}),Me=e.forwardRef(({className:s,inset:a,disabled:r,onClick:n,...l},o)=>{const i=e.useContext($e);return t.jsx("div",{ref:o,className:Ce("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors","hover:bg-accent hover:text-accent-foreground","focus:bg-accent focus:text-accent-foreground",r&&"pointer-events-none opacity-50",a&&"pl-8",s),onClick:e=>{r||(n?.(e),i?.onOpenChange(!1))},role:"menuitem","aria-disabled":r,...l})}),He=e.forwardRef(({className:e,children:a,checked:r,onCheckedChange:n,disabled:l,onClick:o,...i},c)=>t.jsxs("div",{ref:c,className:Ce("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors","hover:bg-accent hover:text-accent-foreground","focus:bg-accent focus:text-accent-foreground",l&&"pointer-events-none opacity-50",e),onClick:e=>{l||(o?.(e),n?.(!r))},role:"menuitemcheckbox","aria-checked":r,"aria-disabled":l,...i,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:r&&t.jsx(s,{className:"h-4 w-4"})}),a]})),Ve=e.forwardRef(({className:s,children:r,value:n,disabled:l,onClick:o,...i},c)=>{const d=e.useContext(ze),m=d?.value===n;return t.jsxs("div",{ref:c,className:Ce("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors","hover:bg-accent hover:text-accent-foreground","focus:bg-accent focus:text-accent-foreground",l&&"pointer-events-none opacity-50",s),onClick:e=>{l||(o?.(e),d?.onValueChange(n))},role:"menuitemradio","aria-checked":m,"aria-disabled":l,...i,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:m&&t.jsx(a,{className:"h-2 w-2 fill-current"})}),r]})}),qe=e.forwardRef(({className:e,inset:s,...a},r)=>t.jsx("div",{ref:r,className:Ce("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",e),...a})),Je=e.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:Ce("-mx-1 my-1 h-px bg-muted",e),role:"separator",...s})),Ge=e.forwardRef(({className:s,inset:a,children:n,disabled:l,...o},i)=>{const c=e.useContext($e);if(!c)throw new Error("DropdownMenuSubTrigger must be used within DropdownMenuSub");return t.jsxs("div",{ref:i,className:Ce("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none","hover:bg-accent","data-[state=open]:bg-accent",l&&"pointer-events-none opacity-50",a&&"pl-8",s),onClick:()=>!l&&c.onOpenChange(!c.open),"data-state":c.open?"open":"closed",...o,children:[n,t.jsx(r,{className:"ml-auto h-4 w-4"})]})}),We=e.forwardRef(({className:s,children:a,...r},n)=>{const l=e.useContext($e);if(!l)throw new Error("DropdownMenuSubContent must be used within DropdownMenuSub");return l.open?t.jsx("div",{ref:n,className:Ce("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg","absolute left-full top-0 ml-1","animate-in fade-in-0 zoom-in-95",s),...r,children:a}):null});Oe.displayName="DropdownMenuTrigger",Ue.displayName="DropdownMenuContent",Me.displayName="DropdownMenuItem",He.displayName="DropdownMenuCheckboxItem",Ve.displayName="DropdownMenuRadioItem",qe.displayName="DropdownMenuLabel",Je.displayName="DropdownMenuSeparator",We.displayName="DropdownMenuSubContent",Ge.displayName="DropdownMenuSubTrigger";const Ke=e.forwardRef(({className:e,type:s,...a},r)=>t.jsx("input",{type:s,className:Ce("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...a}));Ke.displayName="Input";const Qe=_e("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ye({className:e,variant:s,...a}){return t.jsx("div",{className:Ce(Qe({variant:s}),e),...a})}const Xe=_e("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ze=e.forwardRef(({className:e,...s},a)=>t.jsx("label",{ref:a,className:Ce(Xe(),e),...s}));Ze.displayName="Label";const et=e.createContext(null),tt=({value:s,defaultValue:a="",onValueChange:r,children:n})=>{const[l,o]=e.useState(a),[i,c]=e.useState(!1),d=s??l;return t.jsx(et.Provider,{value:{value:d,onValueChange:e=>{void 0===s&&o(e),r?.(e),c(!1)},open:i,setOpen:c},children:n})},st=({placeholder:s})=>{const a=e.useContext(et);if(!a)throw new Error("SelectValue must be used within Select");return t.jsx("span",{children:a.value||s})},at=e.forwardRef(({className:s,children:a,...r})=>{const l=e.useContext(et);if(!l)throw new Error("SelectTrigger must be used within Select");const o=e.useRef(null);return e.useEffect(()=>{const e=e=>{if(o.current&&!o.current.contains(e.target)){const t=document.getElementById("select-content");t&&!t.contains(e.target)&&l.setOpen(!1)}};if(l.open)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[l]),t.jsxs("button",{ref:o,onClick:()=>l.setOpen(!l.open),className:Ce("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...r,children:[a,t.jsx(n,{className:"h-4 w-4 opacity-50"})]})}),rt=e.forwardRef(({className:s,children:a,position:r="popper",...n},l)=>{const o=e.useContext(et);if(!o)throw new Error("SelectContent must be used within Select");return o.open?t.jsx("div",{id:"select-content",ref:l,className:Ce("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md","animate-in fade-in-0 zoom-in-95","popper"===r&&"mt-1",s),...n,children:t.jsx("div",{className:Ce("p-1 overflow-auto max-h-[300px]","popper"===r&&"min-w-full"),children:a})}):null}),nt=e.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:Ce("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...s})),lt=e.forwardRef(({className:a,children:r,value:n,...l},o)=>{const i=e.useContext(et);if(!i)throw new Error("SelectItem must be used within Select");const c=i.value===n;return t.jsxs("div",{ref:o,onClick:()=>i.onValueChange(n),className:Ce("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none","hover:bg-accent hover:text-accent-foreground","data-[disabled]:pointer-events-none data-[disabled]:opacity-50",c&&"bg-accent text-accent-foreground",a),...l,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:c&&t.jsx(s,{className:"h-4 w-4"})}),r]})}),ot=e.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:Ce("-mx-1 my-1 h-px bg-muted",e),...s}));at.displayName="SelectTrigger",rt.displayName="SelectContent",nt.displayName="SelectLabel",lt.displayName="SelectItem",ot.displayName="SelectSeparator";const it=e.createContext(null),ct=e.forwardRef(({value:s,defaultValue:a="",onValueChange:r,className:n,children:l,...o},i)=>{const[c,d]=e.useState(a),m=s??c;return t.jsx(it.Provider,{value:{value:m,onValueChange:e=>{s||d(e),r?.(e)}},children:t.jsx("div",{ref:i,className:n,...o,children:l})})}),dt=e.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,role:"tablist",className:Ce("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s})),mt=e.forwardRef(({className:s,value:a,children:r,...n},l)=>{const o=e.useContext(it);if(!o)throw new Error("TabsTrigger must be used within Tabs");const i=o.value===a;return t.jsx("button",{ref:l,role:"tab","aria-selected":i,"data-state":i?"active":"inactive",onClick:()=>o.onValueChange(a),className:Ce("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","disabled:pointer-events-none disabled:opacity-50",i&&"bg-background text-foreground shadow-sm",s),...n,children:r})}),ut=e.forwardRef(({className:s,value:a,children:r,...n},l)=>{const o=e.useContext(it);if(!o)throw new Error("TabsContent must be used within Tabs");return o.value===a?t.jsx("div",{ref:l,role:"tabpanel",className:Ce("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...n,children:r}):null});ct.displayName="Tabs",dt.displayName="TabsList",mt.displayName="TabsTrigger",ut.displayName="TabsContent";const ht=e.forwardRef(({className:e,...s},a)=>t.jsx("textarea",{className:Ce("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...s}));function xt(t,s={}){const{saveInterval:a=s.interval||3e4,debounceDelay:r=1e3,enableLocalStorage:n=!0,enableCloudSave:o=!0,onSave:i,onRestore:c,storageKey:d=(s.postId?`wordpress-editor-autosave-${s.postType||"post"}-${s.postId}`:"wordpress-editor-autosave"),onSaveSuccess:m}=s,[u,h]=e.useState({isSaving:!1,lastSavedAt:null,hasUnsavedChanges:!1,error:null,backupExists:!1}),[x,g]=e.useState(t||null),p=function(t,s){const[a,r]=e.useState(t);return e.useEffect(()=>{const e=setTimeout(()=>{r(t)},s);return()=>{clearTimeout(e)}},[t,s]),a}(x,r),b=e.useRef(void 0),f=e.useRef(!1);e.useEffect(()=>{if(n){const e=localStorage.getItem(d);h(t=>({...t,backupExists:!!e}))}},[n,d]);const v=e.useCallback(e=>{if(n)try{const t={content:e,timestamp:(new Date).toISOString(),version:"1.0"};localStorage.setItem(d,JSON.stringify(t))}catch(t){if(t instanceof DOMException&&"QuotaExceededError"===t.name)try{localStorage.removeItem(d+"-old"),localStorage.setItem(d+"-old",localStorage.getItem(d)||""),localStorage.setItem(d,JSON.stringify(e))}catch(s){}}},[n,d]),y=e.useCallback(async e=>{if(o&&i){h(e=>({...e,isSaving:!0,error:null}));try{await i(e),h(e=>({...e,isSaving:!1,lastSavedAt:new Date,hasUnsavedChanges:!1})),m&&m(),n&&(localStorage.removeItem(d),h(e=>({...e,backupExists:!1})))}catch(t){const s=t instanceof Error?t.message:"Unknown error";h(e=>({...e,isSaving:!1,error:s})),v(e),l.error("Failed to save to cloud. Local backup created.")}}},[o,i,n,d,v,m]),j=e.useCallback(async(e=x,t=!1)=>{e&&!f.current&&(v(e),!t&&b.current||await y(e))},[x,v,y]),w=e.useCallback(e=>{f.current||(g(e),h(e=>({...e,hasUnsavedChanges:!0})))},[]);e.useEffect(()=>{p&&!f.current&&j(p)},[p,j]),e.useEffect(()=>{if(!o||!u.hasUnsavedChanges)return;const e=setInterval(()=>{u.hasUnsavedChanges&&x&&j(x,!0)},a);return()=>clearInterval(e)},[o,u.hasUnsavedChanges,x,j,a]);const N=e.useCallback(async()=>{f.current=!0;try{if(c){const e=await c();if(e)return g(e),h(e=>({...e,hasUnsavedChanges:!1,lastSavedAt:new Date})),f.current=!1,e}if(n){const e=localStorage.getItem(d);if(e){const{content:t,timestamp:s}=JSON.parse(e);return g(t),l.success(`Restored from backup (${new Date(s).toLocaleString()})`),f.current=!1,t}}}catch(e){l.error("Failed to restore backup")}finally{f.current=!1}return null},[c,n,d]),k=e.useCallback(()=>{n&&(localStorage.removeItem(d),localStorage.removeItem(d+"-old"),s.postId&&(localStorage.removeItem(`page-${s.postId}-draft`),localStorage.removeItem(`post-${s.postId}-draft`)),h(e=>({...e,backupExists:!1,hasUnsavedChanges:!1})),f.current=!0,setTimeout(()=>{f.current=!1},100))},[n,d,s.postId]);return e.useEffect(()=>{const e=e=>{if(u.hasUnsavedChanges){const t="You have unsaved changes. Are you sure you want to leave?";return e.preventDefault(),e.returnValue=t,t}};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[u.hasUnsavedChanges]),e.useEffect(()=>{const e=()=>{document.hidden&&u.hasUnsavedChanges&&x&&j(x,!0)};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[u.hasUnsavedChanges,x,j]),{...u,updateContent:w,save:()=>j(x,!0),restoreFromBackup:N,clearBackup:k,lastSaved:u.lastSavedAt,savedInLocalStorage:u.backupExists,recoverFromLocalStorage:N,clearLocalStorage:k}}ht.displayName="Textarea";const gt=({_isOpen:a,onClose:r,onSelect:n,allowMultiple:x=!1,acceptedTypes:g=["image/*"]})=>{const[p,b]=e.useState("grid"),[f,v]=e.useState(""),[y,j]=e.useState([]),[w,N]=e.useState("library"),k=ae(),{data:C=[],isLoading:S}=re({queryKey:["media",f],queryFn:async()=>{const e=new URLSearchParams;f&&e.append("search",f);return(await je.api.get(`/media?${e}`)).data},enabled:a}),E=ne({mutationFn:async e=>{const t=new FormData;e.forEach(e=>{t.append("files",e)});return(await je.api.post("/media/upload",t,{headers:{"Content-Type":"multipart/form-data"}})).data},onSuccess:()=>{l.success("파일이 업로드되었습니다"),k.invalidateQueries({queryKey:["media"]}),N("library")},onError:()=>{l.error("파일 업로드에 실패했습니다")}}),T=e.useCallback(e=>{E.mutate(e)},[E]),{getRootProps:R,getInputProps:P,isDragActive:I}=o({onDrop:T,accept:g.reduce((e,t)=>({...e,[t]:[]}),{}),multiple:!0}),B=e=>{x?j(t=>t.includes(e.id)?t.filter(t=>t!==e.id):[...t,e.id]):(n(e),r())};return a?t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-6xl h-[80vh] flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[t.jsx("h2",{className:"text-xl font-semibold",children:"미디어 라이브러리"}),t.jsx("button",{onClick:r,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:t.jsx(i,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"flex border-b",children:[t.jsx("button",{onClick:()=>N("library"),className:se("px-6 py-3 font-medium transition-colors","library"===w?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"),children:"미디어 라이브러리"}),t.jsx("button",{onClick:()=>N("upload"),className:se("px-6 py-3 font-medium transition-colors","upload"===w?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"),children:"파일 업로드"})]}),t.jsx("div",{className:"flex-1 overflow-hidden",children:"library"===w?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx(c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),t.jsx(Ke,{type:"search",placeholder:"미디어 검색...",value:f,onChange:e=>v(e.target.value),className:"pl-10 w-64"})]}),t.jsxs("div",{className:"flex items-center gap-1 border rounded-lg",children:[t.jsx("button",{onClick:()=>b("grid"),className:se("p-2 transition-colors","grid"===p?"bg-gray-100":"hover:bg-gray-50"),children:t.jsx(d,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>b("list"),className:se("p-2 transition-colors","list"===p?"bg-gray-100":"hover:bg-gray-50"),children:t.jsx(m,{className:"w-4 h-4"})})]})]}),x&&y.length>0&&t.jsxs(Ae,{onClick:()=>{const e=C.filter(e=>y.includes(e.id));e.length>0&&(e.forEach(e=>n(e)),r())},children:[y.length,"개 선택 완료"]})]}),t.jsx("div",{className:"p-4 overflow-y-auto h-full",children:S?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):0===C.length?t.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[t.jsx(u,{className:"w-16 h-16 mb-4"}),t.jsx("p",{children:"미디어가 없습니다"})]}):"grid"===p?t.jsx("div",{className:"grid grid-cols-6 gap-4",children:C.map(e=>t.jsxs("div",{onClick:()=>B(e),className:se("relative aspect-square rounded-lg overflow-hidden cursor-pointer group","border-2 transition-all hover:shadow-lg",y.includes(e.id)?"border-blue-600":"border-gray-200 hover:border-gray-300"),children:[t.jsx("img",{src:e.thumbnailUrl||e.url,alt:e.alt||e.filename,className:"w-full h-full object-cover"}),t.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-opacity",children:y.includes(e.id)&&t.jsx("div",{className:"absolute top-2 right-2 w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center",children:t.jsx(s,{className:"w-4 h-4 text-white"})})}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-2 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity",children:t.jsx("p",{className:"text-xs text-white truncate",children:e.filename})})]},e.id))}):t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b",children:[t.jsx("th",{className:"text-left py-2",children:"파일"}),t.jsx("th",{className:"text-left py-2",children:"파일명"}),t.jsx("th",{className:"text-left py-2",children:"업로드 일시"}),t.jsx("th",{className:"text-left py-2",children:"크기"})]})}),t.jsx("tbody",{children:C.map(e=>t.jsxs("tr",{onClick:()=>B(e),className:se("border-b cursor-pointer hover:bg-gray-50",y.includes(e.id)&&"bg-blue-50"),children:[t.jsx("td",{className:"py-2",children:t.jsx("img",{src:e.thumbnailUrl||e.url,alt:e.alt||e.filename,className:"w-10 h-10 object-cover rounded"})}),t.jsx("td",{className:"py-2",children:e.filename}),t.jsx("td",{className:"py-2 text-sm text-gray-600",children:oe(new Date(e.uploadedAt),"yyyy-MM-dd HH:mm")}),t.jsxs("td",{className:"py-2 text-sm text-gray-600",children:[(e.size/1024/1024).toFixed(2)," MB"]})]},e.id))})]})})]}):t.jsxs("div",{className:"p-8 h-full flex items-center justify-center",children:[t.jsxs("div",{...R(),className:se("w-full max-w-2xl h-64 border-2 border-dashed rounded-lg","flex flex-col items-center justify-center cursor-pointer","transition-colors",I?"border-blue-600 bg-blue-50":"border-gray-300 hover:border-gray-400"),children:[t.jsx("input",{...P()}),t.jsx(h,{className:"w-12 h-12 text-gray-400 mb-4"}),I?t.jsx("p",{className:"text-lg text-blue-600",children:"파일을 여기에 놓으세요"}):t.jsxs(t.Fragment,{children:[t.jsx("p",{className:"text-lg text-gray-600 mb-2",children:"파일을 드래그하거나 클릭하여 업로드"}),t.jsxs("p",{className:"text-sm text-gray-500",children:["지원 형식: ",g.join(", ")]})]})]}),E.isPending&&t.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})})]})})]})}):null},pt=({settings:e,onChange:s})=>{const a=[{value:"left",icon:x,label:"왼쪽"},{value:"center",icon:g,label:"가운데"},{value:"right",icon:p,label:"오른쪽"},{value:"wide",icon:b,label:"넓게"},{value:"full",icon:f,label:"전체 너비"}];return t.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx(Ze,{className:"text-sm font-medium mb-2 block",children:"정렬"}),t.jsx("div",{className:"flex gap-1",children:a.map(a=>{const r=a.icon;return t.jsx("button",{onClick:()=>s({...e,alignment:a.value}),className:se("p-2 rounded transition-colors",e.alignment===a.value?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-100"),title:a.label,children:t.jsx(r,{className:"w-4 h-4"})},a.value)})})]}),t.jsxs("div",{children:[t.jsx(Ze,{className:"text-sm font-medium mb-2 block",children:"이미지 크기"}),t.jsx("select",{value:e.size||"large",onChange:t=>s({...e,size:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[{value:"thumbnail",label:"썸네일 (150x150)"},{value:"medium",label:"중간 (300x300)"},{value:"large",label:"크게 (1024x1024)"},{value:"full",label:"원본 크기"}].map(e=>t.jsx("option",{value:e.value,children:e.label},e.value))})]}),"full"===e.size&&t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{children:[t.jsx(Ze,{htmlFor:"width",className:"text-sm",children:"너비"}),t.jsx(Ke,{id:"width",type:"number",value:e.width||"",onChange:t=>s({...e,width:parseInt(t.target.value)||void 0}),placeholder:"px"})]}),t.jsxs("div",{children:[t.jsx(Ze,{htmlFor:"height",className:"text-sm",children:"높이"}),t.jsx(Ke,{id:"height",type:"number",value:e.height||"",onChange:t=>s({...e,height:parseInt(t.target.value)||void 0}),placeholder:"px"})]})]}),t.jsxs("div",{children:[t.jsxs(Ze,{htmlFor:"alt",className:"text-sm font-medium mb-1 block",children:[t.jsx(v,{className:"w-3 h-3 inline mr-1"}),"대체 텍스트"]}),t.jsx(Ke,{id:"alt",value:e.alt||"",onChange:t=>s({...e,alt:t.target.value}),placeholder:"이미지 설명"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"접근성을 위해 이미지를 설명하세요"})]}),t.jsxs("div",{children:[t.jsx(Ze,{htmlFor:"caption",className:"text-sm font-medium mb-1 block",children:"캡션"}),t.jsx(ht,{id:"caption",value:e.caption||"",onChange:t=>s({...e,caption:t.target.value}),placeholder:"이미지 캡션 (선택사항)",rows:2})]}),t.jsxs("div",{children:[t.jsxs(Ze,{htmlFor:"link",className:"text-sm font-medium mb-1 block",children:[t.jsx(y,{className:"w-3 h-3 inline mr-1"}),"링크 URL"]}),t.jsx(Ke,{id:"link",type:"url",value:e.link||"",onChange:t=>s({...e,link:t.target.value}),placeholder:"https://example.com"}),e.link&&t.jsx("div",{className:"mt-2",children:t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:"_blank"===e.linkTarget,onChange:t=>s({...e,linkTarget:t.target.checked?"_blank":"_self"}),className:"rounded"}),t.jsx("span",{className:"text-sm",children:"새 탭에서 열기"})]})})]})]})},bt=({settings:e,onChange:s})=>t.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 rounded-lg",children:[t.jsxs("div",{children:[t.jsxs(Ze,{className:"text-sm font-medium mb-2 block",children:[t.jsx(d,{className:"w-3 h-3 inline mr-1"}),"컬럼 수"]}),t.jsx("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3,4,5,6].map(a=>t.jsxs("button",{onClick:()=>s({...e,columns:a}),className:se("p-2 rounded transition-colors text-sm",e.columns===a?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-100 border border-gray-300"),children:[a,"열"]},a))})]}),t.jsxs("div",{children:[t.jsxs(Ze,{className:"text-sm font-medium mb-2 block",children:[t.jsx(j,{className:"w-3 h-3 inline mr-1"}),"이미지 표시"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>s({...e,imageCrop:!0}),className:se("flex-1 p-2 rounded transition-colors text-sm",e.imageCrop?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-100 border border-gray-300"),children:"자르기"}),t.jsx("button",{onClick:()=>s({...e,imageCrop:!1}),className:se("flex-1 p-2 rounded transition-colors text-sm",e.imageCrop?"bg-white text-gray-600 hover:bg-gray-100 border border-gray-300":"bg-blue-600 text-white"),children:"전체 표시"})]})]}),t.jsxs("div",{children:[t.jsxs(Ze,{className:"text-sm font-medium mb-2 block",children:[t.jsx(y,{className:"w-3 h-3 inline mr-1"}),"이미지 클릭 시"]}),t.jsxs("select",{value:e.linkTo||"none",onChange:t=>s({...e,linkTo:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"none",children:"링크 없음"}),t.jsx("option",{value:"media",children:"미디어 파일"}),t.jsx("option",{value:"attachment",children:"첨부 페이지"})]})]}),e.images&&e.images.length>0&&t.jsxs("div",{children:[t.jsx(Ze,{className:"text-sm font-medium mb-2 block",children:"이미지 관리"}),t.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:e.images.map((a,r)=>t.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white rounded border",children:[t.jsx("img",{src:a.thumbnailUrl||a.url,alt:a.alt||"",className:"w-10 h-10 object-cover rounded"}),t.jsx("span",{className:"flex-1 text-sm truncate",children:a.alt||`이미지 ${r+1}`}),t.jsx("button",{onClick:()=>{const t=e.images.filter((e,t)=>t!==r);s({...e,images:t})},className:"text-red-600 hover:text-red-700 text-sm",children:"제거"})]},r))})]})]}),ft=({settings:e,onChange:s})=>{const a=[{value:"left",icon:x,label:"왼쪽"},{value:"center",icon:g,label:"가운데"},{value:"right",icon:p,label:"오른쪽"}];return t.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 rounded-lg",children:[t.jsxs("div",{children:[t.jsxs(Ze,{htmlFor:"title",className:"text-sm font-medium mb-1 block",children:[t.jsx(v,{className:"w-3 h-3 inline mr-1"}),"제목"]}),t.jsx(Ke,{id:"title",value:e.title||"",onChange:t=>s({...e,title:t.target.value}),placeholder:"Cover 제목"})]}),t.jsxs("div",{children:[t.jsx(Ze,{htmlFor:"text",className:"text-sm font-medium mb-1 block",children:"부제목"}),t.jsx(ht,{id:"text",value:e.text||"",onChange:t=>s({...e,text:t.target.value}),placeholder:"Cover 부제목 텍스트",rows:2})]}),t.jsxs("div",{children:[t.jsx(Ze,{className:"text-sm font-medium mb-2 block",children:"콘텐츠 정렬"}),t.jsx("div",{className:"flex gap-1",children:a.map(a=>{const r=a.icon;return t.jsx("button",{onClick:()=>s({...e,contentAlign:a.value}),className:se("p-2 rounded transition-colors",e.contentAlign===a.value?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-100"),title:a.label,children:t.jsx(r,{className:"w-4 h-4"})},a.value)})})]}),t.jsxs("div",{children:[t.jsxs(Ze,{htmlFor:"minHeight",className:"text-sm font-medium mb-1 block",children:[t.jsx(w,{className:"w-3 h-3 inline mr-1"}),"최소 높이"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"range",min:"100",max:"800",value:e.minHeight||300,onChange:t=>s({...e,minHeight:parseInt(t.target.value)}),className:"flex-1"}),t.jsxs("span",{className:"text-sm w-16 text-right",children:[e.minHeight||300,"px"]})]})]}),t.jsxs("div",{children:[t.jsxs(Ze,{className:"text-sm font-medium mb-2 block",children:[t.jsx(N,{className:"w-3 h-3 inline mr-1"}),"오버레이 색상"]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{color:"rgba(0, 0, 0, 0.5)",label:"블랙 50%"},{color:"rgba(0, 0, 0, 0.7)",label:"블랙 70%"},{color:"rgba(255, 255, 255, 0.5)",label:"화이트 50%"},{color:"rgba(0, 51, 102, 0.7)",label:"네이비 70%"},{color:"rgba(0, 0, 0, 0)",label:"투명"}].map(a=>t.jsxs("button",{onClick:()=>s({...e,overlayColor:a.color}),className:se("p-2 rounded border-2 text-sm transition-colors",e.overlayColor===a.color?"border-blue-600":"border-gray-300 hover:border-gray-400"),children:[t.jsx("div",{className:"w-full h-8 rounded mb-1",style:{backgroundColor:a.color,border:"1px solid #e5e7eb"}}),t.jsx("span",{className:"text-xs",children:a.label})]},a.color))}),t.jsxs("div",{children:[t.jsx(Ze,{htmlFor:"customColor",className:"text-xs text-gray-600",children:"커스텀 색상"}),t.jsx(Ke,{id:"customColor",type:"text",value:e.overlayColor||"",onChange:t=>s({...e,overlayColor:t.target.value}),placeholder:"rgba(0, 0, 0, 0.5)",className:"mt-1"})]})]})]})]})},vt=({settings:e,onChange:s})=>t.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 rounded-lg",children:[t.jsxs("div",{children:[t.jsxs(Ze,{htmlFor:"text",className:"text-sm font-medium mb-1 block",children:[t.jsx(v,{className:"w-3 h-3 inline mr-1"}),"버튼 텍스트"]}),t.jsx(Ke,{id:"text",value:e.text||"",onChange:t=>s({...e,text:t.target.value}),placeholder:"버튼 텍스트"})]}),t.jsxs("div",{children:[t.jsxs(Ze,{htmlFor:"url",className:"text-sm font-medium mb-1 block",children:[t.jsx(k,{className:"w-3 h-3 inline mr-1"}),"링크 URL"]}),t.jsx(Ke,{id:"url",type:"url",value:e.url||"",onChange:t=>s({...e,url:t.target.value}),placeholder:"https://example.com"}),t.jsx("div",{className:"mt-2",children:t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:"_blank"===e.target,onChange:t=>s({...e,target:t.target.checked?"_blank":"_self"}),className:"rounded"}),t.jsx("span",{className:"text-sm",children:"새 탭에서 열기"})]})})]}),t.jsxs("div",{children:[t.jsx(Ze,{className:"text-sm font-medium mb-2 block",children:"버튼 스타일"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>s({...e,style:"fill"}),className:se("flex-1 p-2 rounded transition-colors text-sm","fill"===e.style?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-100 border border-gray-300"),children:"채우기"}),t.jsx("button",{onClick:()=>s({...e,style:"outline"}),className:se("flex-1 p-2 rounded transition-colors text-sm","outline"===e.style?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-100 border border-gray-300"),children:"윤곽선"})]})]}),t.jsxs("div",{children:[t.jsxs(Ze,{className:"text-sm font-medium mb-2 block",children:[t.jsx(N,{className:"w-3 h-3 inline mr-1"}),"색상"]}),t.jsx("div",{className:"grid grid-cols-3 gap-2 mb-2",children:[{bg:"#007cba",text:"#ffffff",label:"파란색"},{bg:"#28a745",text:"#ffffff",label:"초록색"},{bg:"#dc3545",text:"#ffffff",label:"빨간색"},{bg:"#ffc107",text:"#000000",label:"노란색"},{bg:"#6c757d",text:"#ffffff",label:"회색"},{bg:"#000000",text:"#ffffff",label:"검정색"}].map(a=>t.jsx("button",{onClick:()=>s({...e,backgroundColor:a.bg,textColor:a.text}),className:se("p-2 rounded border-2 transition-colors",e.backgroundColor===a.bg?"border-blue-600":"border-gray-300 hover:border-gray-400"),children:t.jsx("div",{className:"w-full h-6 rounded flex items-center justify-center text-xs font-medium",style:{backgroundColor:a.bg,color:a.text},children:a.label})},a.bg))}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{children:[t.jsx(Ze,{htmlFor:"bgColor",className:"text-xs text-gray-600",children:"배경색"}),t.jsx(Ke,{id:"bgColor",type:"color",value:e.backgroundColor||"#007cba",onChange:t=>s({...e,backgroundColor:t.target.value}),className:"mt-1 h-8"})]}),t.jsxs("div",{children:[t.jsx(Ze,{htmlFor:"textColor",className:"text-xs text-gray-600",children:"텍스트색"}),t.jsx(Ke,{id:"textColor",type:"color",value:e.textColor||"#ffffff",onChange:t=>s({...e,textColor:t.target.value}),className:"mt-1 h-8"})]})]})]}),t.jsxs("div",{children:[t.jsxs(Ze,{htmlFor:"borderRadius",className:"text-sm font-medium mb-1 block",children:[t.jsx(a,{className:"w-3 h-3 inline mr-1"}),"모서리 둥글기"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"range",min:"0",max:"50",value:e.borderRadius||4,onChange:t=>s({...e,borderRadius:parseInt(t.target.value)}),className:"flex-1"}),t.jsxs("span",{className:"text-sm w-12 text-right",children:[e.borderRadius||4,"px"]})]})]}),t.jsxs("div",{children:[t.jsx(Ze,{className:"text-sm font-medium mb-2 block",children:"미리보기"}),t.jsx("div",{className:"p-4 bg-white rounded border flex justify-center",children:t.jsx("button",{className:se("px-4 py-2 rounded transition-colors","fill"===e.style&&"text-white","outline"===e.style&&"border-2"),style:{backgroundColor:"fill"===e.style?e.backgroundColor:"transparent",color:"fill"===e.style?e.textColor:e.backgroundColor,borderColor:"outline"===e.style?e.backgroundColor:"transparent",borderRadius:`${e.borderRadius}px`},children:e.text||"버튼"})})]})]}),yt=[{id:"uagb/advanced-heading",name:"Advanced Heading",icon:v,category:"text"},{id:"uagb/info-box",name:"Info Box",icon:D,category:"layout"},{id:"uagb/testimonial",name:"Testimonial",icon:C,category:"text"},{id:"uagb/team",name:"Team",icon:_,category:"layout"},{id:"uagb/social-share",name:"Social Share",icon:L,category:"social"},{id:"uagb/google-map",name:"Google Map",icon:A,category:"embed"},{id:"uagb/icon-list",name:"Icon List",icon:m,category:"text"},{id:"uagb/price-list",name:"Price List",icon:$,category:"layout"},{id:"uagb/post-carousel",name:"Post Carousel",icon:d,category:"layout"},{id:"uagb/table-of-contents",name:"Table of Contents",icon:m,category:"text"},{id:"uagb/timeline",name:"Timeline",icon:D,category:"layout"},{id:"uagb/blockquote",name:"Blockquote",icon:C,category:"text"},{id:"uagb/call-to-action",name:"Call To Action",icon:z,category:"layout"},{id:"uagb/columns",name:"Advanced Columns",icon:P,category:"layout"},{id:"uagb/section",name:"Section",icon:I,category:"layout"}],jt=[{id:"o4o/cpt-acf-loop",name:"CPT/ACF Loop",icon:m,category:"o4o"}],wt=[{id:"core/paragraph",name:"Paragraph",icon:v,category:"text"},{id:"core/heading",name:"Heading",icon:v,category:"text"},{id:"core/list",name:"List",icon:m,category:"text"},{id:"core/quote",name:"Quote",icon:C,category:"text"},{id:"core/code",name:"Code",icon:S,category:"text"},{id:"core/table",name:"Table",icon:E,category:"text"},{id:"core/image",name:"Image",icon:u,category:"media"},{id:"core/gallery",name:"Gallery",icon:d,category:"media"},{id:"core/video",name:"Video",icon:T,category:"media"},{id:"core/audio",name:"Audio",icon:R,category:"media"},{id:"core/cover",name:"Cover",icon:u,category:"media"},{id:"core/columns",name:"Columns",icon:P,category:"design"},{id:"core/group",name:"Group",icon:I,category:"design"},{id:"core/button",name:"Button",icon:B,category:"design"},{id:"core/spacer",name:"Spacer",icon:I,category:"design"},{id:"core/separator",name:"Separator",icon:I,category:"design"}],Nt=({initialBlocks:s=[],onChange:a,content:r,onContentChange:n})=>{const[l,o]=e.useState(()=>r?(e=>{if(!e||!e.trim())return[];const t=[...e.matchAll(/<!-- wp:([a-z0-9-]+\/[a-z0-9-]+)(\s+({[^}]*}))?\s*-->([\s\S]*?)<!-- \/wp:\1 -->/g)];return t.length>0?t.map((e,t)=>{const s=e[1],a=e[3],r=e[4].trim();let n={};if(a)try{n=JSON.parse(a)}catch(o){}let l={};switch(s){case"core/paragraph":const e=r.match(/<p>(.*?)<\/p>/s);l={text:e?e[1]:r};break;case"core/heading":const t=r.match(/<h(\d)>(.*?)<\/h\d>/s);t&&(l={text:t[2],level:parseInt(t[1])});break;case"core/list":l={items:[...r.matchAll(/<li>(.*?)<\/li>/gs)].map(e=>e[1])};break;case"core/quote":const s=r.match(/<blockquote[^>]*><p>(.*?)<\/p>(?:<cite>(.*?)<\/cite>)?<\/blockquote>/s);s&&(l={text:s[1],citation:s[2]});break;case"core/image":const a=r.match(/<img[^>]+src="([^"]+)"[^>]*alt="([^"]*)"[^>]*>/),n=r.match(/<figcaption>(.*?)<\/figcaption>/);a&&(l={url:a[1],alt:a[2],caption:n?n[1]:void 0});break;case"o4o/cpt-acf-loop":const i=r.match(/data-block='([^']+)'/);if(i)try{l=JSON.parse(i[1])}catch(o){}break;default:const c=r.match(/data-block='([^']+)'/);if(c)try{l=JSON.parse(c[1])}catch(o){l={raw:r}}else l={raw:r}}return{id:`block-${Date.now()}-${t}`,type:s,content:l,attributes:n}}):[{id:`block-${Date.now()}`,type:"core/paragraph",content:{text:e.replace(/<[^>]*>/g,"")},attributes:{}}]})(r):s),[c,m]=e.useState(!1),[h,x]=e.useState(null),[g,p]=e.useState("all"),[b,f]=e.useState(!1),[v,y]=e.useState(null),[j,N]=e.useState(!1),C=[...wt,...yt,...jt],S="all"===g?C:C.filter(e=>e.category===g),E=e=>{o(e),a?.(e),n?.((e=>e.map(e=>{const t=e.type,s=e.attributes||{},a=e.content;let r=`\x3c!-- wp:${t}`;switch(Object.keys(s).length>0&&(r+=` ${JSON.stringify(s)}`),r+=" --\x3e\n",e.type){case"core/paragraph":r+=`<p>${a.text||""}</p>`;break;case"core/heading":const e=a.level||2;r+=`<h${e}>${a.text||""}</h${e}>`;break;case"core/list":r+=`<ul>${(a.items||[]).map(e=>`<li>${e}</li>`).join("\n")}</ul>`;break;case"core/quote":r+=`<blockquote class="wp-block-quote"><p>${a.text||""}</p>`,a.citation&&(r+=`<cite>${a.citation}</cite>`),r+="</blockquote>";break;case"core/image":r+=`<figure class="wp-block-image"><img src="${a.url||""}" alt="${a.alt||""}"/>`,a.caption&&(r+=`<figcaption>${a.caption}</figcaption>`),r+="</figure>";break;case"o4o/cpt-acf-loop":r+=`<div class="wp-block-o4o-cpt-acf-loop" data-block='${JSON.stringify(a)}'></div>`;break;default:r+=`<div class="wp-block-${t.replace("/","-")}" data-block='${JSON.stringify(a)}'></div>`}return r+=`\n\x3c!-- /wp:${t} --\x3e\n`,r}).join("\n"))(e))},T=e=>{switch(e){case"core/paragraph":return{text:"Start writing or type / to choose a block"};case"core/heading":return{text:"Heading",level:2};case"uagb/advanced-heading":return{text:"Advanced Heading",level:2,alignment:"center"};case"core/image":return{url:"",alt:"",caption:"",alignment:"center",size:"large"};case"core/gallery":return{images:[],columns:3,imageCrop:!0,linkTo:"none"};case"core/video":return{url:"",autoplay:!1,loop:!1,muted:!1,controls:!0};case"core/cover":return{url:"",overlayColor:"rgba(0, 0, 0, 0.5)",minHeight:300,contentAlign:"center",title:"Cover Title",text:"Cover subtitle text"};case"core/columns":return{columns:[{id:`col-${Date.now()}-1`,content:[],width:50},{id:`col-${Date.now()}-2`,content:[],width:50}]};case"core/button":return{text:"Click me",url:"#",target:"_self",style:"fill",backgroundColor:"#007cba",textColor:"#ffffff",borderRadius:4};case"core/spacer":return{height:100};case"core/separator":return{style:"default",color:"#cccccc"};case"core/code":return{content:"// Your code here",language:"javascript"};case"core/table":return{head:[["Column 1","Column 2","Column 3"]],body:[["Row 1 Cell 1","Row 1 Cell 2","Row 1 Cell 3"],["Row 2 Cell 1","Row 2 Cell 2","Row 2 Cell 3"]],foot:[]};case"core/group":return{blocks:[],backgroundColor:"",padding:20};default:return{}}};return t.jsxs("div",{className:"gutenberg-editor bg-modern-bg-card rounded-lg",children:[t.jsx("div",{className:"border-b border-modern-border-primary p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg font-semibold text-modern-text-primary",children:"Block Editor"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{className:"px-3 py-1.5 text-sm border border-modern-border-primary rounded hover:bg-modern-bg-hover",children:"Preview"}),t.jsx("button",{className:"px-3 py-1.5 text-sm bg-modern-primary text-white rounded hover:bg-modern-primary-hover",children:"Update"})]})]})}),t.jsxs("div",{className:"p-8 min-h-[400px]",children:[l.map(e=>{const s=C.find(t=>t.id===e.type)?.icon||D;return t.jsxs("div",{className:se("group relative border-2 rounded-lg p-4 mb-4 transition-all",h===e.id?"border-modern-primary bg-modern-primary-alpha":"border-transparent hover:border-modern-border-primary"),onClick:()=>x(e.id),children:[t.jsx("div",{className:"absolute -top-4 left-1/2 transform -translate-x-1/2 opacity-0 group-hover:opacity-100 transition-opacity",children:t.jsxs("div",{className:"flex items-center gap-1 bg-modern-bg-card border border-modern-border-primary rounded-lg shadow-modern-shadow p-1",children:[t.jsx("button",{className:"p-1 hover:bg-modern-bg-hover rounded",children:t.jsx(w,{className:"w-4 h-4 text-modern-text-secondary"})}),t.jsx("button",{onClick:t=>{t.stopPropagation(),(e=>{const t=l.findIndex(t=>t.id===e);if(-1!==t){const e={...l[t],id:`block-${Date.now()}`},s=[...l.slice(0,t+1),e,...l.slice(t+1)];E(s)}})(e.id)},className:"p-1 hover:bg-modern-bg-hover rounded",children:t.jsx(O,{className:"w-4 h-4 text-modern-text-secondary"})}),t.jsx("button",{onClick:t=>{t.stopPropagation(),(e=>{const t=l.filter(t=>t.id!==e);E(t)})(e.id)},className:"p-1 hover:bg-modern-bg-hover rounded",children:t.jsx(U,{className:"w-4 h-4 text-modern-error"})}),t.jsx("button",{className:"p-1 hover:bg-modern-bg-hover rounded",children:t.jsx(M,{className:"w-4 h-4 text-modern-text-secondary"})})]})}),t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"w-8 h-8 bg-modern-bg-tertiary rounded flex items-center justify-center",children:t.jsx(s,{className:"w-4 h-4 text-modern-text-secondary"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"text-xs text-modern-text-tertiary mb-1",children:C.find(t=>t.id===e.type)?.name}),e.type.includes("heading")&&t.jsx("h2",{className:"text-2xl font-bold text-modern-text-primary",children:e.content.text}),e.type.includes("paragraph")&&t.jsx("p",{className:"text-modern-text-primary",children:e.content.text}),"core/image"===e.type&&t.jsxs("div",{className:"space-y-2",children:[e.content.url?t.jsxs("div",{className:se("relative","left"===e.content.alignment&&"mr-auto","center"===e.content.alignment&&"mx-auto","right"===e.content.alignment&&"ml-auto","thumbnail"===e.content.size&&"max-w-[150px]","medium"===e.content.size&&"max-w-[300px]","large"===e.content.size&&"max-w-[1024px]","full"===e.content.size&&"max-w-full"),children:[t.jsx("img",{src:e.content.url,alt:e.content.alt||"",className:"w-full h-auto rounded"}),e.content.caption&&t.jsx("p",{className:"text-sm text-gray-600 mt-2 text-center",children:e.content.caption})]}):t.jsx("button",{onClick:t=>{t.stopPropagation(),y(()=>t=>{const s={...e,content:{...e.content,url:t.url,alt:t.alt||t.filename,width:t.width,height:t.height}},a=l.map(t=>t.id===e.id?s:t);E(a),f(!1)}),f(!0)},className:"w-full h-32 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center hover:border-modern-primary hover:bg-gray-50 transition-colors",children:t.jsxs("div",{className:"text-center",children:[t.jsx(u,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),t.jsx("span",{className:"text-sm text-gray-600",children:"미디어 선택"})]})}),h===e.id&&e.content.url&&t.jsx("button",{onClick:e=>{e.stopPropagation(),N(!0)},className:"absolute top-2 right-2 p-1 bg-white rounded shadow hover:bg-gray-100",children:t.jsx(H,{className:"w-4 h-4"})})]}),"core/gallery"===e.type&&t.jsxs("div",{className:"space-y-2",children:[e.content.images&&e.content.images.length>0?t.jsx("div",{className:se("grid gap-2",1===e.content.columns&&"grid-cols-1",2===e.content.columns&&"grid-cols-2",3===e.content.columns&&"grid-cols-3",4===e.content.columns&&"grid-cols-4",5===e.content.columns&&"grid-cols-5",6===e.content.columns&&"grid-cols-6"),children:e.content.images.map((s,a)=>t.jsx("div",{className:"relative aspect-square",children:t.jsx("img",{src:s.url||s.thumbnailUrl,alt:s.alt||"",className:se("w-full h-full rounded",e.content.imageCrop?"object-cover":"object-contain")})},a))}):t.jsx("button",{onClick:t=>{t.stopPropagation(),y(()=>t=>{const s={...e,content:{...e.content,images:[...e.content.images||[],{id:t.id,url:t.url,thumbnailUrl:t.thumbnailUrl,alt:t.alt||t.filename}]}},a=l.map(t=>t.id===e.id?s:t);E(a)}),f(!0)},className:"w-full h-32 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center hover:border-modern-primary hover:bg-gray-50 transition-colors",children:t.jsxs("div",{className:"text-center",children:[t.jsx(d,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),t.jsx("span",{className:"text-sm text-gray-600",children:"갤러리 이미지 추가"})]})}),h===e.id&&e.content.images?.length>0&&t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:t=>{t.stopPropagation(),y(()=>t=>{const s={...e,content:{...e.content,images:[...e.content.images,{id:t.id,url:t.url,thumbnailUrl:t.thumbnailUrl,alt:t.alt||t.filename}]}},a=l.map(t=>t.id===e.id?s:t);E(a)}),f(!0)},className:"px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50",children:"이미지 추가"}),t.jsx("button",{onClick:e=>{e.stopPropagation(),N(!0)},className:"p-1 border border-gray-300 rounded hover:bg-gray-50",children:t.jsx(H,{className:"w-4 h-4"})})]})]}),"core/cover"===e.type&&t.jsxs("div",{className:"relative rounded-lg overflow-hidden",style:{minHeight:e.content.minHeight||300},children:[e.content.url?t.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:`url(${e.content.url})`},children:t.jsx("div",{className:"absolute inset-0",style:{backgroundColor:e.content.overlayColor}})}):t.jsx("div",{className:"absolute inset-0",style:{backgroundColor:e.content.overlayColor||"#000"}}),t.jsxs("div",{className:se("relative z-10 h-full flex flex-col justify-center p-8 text-white","left"===e.content.contentAlign&&"items-start text-left","center"===e.content.contentAlign&&"items-center text-center","right"===e.content.contentAlign&&"items-end text-right"),children:[t.jsx("h2",{className:"text-3xl font-bold mb-2",children:e.content.title}),t.jsx("p",{className:"text-lg",children:e.content.text})]}),!e.content.url&&t.jsx("button",{onClick:t=>{t.stopPropagation(),y(()=>t=>{const s={...e,content:{...e.content,url:t.url}},a=l.map(t=>t.id===e.id?s:t);E(a),f(!1)}),f(!0)},className:"absolute top-4 right-4 p-2 bg-white rounded shadow hover:bg-gray-100",children:t.jsx(u,{className:"w-4 h-4"})}),h===e.id&&t.jsx("button",{onClick:e=>{e.stopPropagation(),N(!0)},className:"absolute top-4 left-4 p-1 bg-white rounded shadow hover:bg-gray-100",children:t.jsx(H,{className:"w-4 h-4"})})]}),"core/button"===e.type&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("a",{href:e.content.url,target:e.content.target,className:se("inline-flex items-center px-4 py-2 rounded transition-colors","fill"===e.content.style&&"text-white","outline"===e.content.style&&"border-2"),style:{backgroundColor:"fill"===e.content.style?e.content.backgroundColor:"transparent",color:"fill"===e.content.style?e.content.textColor:e.content.backgroundColor,borderColor:"outline"===e.content.style?e.content.backgroundColor:"transparent",borderRadius:`${e.content.borderRadius}px`},children:e.content.text}),t.jsx(k,{className:"w-4 h-4 text-gray-400"})]}),"core/spacer"===e.type&&t.jsx("div",{className:"relative border-2 border-dashed border-gray-300 rounded",style:{height:e.content.height},children:t.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500",children:t.jsxs("span",{className:"text-sm",children:[e.content.height,"px"]})})}),"core/separator"===e.type&&t.jsx("div",{className:"py-4",children:t.jsx("hr",{className:se("wide"===e.content.style&&"w-full","default"===e.content.style&&"w-24 mx-auto","dots"===e.content.style&&"border-dotted"),style:{borderColor:e.content.color}})}),"core/code"===e.type&&t.jsx("pre",{className:"bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto",children:t.jsx("code",{className:`language-${e.content.language}`,children:e.content.content})}),"core/table"===e.type&&t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full border-collapse",children:[e.content.head.length>0&&t.jsx("thead",{children:e.content.head.map((e,s)=>t.jsx("tr",{children:e.map((e,s)=>t.jsx("th",{className:"border border-gray-300 px-4 py-2 bg-gray-100 font-semibold",children:e},s))},s))}),t.jsx("tbody",{children:e.content.body.map((e,s)=>t.jsx("tr",{children:e.map((e,s)=>t.jsx("td",{className:"border border-gray-300 px-4 py-2",children:e},s))},s))})]})}),"core/video"===e.type&&t.jsx("div",{className:"space-y-2",children:e.content.url?t.jsx("video",{src:e.content.url,controls:e.content.controls,autoPlay:e.content.autoplay,loop:e.content.loop,muted:e.content.muted,className:"w-full rounded"}):t.jsx("button",{onClick:t=>{t.stopPropagation(),y(()=>t=>{const s={...e,content:{...e.content,url:t.url}},a=l.map(t=>t.id===e.id?s:t);E(a),f(!1)}),f(!0)},className:"w-full h-32 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center hover:border-modern-primary hover:bg-gray-50 transition-colors",children:t.jsxs("div",{className:"text-center",children:[t.jsx(V,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),t.jsx("span",{className:"text-sm text-gray-600",children:"비디오 선택"})]})})}),"core/columns"===e.type&&t.jsx("div",{className:"grid gap-4",style:{gridTemplateColumns:e.content.columns.map(e=>`${e.width}%`).join(" ")},children:e.content.columns.map((e,s)=>t.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded p-4 min-h-[100px]",children:t.jsxs("div",{className:"text-sm text-gray-500 mb-2",children:["Column ",s+1]})},e.id))}),"core/group"===e.type&&t.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded min-h-[100px]",style:{backgroundColor:e.content.backgroundColor,padding:`${e.content.padding}px`},children:t.jsx("div",{className:"text-sm text-gray-500",children:"Group Block"})})]})]})]},e.id)}),t.jsxs("div",{className:"relative",children:[t.jsxs("button",{onClick:()=>m(!c),className:se("w-full py-4 border-2 border-dashed rounded-lg transition-all","hover:border-modern-primary hover:bg-modern-primary-alpha","flex items-center justify-center gap-2",c?"border-modern-primary bg-modern-primary-alpha":"border-modern-border-secondary"),children:[t.jsx(F,{className:"w-5 h-5 text-modern-text-secondary"}),t.jsx("span",{className:"text-modern-text-secondary",children:"Add block"})]}),c&&t.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-modern-bg-card border border-modern-border-primary rounded-lg shadow-modern-shadow-xl z-50",children:t.jsxs("div",{className:"p-4",children:[t.jsx("div",{className:"flex items-center gap-2 mb-4 pb-4 border-b border-modern-border-primary",children:["all","text","media","design","layout","social","embed","o4o"].map(e=>t.jsx("button",{onClick:()=>p(e),className:se("px-3 py-1.5 text-sm rounded transition-colors capitalize",g===e?"bg-modern-primary text-white":"text-modern-text-secondary hover:bg-modern-bg-hover"),children:e},e))}),t.jsx("div",{className:"grid grid-cols-3 gap-2 max-h-96 overflow-y-auto",children:S.map(e=>{const s=e.icon;return t.jsxs("button",{onClick:()=>(e=>{const t={id:`block-${Date.now()}`,type:e,content:T(e),attributes:{}},s=[...l,t];E(s),m(!1)})(e.id),className:"flex flex-col items-center gap-2 p-4 border border-modern-border-primary rounded-lg hover:border-modern-primary hover:bg-modern-bg-hover transition-all",children:[t.jsx(s,{className:"w-6 h-6 text-modern-text-secondary"}),t.jsx("span",{className:"text-xs text-modern-text-secondary text-center",children:e.name})]},e.id)})})]})})]})]}),t.jsx(gt,{_isOpen:b,onClose:()=>{f(!1),y(null)},onSelect:e=>{v&&v(e)},allowMultiple:"core/gallery"===l.find(e=>e.id===h)?.type}),j&&h&&t.jsxs("div",{className:"fixed inset-y-0 right-0 w-80 bg-white shadow-xl z-40",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[t.jsx("h3",{className:"font-semibold",children:"블록 설정"}),t.jsx("button",{onClick:()=>N(!1),className:"p-1 hover:bg-gray-100 rounded",children:t.jsx(i,{className:"w-4 h-4"})})]}),t.jsxs("div",{className:"p-4 overflow-y-auto h-full",children:["core/image"===l.find(e=>e.id===h)?.type&&t.jsx(pt,{settings:l.find(e=>e.id===h)?.content||{},onChange:e=>{const t=l.map(t=>t.id===h?{...t,content:{...t.content,...e}}:t);E(t)}}),"core/gallery"===l.find(e=>e.id===h)?.type&&t.jsx(bt,{settings:l.find(e=>e.id===h)?.content||{},onChange:e=>{const t=l.map(t=>t.id===h?{...t,content:{...t.content,...e}}:t);E(t)}}),"core/cover"===l.find(e=>e.id===h)?.type&&t.jsx(ft,{settings:l.find(e=>e.id===h)?.content||{},onChange:e=>{const t=l.map(t=>t.id===h?{...t,content:{...t.content,...e}}:t);E(t)}}),"core/button"===l.find(e=>e.id===h)?.type&&t.jsx(vt,{settings:l.find(e=>e.id===h)?.content||{},onChange:e=>{const t=l.map(t=>t.id===h?{...t,content:{...t.content,...e}}:t);E(t)}})]})]})]})},kt=e.createContext(null),Ct=({open:s,defaultOpen:a=!1,onOpenChange:r,children:n})=>{const[l,o]=e.useState(a),i=s??l;return t.jsx(kt.Provider,{value:{open:i,onOpenChange:e=>{void 0===s&&o(e),r?.(e)}},children:n})},St=e.forwardRef(({onClick:s,...a},r)=>{const n=e.useContext(kt);if(!n)throw new Error("DialogTrigger must be used within Dialog");return t.jsx("button",{ref:r,onClick:e=>{s?.(e),n.onOpenChange(!0)},...a})}),Et=({children:s})=>{const a=e.useContext(kt);if(!a)throw new Error("DialogPortal must be used within Dialog");return a.open?t.jsx(t.Fragment,{children:s}):null},Tt=e.forwardRef(({onClick:s,...a},r)=>{const n=e.useContext(kt);if(!n)throw new Error("DialogClose must be used within Dialog");return t.jsx("button",{ref:r,onClick:e=>{s?.(e),n.onOpenChange(!1)},...a})}),Rt=e.forwardRef(({className:s,onClick:a,...r},n)=>{const l=e.useContext(kt);if(!l)throw new Error("DialogOverlay must be used within Dialog");return t.jsx("div",{ref:n,className:Ce("fixed inset-0 z-[100000] bg-black/80",s),onClick:e=>{a?.(e),e.target===e.currentTarget&&l.onOpenChange(!1)},...r})}),Pt=e.forwardRef(({className:s,children:a,...r},n)=>{const l=e.useContext(kt);if(!l)throw new Error("DialogContent must be used within Dialog");return e.useEffect(()=>{if(l.open){const e=e=>{"Escape"===e.key&&l.onOpenChange(!1)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}},[l]),t.jsxs(Et,{children:[t.jsx(Rt,{}),t.jsxs("div",{ref:n,className:Ce("fixed left-[50%] top-[50%] z-[100001] grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg sm:rounded-lg",s),...r,children:[a,t.jsxs(Tt,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[t.jsx(i,{className:"h-4 w-4"}),t.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}),It=({className:e,...s})=>t.jsx("div",{className:Ce("flex flex-col space-y-1.5 text-center sm:text-left",e),...s}),Bt=({className:e,...s})=>t.jsx("div",{className:Ce("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...s}),Dt=e.forwardRef(({className:e,...s},a)=>t.jsx("h2",{ref:a,className:Ce("text-lg font-semibold leading-none tracking-tight",e),...s})),_t=e.forwardRef(({className:e,...s},a)=>t.jsx("p",{ref:a,className:Ce("text-sm text-muted-foreground",e),...s}));Ct.displayName="Dialog",St.displayName="DialogTrigger",Et.displayName="DialogPortal",Tt.displayName="DialogClose",Rt.displayName="DialogOverlay",Pt.displayName="DialogContent",It.displayName="DialogHeader",Bt.displayName="DialogFooter",Dt.displayName="DialogTitle",_t.displayName="DialogDescription";const Lt=e.forwardRef(({className:e,value:s=0,max:a=100,...r},n)=>{const l=Math.min(Math.max(0,s/a*100),100);return t.jsx("div",{ref:n,role:"progressbar","aria-valuemin":0,"aria-valuemax":a,"aria-valuenow":s,className:Ce("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...r,children:t.jsx("div",{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-l}%)`}})})});Lt.displayName="Progress";const At=_e("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),$t=e.forwardRef(({className:e,variant:s,...a},r)=>t.jsx("div",{ref:r,role:"alert",className:Ce(At({variant:s}),e),...a}));$t.displayName="Alert";const zt=e.forwardRef(({className:e,...s},a)=>t.jsx("h5",{ref:a,className:Ce("mb-1 font-medium leading-none tracking-tight",e),...s}));zt.displayName="AlertTitle";const Ft=e.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:Ce("text-sm [&_p]:leading-relaxed",e),...s}));Ft.displayName="AlertDescription";const Ot=({onInsertBlock:s,onEditBlock:a,onCreateNew:r,compact:n=!1})=>{const[l,o]=e.useState([]),[i,u]=e.useState(!0),[h,x]=e.useState(""),[g,p]=e.useState("all"),[b,f]=e.useState("grid"),[v,y]=e.useState([]),[j,w]=e.useState(1),[N,k]=e.useState(1),C=async(e=1,t="",s="all")=>{u(!0);try{const a=new URLSearchParams({page:e.toString(),per_page:n?"8":"12",search:t,status:"active",order:"DESC",orderby:"usageCount"});"all"!==s&&a.append("category",s);const r=await fetch(`/api/reusable-blocks?${a}`,{credentials:"include"});if(!r.ok)throw new Error("Failed to fetch blocks");const l=await r.json(),i=parseInt(r.headers.get("X-WP-TotalPages")||"1");o(l),k(i)}catch(a){}finally{u(!1)}};e.useEffect(()=>{C(j,h,g)},[j,h,g]),e.useEffect(()=>{(async()=>{try{const e=await fetch("/api/reusable-blocks/categories",{credentials:"include"});if(e.ok){const t=await e.json();y(t)}}catch(e){}})()},[]);const S=e=>{s&&s(e)},E=async e=>{try{(await fetch(`/api/reusable-blocks/${e}/duplicate`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({})})).ok&&C(j,h,g)}catch(t){}},T=async e=>{if(confirm("Are you sure you want to delete this reusable block?"))try{(await fetch(`/api/reusable-blocks/${e}`,{method:"DELETE",credentials:"include"})).ok&&C(j,h,g)}catch(t){}},R=e=>t.jsxs(Se,{className:"group relative overflow-hidden",children:[t.jsxs("div",{className:"aspect-video bg-gray-50 border-b overflow-hidden",children:[e.preview?.screenshot?t.jsx("img",{src:e.preview.screenshot,alt:e.title,className:"w-full h-full object-cover"}):e.preview?.html?t.jsx("div",{className:"w-full h-full p-2 text-xs overflow-hidden",dangerouslySetInnerHTML:{__html:e.preview.html}}):t.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:t.jsx(d,{className:"h-8 w-8"})}),t.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[t.jsx(Ae,{size:"sm",onClick:()=>S(e),className:"bg-blue-600 hover:bg-blue-700",children:"Insert"}),e.isEditable&&a&&t.jsx(Ae,{size:"sm",variant:"outline",onClick:()=>a(e.id),children:t.jsx(q,{className:"h-4 w-4"})})]})]}),t.jsxs("div",{className:"p-3",children:[t.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[t.jsx("h3",{className:"font-medium text-sm line-clamp-2",children:e.title}),t.jsxs(Fe,{children:[t.jsx(Oe,{children:t.jsx(Ae,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 opacity-0 group-hover:opacity-100",children:"•••"})}),t.jsxs(Ue,{align:"end",children:[t.jsxs(Me,{onClick:()=>S(e),children:[t.jsx(F,{className:"h-4 w-4 mr-2"}),"Insert Block"]}),t.jsxs(Me,{onClick:()=>E(e.id),children:[t.jsx(O,{className:"h-4 w-4 mr-2"}),"Duplicate"]}),e.isEditable&&a&&t.jsxs(Me,{onClick:()=>a(e.id),children:[t.jsx(q,{className:"h-4 w-4 mr-2"}),"Edit"]}),"current-user-id"===e.author.id&&t.jsxs(Me,{onClick:()=>T(e.id),className:"text-red-600",children:[t.jsx(J,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]}),e.description&&t.jsx("p",{className:"text-xs text-gray-600 mb-2 line-clamp-2",children:e.description}),t.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[e.category&&t.jsx(Ye,{variant:"secondary",className:"text-xs",children:e.category}),e.isGlobal&&t.jsxs(Ye,{variant:"outline",className:"text-xs",children:[t.jsx(z,{className:"h-3 w-3 mr-1"}),"Global"]})]}),t.jsxs("span",{children:[e.usageCount," uses"]})]}),e.tags.length>0&&t.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[e.tags.slice(0,3).map(e=>t.jsx(Ye,{variant:"outline",className:"text-xs",children:e},e)),e.tags.length>3&&t.jsxs(Ye,{variant:"outline",className:"text-xs",children:["+",e.tags.length-3]})]})]})]},e.id);return n?t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx(c,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),t.jsx(Ke,{placeholder:"Search reusable blocks...",value:h,onChange:e=>x(e.target.value),className:"pl-10"})]}),t.jsx("div",{className:"grid grid-cols-2 gap-3",children:i?Array.from({length:4}).map((e,s)=>t.jsx("div",{className:"aspect-video bg-gray-100 rounded animate-pulse"},s)):0===l.length?t.jsx("div",{className:"col-span-2 text-center py-8 text-gray-500",children:"No reusable blocks found"}):l.map(R)}),r&&t.jsxs(Ae,{onClick:r,className:"w-full",variant:"outline",children:[t.jsx(F,{className:"h-4 w-4 mr-2"}),"Create New Block"]})]}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold",children:"Reusable Blocks"}),t.jsx("p",{className:"text-gray-600",children:"Browse and manage your reusable block library"})]}),r&&t.jsxs(Ae,{onClick:r,children:[t.jsx(F,{className:"h-4 w-4 mr-2"}),"Create New Block"]})]}),t.jsx(Se,{className:"p-4",children:t.jsxs("div",{className:"flex items-center justify-between gap-4",children:[t.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[t.jsxs("div",{className:"relative",children:[t.jsx(c,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),t.jsx(Ke,{placeholder:"Search reusable blocks...",value:h,onChange:e=>x(e.target.value),className:"pl-10 w-64"})]}),t.jsxs(Fe,{children:[t.jsx(Oe,{children:t.jsxs(Ae,{variant:"outline",children:["Category: ","all"===g?"All":g]})}),t.jsxs(Ue,{children:[t.jsx(Me,{onClick:()=>p("all"),children:"All Categories"}),v.map(e=>t.jsx(Me,{onClick:()=>p(e),children:e},e))]})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ae,{variant:"grid"===b?"default":"outline",size:"sm",onClick:()=>f("grid"),children:t.jsx(d,{className:"h-4 w-4"})}),t.jsx(Ae,{variant:"list"===b?"default":"outline",size:"sm",onClick:()=>f("list"),children:t.jsx(m,{className:"h-4 w-4"})})]})]})}),t.jsxs(ct,{defaultValue:"all",className:"space-y-4",children:[t.jsxs(dt,{children:[t.jsx(mt,{value:"all",children:"All Blocks"}),t.jsx(mt,{value:"mine",children:"My Blocks"}),t.jsx(mt,{value:"global",children:"Global Blocks"})]}),t.jsxs(ut,{value:"all",className:"space-y-4",children:[i?t.jsx("div",{className:"grid "+("grid"===b?"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4":"gap-3"),children:Array.from({length:8}).map((e,s)=>t.jsx("div",{className:"grid"===b?"aspect-video bg-gray-100 rounded animate-pulse":"h-20 bg-gray-100 rounded animate-pulse"},s))}):0===l.length?t.jsxs("div",{className:"text-center py-12",children:[t.jsx(d,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500 mb-4",children:"No reusable blocks found"}),r&&t.jsxs(Ae,{onClick:r,children:[t.jsx(F,{className:"h-4 w-4 mr-2"}),"Create Your First Block"]})]}):t.jsx("div",{className:"grid"===b?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4":"space-y-3",children:"grid"===b?l.map(R):l.map(e=>t.jsx(Se,{className:"p-4 hover:bg-gray-50",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-16 h-12 bg-gray-100 rounded border overflow-hidden flex-shrink-0",children:e.preview?.screenshot?t.jsx("img",{src:e.preview.screenshot,alt:e.title,className:"w-full h-full object-cover"}):t.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:t.jsx(d,{className:"h-4 w-4"})})}),t.jsx("div",{className:"flex-1 min-w-0",children:t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsx("h3",{className:"font-medium text-sm truncate",children:e.title}),e.description&&t.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-1",children:e.description}),t.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.category&&t.jsx(Ye,{variant:"secondary",className:"text-xs",children:e.category}),t.jsxs("span",{className:"text-xs text-gray-500",children:[e.usageCount," uses"]}),t.jsxs("span",{className:"text-xs text-gray-500",children:["by ",e.author.name]})]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(Ae,{size:"sm",onClick:()=>S(e),children:"Insert"}),t.jsxs(Fe,{children:[t.jsx(Oe,{children:t.jsx(Ae,{variant:"ghost",size:"sm",children:"•••"})}),t.jsxs(Ue,{align:"end",children:[t.jsxs(Me,{onClick:()=>E(e.id),children:[t.jsx(O,{className:"h-4 w-4 mr-2"}),"Duplicate"]}),e.isEditable&&a&&t.jsxs(Me,{onClick:()=>a(e.id),children:[t.jsx(q,{className:"h-4 w-4 mr-2"}),"Edit"]}),"current-user-id"===e.author.id&&t.jsxs(Me,{onClick:()=>T(e.id),className:"text-red-600",children:[t.jsx(J,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]})]})})]})},e.id))}),N>1&&t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"text-sm text-gray-500",children:["Page ",j," of ",N]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Ae,{variant:"outline",disabled:1===j,onClick:()=>w(j-1),children:"Previous"}),t.jsx(Ae,{variant:"outline",disabled:j===N,onClick:()=>w(j+1),children:"Next"})]})]})]}),t.jsx(ut,{value:"mine",children:t.jsx("p",{className:"text-gray-500",children:"Your personal reusable blocks"})}),t.jsx(ut,{value:"global",children:t.jsx("p",{className:"text-gray-500",children:"Blocks shared across the organization"})})]})]})};let Ut=!1;async function Mt(){if(Ut)return;await ve(()=>import("./wordpress-hooks-shim-Dsy0vzLf.js"),[]);const{default:e}=await ve(async()=>{const{default:e}=await import("./wordpress-polyfill-0dZxWs-4.js");return{default:e}},[]);e(),Ut=!0}const Ht=()=>{const[t,s]=e.useState(!1),[a,r]=e.useState(null),n=e.useCallback(async e=>{s(!0),r(null);try{const t=await fetch("/api/reusable-blocks",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.error||"Failed to save reusable block")}return await t.json()}catch(t){const e=t instanceof Error?t.message:"Unknown error occurred";return r(e),null}finally{s(!1)}},[]),l=e.useCallback(async e=>{s(!0),r(null);try{const t=await fetch(`/api/reusable-blocks/${e}`,{credentials:"include"});if(!t.ok){const e=await t.json();throw new Error(e.error||"Failed to fetch reusable block")}const s=await t.json();let a;if(Array.isArray(s.content))a=s.content;else if(window.wp?.blocks?.parse)a=window.wp.blocks.parse(s.content);else{const{parse:e}=await ve(async()=>{const{parse:e}=await import("./wp-foundation-Ht0JG6Uo.js").then(e=>e.aO);return{parse:e}},__vite__mapDeps([0,1,2,3]));a=e(s.content)}return a}catch(t){const e=t instanceof Error?t.message:"Unknown error occurred";return r(e),null}finally{s(!1)}},[]);return{loading:t,error:a,saveAsReusableBlock:n,insertReusableBlock:l,duplicateReusableBlock:e.useCallback(async e=>{s(!0),r(null);try{const t=await fetch(`/api/reusable-blocks/${e}/duplicate`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({})});if(!t.ok){const e=await t.json();throw new Error(e.error||"Failed to duplicate reusable block")}return await t.json()}catch(t){const e=t instanceof Error?t.message:"Unknown error occurred";return r(e),null}finally{s(!1)}},[]),deleteReusableBlock:e.useCallback(async e=>{s(!0),r(null);try{const t=await fetch(`/api/reusable-blocks/${e}`,{method:"DELETE",credentials:"include"});if(!t.ok){const e=await t.json();throw new Error(e.error||"Failed to delete reusable block")}return!0}catch(t){const e=t instanceof Error?t.message:"Unknown error occurred";return r(e),!1}finally{s(!1)}},[]),updateReusableBlock:e.useCallback(async(e,t)=>{s(!0),r(null);try{const s=await fetch(`/api/reusable-blocks/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!s.ok){const e=await s.json();throw new Error(e.error||"Failed to update reusable block")}return await s.json()}catch(a){const e=a instanceof Error?a.message:"Unknown error occurred";return r(e),null}finally{s(!1)}},[]),convertBlocksToReusable:e.useCallback(e=>{const t=e.map(e=>e.name||"unknown").join(", "),s=e=>e.map(e=>e.attributes?.content?e.attributes.content.replace(/<[^>]*>/g,""):e.innerBlocks?.length?s(e.innerBlocks):"").filter(Boolean).join(" ").slice(0,200);return{title:`Reusable Block (${t})`,description:s(e)||void 0,content:e,category:"general",tags:[],visibility:"private",isGlobal:!1,metadata:{version:"1.0.0",compatibility:["wordpress-6.0+"],keywords:t.split(", "),difficulty:"beginner"}}},[]),validateBlockData:e.useCallback(e=>{const t=[];if(e.title&&0!==e.title.trim().length||t.push("Title is required"),e.title&&e.title.length>255&&t.push("Title must be less than 255 characters"),e.content&&Array.isArray(e.content)&&0!==e.content.length||t.push("Block content is required"),e.description&&e.description.length>1e3&&t.push("Description must be less than 1000 characters"),e.category&&e.category.length>100&&t.push("Category must be less than 100 characters"),e.tags&&e.tags.length>10&&t.push("Maximum 10 tags allowed"),e.tags){e.tags.filter(e=>e.length>50).length>0&&t.push("Each tag must be less than 50 characters")}return e.visibility&&!["private","public","organization"].includes(e.visibility)&&t.push("Invalid visibility setting"),{valid:0===t.length,errors:t}},[])}},Vt=({isOpen:s,onClose:a,selectedBlocks:r,onSaved:n})=>{const{saveAsReusableBlock:l,convertBlocksToReusable:o,validateBlockData:c,loading:d,error:m}=Ht(),[u,h]=e.useState({title:"",description:"",category:"",tags:[],visibility:"private",isGlobal:!1}),[x,g]=e.useState(""),[p,b]=e.useState([]),[f,v]=e.useState([]);e.useEffect(()=>{if(s&&r.length>0){const e=o(r);h({title:e.title,description:e.description||"",category:e.category||"",tags:e.tags||[],visibility:e.visibility||"private",isGlobal:e.isGlobal||!1})}},[s,r,o]),e.useEffect(()=>{s&&(async()=>{try{const e=await fetch("/api/reusable-blocks/categories",{credentials:"include"});if(e.ok){const t=await e.json();v(t)}}catch(e){}})()},[s]);const y=()=>{const e=x.trim();e&&!u.tags.includes(e)&&u.tags.length<10&&(h(t=>({...t,tags:[...t.tags,e]})),g(""))};return t.jsx(Ct,{open:s,onOpenChange:a,children:t.jsxs(Pt,{className:"sm:max-w-md",children:[t.jsxs(It,{children:[t.jsx(Dt,{children:"Save as Reusable Block"}),t.jsx(_t,{children:"Save the selected blocks as a reusable block that can be used across your site."})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Ze,{htmlFor:"title",children:"Title *"}),t.jsx(Ke,{id:"title",value:u.title,onChange:e=>h(t=>({...t,title:e.target.value})),placeholder:"Enter block title...",maxLength:255})]}),t.jsxs("div",{children:[t.jsx(Ze,{htmlFor:"description",children:"Description"}),t.jsx(ht,{id:"description",value:u.description,onChange:e=>h(t=>({...t,description:e.target.value})),placeholder:"Describe what this block does...",rows:3,maxLength:1e3}),t.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[u.description.length,"/1000 characters"]})]}),t.jsxs("div",{children:[t.jsx(Ze,{htmlFor:"category",children:"Category"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(tt,{value:u.category,onValueChange:e=>h(t=>({...t,category:e})),children:[t.jsx(at,{className:"flex-1",children:t.jsx(st,{placeholder:"Select or create category..."})}),t.jsxs(rt,{children:[t.jsx(lt,{value:"general",children:"General"}),t.jsx(lt,{value:"layout",children:"Layout"}),t.jsx(lt,{value:"content",children:"Content"}),t.jsx(lt,{value:"media",children:"Media"}),t.jsx(lt,{value:"widgets",children:"Widgets"}),f.map(e=>t.jsx(lt,{value:e,children:e},e))]})]}),t.jsx(Ke,{placeholder:"Or type new category",value:u.category,onChange:e=>h(t=>({...t,category:e.target.value})),className:"flex-1",maxLength:100})]})]}),t.jsxs("div",{children:[t.jsx(Ze,{children:"Tags"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Ke,{placeholder:"Add tags...",value:x,onChange:e=>g(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),y())},maxLength:50,disabled:u.tags.length>=10}),t.jsx(Ae,{type:"button",variant:"outline",size:"sm",onClick:y,disabled:!x.trim()||u.tags.includes(x.trim())||u.tags.length>=10,children:t.jsx(F,{className:"h-4 w-4"})})]}),u.tags.length>0&&t.jsx("div",{className:"flex flex-wrap gap-2",children:u.tags.map(e=>t.jsxs(Ye,{variant:"secondary",className:"flex items-center gap-1",children:[e,t.jsx("button",{type:"button",onClick:()=>{return t=e,void h(e=>({...e,tags:e.tags.filter(e=>e!==t)}));var t},className:"ml-1 text-gray-500 hover:text-red-500",children:t.jsx(i,{className:"h-3 w-3"})})]},e))}),t.jsxs("div",{className:"text-xs text-gray-500",children:[u.tags.length,"/10 tags"]})]})]}),t.jsxs("div",{children:[t.jsx(Ze,{htmlFor:"visibility",children:"Visibility"}),t.jsxs(tt,{value:u.visibility,onValueChange:e=>h(t=>({...t,visibility:e})),children:[t.jsx(at,{children:t.jsx(st,{})}),t.jsxs(rt,{children:[t.jsx(lt,{value:"private",children:"Private (Only me)"}),t.jsx(lt,{value:"organization",children:"Organization (Team members)"}),t.jsx(lt,{value:"public",children:"Public (Everyone)"})]})]})]}),t.jsxs("div",{className:"bg-gray-50 p-3 rounded-md",children:[t.jsxs("div",{className:"text-sm text-gray-600",children:[t.jsx("strong",{children:"Blocks to save:"})," ",r.length," block",1!==r.length?"s":""]}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:r.map(e=>e.name||"unknown").join(", ")})]}),(p.length>0||m)&&t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:t.jsxs("div",{className:"text-sm text-red-800",children:[m&&t.jsx("div",{className:"mb-2",children:m}),p.map((e,s)=>t.jsxs("div",{children:["• ",e]},s))]})})]}),t.jsxs(Bt,{children:[t.jsx(Ae,{variant:"outline",onClick:a,disabled:d,children:"Cancel"}),t.jsx(Ae,{onClick:async()=>{const e={title:u.title,description:u.description||void 0,content:r,category:u.category||void 0,tags:u.tags,visibility:u.visibility,isGlobal:u.isGlobal,metadata:{version:"1.0.0",compatibility:["wordpress-6.0+"],keywords:u.tags,difficulty:"beginner"}},t=c(e);if(t.valid){b([]);try{const t=await l(e);t&&(n?.(t),a(),h({title:"",description:"",category:"",tags:[],visibility:"private",isGlobal:!1}))}catch(s){}}else b(t.errors)},disabled:d||!u.title.trim(),children:d?"Saving...":"Save Block"})]})]})})},qt=e.forwardRef(({className:e,children:s,orientation:a="vertical",...r},n)=>t.jsx("div",{ref:n,className:Ce("relative overflow-auto",{"overflow-y-auto overflow-x-hidden":"vertical"===a,"overflow-x-auto overflow-y-hidden":"horizontal"===a,"overflow-auto":"both"===a},"scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100","hover:scrollbar-thumb-gray-400",e),...r,children:s}));function Jt({className:e,...s}){return t.jsx("div",{className:Ce("animate-pulse rounded-md bg-gray-200",e),...s})}qt.displayName="ScrollArea";const Gt=({onInsertPattern:s,onPreviewPattern:a,compact:r=!1,selectedCategory:n="all"})=>{const[l,o]=e.useState([]),[i,u]=e.useState([]),[h,x]=e.useState(!0),[g,p]=e.useState(""),[b,f]=e.useState(n),[v,y]=e.useState("grid"),[j,w]=e.useState(1),[N,k]=e.useState(1),[C,S]=e.useState(null);e.useEffect(()=>{(async()=>{try{const e=await fetch("/api/block-patterns/categories");if(e.ok){const t=await e.json();u(t)}}catch(e){}})()},[]),e.useEffect(()=>{(async(e=1,t="",s="all")=>{x(!0);try{const a=new URLSearchParams({page:e.toString(),per_page:r?"12":"24",search:t,orderby:"featured",order:"DESC"});"all"!==s&&a.append("category",s);const n=await fetch(`/api/block-patterns?${a}`);if(!n.ok)throw new Error("Failed to fetch patterns");const l=await n.json(),i=parseInt(n.headers.get("X-WP-TotalPages")||"1");o(l),k(i)}catch(a){}finally{x(!1)}})(j,g,b)},[j,g,b]);const E=e=>{s&&s(e)},T=e=>{a&&a(e)},R=e=>t.jsxs(Se,{className:"group relative overflow-hidden cursor-pointer transition-all "+(C===e.id?"ring-2 ring-blue-500":""),onMouseEnter:()=>S(e.id),onMouseLeave:()=>S(null),onClick:()=>E(e),children:[t.jsxs("div",{className:"aspect-[4/3] bg-gray-50 border-b overflow-hidden relative",children:[e.preview?.screenshot?t.jsx("img",{src:e.preview.screenshot,alt:e.title,className:"w-full h-full object-cover"}):e.preview?.html?t.jsx("div",{className:"w-full h-full p-4 overflow-hidden",children:t.jsx("div",{className:"transform scale-50 origin-top-left w-[200%] h-[200%]",children:t.jsx("div",{dangerouslySetInnerHTML:{__html:e.preview.html}})})}):t.jsx("div",{className:"w-full h-full flex items-center justify-center",children:t.jsx(G,{className:"h-12 w-12 text-gray-300"})}),t.jsxs("div",{className:"absolute top-2 left-2 flex gap-1",children:[e.featured&&t.jsxs(Ye,{className:"bg-yellow-500 text-white",children:[t.jsx(z,{className:"h-3 w-3 mr-1 fill-current"}),"Featured"]}),e.isPremium&&t.jsx(Ye,{className:"bg-purple-500 text-white",children:"Pro"}),"core"===e.source&&t.jsx(Ye,{variant:"secondary",children:"Core"})]}),t.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[t.jsx(Ae,{size:"sm",onClick:t=>{t.stopPropagation(),E(e)},className:"bg-blue-600 hover:bg-blue-700",children:"Insert Pattern"}),a&&t.jsx(Ae,{size:"sm",variant:"outline",onClick:t=>{t.stopPropagation(),T(e)},className:"text-white border-white hover:bg-white/20",children:t.jsx(W,{className:"h-4 w-4"})})]})]}),t.jsxs("div",{className:"p-4",children:[t.jsx("h3",{className:"font-medium text-sm mb-1",children:e.title}),e.description&&t.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:e.description}),t.jsxs("div",{className:"flex items-center justify-between mt-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ye,{variant:"outline",className:"text-xs",children:i.find(t=>t.id===e.category)?.name||e.category}),e.usageCount>0&&t.jsxs("span",{className:"text-xs text-gray-500",children:[e.usageCount," uses"]})]}),t.jsxs("span",{className:"text-xs text-gray-400",children:["by ",e.author.name]})]}),e.tags.length>0&&t.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:e.tags.slice(0,3).map(e=>t.jsxs("span",{className:"text-xs text-gray-500",children:["#",e]},e))})]})]},e.id),P=()=>t.jsx("div",{className:"grid"===v?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4":"space-y-3",children:Array.from({length:6}).map((e,s)=>t.jsxs(Se,{className:"overflow-hidden",children:[t.jsx(Jt,{className:"grid"===v?"h-48":"h-20"}),t.jsxs("div",{className:"p-4 space-y-2",children:[t.jsx(Jt,{className:"h-4 w-3/4"}),t.jsx(Jt,{className:"h-3 w-full"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Jt,{className:"h-5 w-16"}),t.jsx(Jt,{className:"h-5 w-16"})]})]})]},s))});return r?t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx(c,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),t.jsx(Ke,{placeholder:"Search patterns...",value:g,onChange:e=>p(e.target.value),className:"pl-10"})]}),t.jsx(qt,{className:"w-full",children:t.jsxs("div",{className:"flex gap-2 pb-2",children:[t.jsx(Ae,{variant:"all"===b?"default":"outline",size:"sm",onClick:()=>f("all"),children:"All"}),i.map(e=>t.jsxs(Ae,{variant:b===e.id?"default":"outline",size:"sm",onClick:()=>f(e.id),children:[e.name," (",e.count,")"]},e.id))]})}),t.jsx("div",{className:"space-y-3",children:h?P():0===l.length?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(G,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"No patterns found"})]}):t.jsx("div",{className:"grid grid-cols-2 gap-3",children:l.slice(0,6).map(R)})})]}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold",children:"Block Patterns"}),t.jsx("p",{className:"text-gray-600",children:"Pre-designed block layouts to speed up your workflow"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ae,{variant:"grid"===v?"default":"outline",size:"sm",onClick:()=>y("grid"),children:t.jsx(d,{className:"h-4 w-4"})}),t.jsx(Ae,{variant:"list"===v?"default":"outline",size:"sm",onClick:()=>y("list"),children:t.jsx(m,{className:"h-4 w-4"})})]})]}),t.jsx(Se,{className:"p-4",children:t.jsx("div",{className:"flex items-center gap-4",children:t.jsxs("div",{className:"relative flex-1",children:[t.jsx(c,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),t.jsx(Ke,{placeholder:"Search patterns...",value:g,onChange:e=>p(e.target.value),className:"pl-10"})]})})}),t.jsxs(ct,{value:b,onValueChange:f,children:[t.jsxs(dt,{className:"w-full justify-start overflow-x-auto",children:[t.jsxs(mt,{value:"all",children:["All Patterns",i.length>0&&t.jsxs("span",{className:"ml-2 text-xs",children:["(",i.reduce((e,t)=>e+t.count,0),")"]})]}),i.map(e=>t.jsxs(mt,{value:e.id,children:[e.name,t.jsxs("span",{className:"ml-2 text-xs",children:["(",e.count,")"]})]},e.id))]}),t.jsx(ut,{value:b,className:"mt-6",children:h?P():0===l.length?t.jsxs("div",{className:"text-center py-16",children:[t.jsx(G,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-medium mb-2",children:"No patterns found"}),t.jsx("p",{className:"text-gray-500",children:"Try adjusting your search or filter criteria"})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"grid"===v?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4":"space-y-3",children:"grid"===v?l.map(R):l.map(e=>t.jsx(Se,{className:"p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>E(e),children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-20 h-16 bg-gray-100 rounded border overflow-hidden flex-shrink-0",children:e.preview?.screenshot?t.jsx("img",{src:e.preview.screenshot,alt:e.title,className:"w-full h-full object-cover"}):t.jsx("div",{className:"w-full h-full flex items-center justify-center",children:t.jsx(G,{className:"h-6 w-6 text-gray-400"})})}),t.jsx("div",{className:"flex-1 min-w-0",children:t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsxs("h3",{className:"font-medium text-sm flex items-center gap-2",children:[e.title,e.featured&&t.jsx(z,{className:"h-3 w-3 text-yellow-500 fill-current"}),e.isPremium&&t.jsx(Ye,{className:"text-xs bg-purple-500 text-white",children:"Pro"})]}),e.description&&t.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-1",children:e.description}),t.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[t.jsx(Ye,{variant:"outline",className:"text-xs",children:i.find(t=>t.id===e.category)?.name||e.category}),t.jsxs("span",{className:"text-xs text-gray-500",children:[e.usageCount," uses"]}),t.jsxs("span",{className:"text-xs text-gray-500",children:["by ",e.author.name]})]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(Ae,{size:"sm",onClick:t=>{t.stopPropagation(),E(e)},children:"Insert"}),a&&t.jsx(Ae,{size:"sm",variant:"ghost",onClick:t=>{t.stopPropagation(),T(e)},children:t.jsx(W,{className:"h-4 w-4"})})]})]})})]})},e.id))}),N>1&&t.jsxs("div",{className:"flex items-center justify-between mt-8",children:[t.jsxs("div",{className:"text-sm text-gray-500",children:["Page ",j," of ",N]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Ae,{variant:"outline",disabled:1===j,onClick:()=>w(j-1),children:"Previous"}),t.jsx(Ae,{variant:"outline",disabled:j===N,onClick:()=>w(j+1),children:"Next"})]})]})]})})]})]})},Wt=e=>e.map(e=>({name:e.name,attributes:e.attributes,innerBlocks:e.innerBlocks?Wt(e.innerBlocks):void 0,innerHTML:e.innerHTML})),Kt=e=>{const t=e=>{const s={name:e.name,attributes:e.attributes||{},innerBlocks:[],innerHTML:e.innerHTML||""};return e.innerBlocks&&e.innerBlocks.length>0&&(s.innerBlocks=e.innerBlocks.map(t)),s.clientId=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,s};return e.content.map(t)};const Qt={"o4o/group":()=>ve(()=>import("./block-group-BascGEu1.js"),__vite__mapDeps([4,0,1])),"o4o/columns":()=>ve(()=>import("./block-columns-DWjg4ArH.js"),__vite__mapDeps([5,0,1]))},Yt=new Set;async function Xt(e){if(Yt.has(e))return;const t=Qt[e];if(t)try{await t(),Yt.add(e)}catch(s){}}const Zt=({showSidebar:e=!0})=>t.jsxs("div",{className:"flex h-full",children:[t.jsxs("div",{className:"flex-1 p-6 space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-2 p-2 border rounded",children:[t.jsx(Jt,{className:"h-8 w-8"}),t.jsx(Jt,{className:"h-8 w-8"}),t.jsx(Jt,{className:"h-8 w-8"}),t.jsx("div",{className:"flex-1"}),t.jsx(Jt,{className:"h-8 w-24"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx(Jt,{className:"h-12 w-2/3"}),t.jsx(Jt,{className:"h-4 w-full"}),t.jsx(Jt,{className:"h-4 w-full"}),t.jsx(Jt,{className:"h-4 w-3/4"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[t.jsx(Jt,{className:"h-32"}),t.jsx(Jt,{className:"h-32"})]})]})]}),e&&t.jsxs("div",{className:"w-80 border-l p-4 space-y-4",children:[t.jsx(Jt,{className:"h-8 w-full"}),t.jsx(Jt,{className:"h-12 w-full"}),t.jsx(Jt,{className:"h-12 w-full"}),t.jsx(Jt,{className:"h-12 w-full"})]})]}),es=({isSaving:e,lastSavedAt:s,hasError:a})=>{if(e)return t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[t.jsx(K,{className:"h-3 w-3 animate-spin"}),t.jsx("span",{children:"Saving..."})]});if(a)return t.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-600",children:[t.jsx(Q,{className:"h-3 w-3"}),t.jsx("span",{children:"Save failed"})]});if(s){const e=function(e){const t=Math.floor(((new Date).getTime()-e.getTime())/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:`${Math.floor(t/86400)}d ago`}(s);return t.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[t.jsx(Y,{className:"h-3 w-3"}),t.jsxs("span",{children:["Saved ",e]})]})}return null};const ts=({initialContent:s="",onChange:a,settings:r={},showReusableBlocks:n=!0})=>{const[l,o]=e.useState([]),[i]=e.useState([]),[c,d]=e.useState(!1),[m,u]=e.useState(!1),[h,x]=e.useState(!1),[g,p]=e.useState(!0),[b,f]=e.useState(!1),v=e.useRef(null),{insertReusableBlock:y,loading:j}=Ht(),{insertBlockPattern:w,loading:N}=(()=>{const[t,s]=e.useState(!1),[a,r]=e.useState(null),n=e.useCallback(async e=>{s(!0),r(null);try{const t=await fetch(`/api/block-patterns/${e}`);if(!t.ok){const e=await t.json();throw new Error(e.error||"Failed to fetch block pattern")}const s=await t.json();return Kt(s)}catch(t){const e=t instanceof Error?t.message:"Unknown error occurred";return r(e),null}finally{s(!1)}},[]),l=e.useCallback(async e=>{s(!0),r(null);try{const t=await fetch("/api/block-patterns",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.error||"Failed to create block pattern")}return await t.json()}catch(t){const e=t instanceof Error?t.message:"Unknown error occurred";return r(e),null}finally{s(!1)}},[]),o=e.useCallback(async e=>{s(!0),r(null);try{const t=await fetch(`/api/block-patterns/${e}/duplicate`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({})});if(!t.ok){const e=await t.json();throw new Error(e.error||"Failed to duplicate block pattern")}return await t.json()}catch(t){const e=t instanceof Error?t.message:"Unknown error occurred";return r(e),null}finally{s(!1)}},[]),i=e.useCallback(async e=>{s(!0),r(null);try{const t=await fetch(`/api/block-patterns/${e}`,{method:"DELETE",credentials:"include"});if(!t.ok){const e=await t.json();throw new Error(e.error||"Failed to delete block pattern")}return!0}catch(t){const e=t instanceof Error?t.message:"Unknown error occurred";return r(e),!1}finally{s(!1)}},[]),c=e.useCallback(async(e,t)=>{s(!0),r(null);try{const s=await fetch(`/api/block-patterns/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!s.ok){const e=await s.json();throw new Error(e.error||"Failed to update block pattern")}return await s.json()}catch(a){const e=a instanceof Error?a.message:"Unknown error occurred";return r(e),null}finally{s(!1)}},[]),d=e.useCallback(e=>{const t=e.map(e=>({name:e.name,attributes:e.attributes,innerBlocks:e.innerBlocks?Wt(e.innerBlocks):void 0,innerHTML:e.innerHTML})),s=e.map(e=>e.name);let a="general";return s.includes("core/navigation")||s.includes("core/site-logo")?a="header":s.includes("core/heading")&&s.includes("core/buttons")?a="hero":s.includes("core/columns")&&s.length>3?a="features":(s.includes("core/quote")||s.includes("core/testimonial"))&&(a="testimonials"),{title:`Custom ${a.charAt(0).toUpperCase()+a.slice(1)} Pattern`,description:`A custom ${a} pattern created from selected blocks`,content:t,category:a,tags:[],visibility:"private",metadata:{blockTypes:s,createdFrom:"editor"}}},[]),m=e.useCallback((e,t)=>!e.dependencies||0===e.dependencies.length||(e.metadata?.blockTypes||[]).every(e=>t.includes(e)),[]),u=e.useCallback((e,t)=>{if(e.colorScheme&&e.colorScheme.length>0&&e.colorScheme.forEach((e,s)=>{t.style.setProperty(`--pattern-color-${s+1}`,e)}),e.typography&&(e.typography.fontFamily&&(t.style.fontFamily=e.typography.fontFamily),e.typography.fontSize&&(t.style.fontSize=e.typography.fontSize),e.typography.lineHeight&&(t.style.lineHeight=e.typography.lineHeight),e.typography.fontWeight&&(t.style.fontWeight=e.typography.fontWeight)),e.preview?.css){const s=document.createElement("style");s.textContent=e.preview.css,t.appendChild(s)}},[]);return{loading:t,error:a,insertBlockPattern:n,createBlockPattern:l,duplicateBlockPattern:o,deleteBlockPattern:i,updateBlockPattern:c,convertBlocksToPattern:d,transformPatternToBlocks:Kt,validatePatternCompatibility:m,applyPatternStyles:u}})(),{metrics:k,measureRenderTime:C}=function(t={}){const{enableMonitoring:s=!0,warnThreshold:a={blockCount:100,renderTime:100,memoryUsage:52428800,fps:30},onPerformanceIssue:r}=t,[n,l]=e.useState({blockCount:0,renderTime:0,memoryUsage:0,fps:60,lagSpikes:0}),o=e.useRef(0),i=e.useRef(performance.now()),c=e.useRef([]),d=e.useRef(void 0),m=e.useCallback(()=>{const e=performance.now(),t=e-i.current;if(t>0){const e=1e3/t;c.current.push(e),c.current.length>60&&c.current.shift();const s=c.current.reduce((e,t)=>e+t,0)/c.current.length;t>33&&l(e=>({...e,lagSpikes:e.lagSpikes+1})),l(e=>({...e,fps:Math.round(s)}))}i.current=e,o.current++,s&&(d.current=requestAnimationFrame(m))},[s]),u=e.useCallback(async()=>{if("memory"in performance&&performance.memory){const e=performance.memory;l(t=>({...t,memoryUsage:e.usedJSHeapSize}))}},[]),h=e.useCallback(()=>{if("undefined"!=typeof window&&window.wp?.data){const{getBlocks:e}=window.wp.data.select("core/block-editor"),t=e();if(t){let e=0;const s=t=>{t.forEach(t=>{e++,t.innerBlocks?.length>0&&s(t.innerBlocks)})};s(t),l(t=>({...t,blockCount:e}))}}},[]),x=e.useCallback(e=>{const t=performance.now();e(),requestAnimationFrame(()=>{const e=performance.now()-t;l(t=>({...t,renderTime:e}))})},[]);return e.useEffect(()=>{if(!s)return;const e=[];a.blockCount&&n.blockCount>a.blockCount&&e.push(`High block count: ${n.blockCount}`),a.renderTime&&n.renderTime>a.renderTime&&e.push(`Slow render: ${n.renderTime.toFixed(2)}ms`),a.memoryUsage&&n.memoryUsage>a.memoryUsage&&e.push(`High memory usage: ${(n.memoryUsage/1024/1024).toFixed(2)}MB`),a.fps&&n.fps<a.fps&&e.push(`Low FPS: ${n.fps}`),e.length>0&&r&&r(n)},[n,a,r,s]),e.useEffect(()=>{if(!s)return;m();const e=setInterval(()=>{u(),h()},1e3);return()=>{d.current&&cancelAnimationFrame(d.current),clearInterval(e)}},[s,m,u,h]),{metrics:n,measureRenderTime:x,resetMetrics:()=>{l({blockCount:0,renderTime:0,memoryUsage:0,fps:60,lagSpikes:0}),c.current=[]}}}({onPerformanceIssue:e=>{e.blockCount}}),{isSaving:S,lastSavedAt:E,backupExists:T,updateContent:R,restoreFromBackup:P}=xt(l,{onSave:async e=>{a&&a(pe(e),e)},saveInterval:3e4,debounceDelay:1e3}),I={alignWide:!0,availableTemplates:[],allowedBlockTypes:!0,disableCustomColors:!1,disableCustomFontSizes:!1,disableCustomGradients:!1,enableCustomSpacing:!0,isRTL:!1,mediaUpload:e=>{},__experimentalBlockPatterns:[],__experimentalSetIsInserterOpened:()=>{},...r};e.useEffect(()=>{Mt().then(()=>{f(!0)})},[]),e.useEffect(()=>{if(!b)return;(async()=>{p(!0);try{if((window.wp?.domReady||(e=>{"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}))(()=>{const e=document.createElement("style");e.textContent="\n  /* Group Block Styles */\n  .o4o-group-block {\n    box-sizing: border-box;\n  }\n  \n  .o4o-group-block.flex {\n    display: flex;\n  }\n  \n  .o4o-group-block.grid {\n    display: grid;\n  }\n  \n  /* Columns Block Styles */\n  .o4o-columns-block {\n    display: flex;\n    width: 100%;\n    box-sizing: border-box;\n  }\n  \n  .o4o-column-block {\n    box-sizing: border-box;\n    flex-grow: 0;\n    flex-shrink: 0;\n  }\n  \n  @media (max-width: 768px) {\n    .o4o-columns-block.stack-on-mobile {\n      flex-direction: column !important;\n    }\n    \n    .o4o-columns-block.stack-on-mobile .o4o-column-block {\n      flex-basis: 100% !important;\n      margin-bottom: 20px;\n    }\n  }\n  \n  /* InnerBlocks Styles */\n  .block-editor-inner-blocks {\n    height: 100%;\n  }\n  \n  .block-editor-inner-blocks .block-editor-block-list__layout {\n    height: 100%;\n  }\n  \n  /* Block Appender Styles */\n  .block-list-appender {\n    margin-top: 20px;\n  }\n  \n  .block-editor-button-block-appender {\n    width: 100%;\n    justify-content: center;\n    padding: 12px;\n    border: 2px dashed #ddd;\n    color: #555;\n    transition: all 0.2s ease;\n  }\n  \n  .block-editor-button-block-appender:hover {\n    border-color: #007cba;\n    color: #007cba;\n    background-color: rgba(0, 124, 186, 0.04);\n  }\n",document.head.appendChild(e)}),function(){if("undefined"!=typeof window&&window.wp?.data){const{subscribe:e}=window.wp.data;if(!e)return;let t=new Set;e(()=>{const e=window.wp?.data?.select;if(!e)return;const s=e("core/block-editor")?.getBlocks;if(!s)return;const a=s();if(!a)return;const r=new Set,n=e=>{e.forEach(e=>{r.add(e.name),e.innerBlocks?.length>0&&n(e.innerBlocks)})};n(a),r.forEach(e=>{!t.has(e)&&Qt[e]&&Xt(e)}),t=r})}}(),s&&await async function(e){const t=/<!-- wp:(\S+)/g,s=new Set;let a;for(;null!==(a=t.exec(e));)s.add(a[1]);const r=Array.from(s).map(e=>Xt(e));await Promise.all(r)}(s),T&&!s){if(window.confirm("Found unsaved changes. Would you like to restore them?")){const e=await P();if(e)return o(e),void p(!1)}}}catch(e){}finally{p(!1)}})()},[b]),e.useEffect(()=>{if(s)try{const e=ie(s);if(e.length>0)o(e);else{const e=ce("core/paragraph",{content:s});o([e])}}catch(e){const t=ce("core/paragraph");o([t])}else{const e=ce("core/paragraph");o([e])}},[s]);const B=e=>{C(()=>{if(o(e),R(e),a)try{const t=pe(e);a(t,e)}catch(t){}})};return!b||g?t.jsx(Zt,{showSidebar:!0}):t.jsxs("div",{className:"wordpress-block-editor",ref:v,children:[k.blockCount>100&&t.jsxs($t,{className:"mb-4",children:[t.jsx(Q,{className:"h-4 w-4"}),t.jsxs(Ft,{children:["High block count (",k.blockCount," blocks) may affect performance. Consider splitting content into multiple pages."]})]}),T&&t.jsx($t,{className:"mb-4",children:t.jsxs(Ft,{className:"flex items-center justify-between",children:[t.jsx("span",{children:"Found unsaved changes from your last session."}),t.jsxs(Ae,{size:"sm",variant:"outline",onClick:P,children:[t.jsx(X,{className:"h-4 w-4 mr-2"}),"Restore"]})]})}),t.jsx(be,{children:t.jsxs(de,{value:l,onInput:B,onChange:B,settings:I,useSubRegistry:!1,children:[t.jsx("div",{className:"block-editor-toolbar",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(me,{}),t.jsx(es,{isSaving:S,lastSavedAt:E,hasError:!1})]}),n&&t.jsxs("div",{className:"flex items-center gap-2",children:[i.length>0&&t.jsxs(Ae,{size:"sm",variant:"outline",onClick:()=>{i.length>0&&u(!0)},disabled:j,children:[t.jsx(Z,{className:"h-4 w-4 mr-2"}),"Save as Reusable"]}),t.jsxs(Ae,{size:"sm",variant:"outline",onClick:()=>d(!0),children:[t.jsx(ee,{className:"h-4 w-4 mr-2"}),"Reusable Blocks"]}),t.jsxs(Ae,{size:"sm",variant:"outline",onClick:()=>x(!0),disabled:N,children:[t.jsx(G,{className:"h-4 w-4 mr-2"}),"Block Patterns"]})]})]})}),t.jsx("div",{className:"block-editor-content",children:t.jsx(ue,{children:t.jsx(he,{children:t.jsx(xe,{className:"block-editor-block-list"})})})}),t.jsx("div",{className:"block-editor-inspector",children:t.jsx(ge,{})})]})}),c&&t.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Reusable Blocks"}),t.jsx(Ae,{variant:"ghost",size:"sm",onClick:()=>d(!1),children:"×"})]}),t.jsx("div",{className:"p-4 overflow-auto max-h-[calc(90vh-120px)]",children:t.jsx(Ot,{onInsertBlock:async e=>{try{const t=await y(e.id);if(t&&t.length>0){const e=[...l,...t];B(e),d(!1)}}catch(t){}},compact:!1})})]})}),t.jsx(Vt,{isOpen:m,onClose:()=>u(!1),selectedBlocks:i,onSaved:()=>{}}),h&&t.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-white rounded-lg w-full max-w-6xl max-h-[90vh] overflow-hidden",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Block Patterns"}),t.jsx(Ae,{variant:"ghost",size:"sm",onClick:()=>x(!1),children:"×"})]}),t.jsx("div",{className:"p-4 overflow-auto max-h-[calc(90vh-120px)]",children:t.jsx(Gt,{onInsertPattern:async e=>{try{const t=await w(e.id);if(t&&t.length>0){const e=[...l,...t];B(e),x(!1)}}catch(t){}},compact:!1})})]})}),t.jsx("style",{children:"\n        .wordpress-block-editor {\n          display: flex;\n          flex-direction: column;\n          height: 100%;\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen-Sans, Ubuntu, Cantarell, 'Helvetica Neue', sans-serif;\n        }\n\n        .block-editor-toolbar {\n          background: #fff;\n          border-bottom: 1px solid #e0e0e0;\n          padding: 8px 16px;\n          position: sticky;\n          top: 0;\n          z-index: 20;\n        }\n\n        .block-editor-content {\n          flex: 1;\n          overflow: auto;\n          padding: 16px;\n          background: #fff;\n        }\n\n        .block-editor-inspector {\n          width: 280px;\n          background: #f8f9fa;\n          border-left: 1px solid #e0e0e0;\n          overflow: auto;\n        }\n\n        /* WordPress Block Editor Styles */\n        :global(.block-editor-block-list__layout) {\n          max-width: 840px;\n          margin: 0 auto;\n        }\n\n        :global(.block-editor-block-list__block) {\n          margin: 28px 0;\n        }\n\n        :global(.block-editor-block-list__block.is-selected) {\n          outline: 1px solid #007cba;\n          outline-offset: -1px;\n        }\n\n        :global(.block-editor-block-list__block.is-hovered) {\n          outline: 1px solid #007cba;\n          outline-offset: -1px;\n          outline-style: dashed;\n        }\n\n        /* Block Toolbar Styles */\n        :global(.block-editor-block-toolbar) {\n          background: #fff;\n          border: 1px solid #e0e0e0;\n          border-radius: 4px;\n          box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);\n        }\n\n        /* Popover Styles */\n        :global(.components-popover) {\n          z-index: 1000000;\n        }\n\n        :global(.components-popover__content) {\n          background: #fff;\n          border: 1px solid #e0e0e0;\n          border-radius: 4px;\n          box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);\n        }\n\n        /* Inspector Styles */\n        :global(.block-editor-block-inspector) {\n          padding: 16px;\n        }\n\n        :global(.block-editor-block-inspector .components-panel) {\n          border: none;\n          margin-bottom: 16px;\n        }\n\n        :global(.block-editor-block-inspector .components-panel__header) {\n          background: #f8f9fa;\n          border-bottom: 1px solid #e0e0e0;\n          padding: 8px 16px;\n          font-weight: 600;\n        }\n\n        :global(.block-editor-block-inspector .components-panel__body) {\n          padding: 16px;\n        }\n      "})]})};export{ye as A,Ae as B,Se as C,Fe as D,_t as E,Bt as F,Nt as G,Ne as H,Ke as I,$t as J,Ft as K,Ze as L,Le as M,zt as N,qt as O,Lt as P,Ie as Q,Ot as R,tt as S,ht as T,Mt as U,ts as W,ve as _,ct as a,dt as b,Ce as c,mt as d,ut as e,at as f,st as g,rt as h,lt as i,je as j,Ee as k,Te as l,Pe as m,Oe as n,Ue as o,qe as p,Je as q,Me as r,Ye as s,Re as t,ke as u,xt as v,Ct as w,Pt as x,It as y,Dt as z};
