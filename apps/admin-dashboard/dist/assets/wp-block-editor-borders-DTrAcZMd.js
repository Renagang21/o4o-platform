import{f as o,h as e,i as r,d as t,j as s}from"./wp-block-editor-utils-BS9xY-75.js";import{c as n}from"./vendor-ui-CrFdsnXa.js";import{d as l}from"./wp-blocks-core-BDaUU0zy.js";import{a}from"./wp-core-BedthL0o.js";import{j as i,u as d,I as c}from"./wp-block-editor-misc-5qbjj7fi.js";import{g as u,u as h}from"./wp-block-editor-colors-uaYdG60c.js";import{s as p}from"./wp-block-editor-store-D0LqdVTA.js";import{a as b}from"./wp-i18n-D2qT7FTy.js";import{j as m,r as f}from"./vendor-react-DqgGMt48.js";import{__experimentalParseQuantityAndUnitFromRawValue as g,__experimentalUnitControl as x,Tooltip as v,Button as _,__experimentalUseCustomUnits as w,BaseControl as j,RangeControl as C,Dropdown as y,__experimentalDropdownContentWrapper as S,__experimentalHStack as B,FlexItem as k,__experimentalVStack as N,__experimentalHeading as L,Composite as R,__experimentalHasSplitBorders as I,__experimentalToolsPanelItem as U,__experimentalIsDefinedBorder as D,__experimentalBorderBoxControl as A,__experimentalItemGroup as F,__experimentalToolsPanel as z}from"./wp-components-Jwbue4-Q.js";import{e as P,f as V,I as O,s as T,i as M}from"./wp-misc-nAANEFFa.js";import{u as $,b as H,c as W}from"./wp-block-editor-global-styles-CgbocFEz.js";function E(o){return[...o].sort((e,r)=>o.filter(o=>o===r).length-o.filter(o=>o===e).length).shift()}function G(o={}){const{flat:e,...r}=o;return e||E(Object.values(r).filter(Boolean))||"px"}function K(o={}){if("string"==typeof o)return o;const e=Object.values(o).map(o=>g(o)),r=e.map(o=>{var e;return null!==(e=o[0])&&void 0!==e?e:""}),t=e.map(o=>o[1]),s=r.every(o=>o===r[0])?r[0]:"",n=E(t);return 0===s||s?`${s}${n}`:void 0}function Q(o={}){const e=K(o);return"string"!=typeof o&&isNaN(parseFloat(e))}function q(o){if(!o)return!1;if("string"==typeof o)return!0;return!!Object.values(o).filter(o=>!!o||0===o).length}function J({onChange:o,selectedUnits:e,setSelectedUnits:r,values:t,...s}){let n=K(t);void 0===n&&(n=G(e));const l=q(t)&&Q(t),a=l?b("Mixed"):null;return m.jsx(x,{...s,"aria-label":b("Border radius"),disableUnits:l,isOnly:!0,value:n,onChange:e=>{const r=!isNaN(parseFloat(e));o(r?e:void 0)},onUnitChange:o=>{r({topLeft:o,topRight:o,bottomLeft:o,bottomRight:o})},placeholder:a,size:"__unstable-large"})}const X={topLeft:b("Top left"),topRight:b("Top right"),bottomLeft:b("Bottom left"),bottomRight:b("Bottom right")};function Y({onChange:o,selectedUnits:e,setSelectedUnits:r,values:t,...s}){const n=e=>r=>{if(!o)return;const t=!isNaN(parseFloat(r))?r:void 0;o({...l,[e]:t})},l="string"!=typeof t?t:{topLeft:t,topRight:t,bottomLeft:t,bottomRight:t};return m.jsx("div",{className:"components-border-radius-control__input-controls-wrapper",children:Object.entries(X).map(([o,t])=>{const[a,i]=g(l[o]),d=l[o]?i:e[o]||e.flat;return m.jsx(v,{text:t,placement:"top",children:m.jsx("div",{className:"components-border-radius-control__tooltip-wrapper",children:m.jsx(x,{...s,"aria-label":t,value:[a,d].join(""),onChange:n(o),onUnitChange:(c=o,o=>{const t={...e};t[c]=o,r(t)}),size:"__unstable-large"})})},o);var c})})}function Z({isLinked:o,...e}){const r=b(o?"Unlink radii":"Link radii");return m.jsx(v,{text:r,children:m.jsx(_,{...e,className:"component-border-radius-control__linked-button",size:"small",icon:o?P:V,iconSize:24,"aria-label":r})})}const oo={topLeft:void 0,topRight:void 0,bottomLeft:void 0,bottomRight:void 0},eo={px:100,em:20,rem:20};function ro({onChange:o,values:e}){const[r,t]=f.useState(!q(e)||!Q(e)),[s,n]=f.useState({flat:"string"==typeof e?g(e)[1]:void 0,topLeft:g(e?.topLeft)[1],topRight:g(e?.topRight)[1],bottomLeft:g(e?.bottomLeft)[1],bottomRight:g(e?.bottomRight)[1]}),[l]=i("spacing.units"),a=w({availableUnits:l||["px","em","rem"]}),d=G(s),c=a&&a.find(o=>o.value===d),u=c?.step||1,[h]=g(K(e));return m.jsxs("fieldset",{className:"components-border-radius-control",children:[m.jsx(j.VisualLabel,{as:"legend",children:b("Radius")}),m.jsxs("div",{className:"components-border-radius-control__wrapper",children:[r?m.jsxs(m.Fragment,{children:[m.jsx(J,{className:"components-border-radius-control__unit-control",values:e,min:0,onChange:o,selectedUnits:s,setSelectedUnits:n,units:a}),m.jsx(C,{__next40pxDefaultSize:!0,label:b("Border radius"),hideLabelFromVision:!0,className:"components-border-radius-control__range-control",value:null!=h?h:"",min:0,max:eo[d],initialPosition:0,withInputField:!1,onChange:e=>{o(void 0!==e?`${e}${d}`:void 0)},step:u,__nextHasNoMarginBottom:!0})]}):m.jsx(Y,{min:0,onChange:o,selectedUnits:s,setSelectedUnits:n,values:e||oo,units:a}),m.jsx(Z,{onClick:()=>t(!r),isLinked:r})]})]})}const to=[];function so({shadow:o,onShadowChange:e,settings:r}){const t=co(r);return m.jsx("div",{className:"block-editor-global-styles__shadow-popover-container",children:m.jsxs(N,{spacing:4,children:[m.jsx(L,{level:5,children:b("Drop shadow")}),m.jsx(no,{presets:t,activeShadow:o,onSelect:e}),m.jsx("div",{className:"block-editor-global-styles__clear-shadow",children:m.jsx(_,{__next40pxDefaultSize:!0,variant:"tertiary",onClick:()=>e(void 0),children:b("Clear")})})]})})}function no({presets:o,activeShadow:e,onSelect:r}){return o?m.jsx(R,{role:"listbox",className:"block-editor-global-styles__shadow__list","aria-label":b("Drop shadows"),children:o.map(({name:o,slug:t,shadow:s})=>m.jsx(lo,{label:o,isActive:s===e,type:"unset"===t?"unset":"preset",onSelect:()=>r(s===e?void 0:s),shadow:s},t))}):null}function lo({type:o,label:e,isActive:r,onSelect:t,shadow:s}){return m.jsx(v,{text:e,children:m.jsx(R.Item,{role:"option","aria-label":e,"aria-selected":r,className:n("block-editor-global-styles__shadow__item",{"is-active":r}),render:m.jsx("button",{className:n("block-editor-global-styles__shadow-indicator",{unset:"unset"===o}),onClick:t,style:{boxShadow:s},"aria-label":e,children:r&&m.jsx(O,{icon:M})})})})}function ao({shadow:o,onShadowChange:e,settings:r}){return m.jsx(y,{popoverProps:{placement:"left-start",offset:36,shift:!0},className:"block-editor-global-styles__shadow-dropdown",renderToggle:io(),renderContent:()=>m.jsx(S,{paddingSize:"medium",children:m.jsx(so,{shadow:o,onShadowChange:e,settings:r})})})}function io(){return({onToggle:o,isOpen:e})=>{const r={onClick:o,className:n({"is-open":e}),"aria-expanded":e};return m.jsx(_,{__next40pxDefaultSize:!0,...r,children:m.jsxs(B,{justify:"flex-start",children:[m.jsx(O,{className:"block-editor-global-styles__toggle-icon",icon:T,size:24}),m.jsx(k,{children:b("Drop shadow")})]})})}}function co(o){return f.useMemo(()=>{var e;if(!o?.shadow)return to;const r=o?.shadow?.defaultPresets,{default:t,theme:s,custom:n}=null!==(e=o?.shadow?.presets)&&void 0!==e?e:{},l={name:b("Unset"),slug:"unset",shadow:"none"},a=[...r&&t||to,...s||to,...n||to];return a.length&&a.unshift(l),a},[o])}function uo(o){return Object.values(ho(o)).some(Boolean)}function ho(o){return{hasBorderColor:po(o),hasBorderRadius:bo(o),hasBorderStyle:mo(o),hasBorderWidth:fo(o),hasShadow:go(o)}}function po(o){return o?.border?.color}function bo(o){return o?.border?.radius}function mo(o){return o?.border?.style}function fo(o){return o?.border?.width}function go(o){const e=co(o);return!!o?.shadow&&e.length>0}function xo({resetAllFilter:o,onChange:e,value:r,panelId:t,children:s,label:n}){const l=W();return m.jsx(z,{label:n,resetAll:()=>{const t=o(r);e(t)},panelId:t,dropdownMenuProps:l,children:s})}const vo={radius:!0,color:!0,width:!0,shadow:!0};function _o({as:e=xo,value:r,onChange:t,inheritedValue:s=r,settings:n,panelId:l,name:a,defaultControls:i=vo}){var d,c,u,h;const p=$(n),g=f.useCallback(o=>H({settings:n},"",o),[n]),x=o=>{const e=p.flatMap(({colors:o})=>o).find(({color:e})=>e===o);return e?"var:preset|color|"+e.slug:o},v=f.useMemo(()=>{if(I(s?.border)){const o={...s?.border};return["top","right","bottom","left"].forEach(e=>{o[e]={...o[e],color:g(o[e]?.color)}}),o}return{...s?.border,color:s?.border?.color?g(s?.border?.color):void 0}},[s?.border,g]),_=o=>t({...r,border:o}),w=po(n),C=mo(n),y=fo(n),S=bo(n),B=g(v?.radius),k=o=>_({...v,radius:o}),N=()=>{const o=r?.border?.radius;return"object"==typeof o?Object.entries(o).some(Boolean):!!o},L=go(n),R=g(s?.shadow),z=null!==(d=n?.shadow?.presets)&&void 0!==d?d:{},P=null!==(c=null!==(u=null!==(h=z.custom)&&void 0!==h?h:z.theme)&&void 0!==u?u:z.default)&&void 0!==c?c:[],V=e=>{const s=P?.find(({shadow:o})=>o===e)?.slug;t(o(r,["shadow"],s?`var:preset|shadow|${s}`:e||void 0))},O=f.useCallback(o=>({...o,border:void 0,shadow:void 0}),[]),T=i?.color||i?.width,M=w||C||y||S,W=Io({blockName:a,hasShadowControl:L,hasBorderControl:M});return m.jsxs(e,{resetAllFilter:O,value:r,onChange:t,panelId:l,label:W,children:[(y||w)&&m.jsx(U,{hasValue:()=>D(r?.border),label:b("Border"),onDeselect:()=>(()=>{if(N())return _({radius:r?.border?.radius});_(void 0)})(),isShownByDefault:T,panelId:l,children:m.jsx(A,{colors:p,enableAlpha:!0,enableStyle:C,onChange:o=>{const e={...o};I(e)?["top","right","bottom","left"].forEach(o=>{e[o]&&(e[o]={...e[o],color:x(e[o]?.color)})}):e&&(e.color=x(e.color)),_({radius:v?.radius,...e})},popoverOffset:40,popoverPlacement:"left-start",value:v,__experimentalIsRenderedInSidebar:!0,size:"__unstable-large",hideLabelFromVision:!L,label:b("Border")})}),S&&m.jsx(U,{hasValue:N,label:b("Radius"),onDeselect:()=>k(void 0),isShownByDefault:i.radius,panelId:l,children:m.jsx(ro,{values:B,onChange:o=>{k(o||void 0)}})}),L&&m.jsxs(U,{label:b("Shadow"),hasValue:()=>!!r?.shadow,onDeselect:()=>V(void 0),isShownByDefault:i.shadow,panelId:l,children:[M?m.jsx(j.VisualLabel,{as:"legend",children:b("Shadow")}):null,m.jsx(F,{isBordered:!0,isSeparated:!0,children:m.jsx(ao,{shadow:R,onShadowChange:V,settings:n})})]})]})}const wo="__experimentalBorder",jo="shadow",Co=(o,e,r)=>{let t;return o.some(o=>o.colors.some(o=>o[e]===r&&(t=o,!0))),t},yo=({colors:o,namedColor:e,customColor:r})=>{if(e){const r=Co(o,"slug",e);if(r)return r}if(!r)return{color:void 0};const t=Co(o,"color",r);return t||{color:r}};function So(o){const e=/var:preset\|color\|(.+)/.exec(o);return e&&e[1]?e[1]:null}function Bo(o){if(I(o?.border))return{style:o,borderColor:void 0};const e=o?.border?.color,r=e?.startsWith("var:preset|color|")?e.substring(17):void 0,s={...o};return s.border={...s.border,color:r?void 0:e},{style:t(s),borderColor:r}}function ko(o){return I(o.style?.border)?o.style:{...o.style,border:{...o.style?.border,color:o.borderColor?"var:preset|color|"+o.borderColor:o.style?.border?.color}}}function No({label:o,children:e,resetAllFilter:r}){const t=f.useCallback(o=>{const e=ko(o),t=r(e);return{...o,...Bo(t)}},[r]);return m.jsx(c,{group:"border",resetAllFilter:t,label:o,children:e})}function Lo({clientId:o,name:e,setAttributes:r,settings:t}){const s=uo(t);const{style:n,borderColor:a}=d(function(e){const{style:r,borderColor:t}=e(p).getBlockAttributes(o)||{};return{style:r,borderColor:t}},[o]),i=f.useMemo(()=>ko({style:n,borderColor:a}),[n,a]);if(!s)return null;const c={...l(e,[wo,"__experimentalDefaultControls"]),...l(e,[jo,"__experimentalDefaultControls"])};return m.jsx(_o,{as:No,panelId:o,settings:t,value:i,onChange:o=>{r(Bo(o))},defaultControls:c})}function Ro(o,e="any"){const r=l(o,wo);return!0===r||("any"===e?!!(r?.color||r?.radius||r?.width||r?.style):!!r?.[e])}function Io({blockName:o,hasBorderControl:r,hasShadowControl:t}={}){const s=ho(e(o));return r||t||!o||(r=s?.hasBorderColor||s?.hasBorderStyle||s?.hasBorderWidth||s?.hasBorderRadius,t=s?.hasShadow),b(r&&t?"Border & Shadow":t?"Shadow":"Border")}function Uo(o,e,t){if(!Ro(e,"color")||r(e,wo,"color"))return o;const s=Do(t),l=n(o.className,s);return o.className=l||void 0,o}function Do(o){const{borderColor:e,style:r}=o,t=u("border-color",e);return n({"has-border-color":e||r?.border?.color,[t]:!!t})}const Ao={useBlockProps:function({name:o,borderColor:e,style:s}){const{colors:n}=h();if(!Ro(o,"color")||r(o,wo,"color"))return{};const{color:l}=yo({colors:n,namedColor:e}),{color:a}=yo({colors:n,namedColor:So(s?.border?.top?.color)}),{color:i}=yo({colors:n,namedColor:So(s?.border?.right?.color)}),{color:d}=yo({colors:n,namedColor:So(s?.border?.bottom?.color)}),{color:c}=yo({colors:n,namedColor:So(s?.border?.left?.color)});return Uo({style:t({borderTopColor:a||l,borderRightColor:i||l,borderBottomColor:d||l,borderLeftColor:c||l})||{}},o,{borderColor:e,style:s})},addSaveProps:Uo,attributeKeys:["borderColor","style"],hasSupport:o=>Ro(o,"color")};function Fo(o){const e=o.style?.border||{};return{className:Do(o)||void 0,style:s({border:e})}}function zo(o){const{colors:e}=h(),r=Fo(o),{borderColor:t}=o;if(t){const o=yo({colors:e,namedColor:t});r.style.borderColor=o.color}return r}function Po(o){const e=o.style?.shadow||"";return{style:s({shadow:e})}}a("blocks.registerBlockType","core/border/addAttributes",function(o){return Ro(o,"color")?o.attributes.borderColor?o:{...o,attributes:{...o.attributes,borderColor:{type:"string"}}}:o});export{_o as B,jo as S,ho as a,Io as b,zo as c,Po as d,ro as e,wo as f,Fo as g,Lo as h,Ao as i,uo as u};
