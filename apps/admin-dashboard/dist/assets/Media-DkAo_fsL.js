import{u as e,r as s,j as t,aI as r,aD as i,V as o,c0 as a,c1 as l}from"./vendor-react-DqgGMt48.js";import{M as p}from"./MediaLibrary-nyc6jqxF.js";import{B as d,b as c}from"./page-template-editor-Dej8aqbo.js";import"./vendor-monaco-BxJH8uUv.js";import"./wp-misc-CVe7ECV4.js";import"./vendor-ui-CrFdsnXa.js";import"./vendor-query-D_c3FRkE.js";import"./vendor-utils-C9jLuAcl.js";import"./wp-data-D64LRRbU.js";import"./wp-block-editor-misc-De1L5-zR.js";import"./wp-core-kvRrOm9B.js";import"./wp-block-editor-api-BKhomcj9.js";import"./wp-blocks-core-NinAvWTg.js";import"./wp-block-editor-store-BZ6fZn58.js";import"./wp-block-editor-clipboard-DrG0xX4B.js";import"./wp-i18n-D6_Il8Rt.js";import"./wp-block-editor-global-styles-DiR2HQC4.js";import"./wp-block-editor-typography-W96exnXk.js";import"./wp-components-BJYLMD7r.js";import"./wp-block-editor-spacing-CpdaiY4Q.js";import"./wp-block-editor-menus-IWaA-N3x.js";import"./wp-block-editor-core-BSca1VBH.js";import"./wp-block-editor-utils-Bqn4TiQr.js";import"./wp-block-editor-a11y-YlMsb8JF.js";import"./wp-block-editor-preview-CaF7fUZD.js";import"./wp-block-editor-borders-BtjnCtLF.js";import"./wp-block-editor-formats-B4-8T-Nh.js";import"./wp-block-editor-selection-DYIw7ude.js";import"./wp-block-editor-inline-DHEsfgnI.js";import"./wp-block-editor-ui-l6-7VhtF.js";import"./wp-block-editor-transforms-Bm69JWBw.js";import"./wp-block-editor-patterns-CNk0M6ZZ.js";import"./wp-block-editor-navigation-iME_YXGb.js";import"./wp-block-editor-dnd-DduwJSaE.js";import"./wp-block-editor-media-CVSKmHRK.js";import"./wp-api-Dp_oFsVM.js";import"./wp-block-editor-keyboard-C8o4qxcy.js";import"./wp-block-editor-templates-A6LfENHh.js";import"./checkbox-SgEH-Fe7.js";const n=()=>{const a=e(),[l,p]=s.useState([]),[n,m]=s.useState(!1),[j,u]=s.useState(!1),x=s.useCallback(e=>{e.preventDefault(),e.stopPropagation(),u(!1);const s=e.dataTransfer.files;s&&s.length>0&&h(s)},[]),b=s.useCallback(e=>{e.preventDefault(),e.stopPropagation(),u(!0)},[]),g=s.useCallback(e=>{e.preventDefault(),e.stopPropagation(),u(!1)},[]),h=e=>{const s=Array.from(e).map(e=>({file:e,id:`${Date.now()}-${Math.random()}`,status:"pending",progress:0,preview:e.type.startsWith("image/")?URL.createObjectURL(e):void 0}));p(e=>[...e,...s])},w=async e=>{try{p(s=>s.map(s=>s.id===e.id?{...s,status:"uploading",progress:10}:s));const s=new FormData;s.append("file",e.file),s.append("title",e.file.name.replace(/\.[^/.]+$/,""));const t=setInterval(()=>{p(s=>s.map(s=>s.id===e.id&&"uploading"===s.status?{...s,progress:Math.min(s.progress+10,90)}:s))},200),r=await c.api.post("/media/upload",s,{headers:{"Content-Type":"multipart/form-data"}});return clearInterval(t),p(s=>s.map(s=>s.id===e.id?{...s,status:"success",progress:100}:s)),r.data}catch(s){throw p(s=>s.map(s=>s.id===e.id?{...s,status:"error",error:"업로드 실패"}:s)),s}},v=()=>{const e=document.createElement("input");e.type="file",e.multiple=!0,e.accept="image/*,video/*,audio/*,application/pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx",e.onchange=e=>{const s=e.target.files;s&&h(s)},e.click()};return t.jsx("div",{className:"wp-admin-content",children:t.jsxs("div",{className:"wrap",children:[t.jsx("h1",{className:"wp-heading-inline",children:"새 미디어 추가"}),t.jsx("div",{className:"mt-6",children:0===l.length?t.jsxs("div",{className:"border-4 border-dashed rounded-lg p-12 text-center transition-colors "+(j?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"),onDrop:x,onDragOver:b,onDragLeave:g,onClick:v,style:{cursor:"pointer"},children:[t.jsx(r,{className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),t.jsx("h3",{className:"text-xl font-medium text-gray-700 mb-2",children:"파일을 여기에 드래그하거나 클릭하여 선택하세요"}),t.jsx("p",{className:"text-sm text-gray-500",children:"최대 업로드 파일 크기: 100MB"}),t.jsx(d,{variant:"outline",className:"mt-4",onClick:e=>{e.stopPropagation(),v()},children:"파일 선택"})]}):t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsxs("h3",{className:"text-lg font-medium",children:[l.length,"개 파일 선택됨"]}),t.jsxs("div",{className:"space-x-2",children:[t.jsx(d,{variant:"outline",onClick:v,children:"파일 추가"}),t.jsx(d,{onClick:async()=>{m(!0);const e=l.filter(e=>"pending"===e.status);let s=0,t=0;for(const i of e)try{await w(i),s++}catch(r){t++}m(!1),s>0&&(o.success(`${s}개 파일이 업로드되었습니다`),0===t&&setTimeout(()=>{a("/media/library")},1500)),t>0&&o.error(`${t}개 파일 업로드에 실패했습니다`)},disabled:n||l.every(e=>"pending"!==e.status),children:"업로드 시작"})]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(e=>t.jsxs("div",{className:"border rounded-lg p-4 "+("error"===e.status?"border-red-300 bg-red-50":"border-gray-200"),children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"font-medium text-sm truncate",children:e.file.name}),t.jsxs("p",{className:"text-xs text-gray-500",children:[(e.file.size/1024/1024).toFixed(2)," MB"]})]}),"pending"===e.status&&t.jsx("button",{onClick:()=>{return s=e.id,void p(e=>{const t=e.filter(e=>e.id!==s),r=e.find(e=>e.id===s);return r?.preview&&URL.revokeObjectURL(r.preview),t});var s},className:"ml-2 text-gray-400 hover:text-gray-600",children:t.jsx(i,{className:"w-4 h-4"})})]}),e.preview&&t.jsx("img",{src:e.preview,alt:"",className:"w-full h-32 object-cover rounded mb-2"}),"uploading"===e.status&&t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all",style:{width:`${e.progress}%`}})}),"success"===e.status&&t.jsx("div",{className:"text-green-600 text-sm",children:"✓ 업로드 완료"}),"error"===e.status&&t.jsx("div",{className:"text-red-600 text-sm",children:e.error||"업로드 실패"})]},e.id))})]})})]})})},m=()=>t.jsxs(a,{children:[t.jsx(l,{path:"/",element:t.jsx(p,{})}),t.jsx(l,{path:"/library",element:t.jsx(p,{})}),t.jsx(l,{path:"/new",element:t.jsx(n,{})})]});export{m as default};
