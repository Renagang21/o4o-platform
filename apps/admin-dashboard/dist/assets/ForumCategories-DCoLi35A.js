import{r as e,V as s,j as t,P as a,cf as r,N as i,D as n}from"./vendor-react-Bb0TGSr4.js";import{u as c,a as d,b as l}from"./vendor-query-BEO_OofR.js";import{j as o,B as x,w as m,x as p,y as u,z as h,E as j,L as g,I as y,T as v,F as f}from"./page-gutenberg-CGPrHM9_.js";import{S as N}from"./page-template-editor-jCKIl0_P.js";import"./vendor-monaco-BxJH8uUv.js";import"./vendor-ui-CrFdsnXa.js";import"./vendor-utils-B-KQWpLj.js";import"./wp-foundation-Ht0JG6Uo.js";import"./wp-components-CoD93iDH.js";const w=()=>{const w=c(),[b,C]=e.useState(!1),[k,S]=e.useState(null),[F,q]=e.useState({name:"",slug:"",description:"",active:!0}),{data:z=[],isLoading:K}=d({queryKey:["forum-categories"],queryFn:async()=>(await o.api.get("/v1/forum/categories")).data.data}),$=l({mutationFn:async e=>(await o.api.post("/v1/forum/categories",e)).data,onSuccess:()=>{s.success("카테고리가 생성되었습니다"),w.invalidateQueries({queryKey:["forum-categories"]}),D()}}),L=l({mutationFn:async({id:e,data:s})=>(await o.api.put(`/v1/forum/categories/${e}`,s)).data,onSuccess:()=>{s.success("카테고리가 수정되었습니다"),w.invalidateQueries({queryKey:["forum-categories"]}),D()}}),P=l({mutationFn:async e=>(await o.api.delete(`/v1/forum/categories/${e}`)).data,onSuccess:()=>{s.success("카테고리가 삭제되었습니다"),w.invalidateQueries({queryKey:["forum-categories"]})}}),Q=e=>{e?(S(e),q({name:e.name,slug:e.slug,description:e.description,active:e.active})):(S(null),q({name:"",slug:"",description:"",active:!0})),C(!0)},D=()=>{C(!1),S(null),q({name:"",slug:"",description:"",active:!0})};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold text-modern-text-primary",children:"포럼 카테고리"}),t.jsx("p",{className:"text-modern-text-secondary mt-1",children:"포럼 카테고리를 관리하세요."})]}),t.jsxs(x,{onClick:()=>Q(),children:[t.jsx(a,{className:"w-4 h-4 mr-2"}),"새 카테고리"]})]}),t.jsx("div",{className:"wp-card",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-modern-bg-tertiary border-b border-modern-border-primary",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"순서"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"이름"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"설명"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"게시글 수"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"상태"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"작업"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-modern-border-primary",children:K?t.jsx("tr",{children:t.jsx("td",{colSpan:6,className:"px-6 py-12 text-center",children:t.jsx("div",{className:"flex justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-modern-primary"})})})}):0===z.length?t.jsx("tr",{children:t.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-modern-text-secondary",children:"카테고리가 없습니다."})}):z.map(e=>t.jsxs("tr",{className:"hover:bg-modern-bg-hover",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx(r,{className:"w-5 h-5 text-modern-text-tertiary cursor-move"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-modern-text-primary",children:e.name}),t.jsxs("p",{className:"text-xs text-modern-text-secondary",children:["/",e.slug]})]})}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("p",{className:"text-sm text-modern-text-secondary truncate max-w-xs",children:e.description||"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-modern-text-primary",children:e.postCount}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full "+(e.active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.active?"활성":"비활성"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(x,{variant:"ghost",size:"sm",onClick:()=>Q(e),children:t.jsx(i,{className:"w-4 h-4"})}),t.jsx(x,{variant:"ghost",size:"sm",onClick:()=>(e=>{e.postCount>0?s.error("게시글이 있는 카테고리는 삭제할 수 없습니다"):confirm(`"${e.name}" 카테고리를 삭제하시겠습니까?`)&&P.mutate(e.id)})(e),disabled:e.postCount>0,children:t.jsx(n,{className:"w-4 h-4 text-destructive"})})]})})]},e.id))})]})})}),t.jsx(m,{open:b,onOpenChange:C,children:t.jsx(p,{children:t.jsxs("form",{onSubmit:e=>{e.preventDefault(),F.name.trim()?k?L.mutate({id:k.id,data:F}):$.mutate(F):s.error("카테고리 이름을 입력하세요")},children:[t.jsxs(u,{children:[t.jsx(h,{children:k?"카테고리 수정":"새 카테고리"}),t.jsx(j,{children:"포럼 카테고리 정보를 입력하세요."})]}),t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsxs("div",{children:[t.jsx(g,{htmlFor:"name",children:"이름 *"}),t.jsx(y,{id:"name",value:F.name,onChange:e=>{q(s=>{return{...s,name:e.target.value,slug:k?s.slug:(t=e.target.value,t.toLowerCase().replace(/[^a-z0-9가-힣]+/g,"-").replace(/^-+|-+$/g,""))};var t})},placeholder:"예: 일반 토론",required:!0})]}),t.jsxs("div",{children:[t.jsx(g,{htmlFor:"slug",children:"Slug"}),t.jsx(y,{id:"slug",value:F.slug,onChange:e=>q(s=>({...s,slug:e.target.value})),placeholder:"예: general-discussion"})]}),t.jsxs("div",{children:[t.jsx(g,{htmlFor:"description",children:"설명"}),t.jsx(v,{id:"description",value:F.description,onChange:e=>q(s=>({...s,description:e.target.value})),placeholder:"카테고리에 대한 설명을 입력하세요...",rows:3})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx(g,{htmlFor:"active",children:"활성화"}),t.jsx("p",{className:"text-sm text-modern-text-secondary",children:"비활성화 시 게시글 작성이 불가능합니다"})]}),t.jsx(N,{id:"active",checked:F.active,onCheckedChange:e=>q(s=>({...s,active:e}))})]})]}),t.jsxs(f,{children:[t.jsx(x,{type:"button",variant:"outline",onClick:D,children:"취소"}),t.jsx(x,{type:"submit",disabled:$.isPending||L.isPending,children:k?"수정":"생성"})]})]})})})]})};export{w as default};
