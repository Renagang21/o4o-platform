import{a4 as B,a3 as L,V as p,j as e,cD as b,a5 as F,N as E,dj as R,c2 as U,w as z,$ as C,_ as V,bC as _,bA as H,bM as I}from"./vendor-react-CFXBKh8N.js";import{u as X,a as P,b as D}from"./vendor-query-D0j4d4-i.js";import{j as u,B as n,C as c,k as N,l as f,m as d,s as G}from"./page-gutenberg-CihbTQe_.js";import{S as J}from"./separator-CrG8Z3SZ.js";import"./wp-block-editor-DhaEFHLK.js";import"./wp-i18n-DXAO7rTz.js";import"./wp-core-CKjiTxtQ.js";import"./wp-blocks-core-CqiW7X_r.js";import"./wp-misc-BCLjNiWG.js";import"./wp-data-DkVHr7c4.js";import"./wp-components-BOsGWWgw.js";import"./vendor-ui-BkLtITBR.js";import"./vendor-monaco-cpVGocfO.js";import"./vendor-utils-DQ8F5vJI.js";const oe=()=>{const{id:a}=B(),l=L(),o=X(),{data:k,isLoading:q}=P({queryKey:["crowdfunding-project",a],queryFn:async()=>(await u.api.get(`/v1/crowdfunding-simple/projects/${a}`)).data,enabled:!!a}),s=k?.data,{data:M}=P({queryKey:["crowdfunding-participation",a],queryFn:async()=>(await u.api.get(`/v1/crowdfunding-simple/projects/${a}/participation-status`)).data,enabled:!!a}),$=M?.data,j=D({mutationFn:async()=>(await u.api.post(`/v1/crowdfunding-simple/projects/${a}/join`)).data,onSuccess:()=>{p.success("프로젝트에 참여했습니다!"),o.invalidateQueries({queryKey:["crowdfunding-project",a]}),o.invalidateQueries({queryKey:["crowdfunding-participation",a]})},onError:t=>{p.error(t.response?.data?.error||"참여에 실패했습니다.")}}),h=D({mutationFn:async()=>(await u.api.post(`/v1/crowdfunding-simple/projects/${a}/cancel`)).data,onSuccess:()=>{p.success("참여를 취소했습니다."),o.invalidateQueries({queryKey:["crowdfunding-project",a]}),o.invalidateQueries({queryKey:["crowdfunding-participation",a]})},onError:t=>{p.error(t.response?.data?.error||"취소에 실패했습니다.")}});if(q)return e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-modern-primary"})});if(!s)return e.jsxs("div",{className:"text-center py-12",children:[e.jsx(b,{className:"w-16 h-16 text-modern-text-tertiary mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-modern-text-primary mb-2",children:"프로젝트를 찾을 수 없습니다"}),e.jsx("p",{className:"text-modern-text-secondary mb-4",children:"요청하신 프로젝트가 존재하지 않거나 삭제되었습니다."}),e.jsx(n,{onClick:()=>l("/crowdfunding/projects"),children:"프로젝트 목록으로"})]});const S=t=>{const r={recruiting:{label:"모집중",variant:"default",icon:I},in_progress:{label:"진행중",variant:"secondary",icon:H},completed:{label:"완료",variant:"outline",icon:C},cancelled:{label:"중단",variant:"destructive",icon:b}},i=r[t]||r.recruiting,g=i.icon;return e.jsxs(G,{variant:i.variant,className:"flex items-center gap-1",children:[e.jsx(g,{className:"w-3 h-3"}),i.label]})},A=(t,r)=>r>0?Math.min(t/r*100,100):0,K=t=>{const r=new Date(t),i=new Date,g=r.getTime()-i.getTime(),T=Math.ceil(g/(1e3*60*60*24));return Math.max(0,T)},m=t=>new Date(t).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"}),x=A(s.currentParticipantCount,s.targetParticipantCount),y=K(s.endDate),v=s.status==="recruiting"&&y>0,w=$?.status==="joined",Q=v&&!w;return e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(n,{variant:"ghost",size:"sm",onClick:()=>l("/crowdfunding/projects"),children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"프로젝트 목록"]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>l(`/crowdfunding/projects/${a}/edit`),children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"수정"]})})]}),e.jsxs(c,{children:[e.jsx(N,{className:"pb-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(f,{className:"text-2xl",children:s.title}),S(s.status)]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-modern-text-secondary",children:[e.jsxs("span",{children:["개발사: ",s.creatorName]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["등록일: ",m(s.createdAt)]})]})]})})}),e.jsx(d,{children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"프로젝트 설명"}),e.jsx("div",{className:"prose prose-sm max-w-none text-modern-text-secondary whitespace-pre-wrap",children:s.description})]}),s.participants&&s.participants.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3",children:["참여 매장 (",s.participants.length,"개)"]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:s.participants.map(t=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-modern-bg-tertiary rounded-lg",children:[e.jsx("div",{className:"w-10 h-10 bg-modern-primary text-white rounded-full flex items-center justify-center text-sm font-medium",children:t.vendorName?.charAt(0)||"U"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-modern-text-primary",children:t.vendorName}),e.jsxs("p",{className:"text-xs text-modern-text-secondary",children:[m(t.joinedAt)," 참여"]})]})]},t.id))})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(c,{children:[e.jsx(N,{className:"pb-3",children:e.jsxs(f,{className:"text-lg flex items-center gap-2",children:[e.jsx(R,{className:"w-5 h-5 text-modern-primary"}),"진행 현황"]})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-modern-text-secondary",children:"참여 진행률"}),e.jsxs("span",{className:"font-medium text-modern-text-primary",children:[Math.round(x),"%"]})]}),e.jsx("div",{className:"w-full bg-modern-bg-tertiary rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full transition-all duration-300 ${x>=100?"bg-modern-success":x>=50?"bg-modern-primary":"bg-modern-warning"}`,style:{width:`${x}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-modern-text-primary",children:s.currentParticipantCount}),e.jsx("p",{className:"text-xs text-modern-text-secondary",children:"현재 참여"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-modern-text-primary",children:s.targetParticipantCount}),e.jsx("p",{className:"text-xs text-modern-text-secondary",children:"목표 참여"})]})]}),e.jsx(J,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4 text-modern-text-tertiary"}),e.jsx("span",{className:"text-modern-text-secondary",children:"남은 기간"})]}),e.jsx("span",{className:"font-medium text-modern-text-primary",children:v?`${y}일`:"종료됨"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4 text-modern-text-tertiary"}),e.jsx("span",{className:"text-modern-text-secondary",children:"참여 매장"})]}),e.jsxs("span",{className:"font-medium text-modern-text-primary",children:[s.currentParticipantCount,"개"]})]})]})]})]}),e.jsx(c,{children:e.jsx(d,{className:"p-4",children:w?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-modern-success",children:[e.jsx(C,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"참여 중"})]}),e.jsx(n,{variant:"outline",className:"w-full",onClick:()=>h.mutate(),disabled:h.isPending,children:h.isPending?"처리 중...":"참여 취소"})]}):Q?e.jsx(n,{className:"w-full",onClick:()=>j.mutate(),disabled:j.isPending,children:j.isPending?"처리 중...":"프로젝트 참여하기"}):e.jsx("div",{className:"text-center space-y-2",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-modern-text-secondary",children:[e.jsx(V,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm",children:s.status==="completed"?"완료된 프로젝트입니다":s.status==="cancelled"?"중단된 프로젝트입니다":"참여 기간이 종료되었습니다"})]})})})}),s.forumLink&&e.jsx(c,{children:e.jsx(d,{className:"p-4",children:e.jsxs(n,{variant:"outline",className:"w-full",onClick:()=>l(s.forumLink),children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"포럼에서 토론하기"]})})}),e.jsxs(c,{children:[e.jsx(N,{className:"pb-3",children:e.jsx(f,{className:"text-lg",children:"프로젝트 기간"})}),e.jsxs(d,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-modern-text-secondary",children:"시작일"}),e.jsx("span",{className:"text-modern-text-primary",children:m(s.startDate)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-modern-text-secondary",children:"종료일"}),e.jsx("span",{className:"text-modern-text-primary",children:m(s.endDate)})]})]})]})]})]})})]})]})};export{oe as default};
