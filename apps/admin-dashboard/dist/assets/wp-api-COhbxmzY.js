import"./wp-block-editor-misc-Bvzg-2Jv.js";import{_ as e}from"./wp-i18n-BuBz6Sgx.js";import{n as t,g as r,a as o,h as s,b as n,r as i}from"./wp-misc-DyLrwF9p.js";import"./vendor-react-DqgGMt48.js";import"./vendor-monaco-BxJH8uUv.js";import"./wp-core-BVMytgUH.js";import"./wp-block-editor-api-MRWBPx9C.js";import"./wp-blocks-core-65VcejHr.js";import"./wp-block-editor-store-BOagVFfu.js";import"./wp-block-editor-clipboard-D5sqncpm.js";import"./wp-block-editor-utils-BmaAXcuk.js";import"./vendor-ui-CrFdsnXa.js";import"./wp-block-editor-colors-60WWD1Za.js";import"./wp-components-Uj2D7Nfy.js";import"./wp-block-editor-spacing-CY2h70rf.js";import"./wp-block-editor-menus-CucXu4UM.js";import"./wp-block-editor-core-BF86nm2P.js";import"./wp-block-editor-selection-DBFjOmhH.js";import"./wp-block-editor-inline-CtEBI-J7.js";import"./wp-block-editor-formats--rvRJrSX.js";import"./wp-block-editor-ui-DwG3jajt.js";import"./wp-block-editor-transforms-Bg08EtRt.js";import"./wp-block-editor-preview-WXXja22U.js";import"./wp-block-editor-a11y-BVzCbFSD.js";import"./wp-block-editor-global-styles-DFEUywv4.js";import"./wp-block-editor-typography-D5fCIzVQ.js";import"./wp-block-editor-borders-C-QIiBvP.js";import"./wp-block-editor-patterns-DIcm1rGW.js";import"./wp-block-editor-navigation-ufXSM7dn.js";import"./wp-block-editor-dnd-yPphmZPp.js";import"./wp-block-editor-media-CatADaW3.js";import"./wp-api-COhbxmzY.js";import"./vendor-utils-C9jLuAcl.js";import"./wp-block-editor-keyboard-3DDntAoE.js";import"./wp-block-editor-templates-C6YLNdWR.js";import"./vendor-query-D_c3FRkE.js";import"./page-template-editor-5uesjTWI.js";import"./wp-data-CL-okzN5.js";const a=(e,t)=>{let r,o,s=e.path;return"string"==typeof e.namespace&&"string"==typeof e.endpoint&&(r=e.namespace.replace(/^\/|\/$/g,""),o=e.endpoint.replace(/^\//,""),s=o?r+"/"+o:r),delete e.namespace,delete e.endpoint,t({...e,path:s})};function p(e,t){if(t)return Promise.resolve(e.body);try{return Promise.resolve(new window.Response(JSON.stringify(e.body),{status:200,statusText:"OK",headers:e.headers}))}catch{return Object.entries(e.headers).forEach(([t,r])=>{"link"===t.toLowerCase()&&(e.headers[t]=r.replace(/<([^>]+)>/,(e,t)=>`<${encodeURI(t)}>`))}),Promise.resolve(t?e.body:new window.Response(JSON.stringify(e.body),{status:200,statusText:"OK",headers:e.headers}))}}const c=({path:e,url:t,...r},s)=>({...r,url:t&&o(t,s),path:e&&o(e,s)}),d=e=>e.json?e.json():Promise.reject(e),l=e=>{const{next:t}=(e=>{if(!e)return{};const t=e.match(/<([^>]+)>; rel="next"/);return t?{next:t[1]}:{}})(e.headers.get("link"));return t},u=async(e,t)=>{if(!1===e.parse)return t(e);if(!(e=>{const t=!!e.path&&-1!==e.path.indexOf("per_page=-1"),r=!!e.url&&-1!==e.url.indexOf("per_page=-1");return t||r})(e))return t(e);const r=await v({...c(e,{per_page:100}),parse:!1}),o=await d(r);if(!Array.isArray(o))return o;let s=l(r);if(!s)return o;let n=[].concat(o);for(;s;){const t=await v({...e,path:void 0,url:s,parse:!1}),r=await d(t);n=n.concat(r),s=l(t)}return n},m=new Set(["PATCH","PUT","DELETE"]),h="GET",w=(e,t=!0)=>Promise.resolve(((e,t=!0)=>t?204===e.status?null:e.json?e.json():Promise.reject(e):e)(e,t)).catch(e=>f(e,t));function f(t,r=!0){if(!r)throw t;return(t=>{const r={code:"invalid_json",message:e("The response is not a valid JSON response.")};if(!t||!t.json)throw r;return t.json().catch(()=>{throw r})})(t).then(t=>{const r={code:"unknown_error",message:e("An unknown error occurred.")};throw t||r})}const j={Accept:"application/json, */*;q=0.1"},b={credentials:"include"},g=[(e,t)=>("string"!=typeof e.url||s(e.url,"_locale")||(e.url=o(e.url,{_locale:"user"})),"string"!=typeof e.path||s(e.path,"_locale")||(e.path=o(e.path,{_locale:"user"})),t(e)),a,(e,t)=>{const{method:r=h}=e;return m.has(r.toUpperCase())&&(e={...e,headers:{...e.headers,"X-HTTP-Method-Override":r,"Content-Type":"application/json"},method:"POST"}),t(e)},u];const y=e=>{if(e.status>=200&&e.status<300)return e;throw e};let k=t=>{const{url:r,path:o,data:s,parse:n=!0,...i}=t;let{body:a,headers:p}=t;p={...j,...p},s&&(a=JSON.stringify(s),p["Content-Type"]="application/json");return window.fetch(r||o||window.location.href,{...b,...i,body:a,headers:p}).then(e=>Promise.resolve(e).then(y).catch(e=>f(e,n)).then(e=>w(e,n)),t=>{if(t&&"AbortError"===t.name)throw t;throw{code:"fetch_error",message:e("You are probably offline.")}})};function v(e){return g.reduceRight((e,t)=>r=>t(r,e),k)(e).catch(t=>"rest_cookie_invalid_nonce"!==t.code?Promise.reject(t):window.fetch(v.nonceEndpoint).then(y).then(e=>e.text()).then(t=>(v.nonceMiddleware.nonce=t,v(e))))}v.use=function(e){g.unshift(e)},v.setFetchHandler=function(e){k=e},v.createNonceMiddleware=function(e){const t=(e,r)=>{const{headers:o={}}=e;for(const s in o)if("x-wp-nonce"===s.toLowerCase()&&o[s]===t.nonce)return r(e);return r({...e,headers:{...o,"X-WP-Nonce":t.nonce}})};return t.nonce=e,t},v.createPreloadingMiddleware=function(e){const s=Object.fromEntries(Object.entries(e).map(([e,r])=>[t(e),r]));return(e,n)=>{const{parse:i=!0}=e;let a=e.path;if(!a&&e.url){const{rest_route:t,...s}=r(e.url);"string"==typeof t&&(a=o(t,s))}if("string"!=typeof a)return n(e);const c=e.method||"GET",d=t(a);if("GET"===c&&s[d]){const e=s[d];return delete s[d],p(e,!!i)}if("OPTIONS"===c&&s[c]&&s[c][d]){const e=s[c][d];return delete s[c][d],p(e,!!i)}return n(e)}},v.createRootURLMiddleware=e=>(t,r)=>a(t,t=>{let o,s=t.url,n=t.path;return"string"==typeof n&&(o=e,-1!==e.indexOf("?")&&(n=n.replace("?","&")),n=n.replace(/^\//,""),"string"==typeof o&&-1!==o.indexOf("?")&&(n=n.replace("?","&")),s=o+n),r({...t,url:s})}),v.fetchAllMiddleware=u,v.mediaUploadMiddleware=(t,r)=>{if(!function(e){const t=!!e.method&&"POST"===e.method;return(!!e.path&&-1!==e.path.indexOf("/wp/v2/media")||!!e.url&&-1!==e.url.indexOf("/wp/v2/media"))&&t}(t))return r(t);let o=0;const s=e=>(o++,r({path:`/wp/v2/media/${e}/post-process`,method:"POST",data:{action:"create-image-subsizes"},parse:!1}).catch(()=>o<5?s(e):(r({path:`/wp/v2/media/${e}?force=true`,method:"DELETE"}),Promise.reject())));return r({...t,parse:!1}).catch(r=>{if(!r.headers)return Promise.reject(r);const o=r.headers.get("x-wp-upload-attachment-id");return r.status>=500&&r.status<600&&o?s(o).catch(()=>!1!==t.parse?Promise.reject({code:"post_process",message:e("Media upload failed. If this is a photo or a large image, please scale it down and try again.")}):Promise.reject(r)):f(r,t.parse)}).then(e=>w(e,t.parse))},v.createThemePreviewMiddleware=e=>(t,r)=>{if("string"==typeof t.url){const r=n(t.url,"wp_theme_preview");void 0===r?t.url=o(t.url,{wp_theme_preview:e}):""===r&&(t.url=i(t.url,"wp_theme_preview"))}if("string"==typeof t.path){const r=n(t.path,"wp_theme_preview");void 0===r?t.path=o(t.path,{wp_theme_preview:e}):""===r&&(t.path=i(t.path,"wp_theme_preview"))}return r(t)};export{v as default};
