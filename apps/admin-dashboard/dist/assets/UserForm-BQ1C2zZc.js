import{b as B,u as E,r as b,cf as P,z as p,j as e,A as I,c as L}from"./vendor-react-P__8vGRG.js";import{t as V,o as D,e as z,a as q,s as d,l as H}from"./vendor-forms-D2S8MGYp.js";import{B as v,L as c,I as x,S as J,d as M,e as _,f as G,g as h}from"./page-template-editor-BTdVTS-a.js";import{C as K}from"./checkbox-CqkjQ2aW.js";import{C as y,a as C,b as w,c as S,d as U}from"./index-C0gS3Jf3.js";import{B as O}from"./BusinessInfoSection-ulcw75wH.js";import{U as f}from"./userApi-m_Dm3U7g.js";import"./vendor-ui-BkLtITBR.js";import"./vendor-query-CucHvDcH.js";import"./vendor-utils-dq2XMRwt.js";import"./vendor-socket-DgcwqWsT.js";import"./unified-client-DYKT-pLO.js";const Q=D({email:d().email("Invalid email address"),password:d().min(6,"Password must be at least 6 characters").optional().or(H("")),firstName:d().optional(),lastName:d().optional(),roles:q(d()).min(1,"At least one role is required"),status:z(["active","pending","approved","rejected"])});function de(){const{id:i}=B(),o=E(),[j,n]=b.useState(!1),t=!!i,{register:m,handleSubmit:k,setValue:l,watch:g,formState:{errors:r}}=P({resolver:V(Q),defaultValues:{email:"",password:"",firstName:"",lastName:"",roles:["customer"],status:"pending"}}),u=g("roles");b.useEffect(()=>{t&&F()},[i]);const F=async()=>{try{n(!0);const s=await f.getUser(i);if(s.data.success){const a=s.data.data;l("email",a.email),l("firstName",a.firstName||""),l("lastName",a.lastName||""),l("roles",a.roles),l("status",a.status)}}catch{p.error("Failed to load user"),o("/users")}finally{n(!1)}},A=async s=>{try{n(!0);const a={...s,role:s.roles[0]};t?(a.password||delete a.password,await f.updateUser(i,a),p.success("User updated successfully")):(await f.createUser(a),p.success("User created successfully")),o("/users")}catch(a){p.error(a.response?.data?.error||"Failed to save user")}finally{n(!1)}},N=s=>{const a=u||[];a.includes(s)?a.length>1&&l("roles",a.filter(T=>T!==s)):l("roles",[...a,s])},R=[{value:"super_admin",label:"Super Admin",description:"Full system access"},{value:"admin",label:"Admin",description:"Administrative access"},{value:"vendor",label:"Vendor",description:"Vendor/supplier access"},{value:"seller",label:"Seller",description:"Can sell products"},{value:"customer",label:"Customer",description:"Regular user"},{value:"business",label:"Business",description:"Business account"},{value:"moderator",label:"Moderator",description:"Content moderation"},{value:"partner",label:"Partner",description:"Partner access"}];return e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(v,{variant:"ghost",onClick:()=>o("/users"),children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),"Back to Users"]})}),e.jsx("form",{onSubmit:k(A),children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(y,{children:[e.jsxs(C,{children:[e.jsx(w,{children:t?"Edit User":"Add New User"}),e.jsx(S,{children:t?"Update user information":"Create a new user account"})]}),e.jsxs(U,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"firstName",children:"First Name"}),e.jsx(x,{id:"firstName",...m("firstName"),placeholder:"John"}),r.firstName&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.firstName.message})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"lastName",children:"Last Name"}),e.jsx(x,{id:"lastName",...m("lastName"),placeholder:"Doe"}),r.lastName&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.lastName.message})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"email",children:"Email"}),e.jsx(x,{id:"email",type:"email",...m("email"),placeholder:"john.doe@example.com",disabled:t}),r.email&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.email.message})]}),e.jsxs("div",{children:[e.jsxs(c,{htmlFor:"password",children:["Password ",t&&"(leave blank to keep current)"]}),e.jsx(x,{id:"password",type:"password",...m("password"),placeholder:t?"Leave blank to keep current":"Enter password"}),r.password&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.password.message})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"status",children:"Status"}),e.jsxs(J,{value:g("status"),onValueChange:s=>l("status",s),children:[e.jsx(M,{children:e.jsx(_,{placeholder:"Select status"})}),e.jsxs(G,{children:[e.jsx(h,{value:"active",children:"Active"}),e.jsx(h,{value:"pending",children:"Pending"}),e.jsx(h,{value:"approved",children:"Approved"}),e.jsx(h,{value:"rejected",children:"Rejected"})]})]}),r.status&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.status.message})]})]})]})}),e.jsxs("div",{children:[e.jsxs(y,{children:[e.jsxs(C,{children:[e.jsx(w,{children:"User Roles"}),e.jsx(S,{children:"Select one or more roles for this user"})]}),e.jsxs(U,{children:[e.jsx("div",{className:"space-y-3",children:R.map(s=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>N(s.value),children:[e.jsx(K,{checked:u?.includes(s.value)||!1,onCheckedChange:()=>N(s.value),onClick:a=>a.stopPropagation()}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:s.label}),e.jsx("div",{className:"text-sm text-gray-600",children:s.description})]})]},s.value))}),r.roles&&e.jsx("p",{className:"text-sm text-red-500 mt-2",children:r.roles.message})]})]}),e.jsxs("div",{className:"mt-6 flex gap-3",children:[e.jsxs(v,{type:"submit",className:"flex-1",disabled:j,children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),j?"Saving...":t?"Update User":"Create User"]}),e.jsx(v,{type:"button",variant:"outline",onClick:()=>o("/users"),disabled:j,children:"Cancel"})]})]}),t&&u?.some(s=>["business","vendor","seller"].includes(s))&&e.jsx(O,{userId:i,userRole:u[0]})]})})]})}export{de as default};
//# sourceMappingURL=UserForm-BQ1C2zZc.js.map
