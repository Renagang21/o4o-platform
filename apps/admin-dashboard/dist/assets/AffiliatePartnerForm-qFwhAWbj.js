import{a3 as Q,a4 as V,r as F,V as m,j as e,a5 as K,a1 as L}from"./vendor-react-CPLvoCm3.js";import{j as p,B as x,C as j,k as v,l as b,t as y,m as f,L as n,I as i,S as w,f as k,g as E,h as M,i as l,T as P}from"./page-gutenberg-DLeK6fOm.js";import{u as T,a as I,b as S}from"./vendor-query-BtistrhA.js";import"./wp-block-editor-Dl58kgFV.js";import"./wp-i18n-CvFqmxct.js";import"./wp-core-DsNNoVDq.js";import"./wp-blocks-core-Bps80Ozc.js";import"./wp-misc-BM-YUiZN.js";import"./wp-data-CXbtpCh2.js";import"./wp-components-YCGeKRou.js";import"./vendor-ui-BkLtITBR.js";import"./vendor-utils-D_7XgcHg.js";import"./wp-api-pXRzUPJ4.js";import"./vendor-monaco-cpVGocfO.js";const ae=()=>{const d=Q(),{id:o}=V(),u=T(),c=!!o,[s,g]=F.useState({name:"",email:"",website:"",type:"individual",commissionRate:10,paymentMethod:"bank",notes:""}),{data:q,isLoading:R}=I({queryKey:["affiliate-partner",o],queryFn:async()=>(await p.api.get(`/v1/affiliate/partners/${o}`)).data,enabled:c}),t=q?.data,N=S({mutationFn:async a=>(await p.api.post("/v1/affiliate/partners",a)).data,onSuccess:()=>{m.success("제휴사가 추가되었습니다"),u.invalidateQueries({queryKey:["affiliate-partners"]}),d("/affiliate/partners")},onError:()=>{m.error("제휴사 추가에 실패했습니다")}}),C=S({mutationFn:async a=>(await p.api.put(`/v1/affiliate/partners/${o}`,a)).data,onSuccess:()=>{m.success("제휴사 정보가 수정되었습니다"),u.invalidateQueries({queryKey:["affiliate-partners"]}),u.invalidateQueries({queryKey:["affiliate-partner",o]}),d("/affiliate/partners")},onError:()=>{m.error("제휴사 수정에 실패했습니다")}});F.useEffect(()=>{t&&g({name:t.name,email:t.email,website:t.website||"",type:t.type,commissionRate:t.commissionRate,paymentMethod:t.paymentMethod,bankName:t.bankName||"",accountNumber:t.accountNumber||"",accountHolder:t.accountHolder||"",paypalEmail:t.paypalEmail||"",businessNumber:t.businessNumber||"",notes:t.notes||""})},[t]);const H=a=>{a.preventDefault(),c?C.mutate(s):N.mutate(s)},r=(a,h)=>{g(D=>({...D,[a]:h}))};return c&&R?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-modern-primary"})}):e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs(x,{variant:"ghost",size:"sm",onClick:()=>d("/affiliate/partners"),children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"제휴사 목록"]}),e.jsx("h1",{className:"text-2xl font-bold text-modern-text-primary",children:c?"제휴사 수정":"새 제휴사 추가"})]}),e.jsxs("form",{onSubmit:H,children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(j,{children:[e.jsxs(v,{children:[e.jsx(b,{children:"기본 정보"}),e.jsx(y,{children:"제휴사의 기본 정보를 입력하세요"})]}),e.jsxs(f,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"name",children:"이름 *"}),e.jsx(i,{id:"name",value:s.name,onChange:a=>r("name",a.target.value),placeholder:"예: 김인플루언서",required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"email",children:"이메일 *"}),e.jsx(i,{id:"email",type:"email",value:s.email,onChange:a=>r("email",a.target.value),placeholder:"partner@example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"website",children:"웹사이트"}),e.jsx(i,{id:"website",type:"url",value:s.website,onChange:a=>r("website",a.target.value),placeholder:"https://example.com"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"type",children:"제휴사 유형 *"}),e.jsxs(w,{value:s.type,onValueChange:a=>r("type",a),children:[e.jsx(k,{children:e.jsx(E,{})}),e.jsxs(M,{children:[e.jsx(l,{value:"individual",children:"개인"}),e.jsx(l,{value:"influencer",children:"인플루언서"}),e.jsx(l,{value:"blog",children:"블로그"}),e.jsx(l,{value:"business",children:"비즈니스"})]})]})]}),s.type==="business"&&e.jsxs("div",{children:[e.jsx(n,{htmlFor:"businessNumber",children:"사업자번호"}),e.jsx(i,{id:"businessNumber",value:s.businessNumber,onChange:a=>r("businessNumber",a.target.value),placeholder:"123-45-67890"})]})]})]}),e.jsxs(j,{children:[e.jsxs(v,{children:[e.jsx(b,{children:"수수료 및 결제"}),e.jsx(y,{children:"수수료율과 결제 정보를 설정하세요"})]}),e.jsxs(f,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"commissionRate",children:"수수료율 (%) *"}),e.jsx(i,{id:"commissionRate",type:"number",min:"0",max:"100",step:"0.1",value:s.commissionRate,onChange:a=>r("commissionRate",parseFloat(a.target.value)),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"paymentMethod",children:"결제 방법 *"}),e.jsxs(w,{value:s.paymentMethod,onValueChange:a=>r("paymentMethod",a),children:[e.jsx(k,{children:e.jsx(E,{})}),e.jsxs(M,{children:[e.jsx(l,{value:"bank",children:"계좌이체"}),e.jsx(l,{value:"paypal",children:"페이팔"}),s.type==="business"&&e.jsx(l,{value:"invoice",children:"세금계산서"})]})]})]}),s.paymentMethod==="bank"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"bankName",children:"은행명"}),e.jsx(i,{id:"bankName",value:s.bankName,onChange:a=>r("bankName",a.target.value),placeholder:"예: 국민은행"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"accountNumber",children:"계좌번호"}),e.jsx(i,{id:"accountNumber",value:s.accountNumber,onChange:a=>r("accountNumber",a.target.value),placeholder:"123-456-789012"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"accountHolder",children:"예금주"}),e.jsx(i,{id:"accountHolder",value:s.accountHolder,onChange:a=>r("accountHolder",a.target.value),placeholder:"예금주명"})]})]}),s.paymentMethod==="paypal"&&e.jsxs("div",{children:[e.jsx(n,{htmlFor:"paypalEmail",children:"페이팔 이메일"}),e.jsx(i,{id:"paypalEmail",type:"email",value:s.paypalEmail,onChange:a=>r("paypalEmail",a.target.value),placeholder:"paypal@example.com"})]})]})]}),e.jsxs(j,{className:"lg:col-span-2",children:[e.jsxs(v,{children:[e.jsx(b,{children:"추가 정보"}),e.jsx(y,{children:"메모나 특이사항을 입력하세요"})]}),e.jsx(f,{children:e.jsx(P,{value:s.notes,onChange:a=>r("notes",a.target.value),placeholder:"제휴사에 대한 메모나 특이사항을 입력하세요...",rows:4})})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>d("/affiliate/partners"),children:"취소"}),e.jsxs(x,{type:"submit",disabled:N.isPending||C.isPending,children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),c?"수정하기":"추가하기"]})]})]})]})};export{ae as default};
