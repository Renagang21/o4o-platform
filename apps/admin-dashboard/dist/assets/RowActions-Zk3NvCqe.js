import{r as e,j as s,bP as t}from"./vendor-react-B2e3hjul.js";import{a}from"./index-D29lZukw.js";import{B as l}from"./page-gutenberg-C_zDdNV3.js";import{c as n}from"./vendor-ui-CrFdsnXa.js";function i({items:s,idField:t="id",actions:l}){const[n,i]=e.useState(new Set),[c,o]=e.useState(!1),{success:r,error:d}=a(),u=e.useMemo(()=>0!==s.length&&s.every(e=>n.has(String(e[t]))),[s,n,t]),m=e.useMemo(()=>0!==s.length&&(s.some(e=>n.has(String(e[t])))&&!u),[s,n,t,u]),h=e.useCallback(()=>{if(u)i(new Set);else{const e=new Set(s.map(e=>String(e[t])));i(e)}},[s,t,u]),b=e.useCallback(e=>{i(s=>{const t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},[]),p=e.useCallback(()=>{i(new Set)},[]),x=e.useCallback(async e=>{const s=l.find(s=>s.value===e);if(s)if(0!==n.size){if(s.confirmMessage){if(!window.confirm(s.confirmMessage.replace("{count}",String(n.size))))return}o(!0);try{await s.action(Array.from(n)),r(`${s.label} applied to ${n.size} item(s)`),p()}catch(t){d(`Failed to apply ${s.label}: ${t instanceof Error?t.message:"Unknown error"}`)}finally{o(!1)}}else d("No items selected");else d("Invalid action selected")},[l,n,r,d,p]);return{selectedIds:n,selectedCount:n.size,isAllSelected:u,isSomeSelected:m,isProcessing:c,toggleAll:h,toggleItem:b,clearSelection:p,executeBulkAction:x,isSelected:e=>n.has(e)}}const c=({actions:t,selectedCount:a,onActionExecute:n,isProcessing:i=!1,position:c="top"})=>{const[o,r]=e.useState("");return s.jsx("div",{className:`tablenav ${c}`,children:s.jsxs("div",{className:"alignleft actions bulkactions",children:[s.jsx("label",{htmlFor:`bulk-action-selector-${c}`,className:"screen-reader-text",children:"Select bulk action"}),s.jsxs("select",{id:`bulk-action-selector-${c}`,name:"action",value:o,onChange:e=>r(e.target.value),disabled:i,children:[s.jsx("option",{value:"",children:"Bulk actions"}),t.map(e=>s.jsx("option",{value:e.value,children:e.label},e.value))]}),s.jsx(l,{className:"button action",onClick:()=>{o&&(n(o),r(""))},disabled:!o||0===a||i,children:i?"Processing...":"Apply"}),a>0&&s.jsxs("span",{className:"selected-count",children:[a," item",1!==a?"s":""," selected"]})]})})},o=({actions:a,visible:l=!1})=>{const[i,c]=e.useState(l),o=e.useRef(null);return e.useEffect(()=>{c(l)},[l]),s.jsx("div",{ref:o,className:n("row-actions",!i&&"hidden"),children:a.map((e,l)=>{const i=l===a.length-1;return e.href?s.jsxs("span",{children:[s.jsx(t,{to:e.href,className:n("row-action-link",e.isDelete&&"text-red-600 hover:text-red-800",e.isDisabled&&"opacity-50 cursor-not-allowed",e.className),onClick:e.isDisabled?e=>e.preventDefault():void 0,children:e.label}),!i&&s.jsx("span",{className:"text-gray-400 mx-1",children:"|"})]},l):s.jsxs("span",{children:[s.jsx("button",{onClick:e.onClick,disabled:e.isDisabled,className:n("row-action-button",e.isDelete&&"text-red-600 hover:text-red-800",e.isDisabled&&"opacity-50 cursor-not-allowed",e.className),children:e.label}),!i&&s.jsx("span",{className:"text-gray-400 mx-1",children:"|"})]},l)})})};export{c as B,o as R,i as u};
