import{r as e,j as s,bK as a,dI as r,bd as t,bN as i,cT as n,bM as l,V as c,cX as o,cb as d}from"./vendor-react-BQ6HOJoh.js";import{B as m,L as p,I as h,T as x,S as j,h as u,i as g,j as v,k as y,b,d as w,e as N,f,g as k}from"./page-template-editor-C7FodHrK.js";import{ak as C,an as S,az as E,aA as I,aB as F,aC as $,aD as q,aE as T,al as A,am as P,av as L,ao as z,ap as K,aq as D,at as U}from"./wp-misc-DS9m4_P2.js";import{u as O,a as Q,b as B}from"./vendor-query-LYSOqK5P.js";import"./wp-block-editor-a11y-DrduSWFW.js";import"./wp-block-editor-misc-pHCPYvR2.js";import"./wp-block-editor-api-Buev8_QU.js";import"./wp-block-editor-utils-M5qXzE1L.js";import"./wp-block-editor-colors-D38h-Odz.js";import"./wp-blocks-core-6vwQKPfS.js";import"./wp-block-editor-clipboard-Dg0Y1gQ6.js";import"./wp-block-editor-store-B-g1aSix.js";import"./vendor-ui-CrFdsnXa.js";import"./wp-block-editor-dnd-BYoS8-II.js";import"./wp-block-editor-library-BpQvynjE.js";import"./wp-block-editor-menus-BTQ2wZ-f.js";import"./wp-block-editor-keyboard-CeHTtvP5.js";import"./wp-block-editor-typography-Bl_1REQP.js";import"./wp-block-editor-spacing-BD_2CpN7.js";import"./wp-block-editor-core-DL280tSA.js";import"./wp-block-editor-selection-CC4tJpUu.js";import"./wp-block-editor-formats-CLXkimOp.js";import"./wp-block-editor-inline-CpXpUhQU.js";import"./wp-block-editor-ui-B8YE_4QL.js";import"./wp-block-editor-transforms-jLcKa8Hv.js";import"./wp-block-editor-preview-iw2Xu1ib.js";import"./wp-block-editor-global-styles-CV5-K6QF.js";import"./wp-block-editor-borders-BH1devca.js";import"./wp-block-editor-patterns-BXdHo9lm.js";import"./wp-block-editor-navigation-BFSoKzg0.js";import"./wp-block-editor-media-Bg-JiQDT.js";import"./wp-api-BeoadipR.js";import"./wp-i18n-DGPtqsXY.js";import"./wp-core-Y-jV-nrZ.js";import"./vendor-monaco-BxJH8uUv.js";import"./wp-block-editor-upload-BLw1R9wP.js";import"./vendor-utils-D-spY-QM.js";import"./wp-block-editor-templates-o1_wAMb9.js";import"./wp-data-BmtL8k4r.js";import"./wp-components-CeQNCpMW.js";const G=new class{baseUrl;constructor(){const e=window.location.hostname;this.baseUrl="localhost"===e||"127.0.0.1"===e?"http://localhost:4000/api/v1":"admin.neture.co.kr"===e?"https://api.neture.co.kr/api/v1":"/api/v1"}getAuthHeaders(){const e=localStorage.getItem("accessToken")||localStorage.getItem("token"),s={"Content-Type":"application/json"};return e&&(s.Authorization=`Bearer ${e}`),s}async fetch(e,s={}){const{skipAuth:a=!1,headers:r={},...t}=s,i=a?r:{...this.getAuthHeaders(),...r},n=e.startsWith("http")?e:`${this.baseUrl}${e}`,l=await fetch(n,{...t,headers:i});if(401===l.status&&!a)throw localStorage.removeItem("accessToken"),localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login",new Error("Unauthorized");return l}async get(e,s){const a=await this.fetch(e,{...s,method:"GET"});if(!a.ok)throw new Error(`API Error: ${a.statusText}`);return a.json()}async post(e,s,a){const r=await this.fetch(e,{...a,method:"POST",body:s?JSON.stringify(s):void 0});if(!r.ok)throw new Error(`API Error: ${r.statusText}`);return r.json()}async put(e,s,a){const r=await this.fetch(e,{...a,method:"PUT",body:s?JSON.stringify(s):void 0});if(!r.ok)throw new Error(`API Error: ${r.statusText}`);return r.json()}async delete(e,s){const a=await this.fetch(e,{...s,method:"DELETE"});if(!a.ok)throw new Error(`API Error: ${a.statusText}`);return a.json()}},H=()=>{const[o,d]=e.useState(!1),[b,w]=e.useState(null),[N,f]=e.useState({name:"",slug:"",description:"",parentId:""}),k=O(),{data:H=[],isLoading:R}=Q({queryKey:["categories"],queryFn:async()=>{try{return await G.get("/categories")}catch(e){return[{id:"1",name:"Announcements",slug:"announcements",postCount:5},{id:"2",name:"Guides",slug:"guides",postCount:12},{id:"3",name:"News",slug:"news",postCount:8}]}}}),V=B({mutationFn:async e=>b?G.put(`/categories/${b.id}`,e):G.post("/categories",e),onSuccess:()=>{k.invalidateQueries({queryKey:["categories"]}),c.success(b?"카테고리가 수정되었습니다":"카테고리가 생성되었습니다"),W()},onError:()=>{c.error("카테고리 저장에 실패했습니다")}}),J=B({mutationFn:async e=>G.delete(`/categories/${e}`),onSuccess:()=>{k.invalidateQueries({queryKey:["categories"]}),c.success("카테고리가 삭제되었습니다")},onError:()=>{c.error("카테고리 삭제에 실패했습니다")}}),M=e=>{e?(w(e),f({name:e.name,slug:e.slug,description:e.description||"",parentId:e.parentId||""})):(w(null),f({name:"",slug:"",description:"",parentId:""})),d(!0)},W=()=>{d(!1),w(null),f({name:"",slug:"",description:"",parentId:""})},X=(e,a=0)=>s.jsxs("div",{className:a>0?"ml-8":"",children:[s.jsxs(C,{className:"mb-4",children:[s.jsx(A,{className:"pb-3",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"space-y-1 flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[e.children&&e.children.length>0&&s.jsx(t,{className:"w-4 h-4 text-gray-400"}),s.jsx(P,{className:"text-lg",children:e.name})]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["/",e.slug]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(L,{variant:"secondary",children:[e.postCount||0,"개 게시글"]}),s.jsxs(z,{children:[s.jsx(K,{children:s.jsx(m,{variant:"ghost",size:"sm",children:s.jsx(i,{className:"w-4 h-4"})})}),s.jsxs(D,{align:"end",children:[s.jsxs(U,{onClick:()=>M(e),children:[s.jsx(n,{className:"w-4 h-4 mr-2"}),"수정"]}),s.jsxs(U,{onClick:()=>{return s=e.id,void(confirm("정말 이 카테고리를 삭제하시겠습니까?\n하위 카테고리가 있다면 함께 삭제됩니다.")&&J.mutate(s));var s},className:"text-red-600",children:[s.jsx(l,{className:"w-4 h-4 mr-2"}),"삭제"]})]})]})]})]})}),e.description&&s.jsx(S,{children:s.jsx("p",{className:"text-sm text-gray-600",children:e.description})})]}),e.children&&e.children.map(e=>X(e,a+1))]},e.id),Y=(e=>{const s=new Map,a=[];return e.forEach(e=>{s.set(e.id,{...e,children:[]})}),e.forEach(e=>{const r=s.get(e.id);if(e.parentId){const a=s.get(e.parentId);a&&(a.children=a.children||[],a.children.push(r))}else a.push(r)}),a})(H);return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("p",{className:"text-gray-600",children:"계층 구조로 콘텐츠를 체계적으로 분류합니다"}),s.jsxs(m,{onClick:()=>M(),children:[s.jsx(a,{className:"w-4 h-4 mr-2"}),"새 카테고리"]})]}),R?s.jsx("div",{className:"text-center py-12",children:s.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):H.length>0?s.jsx("div",{children:Y.map(e=>X(e))}):s.jsx(C,{children:s.jsxs(S,{className:"text-center py-12",children:[s.jsx(r,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"카테고리가 없습니다"}),s.jsxs(m,{onClick:()=>M(),children:[s.jsx(a,{className:"w-4 h-4 mr-2"}),"첫 카테고리 만들기"]})]})}),s.jsx(E,{open:o,onOpenChange:d,children:s.jsx(I,{children:s.jsxs("form",{onSubmit:e=>{e.preventDefault(),V.mutate(N)},children:[s.jsxs(F,{children:[s.jsx($,{children:b?"카테고리 수정":"새 카테고리"}),s.jsx(q,{children:"게시물을 분류할 카테고리를 만들어보세요"})]}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(p,{htmlFor:"name",children:"이름"}),s.jsx(h,{id:"name",value:N.name,onChange:e=>{var s;f({...N,name:e.target.value,slug:(s=e.target.value,s.toLowerCase().replace(/[^a-z0-9가-힣]+/g,"-").replace(/^-+|-+$/g,""))})},placeholder:"예: 공지사항",required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(p,{htmlFor:"slug",children:"슬러그"}),s.jsx(h,{id:"slug",value:N.slug,onChange:e=>f({...N,slug:e.target.value}),placeholder:"notice",required:!0}),s.jsx("p",{className:"text-xs text-gray-500",children:"URL에 사용되는 고유 식별자입니다"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(p,{htmlFor:"description",children:"설명 (선택)"}),s.jsx(x,{id:"description",value:N.description,onChange:e=>f({...N,description:e.target.value}),placeholder:"이 카테고리에 대한 설명을 입력하세요",rows:3})]}),H.length>0&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(p,{htmlFor:"parent",children:"상위 카테고리 (선택)"}),s.jsxs(j,{value:N.parentId,onValueChange:e=>f({...N,parentId:e}),children:[s.jsx(u,{children:s.jsx(g,{placeholder:"상위 카테고리 선택"})}),s.jsxs(v,{children:[s.jsx(y,{value:"",children:"없음"}),H.filter(e=>e.id!==b?.id).map(e=>s.jsx(y,{value:e.id,children:e.name},e.id))]})]})]})]}),s.jsxs(T,{children:[s.jsx(m,{type:"button",variant:"outline",onClick:W,children:"취소"}),s.jsx(m,{type:"submit",disabled:V.isPending,children:V.isPending?"저장 중...":"저장"})]})]})})})]})},R=()=>{const[r,t]=e.useState(!1),[j,u]=e.useState(null),[g,v]=e.useState([]),[y,w]=e.useState({name:"",slug:"",description:""}),N=O(),{data:f=[],isLoading:k}=Q({queryKey:["tags"],queryFn:async()=>(await b.api.get("/tags")).data}),G=B({mutationFn:async e=>j?b.api.put(`/tags/${j.id}`,e):b.api.post("/tags",e),onSuccess:()=>{N.invalidateQueries({queryKey:["tags"]}),c.success(j?"태그가 수정되었습니다":"태그가 생성되었습니다"),J()},onError:()=>{c.error("태그 저장에 실패했습니다")}}),H=B({mutationFn:async e=>b.api.delete(`/tags/${e}`),onSuccess:()=>{N.invalidateQueries({queryKey:["tags"]}),c.success("태그가 삭제되었습니다")},onError:()=>{c.error("태그 삭제에 실패했습니다")}}),R=B({mutationFn:async e=>b.api.post("/tags/bulk-delete",{ids:e}),onSuccess:()=>{N.invalidateQueries({queryKey:["tags"]}),c.success(`${g.length}개의 태그가 삭제되었습니다`),v([])},onError:()=>{c.error("태그 일괄 삭제에 실패했습니다")}}),V=e=>{e?(u(e),w({name:e.name,slug:e.slug,description:e.description||""})):(u(null),w({name:"",slug:"",description:""})),t(!0)},J=()=>{t(!1),u(null),w({name:"",slug:"",description:""})},M=[...f].sort((e,s)=>(s.postCount||0)-(e.postCount||0)),W=e=>e>=50?"bg-blue-100 text-blue-800 hover:bg-blue-200":e>=20?"bg-green-100 text-green-800 hover:bg-green-200":e>=10?"bg-gray-100 text-gray-800 hover:bg-gray-200":"bg-gray-50 text-gray-600 hover:bg-gray-100";return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("p",{className:"text-gray-600",children:"키워드로 콘텐츠를 유연하게 분류합니다"}),s.jsxs("div",{className:"flex gap-2",children:[g.length>0&&s.jsxs(m,{variant:"destructive",onClick:()=>{confirm(`정말 ${g.length}개의 태그를 삭제하시겠습니까?`)&&R.mutate(g)},disabled:R.isPending,children:[s.jsx(l,{className:"w-4 h-4 mr-2"}),g.length,"개 삭제"]}),s.jsxs(m,{onClick:()=>V(),children:[s.jsx(a,{className:"w-4 h-4 mr-2"}),"새 태그"]})]})]}),k?s.jsx("div",{className:"text-center py-12",children:s.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):f.length>0?s.jsxs(s.Fragment,{children:[s.jsxs(C,{className:"mb-6",children:[s.jsx(A,{children:s.jsx(P,{className:"text-lg",children:"태그 클라우드"})}),s.jsx(S,{children:s.jsx("div",{className:"flex flex-wrap gap-2",children:M.slice(0,30).map(e=>{return s.jsxs(L,{variant:"secondary",className:`cursor-pointer transition-colors ${a=e.postCount||0,a>=50?"text-lg font-semibold":a>=20?"text-base font-medium":a>=10?"text-sm":"text-xs"} ${W(e.postCount||0)}`,onClick:()=>V(e),children:[s.jsx(o,{className:"w-3 h-3 mr-1"}),e.name,s.jsxs("span",{className:"ml-1 opacity-60",children:["(",e.postCount||0,")"]})]},e.id);var a})})})]}),s.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:M.map(e=>s.jsxs(C,{className:g.includes(e.id)?"ring-2 ring-blue-500":"",children:[s.jsx(A,{className:"pb-3",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[s.jsx("input",{type:"checkbox",className:"rounded border-gray-300",checked:g.includes(e.id),onChange:()=>{return s=e.id,void v(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s]);var s}}),s.jsxs("div",{className:"space-y-1 flex-1",children:[s.jsxs(P,{className:"text-lg flex items-center gap-2",children:[s.jsx(d,{className:"w-4 h-4"}),e.name]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["/",e.slug]})]})]}),s.jsxs(z,{children:[s.jsx(K,{children:s.jsx(m,{variant:"ghost",size:"sm",children:s.jsx(i,{className:"w-4 h-4"})})}),s.jsxs(D,{align:"end",children:[s.jsxs(U,{onClick:()=>V(e),children:[s.jsx(n,{className:"w-4 h-4 mr-2"}),"수정"]}),s.jsxs(U,{onClick:()=>{return s=e.id,void(confirm("정말 이 태그를 삭제하시겠습니까?")&&H.mutate(s));var s},className:"text-red-600",children:[s.jsx(l,{className:"w-4 h-4 mr-2"}),"삭제"]})]})]})]})}),s.jsxs(S,{children:[e.description&&s.jsx("p",{className:"text-sm text-gray-600 mb-3",children:e.description}),s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs(L,{variant:"outline",children:[e.postCount||0,"개 게시글"]}),s.jsx("span",{className:"text-gray-500",children:new Date(e.createdAt).toLocaleDateString()})]})]})]},e.id))})]}):s.jsx(C,{children:s.jsxs(S,{className:"text-center py-12",children:[s.jsx(d,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"태그가 없습니다"}),s.jsxs(m,{onClick:()=>V(),children:[s.jsx(a,{className:"w-4 h-4 mr-2"}),"첫 태그 만들기"]})]})}),s.jsx(E,{open:r,onOpenChange:t,children:s.jsx(I,{children:s.jsxs("form",{onSubmit:e=>{e.preventDefault(),G.mutate(y)},children:[s.jsxs(F,{children:[s.jsx($,{children:j?"태그 수정":"새 태그"}),s.jsx(q,{children:"게시물에 사용할 태그를 만들어보세요"})]}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(p,{htmlFor:"name",children:"이름"}),s.jsx(h,{id:"name",value:y.name,onChange:e=>{var s;w({...y,name:e.target.value,slug:(s=e.target.value,s.toLowerCase().replace(/[^a-z0-9가-힣]+/g,"-").replace(/^-+|-+$/g,""))})},placeholder:"예: React",required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(p,{htmlFor:"slug",children:"슬러그"}),s.jsx(h,{id:"slug",value:y.slug,onChange:e=>w({...y,slug:e.target.value}),placeholder:"react",required:!0}),s.jsx("p",{className:"text-xs text-gray-500",children:"URL에 사용되는 고유 식별자입니다"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(p,{htmlFor:"description",children:"설명 (선택)"}),s.jsx(x,{id:"description",value:y.description,onChange:e=>w({...y,description:e.target.value}),placeholder:"이 태그에 대한 설명을 입력하세요",rows:3})]})]}),s.jsxs(T,{children:[s.jsx(m,{type:"button",variant:"outline",onClick:J,children:"취소"}),s.jsx(m,{type:"submit",disabled:G.isPending,children:G.isPending?"저장 중...":"저장"})]})]})})})]})};function V(){const[a,r]=e.useState("categories");return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"카테고리 & 태그"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"콘텐츠를 체계적으로 분류하고 관리합니다"})]}),s.jsxs(w,{value:a,onValueChange:r,className:"w-full",children:[s.jsxs(N,{className:"grid w-full grid-cols-2 max-w-[400px]",children:[s.jsx(f,{value:"categories",children:"카테고리"}),s.jsx(f,{value:"tags",children:"태그"})]}),s.jsx(k,{value:"categories",className:"mt-6",children:s.jsx(H,{})}),s.jsx(k,{value:"tags",className:"mt-6",children:s.jsx(R,{})})]})]})}export{V as default};
