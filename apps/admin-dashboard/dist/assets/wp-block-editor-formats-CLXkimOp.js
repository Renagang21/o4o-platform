import"./wp-block-editor-a11y-DrduSWFW.js";import{ad as e,F as t,x as n,X as r,U as s,ae as i,V as o,af as a,ag as l,ah as c,ai as u,aj as d,ak as f,al as g,am as p,a1 as h,Z as m}from"./wp-block-editor-utils-M5qXzE1L.js";import{r as b,j as v,d as x}from"./vendor-react-BQ6HOJoh.js";import{c as y}from"./vendor-ui-CrFdsnXa.js";import{aR as k,aS as _,aT as S,aU as E,aV as C,aW as w,aX as T,ax as L,ay as j,al as N,ak as R,a as D,ab as O,aD as F,aY as P,s as A,_ as I,aZ as M,aA as $,N as V,V as H,u as B,a_ as U,b as z,a$ as W,a8 as K,b0 as q,b1 as X,ag as Y,b2 as G,b3 as Q,b4 as J,b5 as Z,H as ee,aj as te,b6 as ne,a0 as re,aw as se,av as ie,ar as oe,M as ae,a6 as le,b7 as ce,aM as ue,b8 as de,aH as fe,b9 as ge,ba as pe,aE as he,g as me,ao as be,bb as ve,bc as xe,aJ as ye,bd as ke,D as _e,be as Se,bf as Ee}from"./wp-block-editor-misc-pHCPYvR2.js";import{m as Ce,A as we,M as Te,a as Le,f as je,U as Ne,N as Re}from"./wp-block-editor-menus-BTQ2wZ-f.js";import{x as De,y as Oe,p as Fe,z as Pe,A as Ae,B as Ie,C as Me,D as $e,E as Ve,F as He,G as Be,j as Ue,b as ze,H as We,I as Ke,J as qe,c as Xe,a as Ye,K as Ge,L as Qe,M as Je}from"./wp-block-editor-library-BpQvynjE.js";import{d as Ze,i as et,e as tt,f as nt,j as rt,k as st,p as it,l as ot,s as at,m as lt}from"./wp-misc-DS9m4_P2.js";import{a as ct,s as ut}from"./wp-block-editor-store-B-g1aSix.js";import{u as dt}from"./wp-block-editor-clipboard-Dg0Y1gQ6.js";import{y as ft,z as gt,B as pt,C as ht,D as mt,l as bt,E as vt}from"./wp-blocks-core-6vwQKPfS.js";import{w as xt}from"./wp-block-editor-colors-D38h-Odz.js";import{a as yt,C as kt,b as _t,i as St,d as Et}from"./wp-block-editor-api-Buev8_QU.js";import{D as Ct}from"./wp-block-editor-dnd-BYoS8-II.js";const wt=k({formatTypes:function(e={},t){switch(t.type){case"ADD_FORMAT_TYPES":return{...e,...t.formatTypes.reduce((e,t)=>({...e,[t.name]:t}),{})};case"REMOVE_FORMAT_TYPES":return Object.fromEntries(Object.entries(e).filter(([e])=>!t.names.includes(e)))}return e}}),Tt=_(e=>Object.values(e.formatTypes),e=>[e.formatTypes]);const Lt=Object.freeze(Object.defineProperty({__proto__:null,getFormatType:function(e,t){return e.formatTypes[t]},getFormatTypeForBareElement:function(e,t){const n=Tt(e);return n.find(({className:e,tagName:n})=>null===e&&t===n)||n.find(({className:e,tagName:t})=>null===e&&"*"===t)},getFormatTypeForClassName:function(e,t){return Tt(e).find(({className:e})=>null!==e&&` ${t} `.indexOf(` ${e} `)>=0)},getFormatTypes:Tt},Symbol.toStringTag,{value:"Module"}));const jt=Object.freeze(Object.defineProperty({__proto__:null,addFormatTypes:function(e){return{type:"ADD_FORMAT_TYPES",formatTypes:Array.isArray(e)?e:[e]}},removeFormatTypes:function(e){return{type:"REMOVE_FORMAT_TYPES",names:Array.isArray(e)?e:[e]}}},Symbol.toStringTag,{value:"Module"})),Nt=ct("core/rich-text",{reducer:wt,selectors:Lt,actions:jt});function Rt(e,t){if(e===t)return!0;if(!e||!t)return!1;if(e.type!==t.type)return!1;const n=e.attributes,r=t.attributes;if(n===r)return!0;if(!n||!r)return!1;const s=Object.keys(n),i=Object.keys(r);if(s.length!==i.length)return!1;const o=s.length;for(let a=0;a<o;a++){const e=s[a];if(n[e]!==r[e])return!1}return!0}function Dt(e){const t=e.formats.slice();return t.forEach((e,n)=>{const r=t[n-1];if(r){const s=e.slice();s.forEach((e,t)=>{const n=r[t];Rt(e,n)&&(s[t]=n)}),t[n]=s}}),{...e,formats:t}}function Ot({implementation:e},t){return Ot.body||(Ot.body=e.createHTMLDocument("").body),Ot.body.innerHTML=t,Ot.body}S(Nt);const Ft="ï¿¼";function Pt(e,t=[]){const{formats:n,start:r,end:s,activeFormats:i}=e;if(void 0===r)return t;if(r===s){if(i)return i;const e=n[r-1]||t,s=n[r]||t;return e.length<s.length?e:s}if(!n[r])return t;const o=n.slice(r,s),a=[...o[0]];let l=o.length;for(;l--;){const e=o[l];if(!e)return t;let n=a.length;for(;n--;){const t=a[n];e.find(e=>Rt(t,e))||a.splice(n,1)}if(0===a.length)return t}return a||t}function At(e){return E(Nt).getFormatType(e)}function It(e,t){if(t)return e;const n={};for(const r in e){let t=r;r.startsWith("data-disable-rich-text-")&&(t=r.slice(23)),n[t]=e[r]}return n}function Mt({type:e,tagName:t,attributes:n,unregisteredAttributes:r,object:s,boundaryClass:i,isEditableTree:o}){const a=At(e);let l={};if(i&&o&&(l["data-rich-text-format-boundary"]="true"),!a)return n&&(l={...n,...l}),{type:e,attributes:It(l,o),object:s};l={...r,...l};for(const c in n){const e=!!a.attributes&&a.attributes[c];e?l[e]=n[c]:l[c]=n[c]}return a.className&&(l.class?l.class=`${a.className} ${l.class}`:l.class=a.className),o&&!1===a.contentEditable&&(l.contenteditable="false"),{type:t||a.tagName,object:a.object,attributes:It(l,o)}}function $t(e,t,n){do{if(e[n]!==t[n])return!1}while(n--);return!0}function Vt({value:e,preserveWhiteSpace:t,createEmpty:n,append:r,getLastChild:s,getParent:i,isText:o,getText:a,remove:l,appendText:c,onStartIndex:u,onEndIndex:d,isEditableTree:f,placeholder:g}){const{formats:p,replacements:h,text:m,start:b,end:v}=e,x=p.length+1,y=n(),k=Pt(e),_=k[k.length-1];let S,E;r(y,"");for(let C=0;C<x;C++){const e=m.charAt(C),n=f&&(!E||"\n"===E),x=p[C];let k=s(y);if(x&&x.forEach((e,t)=>{if(k&&S&&$t(x,S,t))return void(k=s(k));const{type:n,tagName:c,attributes:u,unregisteredAttributes:d}=e,g=f&&e===_,p=i(k),h=r(p,Mt({type:n,tagName:c,attributes:u,unregisteredAttributes:d,boundaryClass:g,isEditableTree:f}));o(k)&&0===a(k).length&&l(k),k=r(h,"")}),0===C&&(u&&0===b&&u(y,k),d&&0===v&&d(y,k)),e===Ft){const e=h[C];if(!e)continue;const{type:t,attributes:n,innerHTML:s}=e,o=At(t);f&&"#comment"===t?(k=r(i(k),{type:"span",attributes:{contenteditable:"false","data-rich-text-comment":n["data-rich-text-comment"]}}),r(r(k,{type:"span"}),n["data-rich-text-comment"].trim())):f||"script"!==t?!1===o?.contentEditable?(k=r(i(k),Mt({...e,isEditableTree:f,boundaryClass:b===C&&v===C+1})),s&&r(k,{html:s})):k=r(i(k),Mt({...e,object:!0,isEditableTree:f})):(k=r(i(k),Mt({type:"script",isEditableTree:f})),r(k,{html:decodeURIComponent(n["data-rich-text-script"])})),k=r(i(k),"")}else t||"\n"!==e?o(k)?c(k,e):k=r(i(k),e):(k=r(i(k),{type:"br",attributes:f?{"data-rich-text-line-break":"true"}:void 0,object:!0}),k=r(i(k),""));u&&b===C+1&&u(y,k),d&&v===C+1&&d(y,k),n&&C===m.length&&(r(i(k),"\ufeff"),g&&0===m.length&&r(i(k),{type:"span",attributes:{"data-rich-text-placeholder":g,style:"pointer-events:none;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;"}})),S=x,E=e}return y}function Ht({value:e,preserveWhiteSpace:t}){return Gt(Vt({value:e,preserveWhiteSpace:t,createEmpty:Bt,append:zt,getLastChild:Ut,getParent:Kt,isText:qt,getText:Xt,remove:Yt,appendText:Wt}).children)}function Bt(){return{}}function Ut({children:e}){return e&&e[e.length-1]}function zt(e,t){return"string"==typeof t&&(t={text:t}),t.parent=e,e.children=e.children||[],e.children.push(t),t}function Wt(e,t){e.text+=t}function Kt({parent:e}){return e}function qt({text:e}){return"string"==typeof e}function Xt({text:e}){return e}function Yt(e){const t=e.parent.children.indexOf(e);return-1!==t&&e.parent.children.splice(t,1),e}function Gt(e=[]){return e.map(e=>void 0!==e.html?e.html:void 0===e.text?function({type:e,attributes:t,object:n,children:r}){if("#comment"===e)return`\x3c!--${t["data-rich-text-comment"]}--\x3e`;let s="";for(const i in t)w(i)&&(s+=` ${i}="${T(t[i])}"`);return n?`<${e}${s}>`:`<${e}${s}>${Gt(r)}</${e}>`}(e):C(e.text)).join("")}function Qt({text:e}){return e.replace(Ft,"")}function Jt(){return{formats:[],replacements:[],text:""}}function Zt({tagName:e,attributes:t}){let n;if(t&&t.class&&(n=E(Nt).getFormatTypeForClassName(t.class),n&&(t.class=` ${t.class} `.replace(` ${n.className} `," ").trim(),t.class||delete t.class)),n||(n=E(Nt).getFormatTypeForBareElement(e)),!n)return t?{type:e,attributes:t}:{type:e};if(n.__experimentalCreatePrepareEditableTree&&!n.__experimentalCreateOnChangeEditableValue)return null;if(!t)return{formatType:n,type:n.name,tagName:e};const r={},s={},i={...t};for(const o in n.attributes){const e=n.attributes[o];r[o]=i[e],delete i[e],void 0===r[o]&&delete r[o]}for(const o in i)s[o]=t[o];return!1===n.contentEditable&&delete s.contenteditable,{formatType:n,type:n.name,tagName:e,attributes:r,unregisteredAttributes:s}}class en{#e;static empty(){return new en}static fromPlainText(e){return new en(tn({text:e}))}static fromHTMLString(e){return new en(tn({html:e}))}static fromHTMLElement(e,t={}){const{preserveWhiteSpace:n=!1}=t,r=n?e:sn(e),s=new en(tn({element:r}));return Object.defineProperty(s,"originalHTML",{value:e.innerHTML}),s}constructor(e={formats:[],replacements:[],text:""}){this.#e=e}toPlainText(){return Qt(this.#e)}toHTMLString({preserveWhiteSpace:e}={}){return this.originalHTML||Ht({value:this.#e,preserveWhiteSpace:e})}valueOf(){return this.toHTMLString()}toString(){return this.toHTMLString()}toJSON(){return this.toHTMLString()}get length(){return this.text.length}get formats(){return this.#e.formats}get replacements(){return this.#e.replacements}get text(){return this.#e.text}}for(const fs of Object.getOwnPropertyNames(String.prototype))en.prototype.hasOwnProperty(fs)||Object.defineProperty(en.prototype,fs,{value(...e){return this.toHTMLString()[fs](...e)}});function tn({element:e,text:t,html:n,range:r,__unstableIsEditableTree:s}={}){return n instanceof en?{text:n.text,formats:n.formats,replacements:n.replacements}:"string"==typeof t&&t.length>0?{formats:Array(t.length),replacements:Array(t.length),text:t}:("string"==typeof n&&n.length>0&&(e=Ot(document,n)),"object"!=typeof e?{formats:[],replacements:[],text:""}:ln({element:e,range:r,isEditableTree:s}))}function nn(e,t,n,r){if(!n)return;const{parentNode:s}=t,{startContainer:i,startOffset:o,endContainer:a,endOffset:l}=n,c=e.text.length;void 0!==r.start?e.start=c+r.start:t===i&&t.nodeType===t.TEXT_NODE?e.start=c+o:s===i&&t===i.childNodes[o]?e.start=c:s===i&&t===i.childNodes[o-1]?e.start=c+r.text.length:t===i&&(e.start=c),void 0!==r.end?e.end=c+r.end:t===a&&t.nodeType===t.TEXT_NODE?e.end=c+l:s===a&&t===a.childNodes[l-1]?e.end=c+r.text.length:s===a&&t===a.childNodes[l]?e.end=c:t===a&&(e.end=c+l)}function rn(e,t,n){if(!t)return;const{startContainer:r,endContainer:s}=t;let{startOffset:i,endOffset:o}=t;return e===r&&(i=n(e.nodeValue.slice(0,i)).length),e===s&&(o=n(e.nodeValue.slice(0,o)).length),{startContainer:r,startOffset:i,endContainer:s,endOffset:o}}function sn(e,t=!0){const n=e.cloneNode(!0);return n.normalize(),Array.from(n.childNodes).forEach((e,n,r)=>{if(e.nodeType===e.TEXT_NODE){let s=e.nodeValue;/[\n\t\r\f]/.test(s)&&(s=s.replace(/[\n\t\r\f]+/g," ")),-1!==s.indexOf("  ")&&(s=s.replace(/ {2,}/g," ")),0===n&&s.startsWith(" ")?s=s.slice(1):t&&n===r.length-1&&s.endsWith(" ")&&(s=s.slice(0,-1)),e.nodeValue=s}else e.nodeType===e.ELEMENT_NODE&&sn(e,!1)}),n}const on="\r";function an(e){return e.replace(new RegExp(`[\ufeff${Ft}${on}]`,"gu"),"")}function ln({element:e,range:t,isEditableTree:n}){const r={formats:[],replacements:[],text:""};if(!e)return r;if(!e.hasChildNodes())return nn(r,e,t,{formats:[],replacements:[],text:""}),r;const s=e.childNodes.length;for(let i=0;i<s;i++){const s=e.childNodes[i],o=s.nodeName.toLowerCase();if(s.nodeType===s.TEXT_NODE){const e=an(s.nodeValue);nn(r,s,t=rn(s,t,an),{text:e}),r.formats.length+=e.length,r.replacements.length+=e.length,r.text+=e;continue}if(s.nodeType===s.COMMENT_NODE||s.nodeType===s.ELEMENT_NODE&&"SPAN"===s.tagName&&s.hasAttribute("data-rich-text-comment")){const e={formats:[,],replacements:[{type:"#comment",attributes:{"data-rich-text-comment":s.nodeType===s.COMMENT_NODE?s.nodeValue:s.getAttribute("data-rich-text-comment")}}],text:Ft};nn(r,s,t,e),un(r,e);continue}if(s.nodeType!==s.ELEMENT_NODE)continue;if(n&&"br"===o&&!s.getAttribute("data-rich-text-line-break")){nn(r,s,t,Jt());continue}if("script"===o){const e={formats:[,],replacements:[{type:o,attributes:{"data-rich-text-script":s.getAttribute("data-rich-text-script")||encodeURIComponent(s.innerHTML)}}],text:Ft};nn(r,s,t,e),un(r,e);continue}if("br"===o){nn(r,s,t,Jt()),un(r,tn({text:"\n"}));continue}const a=Zt({tagName:o,attributes:cn({element:s})});if(!1===a?.formatType?.contentEditable){delete a.formatType,nn(r,s,t,Jt()),un(r,{formats:[,],replacements:[{...a,innerHTML:s.innerHTML}],text:Ft});continue}a&&delete a.formatType;const l=ln({element:s,range:t,isEditableTree:n});if(nn(r,s,t,l),!a||s.getAttribute("data-rich-text-placeholder"))un(r,l);else if(0===l.text.length)a.attributes&&un(r,{formats:[,],replacements:[a],text:Ft});else{let e=function(t){if(e.formats===t)return e.newFormats;const n=t?[a,...t]:[a];return e.formats=t,e.newFormats=n,n};e.newFormats=[a],un(r,{...l,formats:Array.from(l.formats,e)})}}return r}function cn({element:e}){if(!e.hasAttributes())return;const t=e.attributes.length;let n;for(let r=0;r<t;r++){const{name:t,value:s}=e.attributes[r];if(0===t.indexOf("data-rich-text-"))continue;n=n||{},n[/^on/i.test(t)?"data-disable-rich-text-"+t:t]=s}return n}function un(e,t){return e.formats=e.formats.concat(t.formats),e.replacements=e.replacements.concat(t.replacements),e.text+=t.text,e}function dn({start:e,end:t}){if(void 0!==e&&void 0!==t)return e===t}function fn({text:e}){return 0===e.length}function gn(e,t,n){const r=e[t].filter(({type:e})=>e!==n);r.length?e[t]=r:delete e[t]}function pn(e,t,n=e.start,r=e.end){const{formats:s,replacements:i,text:o}=e;"string"==typeof t&&(t=tn({text:t}));const a=n+t.text.length;return Dt({formats:s.slice(0,n).concat(t.formats,s.slice(r)),replacements:i.slice(0,n).concat(t.replacements,i.slice(r)),text:o.slice(0,n)+t.text+o.slice(r),start:a,end:a})}function hn(e,t,n){return pn(e,tn(),t,n)}function mn(e,t=e.start,n=e.end){const{formats:r,replacements:s,text:i}=e;return void 0===t||void 0===n?{...e}:{formats:r.slice(t,n),replacements:s.slice(t,n),text:i.slice(t,n)}}function bn({formats:e,replacements:t,text:n,start:r,end:s},i){return function({formats:e,replacements:t,text:n,start:r,end:s},i=r,o=s){if(void 0===r||void 0===s)return;const a={formats:e.slice(0,i),replacements:t.slice(0,i),text:n.slice(0,i)},l={formats:e.slice(o),replacements:t.slice(o),text:n.slice(o),start:0,end:0};return[a,l]}(...arguments)}function vn(e,t){return e===t||e&&t&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset}function xn(e,t,n){const r=e.parentNode;let s=0;for(;e=e.previousSibling;)s++;return n=[s,...n],r!==t&&(n=xn(r,t,n)),n}function yn(e,t){for(t=[...t];e&&t.length>1;)e=e.childNodes[t.shift()];return{node:e,offset:t[0]}}function kn(e,t){if(void 0!==t.html)return e.innerHTML+=t.html;"string"==typeof t&&(t=e.ownerDocument.createTextNode(t));const{type:n,attributes:r}=t;if(n)if("#comment"===n)t=e.ownerDocument.createComment(r["data-rich-text-comment"]);else{t=e.ownerDocument.createElement(n);for(const e in r)t.setAttribute(e,r[e])}return e.appendChild(t)}function _n(e,t){e.appendData(t)}function Sn({lastChild:e}){return e}function En({parentNode:e}){return e}function Cn(e){return e.nodeType===e.TEXT_NODE}function wn({nodeValue:e}){return e}function Tn(e){return e.parentNode.removeChild(e)}function Ln({value:e,current:t,prepareEditableTree:n,__unstableDomOnly:r,placeholder:s}){const{body:i,selection:o}=function({value:e,prepareEditableTree:t,isEditableTree:n=!0,placeholder:r,doc:s=document}){let i=[],o=[];return t&&(e={...e,formats:t(e)}),{body:Vt({value:e,createEmpty:()=>Ot(s,""),append:kn,getLastChild:Sn,getParent:En,isText:Cn,getText:wn,remove:Tn,appendText:_n,onStartIndex(e,t){i=xn(t,e,[t.nodeValue.length])},onEndIndex(e,t){o=xn(t,e,[t.nodeValue.length])},isEditableTree:n,placeholder:r}),selection:{startPath:i,endPath:o}}}({value:e,prepareEditableTree:n,placeholder:s,doc:t.ownerDocument});jn(i,t),void 0===e.start||r||function({startPath:e,endPath:t},n){const{node:r,offset:s}=yn(n,e),{node:i,offset:o}=yn(n,t),{ownerDocument:a}=n,{defaultView:l}=a,c=l.getSelection(),u=a.createRange();u.setStart(r,s),u.setEnd(i,o);const{activeElement:d}=a;if(c.rangeCount>0){if(vn(u,c.getRangeAt(0)))return;c.removeAllRanges()}c.addRange(u),d!==a.activeElement&&d instanceof l.HTMLElement&&d.focus()}(o,t)}function jn(e,t){let n,r=0;for(;n=e.firstChild;){const s=t.childNodes[r];if(s)if(s.isEqualNode(n))e.removeChild(n);else if(s.nodeName!==n.nodeName||s.nodeType===s.TEXT_NODE&&s.data!==n.data)t.replaceChild(n,s);else{const t=s.attributes,r=n.attributes;if(t){let e=t.length;for(;e--;){const{name:r}=t[e];n.getAttribute(r)||s.removeAttribute(r)}}if(r)for(let e=0;e<r.length;e++){const{name:t,value:n}=r[e];s.getAttribute(t)!==n&&s.setAttribute(t,n)}jn(n,s),e.removeChild(n)}else t.appendChild(n);r++}for(;t.childNodes[r];)t.removeChild(t.childNodes[r])}function Nn(e,t,n){if(!e)return;const{ownerDocument:r}=e,{defaultView:s}=r,i=s.getSelection();if(!i)return;if(!i.rangeCount)return;const o=i.getRangeAt(0);if(!o||!o.startContainer)return;const a=function(e,t,n,r){let s=e.startContainer;if(s.nodeType===s.TEXT_NODE&&e.startOffset===s.length&&s.nextSibling)for(s=s.nextSibling;s.firstChild;)s=s.firstChild;if(s.nodeType!==s.ELEMENT_NODE&&(s=s.parentElement),!s)return;if(s===t)return;if(!t.contains(s))return;const i=n+(r?"."+r:"");for(;s!==t;){if(s.matches(i))return s;s=s.parentElement}}(o,e,t,n);return a||function(e,t){return{contextElement:t,getBoundingClientRect:()=>t.contains(e.startContainer)?e.getBoundingClientRect():t.getBoundingClientRect()}}(o,e)}function Rn({editableContentElement:t,settings:n={}}){const{tagName:r,className:s,isActive:i}=n,[o,a]=b.useState(()=>Nn(t,r,s)),l=e(i);return b.useLayoutEffect(()=>{if(!t)return;function e(){a(Nn(t,r,s))}function n(){c.addEventListener("selectionchange",e)}function o(){c.removeEventListener("selectionchange",e)}const{ownerDocument:c}=t;return(t===c.activeElement||!l&&i||l&&!i)&&(a(Nn(t,r,s)),n()),t.addEventListener("focusin",n),t.addEventListener("focusout",o),()=>{o(),t.removeEventListener("focusin",n),t.removeEventListener("focusout",o)}},[t,r,s,i,l]),o}function Dn({record:e}){const t=b.useRef(),{activeFormats:n=[],replacements:r,start:s}=e.current,i=r[s];return b.useEffect(()=>{if(!(n&&n.length||i))return;const e="*[data-rich-text-format-boundary]",r=t.current.querySelector(e);if(!r)return;const{ownerDocument:s}=r,{defaultView:o}=s,a=o.getComputedStyle(r),l=`${`.rich-text:focus ${e}`} {${`background-color: ${xt(a.color).alpha(.2).toRgbString()}`}}`,c="rich-text-boundary-style";let u=s.getElementById(c);u||(u=s.createElement("style"),u.id=c,s.head.appendChild(u)),u.innerHTML!==l&&(u.innerHTML=l)},[n,i]),t}const On=[];const Fn=new Set(["insertParagraph","insertOrderedList","insertUnorderedList","insertHorizontalRule","insertLink"]),Pn=[],An="data-rich-text-placeholder";const In=[e=>t=>{function n(n){const{record:r}=e.current,{ownerDocument:s}=t;if(dn(r.current)||!t.contains(s.activeElement))return;const i=mn(r.current),o=Qt(i),a=Ht({value:i});n.clipboardData.setData("text/plain",o),n.clipboardData.setData("text/html",a),n.clipboardData.setData("rich-text","true"),n.preventDefault(),"cut"===n.type&&s.execCommand("delete")}const{defaultView:r}=t.ownerDocument;return r.addEventListener("copy",n),r.addEventListener("cut",n),()=>{r.removeEventListener("copy",n),r.removeEventListener("cut",n)}},()=>e=>{function t(t){const{target:n}=t;if(n===e||n.textContent&&n.isContentEditable)return;const{ownerDocument:r}=n,{defaultView:s}=r,i=s.getSelection();if(i.containsNode(n))return;const o=r.createRange(),a=n.isContentEditable?n:n.closest("[contenteditable]");o.selectNode(a),i.removeAllRanges(),i.addRange(o),t.preventDefault()}function n(n){n.relatedTarget&&!e.contains(n.relatedTarget)&&"A"===n.relatedTarget.tagName&&t(n)}return e.addEventListener("click",t),e.addEventListener("focusin",n),()=>{e.removeEventListener("click",t),e.removeEventListener("focusin",n)}},e=>t=>{function n(n){const{keyCode:r,shiftKey:s,altKey:i,metaKey:o,ctrlKey:a}=n;if(s||i||o||a||r!==L&&r!==j)return;const{record:l,applyRecord:c,forceRender:u}=e.current,{text:d,formats:f,start:g,end:p,activeFormats:h=[]}=l.current,m=dn(l.current),{ownerDocument:b}=t,{defaultView:v}=b,{direction:x}=v.getComputedStyle(t),y="rtl"===x?j:L,k=n.keyCode===y;if(m&&0===h.length){if(0===g&&k)return;if(p===d.length&&!k)return}if(!m)return;const _=f[g-1]||On,S=f[g]||On,E=k?_:S,C=h.every((e,t)=>e===E[t]);let w=h.length;if(C?w<E.length&&w++:w--,w===h.length)return void(l.current._newActiveFormats=E);n.preventDefault();const T=(C?E:k?S:_).slice(0,w),N={...l.current,activeFormats:T};l.current=N,c(N),u()}return t.addEventListener("keydown",n),()=>{t.removeEventListener("keydown",n)}},e=>t=>{function n(t){const{keyCode:n}=t,{createRecord:r,handleChange:s}=e.current;if(t.defaultPrevented)return;if(n!==N&&n!==R)return;const i=r(),{start:o,end:a,text:l}=i;0===o&&0!==a&&a===l.length&&(s(hn(i)),t.preventDefault())}return t.addEventListener("keydown",n),()=>{t.removeEventListener("keydown",n)}},e=>t=>{const{ownerDocument:n}=t,{defaultView:r}=n;let s=!1;function i(t){if(s)return;let n;t&&(n=t.inputType);const{record:r,applyRecord:i,createRecord:o,handleChange:a}=e.current;if(n&&(0===n.indexOf("format")||Fn.has(n)))return void i(r.current);const l=o(),{start:c,activeFormats:u=[]}=r.current,d=function({value:e,start:t,end:n,formats:r}){const s=Math.min(t,n),i=Math.max(t,n),o=e.formats[s-1]||[],a=e.formats[i]||[];for(e.activeFormats=r.map((e,t)=>{if(o[t]){if(Rt(e,o[t]))return o[t]}else if(a[t]&&Rt(e,a[t]))return a[t];return e});--n>=t;)e.activeFormats.length>0?e.formats[n]=e.activeFormats:delete e.formats[n];return e}({value:l,start:c,end:l.start,formats:u});a(d)}function o(){const{record:a,applyRecord:l,createRecord:c,onSelectionChange:u}=e.current;if("true"!==t.contentEditable)return;if(n.activeElement!==t)return void n.removeEventListener("selectionchange",o);if(s)return;const{start:d,end:f,text:g}=c(),p=a.current;if(g!==p.text)return void i();if(d===p.start&&f===p.end)return void(0===p.text.length&&0===d&&function(e){const t=e.getSelection(),{anchorNode:n,anchorOffset:r}=t;if(n.nodeType!==n.ELEMENT_NODE)return;const s=n.childNodes[r];s&&s.nodeType===s.ELEMENT_NODE&&s.hasAttribute(An)&&t.collapseToStart()}(r));const h={...p,start:d,end:f,activeFormats:p._newActiveFormats,_newActiveFormats:void 0},m=Pt(h,Pn);h.activeFormats=m,a.current=h,l(h,{domOnly:!0}),u(d,f)}function a(){s=!0,n.removeEventListener("selectionchange",o),t.querySelector(`[${An}]`)?.remove()}function l(){s=!1,i({inputType:"insertText"}),n.addEventListener("selectionchange",o)}function c(){const{record:r,isSelected:s,onSelectionChange:i,applyRecord:a}=e.current;if(!t.parentElement.closest('[contenteditable="true"]')){if(s)a(r.current,{domOnly:!0});else{const e=void 0;r.current={...r.current,start:e,end:e,activeFormats:Pn}}i(r.current.start,r.current.end),window.queueMicrotask(o),n.addEventListener("selectionchange",o)}}return t.addEventListener("input",i),t.addEventListener("compositionstart",a),t.addEventListener("compositionend",l),t.addEventListener("focus",c),()=>{t.removeEventListener("input",i),t.removeEventListener("compositionstart",a),t.removeEventListener("compositionend",l),t.removeEventListener("focus",c)}},()=>e=>{const{ownerDocument:t}=e,{defaultView:n}=t,r=n?.getSelection();let s;function i(){return r.rangeCount?r.getRangeAt(0):null}function o(e){const n="keydown"===e.type?"keyup":"pointerup";function r(){t.removeEventListener(n,o),t.removeEventListener("selectionchange",r),t.removeEventListener("input",r)}function o(){r(),vn(s,i())||t.dispatchEvent(new Event("selectionchange"))}t.addEventListener(n,o),t.addEventListener("selectionchange",r),t.addEventListener("input",r),s=i()}return e.addEventListener("pointerdown",o),e.addEventListener("keydown",o),()=>{e.removeEventListener("pointerdown",o),e.removeEventListener("keydown",o)}},function(){return e=>{const{ownerDocument:t}=e,{defaultView:n}=t;let r=null;function s(t){t.defaultPrevented||t.target!==e&&t.target.contains(e)&&(r=e.getAttribute("contenteditable"),e.setAttribute("contenteditable","false"),n.getSelection().removeAllRanges())}function i(){null!==r&&(e.setAttribute("contenteditable",r),r=null)}return n.addEventListener("pointerdown",s),n.addEventListener("pointerup",i),()=>{n.removeEventListener("pointerdown",s),n.removeEventListener("pointerup",i)}}}];function Mn(e){const n=b.useRef(e);b.useInsertionEffect(()=>{n.current=e});const r=b.useMemo(()=>In.map(e=>e(n)),[n]);return t(e=>{const t=r.map(t=>t(e));return()=>{t.forEach(e=>e())}},[r])}function $n(e){if(e.includes(" "))return!1;const t=Ze(e),n=tt(t),r=function(e,t=6){const n=e.split(/[?#]/)[0];return new RegExp(`(?<=\\S)\\.(?:[a-zA-Z_]{2,${t}})(?:\\/|$)`).test(n)}(e),s=e?.startsWith("www."),i=e?.startsWith("#")&&et(e);return n||s||i||r}function Vn({children:e,settingsOpen:t,setSettingsOpen:n}){const i=r(),o=i?b.Fragment:we,a=i?"div":Ce.div,l=`link-control-settings-drawer-${s(Vn)}`;return v.jsxs(v.Fragment,{children:[v.jsx(D,{__next40pxDefaultSize:!0,className:"block-editor-link-control__drawer-toggle","aria-expanded":t,onClick:()=>n(!t),icon:F()?De:Oe,"aria-controls":l,children:O("Advanced","Additional link settings")}),v.jsx(o,{children:t&&v.jsx(a,{className:"block-editor-link-control__drawer",hidden:!t,id:l,initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{duration:.1},children:v.jsx("div",{className:"block-editor-link-control__drawer-inner",children:e})})})]})}const Hn=({searchTerm:e,onClick:t,itemProps:n,buttonText:r})=>{if(!e)return null;let s;return s=r?"function"==typeof r?r(e):r:P(A(I("Create: <mark>%s</mark>"),e),{mark:v.jsx("mark",{})}),v.jsx(Te,{...n,iconPosition:"left",icon:Fe,className:"block-editor-link-control__search-item",onClick:t,children:s})},Bn={post:$e,page:Me,post_tag:Ie,category:Ae,attachment:Pe};function Un({isURL:e,suggestion:t}){let n=null;return e?n=Ve:t.type in Bn&&(n=Bn[t.type],"page"===t.type&&(t.isFrontPage&&(n=He),t.isBlogHome&&(n=Be))),n?v.jsx(V,{className:"block-editor-link-control__search-item-icon",icon:n}):null}function zn(e){const t=e?.trim();return t?.length?e?.replace(/^\/?/,"/"):e}function Wn(e){const t=e?.trim();return t?.length?e?.replace(/\/$/,""):e}const Kn=({itemProps:e,suggestion:t,searchTerm:n,onClick:r,isURL:s=!1,shouldShowType:o=!1})=>{const a=s?I("Press ENTER to add this link"):(l=t.url)?i(nt,rt,(c="",e=>null==e||e!=e?c:e),((e,...t)=>(...n)=>e(...n,...t))(st,24),Wn,zn)(l):l;var l,c;return v.jsx(Te,{...e,info:a,iconPosition:"left",icon:v.jsx(Un,{suggestion:t,isURL:s}),onClick:r,shortcut:o&&qn(t),className:"block-editor-link-control__search-item",children:v.jsx(M,{text:$(t.title),highlight:n})})};function qn(e){return e.isFrontPage?"front page":e.isBlogHome?"blog home":"post_tag"===e.type?"tag":e.type}const Xn="__CREATE__",Yn="link",Gn="mailto",Qn="internal",Jn=[Yn,Gn,"tel",Qn],Zn=[{id:"opensInNewTab",title:I("Open in new tab")}];function er({instanceId:e,withCreateSuggestion:t,currentInputValue:n,handleSuggestionClick:r,suggestionsListProps:s,buildSuggestionItemProps:i,suggestions:o,selectedSuggestion:a,isLoading:l,isInitialSuggestions:c,createSuggestionButtonText:u,suggestionsQuery:d}){const f=y("block-editor-link-control__search-results",{"is-loading":l}),g=1===o.length&&Jn.includes(o[0].type),p=t&&!g&&!c,h=!d?.type,m=`block-editor-link-control-search-results-label-${e}`,b=c?I("Suggestions"):A(I('Search results for "%s"'),n),x=v.jsx(H,{id:m,children:b});return v.jsxs("div",{className:"block-editor-link-control__search-results-wrapper",children:[x,v.jsx("div",{...s,className:f,"aria-labelledby":m,children:v.jsx(Le,{children:o.map((e,t)=>p&&Xn===e.type?v.jsx(Hn,{searchTerm:n,buttonText:u,onClick:()=>r(e),itemProps:i(e,t),isSelected:t===a},e.type):Xn===e.type?null:v.jsx(Kn,{itemProps:i(e,t),suggestion:e,index:t,onClick:()=>{r(e)},isSelected:t===a,isURL:Jn.includes(e.type),searchTerm:n,shouldShowType:h,isFrontPage:e?.isFrontPage,isBlogHome:e?.isBlogHome},`${e.id}-${e.type}`))})})]})}const tr=()=>Promise.resolve([]),nr=e=>{let t=Yn;const n=Ze(e)||"";return n.includes("mailto")&&(t=Gn),n.includes("tel")&&(t="tel"),e?.startsWith("#")&&(t=Qn),Promise.resolve([{id:e,title:e,url:"URL"===t?it(e):e,type:t}])};function rr(e,t,n){const{fetchSearchSuggestions:r,pageOnFront:s,pageForPosts:i}=B(e=>{const{getSettings:t}=e(ut);return{pageOnFront:t().pageOnFront,pageForPosts:t().pageForPosts,fetchSearchSuggestions:t().__experimentalFetchLinkSuggestions}},[]),o=t?nr:tr;return b.useCallback((t,{isInitialSuggestions:a})=>$n(t)?o(t):(async(e,t,n,r,s,i)=>{const{isInitialSuggestions:o}=t,a=await n(e,t);return a.map(e=>Number(e.id)===s?(e.isFrontPage=!0,e):Number(e.id)===i?(e.isBlogHome=!0,e):e),o||$n(e)||!r?a:a.concat({title:e,url:e,type:Xn})})(t,{...e,isInitialSuggestions:a},r,n,s,i),[o,r,s,i,e,n])}const sr=()=>Promise.resolve([]),ir=()=>{},or=b.forwardRef(({value:e,children:t,currentLink:n={},className:r=null,placeholder:i=null,withCreateSuggestion:o=!1,onCreateSuggestion:a=ir,onChange:l=ir,onSelect:c=ir,showSuggestions:u=!0,renderSuggestions:d=e=>v.jsx(er,{...e}),fetchSuggestions:f=null,allowDirectEntry:g=!0,showInitialSuggestions:p=!1,suggestionsQuery:h={},withURLSuggestion:m=!0,createSuggestionButtonText:x,hideLabelFromVision:y=!1,suffix:k},_)=>{const S=rr(h,g,o),E=u?f||S:sr,C=s(or),[w,T]=b.useState(),L=async e=>{let t=e;if(Xn!==e.type){if(g||t&&Object.keys(t).length>=1){const{id:e,url:r,...s}=null!=n?n:{};c({...s,...t},t)}}else try{t=await a(e.title),t?.url&&c(t)}catch(r){}};return v.jsxs("div",{className:"block-editor-link-control__search-input-container",children:[v.jsx(Sr,{disableSuggestions:n?.url===e,label:I("Link"),hideLabelFromVision:y,className:r,value:e,onChange:(e,t)=>{l(e),T(t)},placeholder:null!=i?i:I("Search or type URL"),__experimentalRenderSuggestions:u?e=>d({...e,instanceId:C,withCreateSuggestion:o,createSuggestionButtonText:x,suggestionsQuery:h,handleSuggestionClick:t=>{e.handleSuggestionClick&&e.handleSuggestionClick(t),L(t)}}):null,__experimentalFetchLinkSuggestions:E,__experimentalHandleURLSuggestions:!0,__experimentalShowInitialSuggestions:p,onSubmit:(t,n)=>{const r=t||w;r||e?.trim()?.length?L(r||{url:e}):n.preventDefault()},ref:_,suffix:k}),t]})}),{Slot:ar,Fill:lr}=U("BlockEditorLinkControlViewer");function cr(e,t){switch(t.type){case"RESOLVED":return{...e,isFetching:!1,richData:t.richData};case"ERROR":return{...e,isFetching:!1,richData:null};case"LOADING":return{...e,isFetching:!0};default:throw new Error(`Unexpected action type ${t.type}`)}}function ur({value:e,onEditClick:t,hasRichPreviews:n=!1,hasUnlinkControl:r=!1,onRemove:s}){const i=B(e=>e(ot).get("core","showIconLabels"),[]),o=n?e?.url:null,{richData:a,isFetching:l}=function(e){const[t,n]=b.useReducer(cr,{richData:null,isFetching:!1}),{fetchRichUrlData:r}=B(e=>{const{getSettings:t}=e(ut);return{fetchRichUrlData:t().__experimentalFetchRichUrlData}},[]);return b.useEffect(()=>{if(e?.length&&r&&"undefined"!=typeof AbortController){n({type:"LOADING"});const t=new window.AbortController,s=t.signal;return r(e,{signal:s}).then(e=>{n({type:"RESOLVED",richData:e})}).catch(()=>{s.aborted||n({type:"ERROR"})}),()=>{t.abort()}}},[e]),t}(o),c=a&&Object.keys(a).length,u=e&&st(nt(e.url),24)||"",d=!e?.url?.length,f=!d&&$(a?.title||e?.title||u),g=!e?.url||f.replace(/^[a-z\-.\+]+[0-9]*:(\/\/)?/i,"").replace(/^www\./i,"")===u;let p;p=a?.icon?v.jsx("img",{src:a?.icon,alt:""}):d?v.jsx(V,{icon:Ke,size:32}):v.jsx(V,{icon:Ve});const{createNotice:h}=z(at),m=dt(e.url,()=>{h("info",I("Link copied to clipboard."),{isDismissible:!0,type:"snackbar"})});return v.jsx("div",{"aria-label":I("Currently selected"),className:y("block-editor-link-control__search-item",{"is-current":!0,"is-rich":c,"is-fetching":!!l,"is-preview":!0,"is-error":d,"is-url-title":f===u}),children:v.jsxs("div",{className:"block-editor-link-control__search-item-top",children:[v.jsxs("span",{className:"block-editor-link-control__search-item-header",children:[v.jsx("span",{className:y("block-editor-link-control__search-item-icon",{"is-image":a?.icon}),children:p}),v.jsx("span",{className:"block-editor-link-control__search-item-details",children:d?v.jsx("span",{className:"block-editor-link-control__search-item-error-notice",children:I("Link is empty")}):v.jsxs(v.Fragment,{children:[v.jsx(W,{className:"block-editor-link-control__search-item-title",href:e.url,children:v.jsx(K,{numberOfLines:1,children:f})}),!g&&v.jsx("span",{className:"block-editor-link-control__search-item-info",children:v.jsx(K,{numberOfLines:1,children:u})})]})})]}),v.jsx(D,{icon:Ue,label:I("Edit link"),onClick:t,size:"compact"}),r&&v.jsx(D,{icon:ze,label:I("Remove link"),onClick:s,size:"compact"}),v.jsx(D,{icon:We,label:A(I("Copy link%s"),d||i?"":": "+e.url),ref:m,accessibleWhenDisabled:!0,disabled:d,size:"compact"}),v.jsx(ar,{fillProps:e})]})})}const dr=()=>{},fr=({value:e,onChange:t=dr,settings:n})=>{if(!n||!n.length)return null;const r=n=>r=>{t({...e,[n.id]:r})},s=n.map(t=>v.jsx(q,{__nextHasNoMarginBottom:!0,className:"block-editor-link-control__setting",label:t.title,onChange:r(t),checked:!!e&&!!e[t.id],help:t?.help},t.id));return v.jsxs("fieldset",{className:"block-editor-link-control__settings",children:[v.jsx(H,{as:"legend",children:I("Currently selected link settings")}),s]})};const gr=e=>{let t=!1;return{promise:new Promise((n,r)=>{e.then(e=>t?r({isCanceled:!0}):n(e),e=>r(t?{isCanceled:!0}:e))}),cancel(){t=!0}}};var pr,hr;const mr=x(hr?pr:(hr=1,pr=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,s,i;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(s=r;0!==s--;)if(!e(t[s],n[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(i=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(s=r;0!==s--;)if(!Object.prototype.hasOwnProperty.call(n,i[s]))return!1;for(s=r;0!==s--;){var o=i[s];if(!e(t[o],n[o]))return!1}return!0}return t!=t&&n!=n}));const br=()=>{},vr="core/block-editor",xr="linkControlSettingsDrawer";function yr({searchInputPlaceholder:e,value:t,settings:n=Zn,onChange:r=br,onRemove:s,onCancel:i,noDirectEntry:o=!1,showSuggestions:a=!0,showInitialSuggestions:l,forceIsEditingLink:c,createSuggestion:u,withCreateSuggestion:d,inputValue:f="",suggestionsQuery:g={},noURLSuggestion:p=!1,createSuggestionButtonText:h,hasRichPreviews:m=!1,hasTextControl:x=!1,renderControlBottom:k=null}){void 0===d&&u&&(d=!0);const[_,S]=b.useState(!1),{advancedSettingsPreference:E}=B(e=>{var t;return{advancedSettingsPreference:null!==(t=e(ot).get(vr,xr))&&void 0!==t&&t}},[]),{set:C}=z(ot),w=E||_,T=b.useRef(!0),L=b.useRef(),j=b.useRef(),N=b.useRef(!1),R=n.map(({id:e})=>e),[O,F,P,A,M]=function(e){const[t,n]=b.useState(e||{}),[r,s]=b.useState(e);return mr(e,r)||(s(e),n(e)),[t,n,e=>{n({...t,url:e})},e=>{n({...t,title:e})},e=>r=>{const s=Object.keys(r).reduce((t,n)=>(e.includes(n)&&(t[n]=r[n]),t),{});n({...t,...s})}]}(t),$=t&&!X(O,t),[V,H]=b.useState(void 0!==c?c:!t||!t.url),{createPage:U,isCreatingPage:W,errorMessage:K}=function(e){const t=b.useRef(),[n,r]=b.useState(!1),[s,i]=b.useState(null);return b.useEffect(()=>()=>{t.current&&t.current.cancel()},[]),{createPage:async function(n){r(!0),i(null);try{return t.current=gr(Promise.resolve(e(n))),await t.current.promise}catch(s){if(s&&s.isCanceled)return;throw i(s.message||I("An unknown error occurred during creation. Please try again.")),s}finally{r(!1)}},isCreatingPage:n,errorMessage:s}}(u);b.useEffect(()=>{void 0!==c&&H(c)},[c]),b.useEffect(()=>{if(T.current)return;(Y.focusable.find(L.current)[0]||L.current).focus(),N.current=!1},[V,W]),b.useEffect(()=>(T.current=!1,()=>{T.current=!0}),[]);const q=t?.url?.trim()?.length>0,ne=()=>{N.current=!!L.current?.contains(L.current.ownerDocument.activeElement),H(!1)},re=()=>{$&&r({...t,...O,url:se}),ne()},se=f||O?.url||"",ie=!se?.trim()?.length,oe=s&&t&&!V&&!W,ae=V&&q,le=q&&x,ce=(V||!t)&&!W,ue=!$||ie,de=!!n?.length&&V&&q;return v.jsxs("div",{tabIndex:-1,ref:L,className:"block-editor-link-control",children:[W&&v.jsxs("div",{className:"block-editor-link-control__loading",children:[v.jsx(G,{})," ",I("Creating"),"â¦"]}),ce&&v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:y({"block-editor-link-control__search-input-wrapper":!0,"has-text-control":le,"has-actions":ae}),children:[le&&v.jsx(Q,{__nextHasNoMarginBottom:!0,ref:j,className:"block-editor-link-control__field block-editor-link-control__text-content",label:I("Text"),value:O?.title,onChange:A,onKeyDown:e=>{const{keyCode:t}=e;t!==te||ie||(e.preventDefault(),re())},__next40pxDefaultSize:!0}),v.jsx(or,{currentLink:t,className:"block-editor-link-control__field block-editor-link-control__search-input",placeholder:e,value:se,withCreateSuggestion:d,onCreateSuggestion:U,onChange:P,onSelect:e=>{const t=Object.keys(e).reduce((t,n)=>(R.includes(n)||(t[n]=e[n]),t),{});r({...O,...t,title:O?.title||e?.title}),ne()},showInitialSuggestions:l,allowDirectEntry:!o,showSuggestions:a,suggestionsQuery:g,withURLSuggestion:!p,createSuggestionButtonText:h,hideLabelFromVision:!le,suffix:ae?void 0:v.jsx(J,{variant:"control",children:v.jsx(D,{onClick:ue?br:re,label:I("Submit"),icon:qe,className:"block-editor-link-control__search-submit","aria-disabled":ue,size:"small"})})})]}),K&&v.jsx(Z,{className:"block-editor-link-control__search-error",status:"error",isDismissible:!1,children:K})]}),t&&!V&&!W&&v.jsx(ur,{value:t,onEditClick:()=>H(!0),hasRichPreviews:m,hasUnlinkControl:oe,onRemove:()=>{s(),H(!0)}},t?.url),de&&v.jsx("div",{className:"block-editor-link-control__tools",children:!ie&&v.jsx(Vn,{settingsOpen:w,setSettingsOpen:e=>{C&&C(vr,xr,e),S(e)},children:v.jsx(fr,{value:O,settings:n,onChange:M(R)})})}),ae&&v.jsxs(ee,{justify:"right",className:"block-editor-link-control__search-actions",children:[v.jsx(D,{__next40pxDefaultSize:!0,variant:"tertiary",onClick:e=>{e.preventDefault(),e.stopPropagation(),F(t),q?ne():s?.(),i?.()},children:I("Cancel")}),v.jsx(D,{__next40pxDefaultSize:!0,variant:"primary",onClick:ue?br:re,className:"block-editor-link-control__search-submit","aria-disabled":ue,children:I("Save")})]}),!W&&k&&k()]})}function kr(e){return"function"==typeof e}yr.ViewerFill=lr,yr.DEFAULT_LINK_SETTINGS=Zn;class _r extends b.Component{constructor(e){super(e),this.onChange=this.onChange.bind(this),this.onFocus=this.onFocus.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.selectLink=this.selectLink.bind(this),this.handleOnClick=this.handleOnClick.bind(this),this.bindSuggestionNode=this.bindSuggestionNode.bind(this),this.autocompleteRef=e.autocompleteRef||b.createRef(),this.inputRef=b.createRef(),this.updateSuggestions=u(this.updateSuggestions.bind(this),200),this.suggestionNodes=[],this.suggestionsRequest=null,this.state={suggestions:[],showSuggestions:!1,suggestionsValue:null,selectedSuggestion:null,suggestionsListboxId:"",suggestionOptionIdPrefix:""}}componentDidUpdate(e){const{showSuggestions:t,selectedSuggestion:n}=this.state,{value:r,__experimentalShowInitialSuggestions:s=!1}=this.props;t&&null!==n&&this.suggestionNodes[n]&&this.suggestionNodes[n].scrollIntoView({behavior:"instant",block:"nearest",inline:"nearest"}),e.value===r||this.props.disableSuggestions||(r?.length?this.updateSuggestions(r):s&&this.updateSuggestions())}componentDidMount(){this.shouldShowInitialSuggestions()&&this.updateSuggestions()}componentWillUnmount(){this.suggestionsRequest?.cancel?.(),this.suggestionsRequest=null}bindSuggestionNode(e){return t=>{this.suggestionNodes[e]=t}}shouldShowInitialSuggestions(){const{__experimentalShowInitialSuggestions:e=!1,value:t}=this.props;return e&&!(t&&t.length)}updateSuggestions(e=""){const{__experimentalFetchLinkSuggestions:t,__experimentalHandleURLSuggestions:n}=this.props;if(!t)return;const r=!e?.length;if(e=e.trim(),!r&&(e.length<2||!n&&lt(e)))return this.suggestionsRequest?.cancel?.(),this.suggestionsRequest=null,void this.setState({suggestions:[],showSuggestions:!1,suggestionsValue:e,selectedSuggestion:null,loading:!1});this.setState({selectedSuggestion:null,loading:!0});const s=t(e,{isInitialSuggestions:r});s.then(t=>{this.suggestionsRequest===s&&(this.setState({suggestions:t,suggestionsValue:e,loading:!1,showSuggestions:!!t.length}),t.length?this.props.debouncedSpeak(A(re("%d result found, use up and down arrow keys to navigate.","%d results found, use up and down arrow keys to navigate.",t.length),t.length),"assertive"):this.props.debouncedSpeak(I("No results."),"assertive"))}).catch(()=>{this.suggestionsRequest===s&&this.setState({loading:!1})}).finally(()=>{this.suggestionsRequest===s&&(this.suggestionsRequest=null)}),this.suggestionsRequest=s}onChange(e){this.props.onChange(e)}onFocus(){const{suggestions:e}=this.state,{disableSuggestions:t,value:n}=this.props;!n||t||e&&e.length||null!==this.suggestionsRequest||this.updateSuggestions(n)}onKeyDown(e){this.props.onKeyDown?.(e);const{showSuggestions:t,selectedSuggestion:n,suggestions:r,loading:s}=this.state;if(!t||!r.length||s){switch(e.keyCode){case ie:0!==e.target.selectionStart&&(e.preventDefault(),e.target.setSelectionRange(0,0));break;case se:this.props.value.length!==e.target.selectionStart&&(e.preventDefault(),e.target.setSelectionRange(this.props.value.length,this.props.value.length));break;case te:this.props.onSubmit&&(e.preventDefault(),this.props.onSubmit(null,e))}return}const i=this.state.suggestions[this.state.selectedSuggestion];switch(e.keyCode){case ie:{e.preventDefault();const t=n?n-1:r.length-1;this.setState({selectedSuggestion:t});break}case se:{e.preventDefault();const t=null===n||n===r.length-1?0:n+1;this.setState({selectedSuggestion:t});break}case oe:null!==this.state.selectedSuggestion&&(this.selectLink(i),this.props.speak(I("Link selected.")));break;case te:e.preventDefault(),null!==this.state.selectedSuggestion?(this.selectLink(i),this.props.onSubmit&&this.props.onSubmit(i,e)):this.props.onSubmit&&this.props.onSubmit(null,e)}}selectLink(e){this.props.onChange(e.url,e),this.setState({selectedSuggestion:null,showSuggestions:!1})}handleOnClick(e){this.selectLink(e),this.inputRef.current.focus()}static getDerivedStateFromProps({value:e,instanceId:t,disableSuggestions:n,__experimentalShowInitialSuggestions:r=!1},{showSuggestions:s}){let i=s;const o=e&&e.length;return r||o||(i=!1),!0===n&&(i=!1),{showSuggestions:i,suggestionsListboxId:`block-editor-url-input-suggestions-${t}`,suggestionOptionIdPrefix:`block-editor-url-input-suggestion-${t}`}}render(){return v.jsxs(v.Fragment,{children:[this.renderControl(),this.renderSuggestions()]})}renderControl(){const{label:e=null,className:t,isFullWidth:n,instanceId:r,placeholder:s=I("Paste URL or type to search"),__experimentalRenderControl:i,value:o="",hideLabelFromVision:a=!1}=this.props,{loading:l,showSuggestions:c,selectedSuggestion:u,suggestionsListboxId:d,suggestionOptionIdPrefix:f}=this.state,g=`url-input-control-${r}`,p={id:g,label:e,className:y("block-editor-url-input",t,{"is-full-width":n}),hideLabelFromVision:a},h={id:g,value:o,required:!0,type:"text",onChange:this.onChange,onFocus:this.onFocus,placeholder:s,onKeyDown:this.onKeyDown,role:"combobox","aria-label":e?void 0:I("URL"),"aria-expanded":c,"aria-autocomplete":"list","aria-owns":d,"aria-activedescendant":null!==u?`${f}-${u}`:void 0,ref:this.inputRef,suffix:this.props.suffix};return i?i(p,h,l):v.jsxs(ae,{__nextHasNoMarginBottom:!0,...p,children:[v.jsx(le,{...h,__next40pxDefaultSize:!0}),l&&v.jsx(G,{})]})}renderSuggestions(){const{className:e,__experimentalRenderSuggestions:t}=this.props,{showSuggestions:n,suggestions:r,suggestionsValue:s,selectedSuggestion:i,suggestionsListboxId:o,suggestionOptionIdPrefix:a,loading:l}=this.state;if(!n||0===r.length)return null;const c={id:o,ref:this.autocompleteRef,role:"listbox"},u=(e,t)=>({role:"option",tabIndex:"-1",id:`${a}-${t}`,ref:this.bindSuggestionNode(t),"aria-selected":t===i||void 0});return kr(t)?t({suggestions:r,selectedSuggestion:i,suggestionsListProps:c,buildSuggestionItemProps:u,isLoading:l,handleSuggestionClick:this.handleOnClick,isInitialSuggestions:!s?.length,currentInputValue:s}):v.jsx(je,{placement:"bottom",focusOnMount:!1,children:v.jsx("div",{...c,className:y("block-editor-url-input__suggestions",`${e}__suggestions`),children:r.map((e,t)=>b.createElement(D,{__next40pxDefaultSize:!0,...u(0,t),key:e.id,className:y("block-editor-url-input__suggestion",{"is-selected":t===i}),onClick:()=>this.handleOnClick(e)},e.title))})})}}const Sr=o(a,l,c,ne((e,t)=>{if(kr(t.__experimentalFetchLinkSuggestions))return;const{getSettings:n}=e(ut);return{__experimentalFetchLinkSuggestions:n().__experimentalFetchLinkSuggestions}}))(_r),Er={placement:"bottom-start"},Cr=()=>v.jsxs(v.Fragment,{children:[["bold","italic","link","unknown"].map(e=>v.jsx(ce,{name:`RichText.ToolbarControls.${e}`},e)),v.jsx(ce,{name:"RichText.ToolbarControls",children:e=>{if(!e.length)return null;const t=e.map(([{props:e}])=>e).some(({isActive:e})=>e);return v.jsx(ue,{children:n=>v.jsx(Ct,{icon:Xe,label:I("More"),toggleProps:{...n,className:y(n.className,{"is-pressed":t}),description:I("Displays more block tools")},controls:d(e.map(([{props:e}])=>e),"title"),popoverProps:Er})})}})]});function wr({popoverAnchor:e}){return v.jsx(je,{placement:"top",focusOnMount:!1,anchor:e,className:"block-editor-rich-text__inline-format-toolbar",__unstableSlotName:"block-toolbar",children:v.jsx(fe,{className:"block-editor-rich-text__inline-format-toolbar-group","aria-label":I("Format tools"),children:v.jsx(ge,{children:v.jsx(Cr,{})})})})}const Tr=({inline:e,editableContentElement:t})=>e?v.jsx(wr,{popoverAnchor:t}):v.jsx(de,{group:"inline",children:v.jsx(Cr,{})});function Lr(e){return e(Nt).getFormatTypes()}const jr=new Set(["a","audio","button","details","embed","iframe","input","label","select","textarea","video"]);function Nr(e,t){return e[t]?e[t]:Object.keys(e).filter(e=>e.startsWith(t+".")).reduce((n,r)=>(n[r.slice(t.length+1)]=e[r],n),{})}const Rr=["`",'"',"'","ââ","ââ"];function Dr(e){let t=e.length;for(;t--;){const n=p(e[t].attributes);if(n)return e[t].attributes[n]=e[t].attributes[n].toString().replace(g,""),[e[t].clientId,n,0,0];const r=Dr(e[t].innerBlocks);if(r)return r}return[]}function Or(e){if(!0===e||"p"===e||"li"===e)return!0===e?"p":e}function Fr({allowedFormats:e,disableFormats:t}){return t?Fr.EMPTY_ARRAY:e}Fr.EMPTY_ARRAY=[];const Pr=[e=>t=>{function n(n){const{inputType:r,data:s}=n,{value:i,onChange:o,registry:a}=e.current;if("insertText"!==r)return;if(dn(i))return;const l=f("blockEditor.wrapSelectionSettings",Rr).find(([e,t])=>e===s||t===s);if(!l)return;const[c,u=c]=l,d=i.start,g=i.end+c.length;let p=pn(i,c,d,d);p=pn(p,u,g,g);const{__unstableMarkLastChangeAsPersistent:h,__unstableMarkAutomaticChange:m}=a.dispatch(ut);h(),o(p),m();const b={};for(const e in n)b[e]=n[e];b.data=u;const{ownerDocument:v}=t,{defaultView:x}=v,y=new x.InputEvent("input",b);window.queueMicrotask(()=>{n.target.dispatchEvent(y)}),n.preventDefault()}return t.addEventListener("beforeinput",n),()=>{t.removeEventListener("beforeinput",n)}},e=>t=>{function n(){const{getValue:t,onReplace:n,selectionChange:r,registry:s}=e.current;if(!n)return;const i=t(),{start:o,text:a}=i;if(" "!==a.slice(o-1,o))return;const l=a.slice(0,o).trim(),c=ft("from").filter(({type:e})=>"prefix"===e),u=gt(c,({prefix:e})=>l===e);if(!u)return;const d=Ht({value:pn(i,g,0,o)}),f=u.transform(d);return r(...Dr([f])),n([f]),s.dispatch(ut).__unstableMarkAutomaticChange(),!0}function r(t){const{inputType:r,type:s}=t,{getValue:i,onChange:o,__unstableAllowPrefixTransformations:a,formatTypes:l,registry:c}=e.current;if("insertText"!==r&&"compositionend"!==s)return;if(a&&n())return;const u=i(),d=l.reduce((e,{__unstableInputRule:t})=>(t&&(e=t(e)),e),function(e){const t="tales of gutenberg",{start:n,text:r}=e;return n<18||r.slice(n-18,n).toLowerCase()!==t?e:pn(e," ð¡ð¢ð¦ð¤ð¦ðð§ð¹ð¦ð¦ð¦ð¼ð¿ðð´ððð¦ð¦ð±ðÏððð§ð¥¨ððð ð¥¦ð¥ð¥ðð¥¥ð¥ðµð¥ðð¯ð¾ð²ðºðð®âï¸")}(u)),{__unstableMarkLastChangeAsPersistent:f,__unstableMarkAutomaticChange:g}=c.dispatch(ut);d!==u&&(f(),o({...d,activeFormats:u.activeFormats}),g())}return t.addEventListener("input",r),t.addEventListener("compositionend",r),()=>{t.removeEventListener("input",r),t.removeEventListener("compositionend",r)}},e=>t=>{function n(t){if("insertReplacementText"!==t.inputType)return;const{registry:n}=e.current;n.dispatch(ut).__unstableMarkLastChangeAsPersistent()}return t.addEventListener("beforeinput",n),()=>{t.removeEventListener("beforeinput",n)}},()=>e=>{function t(e){(pe.primary(e,"z")||pe.primary(e,"y")||pe.primaryShift(e,"z"))&&e.preventDefault()}return e.addEventListener("keydown",t),()=>{e.removeEventListener("keydown",t)}},e=>t=>{const{keyboardShortcuts:n}=e.current;function r(e){for(const t of n.current)t(e)}return t.addEventListener("keydown",r),()=>{t.removeEventListener("keydown",r)}},e=>t=>{const{inputEvents:n}=e.current;function r(e){for(const t of n.current)t(e)}return t.addEventListener("input",r),()=>{t.removeEventListener("input",r)}},e=>t=>{function n(t){const{keyCode:n}=t;if(t.defaultPrevented)return;if(n!==R&&n!==he)return;const{registry:r}=e.current,{didAutomaticChange:s,getSettings:i}=r.select(ut),{__experimentalUndo:o}=i();o&&s()&&(t.preventDefault(),o())}return t.addEventListener("keydown",n),()=>{t.removeEventListener("keydown",n)}},e=>t=>{function n(n){const{disableFormats:r,onChange:s,value:i,formatTypes:o,tagName:a,onReplace:l,__unstableEmbedURLOnPaste:c,preserveWhiteSpace:u,pastePlainText:d}=e.current;if(!t.contains(n.target))return;if(n.defaultPrevented)return;const{plainText:f,html:g}=h(n);if(n.preventDefault(),window.console.log("Received HTML:\n\n",g),window.console.log("Received plain text:\n\n",f),r)return void s(pn(i,f));function p(e){const t=o.reduce((e,{__unstablePasteRule:t})=>(t&&e===i&&(e=t(i,{html:g,plainText:f})),e),i);if(t!==i)s(t);else{const t=tn({html:e});!function(e,t){if(t?.length){let n=e.formats.length;for(;n--;)e.formats[n]=[...t,...e.formats[n]||[]]}}(t,i.activeFormats),s(pn(i,t))}}if("true"===n.clipboardData.getData("rich-text"))return void p(g);if(d)return void s(pn(i,tn({text:f})));let m="INLINE";const b=f.trim();c&&fn(i)&&lt(b)&&/^https?:/.test(b)&&(m="BLOCKS");const v=pt({HTML:g,plainText:f,mode:m,tagName:a});"string"==typeof v?p(v):v.length>0&&l&&fn(i)&&l(v,v.length-1,-1)}const{defaultView:r}=t.ownerDocument;return r.addEventListener("paste",n),()=>{r.removeEventListener("paste",n)}},e=>t=>{function n(t){const{keyCode:n}=t;if(t.defaultPrevented)return;const{value:r,onMerge:s,onRemove:i}=e.current;if(n===N||n===R){const{start:e,end:o,text:a}=r,l=n===R,c=r.activeFormats&&!!r.activeFormats.length;if(!dn(r)||c||l&&0!==e||!l&&o!==a.length)return;s?s(!l):i&&fn(r)&&l&&i(!l),t.preventDefault()}}return t.addEventListener("keydown",n),()=>{t.removeEventListener("keydown",n)}},e=>t=>{function n(t){if(t.keyCode!==te)return;const{onReplace:n,onSplit:r}=e.current;n&&r&&(t.__deprecatedOnSplit=!0)}function r(n){if(n.defaultPrevented)return;if(n.target!==t)return;if(n.keyCode!==te)return;const{value:r,onChange:s,disableLineBreaks:i,onSplitAtEnd:o,onSplitAtDoubleLineEnd:a,registry:l}=e.current;n.preventDefault();const{text:c,start:u,end:d}=r;n.shiftKey?i||s(pn(r,"\n")):o&&u===d&&d===c.length?o():a&&u===d&&d===c.length&&"\n\n"===c.slice(-2)?l.batch(()=>{const e={...r};e.start=e.end-2,s(hn(e)),a()}):i||s(pn(r,"\n"))}const{defaultView:s}=t.ownerDocument;return s.addEventListener("keydown",r),t.addEventListener("keydown",n),()=>{s.removeEventListener("keydown",r),t.removeEventListener("keydown",n)}},e=>t=>{function n(){const{registry:n}=e.current;if(!n.select(ut).isMultiSelecting())return;const r=t.parentElement.closest('[contenteditable="true"]');r&&r.focus()}return t.addEventListener("focus",n),()=>{t.removeEventListener("focus",n)}}];function Ar(e){const n=b.useRef(e);n.current=e;const r=b.useMemo(()=>Pr.map(e=>e(n)),[n]);return t(t=>{if(!e.isSelected)return;const n=r.map(e=>e(t));return()=>{n.forEach(e=>e())}},[r,e.isSelected])}const Ir={},Mr=Symbol("usesContext");function $r({onChange:e,onFocus:t,value:n,forwardedRef:r,settings:s}){const{name:i,edit:o,[Mr]:a}=s,l=b.useContext(kt),c=b.useMemo(()=>a?Object.fromEntries(Object.entries(l).filter(([e])=>a.includes(e))):Ir,[a,l]);if(!o)return null;const u=function(e,t){return Pt(e).find(({type:e})=>e===t)}(n,i),d=void 0!==u,f=function({start:e,end:t,replacements:n,text:r}){if(e+1===t&&r[e]===Ft)return n[e]}(n),g=void 0!==f&&f.type===i;return v.jsx(o,{isActive:d,activeAttributes:d&&u.attributes||{},isObjectActive:g,activeObjectAttributes:g&&f.attributes||{},value:n,onChange:e,onFocus:t,contentRef:r,context:c},i)}function Vr({formatTypes:e,...t}){return e.map(e=>b.createElement($r,{settings:e,...t,key:e.name}))}function Hr(e,t){if(es.isEmpty(e)){const e=Or(t);return e?`<${e}></${e}>`:""}return Array.isArray(e)?(me("wp.blockEditor.RichText value prop as children type",{since:"6.1",version:"6.3",alternative:"value prop as string",link:"https://developer.wordpress.org/block-editor/how-to-guides/block-tutorial/introducing-attributes-and-editable-fields/"}),ht.toHTML(e)):"string"==typeof e?e:e.toHTMLString()}function Br({value:e,tagName:t,multiline:n,format:r,...s}){return e=v.jsx(be,{children:Hr(e,n)}),t?v.jsx(t,{...s,children:e}):e}const Ur=b.forwardRef(function({children:e,identifier:t,tagName:n="div",value:r="",onChange:s,multiline:i,...o},a){me("wp.blockEditor.RichText multiline prop",{since:"6.1",version:"6.3",alternative:"nested blocks (InnerBlocks)",link:"https://developer.wordpress.org/block-editor/how-to-guides/block-tutorial/nested-blocks-inner-blocks/"});const{clientId:l}=_t(),{getSelectionStart:c,getSelectionEnd:u}=B(ut),{selectionChange:d}=z(ut),f=Or(i),g=`</${f}>${r=r||`<${f}></${f}>`}<${f}>`.split(`</${f}><${f}>`);function p(e){s(`<${f}>${e.join(`</${f}><${f}>`)}</${f}>`)}return g.shift(),g.pop(),v.jsx(n,{ref:a,children:g.map((e,n)=>v.jsx(Qr,{identifier:`${t}-${n}`,tagName:f,value:e,onChange:e=>{const t=g.slice();t[n]=e,p(t)},isSelected:void 0,onKeyDown:r=>{if(r.keyCode!==te)return;r.preventDefault();const{offset:s}=c(),{offset:i}=u();if("number"!=typeof s||"number"!=typeof i)return;const o=tn({html:e});o.start=s,o.end=i;const a=bn(o).map(e=>Ht({value:e})),f=g.slice();f.splice(n,1,...a),p(f),d(l,`${t}-${n+1}`,0,0)},onMerge:e=>{const r=g.slice();let s=0;if(e){if(!r[n+1])return;r.splice(n,2,r[n]+r[n+1]),s=r[n].length-1}else{if(!r[n-1])return;r.splice(n-1,2,r[n-1]+r[n]),s=r[n-1].length-1}p(r),d(l,`${t}-${n-(e?0:1)}`,s,s)},...o},n))})});function zr({character:e,type:t,onUse:n}){const r=b.useContext(qr),s=b.useRef();return s.current=n,b.useEffect(()=>{function n(n){pe[t](n,e)&&(s.current(),n.preventDefault())}return r.current.add(n),()=>{r.current.delete(n)}},[e,t]),null}function Wr({name:e,shortcutType:t,shortcutCharacter:n,...r}){let s,i="RichText.ToolbarControls";return e&&(i+=`.${e}`),t&&n&&(s=ve[t](n)),v.jsx(xe,{name:i,children:v.jsx(ye,{...r,shortcut:s})})}function Kr({inputType:e,onInput:t}){const n=b.useContext(Xr),r=b.useRef();return r.current=t,b.useEffect(()=>{function t(t){t.inputType===e&&(r.current(),t.preventDefault())}return n.current.add(t),()=>{n.current.delete(t)}},[e]),null}const qr=b.createContext(),Xr=b.createContext(),Yr=Symbol("instanceId");function Gr(e){const{__unstableMobileNoFocusOnMount:t,deleteEnter:n,placeholderTextColor:r,textAlign:s,selectionColor:i,tagsToEliminate:o,disableEditingMenu:a,fontSize:l,fontFamily:c,fontWeight:u,fontStyle:d,minWidth:f,maxWidth:g,disableSuggestions:p,disableAutocorrection:h,...m}=e;return m}function Qr({children:e,tagName:r="div",value:i="",onChange:o,isSelected:a,multiline:l,inlineToolbar:c,wrapperClassName:u,autocompleters:d,onReplace:f,placeholder:g,allowedFormats:p,withoutInteractiveFormatting:h,onRemove:x,onMerge:k,onSplit:_,__unstableOnSplitAtEnd:S,__unstableOnSplitAtDoubleLineEnd:E,identifier:C,preserveWhiteSpace:w,__unstablePastePlainText:T,__unstableEmbedURLOnPaste:L,__unstableDisableFormats:j,disableLineBreaks:N,__unstableAllowPrefixTransformations:R,readOnly:D,...O},F){O=Gr(O),_&&me("wp.blockEditor.RichText onSplit prop",{since:"6.4",alternative:'block.json support key: "splitting"'});const P=s(Qr),M=b.useRef(),$=_t(),{clientId:V,isSelected:H,name:U}=$,W=$[Et],K=b.useContext(kt),q=yt(),{selectionStart:X,selectionEnd:Y,isSelected:G}=B(e=>{if(!H)return{isSelected:!1};const{getSelectionStart:t,getSelectionEnd:n}=e(ut),r=t(),s=n();let i;return void 0===a?i=r.clientId===V&&s.clientId===V&&(C?r.attributeKey===C:r[Yr]===P):a&&(i=r.clientId===V),{selectionStart:i?r.offset:void 0,selectionEnd:i?s.offset:void 0,isSelected:i}},[V,C,P,a,H]),{disableBoundBlock:Q,bindingsPlaceholder:J,bindingsLabel:Z}=B(e=>{var t;if(!W?.[C]||!m(U))return{};const n=W[C],r=mt(n.source),s={};if(r?.usesContext?.length)for(const i of r.usesContext)s[i]=K[i];const o=!r?.canUserEditValue?.({select:e,context:s,args:n.args});if(i.length>0)return{disableBoundBlock:o,bindingsPlaceholder:null,bindingsLabel:null};const{getBlockAttributes:a}=e(ut),l=a(V),c=r?.getFieldsList?.({select:e,context:s}),u=null!==(t=c?.[n?.args?.key]?.label)&&void 0!==t?t:r?.label,d=o?u:A(I("Add %s"),u),f=o?n?.args?.key||r?.label:A(I("Empty %s; start writing to edit its value"),n?.args?.key||r?.label);return{disableBoundBlock:o,bindingsPlaceholder:l?.placeholder||d,bindingsLabel:f}},[W,C,U,K,i]),ee=D||Q,{getSelectionStart:te,getSelectionEnd:ne,getBlockRootClientId:re}=B(ut),{selectionChange:se}=z(ut),ie=Fr({allowedFormats:p,disableFormats:j}),oe=!ie||ie.length>0,ae=b.useCallback((e,t)=>{const n={},r=void 0===e&&void 0===t,s={clientId:V,[C?"attributeKey":Yr]:C||P};if("number"==typeof e||r){if(void 0===t&&re(V)!==re(ne().clientId))return;n.start={...s,offset:e}}if("number"==typeof t||r){if(void 0===e&&re(V)!==re(te().clientId))return;n.end={...s,offset:t}}se(n)},[V,re,ne,te,C,P,se]),{formatTypes:le,prepareHandlers:ce,valueHandlers:ue,changeHandlers:de,dependencies:fe}=function({clientId:e,identifier:t,withoutInteractiveFormatting:n,allowedFormats:r}){const s=B(Lr,[]),i=b.useMemo(()=>s.filter(({name:e,interactive:t,tagName:s})=>!(r&&!r.includes(e)||n&&(t||jr.has(s)))),[s,r,n]),o=B(n=>i.reduce((r,s)=>{return s.__experimentalGetPropsForEditableTreePreparation?{...r,...(i=s.__experimentalGetPropsForEditableTreePreparation(n,{richTextIdentifier:t,blockClientId:e}),o=s.name,"object"!=typeof i?{[o]:i}:Object.fromEntries(Object.entries(i).map(([e,t])=>[`${o}.${e}`,t])))}:r;var i,o},{}),[i,e,t]),a=z(),l=[],c=[],u=[],d=[];for(const f in o)d.push(o[f]);return i.forEach(n=>{if(n.__experimentalCreatePrepareEditableTree){const r=n.__experimentalCreatePrepareEditableTree(Nr(o,n.name),{richTextIdentifier:t,blockClientId:e});n.__experimentalCreateOnChangeEditableValue?c.push(r):l.push(r)}if(n.__experimentalCreateOnChangeEditableValue){let r={};n.__experimentalGetPropsForEditableTreeChangeHandler&&(r=n.__experimentalGetPropsForEditableTreeChangeHandler(a,{richTextIdentifier:t,blockClientId:e}));const s=Nr(o,n.name);u.push(n.__experimentalCreateOnChangeEditableValue({..."object"==typeof s?s:{},...r},{richTextIdentifier:t,blockClientId:e}))}}),{formatTypes:i,prepareHandlers:l,valueHandlers:c,changeHandlers:u,dependencies:d}}({clientId:V,identifier:C,withoutInteractiveFormatting:h,allowedFormats:ie});function ge(e){return le.forEach(t=>{t.__experimentalCreatePrepareEditableTree&&(e=function(e,t,n=e.start,r=e.end){const{formats:s,activeFormats:i}=e,o=s.slice();if(n===r){const e=o[n]?.find(({type:e})=>e===t);if(e){for(;o[n]?.find(t=>t===e);)gn(o,n,t),n--;for(r++;o[r]?.find(t=>t===e);)gn(o,r,t),r++}}else for(let a=n;a<r;a++)o[a]&&gn(o,a,t);return Dt({...e,formats:o,activeFormats:i?.filter(({type:e})=>e!==t)||[]})}(e,t.name,0,e.text.length))}),e.formats}const{value:pe,getValue:he,onChange:be,ref:ve}=function({value:e="",selectionStart:r,selectionEnd:s,placeholder:i,onSelectionChange:o,preserveWhiteSpace:a,onChange:l,__unstableDisableFormats:c,__unstableIsSelected:u,__unstableDependencies:d=[],__unstableAfterParse:f,__unstableBeforeSerialize:g,__unstableAddInvisibleFormats:p}){const h=yt(),[,m]=b.useReducer(()=>({})),v=b.useRef();function x(e,{domOnly:t}={}){Ln({value:e,current:v.current,prepareEditableTree:p,__unstableDomOnly:t,placeholder:i})}const y=b.useRef(e),k=b.useRef();function _(){y.current=e,k.current=e,e instanceof en||(k.current=e?en.fromHTMLString(e,{preserveWhiteSpace:a}):en.empty()),k.current={text:k.current.text,formats:k.current.formats,replacements:k.current.replacements},c&&(k.current.formats=Array(e.length),k.current.replacements=Array(e.length)),f&&(k.current.formats=f(k.current)),k.current.start=r,k.current.end=s}const S=b.useRef(!1);function E(t){if(k.current=t,x(t),c)y.current=t.text;else{const n=g?g(t):t.formats;t={...t,formats:n},y.current="string"==typeof e?Ht({value:t,preserveWhiteSpace:a}):new en(t)}const{start:n,end:r,formats:s,text:i}=k.current;h.batch(()=>{o(n,r),l(y.current,{__unstableFormats:s,__unstableText:i})}),m()}function C(){_(),x(k.current)}k.current?r===k.current.start&&s===k.current.end||(S.current=u,k.current={...k.current,start:r,end:s,activeFormats:void 0}):(S.current=u,_());const w=b.useRef(!1);b.useLayoutEffect(()=>{w.current&&e!==y.current&&(C(),m())},[e]),b.useLayoutEffect(()=>{S.current&&(v.current.ownerDocument.activeElement!==v.current&&v.current.focus(),x(k.current),S.current=!1)},[S.current]);const T=n([v,b.useCallback(e=>{e&&(e.style.whiteSpace="pre-wrap",e.style.minWidth="1px")},[]),Dn({record:k}),Mn({record:k,handleChange:E,applyRecord:x,createRecord:function(){const{ownerDocument:{defaultView:e}}=v.current,t=e.getSelection(),n=t.rangeCount>0?t.getRangeAt(0):null;return tn({element:v.current,range:n,__unstableIsEditableTree:!0})},isSelected:u,onSelectionChange:o,forceRender:m}),t(()=>{C(),w.current=!0},[i,...d])]);return{value:k.current,getValue:()=>k.current,onChange:E,ref:T}}({value:i,onChange(e,{__unstableFormats:t,__unstableText:n}){o(e),Object.values(de).forEach(e=>{e(t,n)})},selectionStart:X,selectionEnd:Y,onSelectionChange:ae,placeholder:J||g,__unstableIsSelected:G,__unstableDisableFormats:j,preserveWhiteSpace:w,__unstableDependencies:[...fe,r],__unstableAfterParse:function(e){return ue.reduce((t,n)=>n(t,e.text),e.formats)},__unstableBeforeSerialize:ge,__unstableAddInvisibleFormats:function(e){return ce.reduce((t,n)=>n(t,e.text),e.formats)}}),xe=ke({onReplace:f,completers:d,record:pe,onChange:be});!function({html:e,value:t}){const n=b.useRef(),r=!!t.activeFormats?.length,{__unstableMarkLastChangeAsPersistent:s}=z(ut);b.useLayoutEffect(()=>{if(n.current){if(n.current!==t.text){const e=window.setTimeout(()=>{s()},1e3);return n.current=t.text,()=>{window.clearTimeout(e)}}s()}else n.current=t.text},[e,r])}({html:i,value:pe});const ye=b.useRef(new Set),_e=b.useRef(new Set);function Se(){M.current?.focus()}const Ee=r;return v.jsxs(v.Fragment,{children:[G&&v.jsx(qr.Provider,{value:ye,children:v.jsx(Xr.Provider,{value:_e,children:v.jsxs(je.__unstableSlotNameProvider,{value:"__unstable-block-tools-after",children:[e&&e({value:pe,onChange:be,onFocus:Se}),v.jsx(Vr,{value:pe,onChange:be,onFocus:Se,formatTypes:le,forwardedRef:M})]})})}),G&&oe&&v.jsx(Tr,{inline:c,editableContentElement:M.current}),v.jsx(Ee,{role:"textbox","aria-multiline":!N,"aria-readonly":ee,...O,"aria-label":Z||O["aria-label"]||g,...xe,ref:n([ve,F,xe.ref,O.ref,Ar({registry:q,getValue:he,onChange:be,__unstableAllowPrefixTransformations:R,formatTypes:le,onReplace:f,selectionChange:se,isSelected:G,disableFormats:j,value:pe,tagName:r,onSplit:_,__unstableEmbedURLOnPaste:L,pastePlainText:T,onMerge:k,onRemove:x,removeEditorOnlyFormats:ge,disableLineBreaks:N,onSplitAtEnd:S,onSplitAtDoubleLineEnd:E,keyboardShortcuts:ye,inputEvents:_e}),M]),contentEditable:!ee,suppressContentEditableWarning:!0,className:y("block-editor-rich-text__editable",O.className,"rich-text"),tabIndex:0!==O.tabIndex||ee?O.tabIndex:null,"data-wp-block-attribute-key":C})]})}const Jr=(Zr=b.forwardRef(Qr),b.forwardRef((e,t)=>{let n=e.value,r=e.onChange;Array.isArray(n)&&(me("wp.blockEditor.RichText value prop as children type",{since:"6.1",version:"6.3",alternative:"value prop as string",link:"https://developer.wordpress.org/block-editor/how-to-guides/block-tutorial/introducing-attributes-and-editable-fields/"}),n=ht.toHTML(e.value),r=t=>e.onChange(ht.fromDOM(Ot(document,t).childNodes)));const s=e.multiline?Ur:Zr;return v.jsx(s,{...e,value:n,onChange:r,ref:t})}));var Zr;Jr.Content=Br,Jr.isEmpty=e=>!e||0===e.length;const es=b.forwardRef((e,t)=>{if(_t()[St]){const{children:t,tagName:n="div",value:r,onChange:s,isSelected:i,multiline:o,inlineToolbar:a,wrapperClassName:l,autocompleters:c,onReplace:u,placeholder:d,allowedFormats:f,withoutInteractiveFormatting:g,onRemove:p,onMerge:h,onSplit:m,__unstableOnSplitAtEnd:b,__unstableOnSplitAtDoubleLineEnd:x,identifier:y,preserveWhiteSpace:k,__unstablePastePlainText:_,__unstableEmbedURLOnPaste:S,__unstableDisableFormats:E,disableLineBreaks:C,__unstableAllowPrefixTransformations:w,readOnly:T,...L}=Gr(e);return v.jsx(n,{...L,dangerouslySetInnerHTML:{__html:Hr(r,o)}})}return v.jsx(Jr,{ref:t,...e,readOnly:!1})});es.Content=Br,es.isEmpty=e=>!e||0===e.length;class ts extends b.Component{constructor(){super(...arguments),this.toggle=this.toggle.bind(this),this.submitLink=this.submitLink.bind(this),this.state={expanded:!1}}toggle(){this.setState({expanded:!this.state.expanded})}submitLink(e){e.preventDefault(),this.toggle()}render(){const{url:e,onChange:t}=this.props,{expanded:n}=this.state,r=I(e?"Edit link":"Insert link");return v.jsxs("div",{className:"block-editor-url-input__button",children:[v.jsx(D,{size:"compact",icon:Ye,label:r,onClick:this.toggle,className:"components-toolbar__control",isPressed:!!e}),n&&v.jsx("form",{className:"block-editor-url-input__button-modal",onSubmit:this.submitLink,children:v.jsxs("div",{className:"block-editor-url-input__button-modal-line",children:[v.jsx(D,{__next40pxDefaultSize:!0,className:"block-editor-url-input__back",icon:Ge,label:I("Close"),onClick:this.toggle}),v.jsx(Sr,{value:e||"",onChange:t,suffix:v.jsx(J,{variant:"control",children:v.jsx(D,{size:"small",icon:qe,label:I("Submit"),type:"submit"})})})]})})]})}}const ns="none",rs="custom",ss="media",is="attachment",os=["noreferrer","noopener"],as=({linkDestination:e,onChangeUrl:t,url:n,mediaType:r="image",mediaUrl:s,mediaLink:i,linkTarget:o,linkClass:a,rel:l,showLightboxSetting:c,lightboxEnabled:u,onSetLightbox:d,resetLightbox:f})=>{const[g,p]=b.useState(!1),[h,m]=b.useState(null),[x,y]=b.useState(!1),[k,_]=b.useState(null),S=b.useRef(null),E=b.useRef();b.useEffect(()=>{if(!E.current)return;(Y.focusable.find(E.current)[0]||E.current).focus()},[x,n,u]);const C=()=>{e!==ss&&e!==is||_(""),y(!0)},w=()=>{y(!1)},T=()=>{const e=[{linkDestination:ss,title:I("Link to image file"),url:"image"===r?s:void 0,icon:Je}];return"image"===r&&i&&e.push({linkDestination:is,title:I("Link to attachment page"),url:"image"===r?i:void 0,icon:Me}),e},L=v.jsxs(_e,{spacing:"3",children:[v.jsx(Se,{__nextHasNoMarginBottom:!0,label:I("Open in new tab"),onChange:e=>{const n=(e=>{const t=e?"_blank":void 0;let n;if(t){const e=(null!=l?l:"").split(" ");os.forEach(t=>{e.includes(t)||e.push(t)}),n=e.join(" ")}else{const e=(null!=l?l:"").split(" ").filter(e=>!1===os.includes(e));n=e.length?e.join(" "):void 0}return{linkTarget:t,rel:n}})(e);t(n)},checked:"_blank"===o}),v.jsx(Q,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:I("Link rel"),value:null!=l?l:"",onChange:e=>{t({rel:e})}}),v.jsx(Q,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:I("Link CSS class"),value:a||"",onChange:e=>{t({linkClass:e})}})]}),j=null!==k?k:n,N=!u||u&&!c,R=!j&&N,O=(T().find(t=>t.linkDestination===e)||{}).title;return v.jsxs(v.Fragment,{children:[v.jsx(ye,{icon:Ye,className:"components-toolbar__control",label:I("Link"),"aria-expanded":g,onClick:()=>{p(!0)},ref:m,isActive:!!n||u&&c}),g&&v.jsx(Ne,{ref:E,anchor:h,onFocusOutside:e=>{const t=S.current;t&&t.contains(e.target)||(p(!1),_(null),w())},onClose:()=>{_(null),w(),p(!1)},renderSettings:N?()=>L:null,additionalControls:R&&v.jsxs(Re,{children:[T().map(e=>v.jsx(Te,{icon:e.icon,iconPosition:"left",onClick:()=>{_(null),(e=>{const n=T();let r;r=e?(n.find(t=>t.url===e)||{linkDestination:rs}).linkDestination:ns,t({linkDestination:r,href:e})})(e.url),w()},children:e.title},e.linkDestination)),c&&v.jsx(Te,{className:"block-editor-url-popover__expand-on-click",icon:Qe,info:I("Scale the image with a lightbox effect."),iconPosition:"left",onClick:()=>{_(null),t({linkDestination:ns,href:""}),d?.(!0),w()},children:I("Expand on click")},"expand-on-click")]}),offset:13,children:u&&c&&!n&&!x?v.jsxs("div",{className:"block-editor-url-popover__expand-on-click",children:[v.jsx(V,{icon:Qe}),v.jsxs("div",{className:"text",children:[v.jsx("p",{children:I("Expand on click")}),v.jsx("p",{className:"description",children:I("Scales the image with a lightbox effect")})]}),v.jsx(D,{icon:ze,label:I("Disable expand on click"),onClick:()=>{d?.(!1)},size:"compact"})]}):!n||x?v.jsx(Ne.LinkEditor,{className:"block-editor-format-toolbar__link-container-content",value:j,onChangeInputValue:_,onSubmit:e=>{if(k){const e=T().find(e=>e.url===k)?.linkDestination||rs;t({href:k,linkDestination:e,lightbox:{enabled:!1}})}w(),_(null),e.preventDefault()},autocompleteRef:S}):n&&!x?v.jsxs(v.Fragment,{children:[v.jsx(Ne.LinkViewer,{className:"block-editor-format-toolbar__link-container-content",url:n,onEditLinkClick:C,urlLabel:O}),v.jsx(D,{icon:ze,label:I("Remove link"),onClick:()=>{t({linkDestination:ns,href:""}),f?.()},size:"compact"})]}):void 0})]})};function ls(e,t,n){if(null==e||!1===e)return;if(Array.isArray(e))return cs(e,t,n);switch(typeof e){case"string":case"number":return}const{type:r,props:s}=e;switch(r){case b.StrictMode:case b.Fragment:return cs(s.children,t,n);case be:return;case Ee.Content:return us(t,n);case Br:return void t.push(s.value)}switch(typeof r){case"string":return void 0!==s.children?cs(s.children,t,n):void 0;case"function":return ls(r.prototype&&"function"==typeof r.prototype.render?new r(s).render():r(s),t,n)}}function cs(e,...t){e=Array.isArray(e)?e:[e];for(let n=0;n<e.length;n++)ls(e[n],...t)}function us(e,t){for(let n=0;n<t.length;n++){const{name:r,attributes:s,innerBlocks:i}=t[n];ls(vt(r,s,v.jsx(Ee.Content,{})),e,i)}}function ds(e=[]){bt.skipFilters=!0;const t=[];return us(t,e),bt.skipFilters=!1,t.map(e=>e instanceof en?e:en.fromHTMLString(e))}export{as as I,yr as L,Jr as P,zr as R,Sr as U,Kr as _,es as a,Rn as b,tn as c,Qt as d,pn as e,or as f,ds as g,er as h,dn as i,Kn as j,Wr as k,ts as l,en as m,$n as n,hn as r,mn as s,Ht as t,Mr as u};
