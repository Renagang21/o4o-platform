import{r as e,j as t,bw as s,aE as r,cm as a,bc as n,E as i,V as o}from"./vendor-react-DqgGMt48.js";import{u as d,a as l,b as c}from"./vendor-query-D_c3FRkE.js";import{B as x,I as m,L as p,T as j,b as h}from"./page-template-editor-5uesjTWI.js";import{cF as u,cG as y,cH as v,cI as b,cU as N,cV as f,cW as g,cX as w,cY as k,cZ as S,cQ as q}from"./wp-misc-DyLrwF9p.js";import"./vendor-monaco-BxJH8uUv.js";import"./vendor-ui-CrFdsnXa.js";import"./vendor-utils-C9jLuAcl.js";import"./wp-blocks-core-65VcejHr.js";import"./wp-block-editor-misc-Bvzg-2Jv.js";import"./wp-core-BVMytgUH.js";import"./wp-block-editor-api-MRWBPx9C.js";import"./wp-block-editor-store-BOagVFfu.js";import"./wp-block-editor-clipboard-D5sqncpm.js";import"./wp-i18n-BuBz6Sgx.js";import"./wp-block-editor-global-styles-DFEUywv4.js";import"./wp-block-editor-typography-D5fCIzVQ.js";import"./wp-components-Uj2D7Nfy.js";import"./wp-block-editor-spacing-CY2h70rf.js";import"./wp-block-editor-menus-CucXu4UM.js";import"./wp-block-editor-core-BF86nm2P.js";import"./wp-block-editor-utils-BmaAXcuk.js";import"./wp-block-editor-colors-60WWD1Za.js";import"./wp-block-editor-a11y-BVzCbFSD.js";import"./wp-block-editor-preview-WXXja22U.js";import"./wp-block-editor-borders-C-QIiBvP.js";import"./wp-block-editor-formats--rvRJrSX.js";import"./wp-block-editor-selection-DBFjOmhH.js";import"./wp-block-editor-inline-CtEBI-J7.js";import"./wp-block-editor-ui-DwG3jajt.js";import"./wp-block-editor-transforms-Bg08EtRt.js";import"./wp-block-editor-patterns-DIcm1rGW.js";import"./wp-block-editor-navigation-ufXSM7dn.js";import"./wp-block-editor-dnd-yPphmZPp.js";import"./wp-block-editor-media-CatADaW3.js";import"./wp-api-COhbxmzY.js";import"./wp-block-editor-keyboard-3DDntAoE.js";import"./wp-block-editor-templates-C6YLNdWR.js";import"./wp-data-CL-okzN5.js";const C=()=>{const C=d(),[I,F]=e.useState(""),[K,_]=e.useState("all"),[P,O]=e.useState(null),[L,$]=e.useState(!1),[U,z]=e.useState(!1),[D,E]=e.useState({inventoryItemId:"",type:"increase",quantity:0,reason:"",notes:""}),{data:Q,isLoading:V}=l({queryKey:["inventory",I,K],queryFn:async()=>{const e=new URLSearchParams;I&&e.append("search",I),"all"!==K&&e.append("status",K);return(await h.api.get(`/v1/inventory?${e.toString()}`)).data}}),A=Q?.data||[],{data:B}=l({queryKey:["stock-movements",P?.id],queryFn:async()=>{if(!P?.id)return{data:[]};return(await h.api.get(`/v1/inventory/${P.id}/movements`)).data},enabled:!!P?.id&&U}),R=B?.data||[],{data:G}=l({queryKey:["inventory-stats"],queryFn:async()=>(await h.api.get("/v1/inventory/stats")).data}),H=G?.data||{},T=c({mutationFn:async e=>(await h.api.post("/v1/inventory/adjust",e)).data,onSuccess:()=>{o.success("재고가 조정되었습니다"),C.invalidateQueries({queryKey:["inventory"]}),C.invalidateQueries({queryKey:["inventory-stats"]}),$(!1),E({inventoryItemId:"",type:"increase",quantity:0,reason:"",notes:""})}}),W=c({mutationFn:async e=>(await h.api.post("/v1/inventory/bulk-reorder",{itemIds:e})).data,onSuccess:()=>{o.success("대량 재주문이 요청되었습니다")}}),X=A.filter(e=>e.currentStock<=e.reorderPoint&&"discontinued"!==e.status);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-modern-text-primary",children:"재고 관리"}),t.jsx("p",{className:"text-modern-text-secondary mt-1",children:"실시간 재고 추적 및 관리"})]}),t.jsx("div",{className:"flex gap-2",children:X.length>0&&t.jsxs(x,{variant:"outline",onClick:()=>W.mutate(X.map(e=>e.id)),disabled:W.isPending,children:[t.jsx(s,{className:"w-4 h-4 mr-2"}),"부족 재고 재주문 (",X.length,")"]})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs(u,{children:[t.jsx(y,{className:"pb-2",children:t.jsx(v,{className:"text-sm font-medium text-modern-text-secondary",children:"총 상품 수"})}),t.jsxs(b,{children:[t.jsx("div",{className:"text-2xl font-bold text-modern-text-primary",children:H.totalItems||0}),t.jsx("p",{className:"text-xs text-modern-text-tertiary mt-1",children:"활성 상품 기준"})]})]}),t.jsxs(u,{children:[t.jsx(y,{className:"pb-2",children:t.jsx(v,{className:"text-sm font-medium text-modern-text-secondary",children:"부족 재고"})}),t.jsxs(b,{children:[t.jsx("div",{className:"text-2xl font-bold text-orange-600",children:H.lowStockItems||0}),t.jsx("p",{className:"text-xs text-modern-text-tertiary mt-1",children:"재주문 필요"})]})]}),t.jsxs(u,{children:[t.jsx(y,{className:"pb-2",children:t.jsx(v,{className:"text-sm font-medium text-modern-text-secondary",children:"품절 상품"})}),t.jsxs(b,{children:[t.jsx("div",{className:"text-2xl font-bold text-red-600",children:H.outOfStockItems||0}),t.jsx("p",{className:"text-xs text-modern-text-tertiary mt-1",children:"즉시 보충 필요"})]})]}),t.jsxs(u,{children:[t.jsx(y,{className:"pb-2",children:t.jsx(v,{className:"text-sm font-medium text-modern-text-secondary",children:"총 재고 가치"})}),t.jsxs(b,{children:[t.jsxs("div",{className:"text-2xl font-bold text-modern-text-primary",children:["₩",(H.totalValue||0).toLocaleString()]}),t.jsx("p",{className:"text-xs text-modern-text-tertiary mt-1",children:"원가 기준"})]})]})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[t.jsx("div",{className:"flex-1",children:t.jsxs("div",{className:"relative",children:[t.jsx(r,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-modern-text-tertiary w-5 h-5"}),t.jsx(m,{type:"text",placeholder:"상품명, SKU로 검색...",value:I,onChange:e=>F(e.target.value),className:"pl-10"})]})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(a,{className:"w-5 h-5 text-modern-text-secondary"}),t.jsxs("select",{value:K,onChange:e=>_(e.target.value),className:"px-4 py-2 border border-modern-border-primary rounded-lg focus:outline-none focus:ring-2 focus:ring-modern-primary",children:[t.jsx("option",{value:"all",children:"모든 상태"}),t.jsx("option",{value:"in_stock",children:"정상 재고"}),t.jsx("option",{value:"low_stock",children:"부족 재고"}),t.jsx("option",{value:"out_of_stock",children:"품절"}),t.jsx("option",{value:"discontinued",children:"단종"})]})]})]}),t.jsx(u,{children:t.jsx(b,{className:"p-0",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-modern-bg-tertiary border-b border-modern-border-primary",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"상품 정보"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"현재 재고"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"예약 재고"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"재주문점"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"상태"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"위치"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"작업"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-modern-border-primary",children:V?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-6 py-12 text-center",children:t.jsx("div",{className:"flex justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-modern-primary"})})})}):0===A.length?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-6 py-12 text-center text-modern-text-secondary",children:"재고 데이터가 없습니다."})}):A.map(e=>{return t.jsxs("tr",{className:"hover:bg-modern-bg-hover",children:[t.jsx("td",{className:"px-6 py-4",children:t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium text-modern-text-primary",children:e.productName}),t.jsxs("div",{className:"text-sm text-modern-text-secondary",children:["SKU: ",e.sku]}),e.variantOptions&&t.jsx("div",{className:"text-xs text-modern-text-tertiary",children:Object.entries(e.variantOptions).map(([e,t])=>`${e}: ${t}`).join(", ")})]})}),t.jsx("td",{className:"px-6 py-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-medium text-modern-text-primary",children:e.currentStock}),e.currentStock<=e.reorderPoint&&t.jsx(s,{className:"w-4 h-4 text-orange-500"})]})}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("span",{className:"text-sm text-modern-text-secondary",children:e.reservedStock})}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("span",{className:"text-sm text-modern-text-secondary",children:e.reorderPoint})}),t.jsx("td",{className:"px-6 py-4",children:(r=e.status,a=e.currentStock,o=e.reorderPoint,"out_of_stock"===r||0===a?t.jsx(q,{variant:"destructive",children:"품절"}):"low_stock"===r||a<=o?t.jsx(q,{variant:"outline",className:"text-orange-600 border-orange-600",children:"부족"}):"discontinued"===r?t.jsx(q,{variant:"secondary",children:"단종"}):t.jsx(q,{children:"정상"}))}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("span",{className:"text-sm text-modern-text-secondary",children:e.location||"-"})}),t.jsx("td",{className:"px-6 py-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(x,{variant:"ghost",size:"sm",onClick:()=>(e=>{O(e),E({inventoryItemId:e.id,type:"increase",quantity:0,reason:"",notes:""}),$(!0)})(e),children:t.jsx(n,{className:"w-4 h-4"})}),t.jsx(x,{variant:"ghost",size:"sm",onClick:()=>(e=>{O(e),z(!0)})(e),children:t.jsx(i,{className:"w-4 h-4"})})]})})]},e.id);var r,a,o})})]})})})}),t.jsx(N,{open:L,onOpenChange:$,children:t.jsx(f,{children:t.jsxs("form",{onSubmit:e=>{e.preventDefault(),D.quantity&&D.reason?T.mutate(D):o.error("수량과 사유를 입력하세요")},children:[t.jsxs(g,{children:[t.jsx(w,{children:"재고 조정"}),t.jsxs(k,{children:[P?.productName," - ",P?.sku]})]}),t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsx("div",{children:t.jsxs(p,{children:["현재 재고: ",P?.currentStock,"개"]})}),t.jsxs("div",{children:[t.jsx(p,{htmlFor:"type",children:"조정 유형"}),t.jsxs("select",{id:"type",value:D.type,onChange:e=>E(t=>({...t,type:e.target.value})),className:"w-full px-3 py-2 border border-modern-border-primary rounded-lg mt-1",children:[t.jsx("option",{value:"increase",children:"증가"}),t.jsx("option",{value:"decrease",children:"감소"}),t.jsx("option",{value:"set",children:"절대값 설정"})]})]}),t.jsxs("div",{children:[t.jsx(p,{htmlFor:"quantity",children:"수량"}),t.jsx(m,{id:"quantity",type:"number",min:"0",value:D.quantity,onChange:e=>E(t=>({...t,quantity:parseInt(e.target.value)||0})),required:!0})]}),t.jsxs("div",{children:[t.jsx(p,{htmlFor:"reason",children:"조정 사유 *"}),t.jsxs("select",{id:"reason",value:D.reason,onChange:e=>E(t=>({...t,reason:e.target.value})),className:"w-full px-3 py-2 border border-modern-border-primary rounded-lg mt-1",required:!0,children:[t.jsx("option",{value:"",children:"사유를 선택하세요"}),t.jsx("option",{value:"manual_count",children:"실사 조정"}),t.jsx("option",{value:"damaged",children:"손상품 처리"}),t.jsx("option",{value:"expired",children:"유통기한 만료"}),t.jsx("option",{value:"returned",children:"반품 처리"}),t.jsx("option",{value:"promotional",children:"판촉 사용"}),t.jsx("option",{value:"theft",children:"분실/도난"}),t.jsx("option",{value:"other",children:"기타"})]})]}),t.jsxs("div",{children:[t.jsx(p,{htmlFor:"notes",children:"메모"}),t.jsx(j,{id:"notes",value:D.notes,onChange:e=>E(t=>({...t,notes:e.target.value})),placeholder:"추가 설명을 입력하세요...",rows:3})]})]}),t.jsxs(S,{children:[t.jsx(x,{type:"button",variant:"outline",onClick:()=>$(!1),children:"취소"}),t.jsx(x,{type:"submit",disabled:T.isPending,children:"조정하기"})]})]})})}),t.jsx(N,{open:U,onOpenChange:z,children:t.jsxs(f,{className:"max-w-4xl",children:[t.jsxs(g,{children:[t.jsx(w,{children:"입출고 이력"}),t.jsxs(k,{children:[P?.productName," - ",P?.sku]})]}),t.jsx("div",{className:"max-h-96 overflow-y-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-modern-bg-tertiary sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-modern-text-secondary",children:"일시"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-modern-text-secondary",children:"유형"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-modern-text-secondary",children:"수량"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-modern-text-secondary",children:"잔여"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-modern-text-secondary",children:"사유"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-modern-text-secondary",children:"참조"})]})}),t.jsx("tbody",{children:R.map(e=>{const s=(e=>{switch(e){case"in":return{label:"입고",color:"text-green-600"};case"out":return{label:"출고",color:"text-red-600"};case"adjustment":return{label:"조정",color:"text-blue-600"};case"reserved":return{label:"예약",color:"text-orange-600"};case"unreserved":return{label:"예약해제",color:"text-purple-600"};default:return{label:e,color:"text-gray-600"}}})(e.type);return t.jsxs("tr",{className:"border-b border-modern-border-primary",children:[t.jsx("td",{className:"px-4 py-2 text-sm",children:new Date(e.createdAt).toLocaleString("ko-KR")}),t.jsx("td",{className:"px-4 py-2",children:t.jsx("span",{className:`text-sm font-medium ${s.color}`,children:s.label})}),t.jsxs("td",{className:"px-4 py-2 text-sm",children:["out"===e.type||"adjustment"===e.type?"-":"+",e.quantity]}),t.jsx("td",{className:"px-4 py-2 text-sm",children:e.remainingStock}),t.jsx("td",{className:"px-4 py-2 text-sm",children:e.reason}),t.jsx("td",{className:"px-4 py-2 text-sm",children:e.reference||"-"})]},e.id)})})]})}),t.jsx(S,{children:t.jsx(x,{onClick:()=>z(!1),children:"닫기"})})]})})]})};export{C as default};
