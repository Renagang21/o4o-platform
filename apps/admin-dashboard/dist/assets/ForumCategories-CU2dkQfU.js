import{r as e,V as s,j as t,b6 as a,ci as r,bc as i,b8 as n}from"./vendor-react-BqkIXTmC.js";import{u as c,a as d,b as l}from"./vendor-query-C5jzPyjL.js";import{b as o,B as m,L as x,I as p,T as u,m as h}from"./page-template-editor-DmUXhR56.js";import{cU as j,cV as g,cW as y,cX as v,cY as f,cZ as w}from"./wp-misc-D0_U3Yh3.js";import"./vendor-monaco-BxJH8uUv.js";import"./vendor-ui-CrFdsnXa.js";import"./vendor-utils-C9jLuAcl.js";import"./wp-blocks-core-C_Umt3qd.js";import"./wp-block-editor-main-DEdKEcH7.js";import"./wp-block-editor-store-Cdz5rmmV.js";import"./wp-block-editor-utils-CmROb2t9.js";import"./wp-i18n-DP14Ry5v.js";import"./wp-core-skmJSxj5.js";import"./wp-components-i3qvAB06.js";import"./wp-api-Dq90bqIA.js";import"./wp-data-CsLR-lZb.js";const N=()=>{const N=c(),[b,k]=e.useState(!1),[C,S]=e.useState(null),[F,q]=e.useState({name:"",slug:"",description:"",active:!0}),{data:K=[],isLoading:$}=d({queryKey:["forum-categories"],queryFn:async()=>(await o.api.get("/v1/forum/categories")).data.data}),z=l({mutationFn:async e=>(await o.api.post("/v1/forum/categories",e)).data,onSuccess:()=>{s.success("카테고리가 생성되었습니다"),N.invalidateQueries({queryKey:["forum-categories"]}),V()}}),L=l({mutationFn:async({id:e,data:s})=>(await o.api.put(`/v1/forum/categories/${e}`,s)).data,onSuccess:()=>{s.success("카테고리가 수정되었습니다"),N.invalidateQueries({queryKey:["forum-categories"]}),V()}}),Q=l({mutationFn:async e=>(await o.api.delete(`/v1/forum/categories/${e}`)).data,onSuccess:()=>{s.success("카테고리가 삭제되었습니다"),N.invalidateQueries({queryKey:["forum-categories"]})}}),P=e=>{e?(S(e),q({name:e.name,slug:e.slug,description:e.description,active:e.active})):(S(null),q({name:"",slug:"",description:"",active:!0})),k(!0)},V=()=>{k(!1),S(null),q({name:"",slug:"",description:"",active:!0})};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold text-modern-text-primary",children:"포럼 카테고리"}),t.jsx("p",{className:"text-modern-text-secondary mt-1",children:"포럼 카테고리를 관리하세요."})]}),t.jsxs(m,{onClick:()=>P(),children:[t.jsx(a,{className:"w-4 h-4 mr-2"}),"새 카테고리"]})]}),t.jsx("div",{className:"wp-card",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-modern-bg-tertiary border-b border-modern-border-primary",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"순서"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"이름"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"설명"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"게시글 수"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"상태"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"작업"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-modern-border-primary",children:$?t.jsx("tr",{children:t.jsx("td",{colSpan:6,className:"px-6 py-12 text-center",children:t.jsx("div",{className:"flex justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-modern-primary"})})})}):0===K.length?t.jsx("tr",{children:t.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-modern-text-secondary",children:"카테고리가 없습니다."})}):K.map(e=>t.jsxs("tr",{className:"hover:bg-modern-bg-hover",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx(r,{className:"w-5 h-5 text-modern-text-tertiary cursor-move"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-modern-text-primary",children:e.name}),t.jsxs("p",{className:"text-xs text-modern-text-secondary",children:["/",e.slug]})]})}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("p",{className:"text-sm text-modern-text-secondary truncate max-w-xs",children:e.description||"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-modern-text-primary",children:e.postCount}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full "+(e.active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.active?"활성":"비활성"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(m,{variant:"ghost",size:"sm",onClick:()=>P(e),children:t.jsx(i,{className:"w-4 h-4"})}),t.jsx(m,{variant:"ghost",size:"sm",onClick:()=>(e=>{e.postCount>0?s.error("게시글이 있는 카테고리는 삭제할 수 없습니다"):confirm(`"${e.name}" 카테고리를 삭제하시겠습니까?`)&&Q.mutate(e.id)})(e),disabled:e.postCount>0,children:t.jsx(n,{className:"w-4 h-4 text-destructive"})})]})})]},e.id))})]})})}),t.jsx(j,{open:b,onOpenChange:k,children:t.jsx(g,{children:t.jsxs("form",{onSubmit:e=>{e.preventDefault(),F.name.trim()?C?L.mutate({id:C.id,data:F}):z.mutate(F):s.error("카테고리 이름을 입력하세요")},children:[t.jsxs(y,{children:[t.jsx(v,{children:C?"카테고리 수정":"새 카테고리"}),t.jsx(f,{children:"포럼 카테고리 정보를 입력하세요."})]}),t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsxs("div",{children:[t.jsx(x,{htmlFor:"name",children:"이름 *"}),t.jsx(p,{id:"name",value:F.name,onChange:e=>{q(s=>{return{...s,name:e.target.value,slug:C?s.slug:(t=e.target.value,t.toLowerCase().replace(/[^a-z0-9가-힣]+/g,"-").replace(/^-+|-+$/g,""))};var t})},placeholder:"예: 일반 토론",required:!0})]}),t.jsxs("div",{children:[t.jsx(x,{htmlFor:"slug",children:"Slug"}),t.jsx(p,{id:"slug",value:F.slug,onChange:e=>q(s=>({...s,slug:e.target.value})),placeholder:"예: general-discussion"})]}),t.jsxs("div",{children:[t.jsx(x,{htmlFor:"description",children:"설명"}),t.jsx(u,{id:"description",value:F.description,onChange:e=>q(s=>({...s,description:e.target.value})),placeholder:"카테고리에 대한 설명을 입력하세요...",rows:3})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx(x,{htmlFor:"active",children:"활성화"}),t.jsx("p",{className:"text-sm text-modern-text-secondary",children:"비활성화 시 게시글 작성이 불가능합니다"})]}),t.jsx(h,{id:"active",checked:F.active,onCheckedChange:e=>q(s=>({...s,active:e}))})]})]}),t.jsxs(w,{children:[t.jsx(m,{type:"button",variant:"outline",onClick:V,children:"취소"}),t.jsx(m,{type:"submit",disabled:z.isPending||L.isPending,children:C?"수정":"생성"})]})]})})})]})};export{N as default};
