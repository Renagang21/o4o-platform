import{c as e}from"./vendor-ui-CrFdsnXa.js";import{c as t,a as n,s as o,i}from"./wp-i18n-BuBz6Sgx.js";import{k as s,j as l,u as r,a as c,W as a,m as d,n as u,o as f,D as g,b as m,p as b,q as p,r as k,w as v,s as h,U as I,t as B,L as y,v as C,x as S,y as E,z as _,A as x,N as w,C as D}from"./wp-block-editor-misc-Bvzg-2Jv.js";import{s as L}from"./wp-block-editor-store-BOagVFfu.js";import{u as P,e as M,f as j,g as T,b as N,h as A,i as R}from"./wp-core-BVMytgUH.js";import{k as O,m as V,o as z,p as F,w as H,q as K,t as G,u as W,v as U,x as Z,y as q,z as X,A as $,B as Y,C as Q,D as J,E as ee,F as te,G as ne,H as oe,J as ie,K as se,L as le,M as re,N as ce}from"./wp-misc-DyLrwF9p.js";import{y as ae,z as de,A as ue,B as fe,C as ge,D as me,E as be,F as pe}from"./wp-block-editor-utils-BmaAXcuk.js";import{r as ke,j as ve,T as he}from"./vendor-react-DqgGMt48.js";import{f as Ie,r as Be,i as ye,e as Ce,j as Se,k as Ee,v as _e,l as xe,a as we,m as De,n as Le,h as Pe,o as Me,q as je,t as Te,u as Ne,w as Ae,x as Re,y as Oe,z as Ve,s as ze,A as Fe}from"./wp-blocks-core-65VcejHr.js";import{u as He}from"./wp-block-editor-clipboard-D5sqncpm.js";import{B as Ke,a as Ge,b as We,u as Ue,P as Ze,D as qe,c as Xe}from"./wp-block-editor-api-MRWBPx9C.js";import{Button as $e,Modal as Ye,withFilters as Qe,__unstableMotion as Je,__unstableAnimatePresence as et,ToolbarButton as tt,Popover as nt}from"./wp-components-Uj2D7Nfy.js";import{u as ot}from"./wp-block-editor-selection-DBFjOmhH.js";import{u as it}from"./wp-block-editor-inline-CtEBI-J7.js";import{B as st,a as lt,b as rt,u as ct}from"./wp-block-editor-menus-CucXu4UM.js";import{I as at,a as dt,S as ut}from"./wp-block-editor-ui-DwG3jajt.js";import{B as ft,a as gt}from"./wp-block-editor-dnd-yPphmZPp.js";const mt=ke.createContext({}),bt={type:"default"},pt=ke.createContext(bt),kt=pt.Provider;function vt(){return ke.useContext(pt)}function ht({layout:e={},css:t,...n}){const o=s(e.type),[i]=l("spacing.blockGap"),r=null!==i;if(o){if(t)return ve.jsx("style",{children:t});const i=o.getLayoutStyle?.({hasBlockGapSupport:r,layout:e,...n});if(i)return ve.jsx("style",{children:i})}return null}function It(e){const{refsMap:t}=ke.useContext(Ke);return P(n=>(t.set(e,n),()=>t.delete(e)),[e])}function Bt(e,t){"function"==typeof e?e(t):e&&(e.current=t)}function yt(e,t){const{refsMap:n}=ke.useContext(Ke);ke.useLayoutEffect(()=>{Bt(t,n.get(e));const o=n.subscribe(e,()=>Bt(t,n.get(e)));return()=>{o(),Bt(t,null)}},[n,e,t])}function Ct(e){const[t,n]=ke.useState(null);return yt(e,n),t}const St=e=>Be({HTML:e.originalContent});function Et({clientId:e}){const{block:o,canInsertHTMLBlock:i,canInsertClassicBlock:s}=r(t=>{const{canInsertBlockType:n,getBlock:o,getBlockRootClientId:i}=t(L),s=i(e);return{block:o(e),canInsertHTMLBlock:n("core/html",s),canInsertClassicBlock:n("core/freeform",s)}},[e]),{replaceBlock:l}=c(L),[u,f]=ke.useState(!1),g=ke.useCallback(()=>f(!1),[]),m=ke.useMemo(()=>({toClassic(){const e=Ie("core/freeform",{content:o.originalContent});return l(o.clientId,e)},toHTML(){const e=Ie("core/html",{content:o.originalContent});return l(o.clientId,e)},toBlocks(){const e=St(o);return l(o.clientId,e)},toRecoveredBlock(){const e=Ie(o.name,o.attributes,o.innerBlocks);return l(o.clientId,e)}}),[o,l]),b=ke.useMemo(()=>[{title:t("Resolve","imperative verb"),onClick:()=>f(!0)},i&&{title:n("Convert to HTML"),onClick:m.toHTML},s&&{title:n("Convert to Classic Block"),onClick:m.toClassic}].filter(Boolean),[i,s,m]);return ve.jsxs(ve.Fragment,{children:[ve.jsx(a,{actions:[ve.jsx($e,{__next40pxDefaultSize:!0,onClick:m.toRecoveredBlock,variant:"primary",children:n("Attempt recovery")},"recover")],secondaryActions:b,children:n("Block contains unexpected or invalid content.")}),u&&ve.jsx(Ye,{title:n("Resolve Block"),onRequestClose:g,className:"block-editor-block-compare",children:ve.jsx(d,{block:o,onKeep:m.toHTML,onConvert:m.toBlocks,convertor:St,convertButtonText:n("Convert to Blocks")})})]})}const _t=ve.jsx(a,{className:"block-editor-block-list__block-crash-warning",children:n("This block has encountered an error and cannot be previewed.")}),xt=()=>_t;class wt extends ke.Component{constructor(){super(...arguments),this.state={hasError:!1}}componentDidCatch(){this.setState({hasError:!0})}render(){return this.state.hasError?this.props.fallback:this.props.children}}function Dt({clientId:e}){const[t,n]=ke.useState(""),o=r(t=>t(L).getBlock(e),[e]),{updateBlock:i}=c(L);return ke.useEffect(()=>{n(ye(o))},[o]),ve.jsx(he,{className:"block-editor-block-list__block-html-textarea",value:t,onBlur:()=>{const s=Ce(o.name);if(!s)return;const l=Se(s,t,o.attributes),r=t||Ee(s,l),[c]=t?_e({...o,attributes:l,originalContent:r}):[!0];i(e,{attributes:l,originalContent:r,isValid:c}),t||n(r)},onChange:e=>n(e.target.value)})}function Lt({clientId:e,initialPosition:t}){const n=ke.useRef(),{isBlockSelected:o,isMultiSelecting:i,__unstableGetEditorMode:s}=r(L);return ke.useEffect(()=>{if(!o(e)||i()||"zoom-out"===s())return;if(null==t)return;if(!n.current)return;const{ownerDocument:l}=n.current;if(ae(n.current,l.activeElement))return;const r=O.tabbable.find(n.current).filter(e=>V(e)),c=-1===t,a=r[c?r.length-1:0]||n.current;if(ae(n.current,a)){if(!n.current.getAttribute("contenteditable")){const e=O.tabbable.findNext(n.current);if(e&&ae(n.current,e)&&z(e))return void e.focus()}F(a,c)}else n.current.focus()},[t,e]),n}function Pt({clientId:e}){const{hoverBlock:t}=c(L);function n(n){if(n.defaultPrevented)return;const o="mouseover"===n.type?"add":"remove";n.preventDefault(),n.currentTarget.classList[o]("is-hovered"),t("add"===o?e:null)}return P(e=>(e.addEventListener("mouseout",n),e.addEventListener("mouseover",n),()=>{e.removeEventListener("mouseout",n),e.removeEventListener("mouseover",n),e.classList.remove("is-hovered"),t(null)}),[])}function Mt(e){const{isBlockSelected:t}=r(L),{selectBlock:n,selectionChange:o}=c(L);return P(i=>{function s(s){i.parentElement.closest('[contenteditable="true"]')||(t(e)?s.target.isContentEditable||o(e):ae(i,s.target)&&n(e))}return i.addEventListener("focusin",s),()=>{i.removeEventListener("focusin",s)}},[t,n])}function jt({clientId:e,isSelected:t}){const{getBlockRootClientId:n,getBlockIndex:o}=r(L),{insertAfterBlock:i,removeBlock:s}=c(L);return P(n=>{if(t)return n.addEventListener("keydown",o),n.addEventListener("dragstart",l),()=>{n.removeEventListener("keydown",o),n.removeEventListener("dragstart",l)};function o(t){const{keyCode:o,target:l}=t;o!==u&&o!==f&&o!==g||l!==n||V(l)||(t.preventDefault(),o===u?i(e):s(e))}function l(e){e.preventDefault()}},[e,t,n,o,i,s])}function Tt(){const{getSettings:e,isZoomOut:t,__unstableGetEditorMode:n}=m(r(L)),{__unstableSetEditorMode:o,resetZoomLevel:i}=m(c(L));return P(s=>{function l(s){if("zoom-out"===n()&&t()&&!s.defaultPrevented){s.preventDefault();const{__experimentalSetIsInserterOpened:t}=e();"function"==typeof t&&t(!1),o("edit"),i()}}return s.addEventListener("dblclick",l),()=>{s.removeEventListener("dblclick",l)}},[e,o,n,t,i])}function Nt(){const e=ke.useContext(hn);return P(t=>{if(e)return e.observe(t),()=>{e.unobserve(t)}},[e])}function At({isSelected:e}){const t=M();return P(n=>{if(e){const{ownerDocument:e}=n,{defaultView:o}=e;if(!o.IntersectionObserver)return;const i=new o.IntersectionObserver(e=>{e[0].isIntersecting||n.scrollIntoView({behavior:t?"instant":"smooth"}),i.disconnect()});return i.observe(n),()=>{i.disconnect()}}},[e])}function Rt(t={},{__unstableIsHtml:i}={}){const{clientId:s,className:l,wrapperProps:r={},isAligned:c,index:a,mode:d,name:u,blockApiVersion:f,blockTitle:g,isSelected:m,isSubtreeDisabled:p,hasOverlay:k,initialPosition:v,blockEditingMode:h,isHighlighted:I,isMultiSelected:B,isPartiallySelected:y,isReusable:C,isDragging:S,hasChildSelected:E,isEditingDisabled:_,hasEditableOutline:x,isTemporarilyEditingAsBlocks:w,defaultClassName:D,isSectionBlock:L}=ke.useContext(mt),P=o(n("Block: %s"),g),M="html"!==d||i?"":"-visual",N=j([t.ref,Lt({clientId:s,initialPosition:v}),It(s),Mt(s),jt({clientId:s,isSelected:m}),Tt(),Pt({clientId:s}),Nt(),b({triggerAnimationOnChange:a,clientId:s}),T({isDisabled:!k}),it({clientId:s,isEnabled:L}),At({isSelected:m})]),A=Ge(),R=!!A[We]&&de(u)?{"--wp-admin-theme-color":"var(--wp-block-synced-color)","--wp-admin-theme-color--rgb":"var(--wp-block-synced-color--rgb)"}:{};f<2&&s===A.clientId&&!0===globalThis.SCRIPT_DEBUG&&H(`Block type "${u}" must support API version 2 or higher to work correctly with "useBlockProps" method.`);let O=!1;return"-"!==r?.style?.marginTop?.charAt(0)&&"-"!==r?.style?.marginBottom?.charAt(0)&&"-"!==r?.style?.marginLeft?.charAt(0)&&"-"!==r?.style?.marginRight?.charAt(0)||(O=!0),{tabIndex:"disabled"===h?-1:0,...r,...t,ref:N,id:`block-${s}${M}`,role:"document","aria-label":P,"data-block":s,"data-type":u,"data-title":g,inert:p?"true":void 0,className:e("block-editor-block-list__block",{"wp-block":!c,"has-block-overlay":k,"is-selected":m,"is-highlighted":I,"is-multi-selected":B,"is-partially-selected":y,"is-reusable":C,"is-dragging":S,"has-child-selected":E,"is-editing-disabled":_,"has-editable-outline":x,"has-negative-margin":O,"is-content-locked-temporarily-editing-as-blocks":w},l,t.className,r.className,D),style:{...r.style,...t.style,...R}}}Rt.save=xe;const{isUnmodifiedBlockContent:Ot}=m(je);function Vt({children:e,isHtml:t,...n}){return ve.jsx("div",{...Rt(n,{__unstableIsHtml:t}),children:e})}function zt({block:{__unstableBlockSource:t},mode:n,isLocked:o,canRemove:i,clientId:s,isSelected:l,isSelectionEnabled:r,className:a,__unstableLayoutClassNames:d,name:u,isValid:f,attributes:g,wrapperProps:m,setAttributes:b,onReplace:v,onInsertBlocksAfter:h,onMerge:I,toggleSelection:B}){var y;const{mayDisplayControls:C,mayDisplayParentControls:S,themeSupportsLayout:E,..._}=ke.useContext(mt),{removeBlock:x}=c(L),w=ke.useCallback(()=>x(s),[s,x]),D=vt()||{};let P=ve.jsx(p,{name:u,isSelected:l,attributes:g,setAttributes:b,insertBlocksAfter:o?void 0:h,onReplace:i?v:void 0,onRemove:i?w:void 0,mergeBlocks:i?I:void 0,clientId:s,isSelectionEnabled:r,toggleSelection:B,__unstableLayoutClassNames:d,__unstableParentLayout:Object.keys(D).length?D:void 0,mayDisplayControls:C,mayDisplayParentControls:S,blockEditingMode:_.blockEditingMode,isPreviewMode:_.isPreviewMode});const M=Ce(u);M?.getEditWrapperProps&&(m=function(t,n){const o={...t,...n};return t?.hasOwnProperty("className")&&n?.hasOwnProperty("className")&&(o.className=e(t.className,n.className)),t?.hasOwnProperty("style")&&n?.hasOwnProperty("style")&&(o.style={...t.style,...n.style}),o}(m,M.getEditWrapperProps(g)));const j=m&&!!m["data-align"]&&!E,T=a?.includes("is-position-sticky");let N;if(j&&(P=ve.jsx("div",{className:e("wp-block",T&&a),"data-align":m["data-align"],children:P})),f)N="html"===n?ve.jsxs(ve.Fragment,{children:[ve.jsx("div",{style:{display:"none"},children:P}),ve.jsx(Vt,{isHtml:!0,children:ve.jsx(Dt,{clientId:s})})]}):M?.apiVersion>1?P:ve.jsx(Vt,{children:P});else{const e=t?Me(t):Ee(M,g);N=ve.jsxs(Vt,{className:"has-warning",children:[ve.jsx(Et,{clientId:s}),ve.jsx(k,{children:K(e)})]})}const{"data-align":A,...R}=null!==(y=m)&&void 0!==y?y:{},O={...R,className:e(R.className,A&&E&&`align${A}`,!(A&&T)&&a)};return ve.jsx(mt.Provider,{value:{wrapperProps:O,isAligned:j,..._},children:ve.jsx(wt,{fallback:ve.jsx(Vt,{className:"has-warning",children:ve.jsx(xt,{})}),children:N})})}const Ft=v((e,t,n)=>{const{updateBlockAttributes:o,insertBlocks:i,mergeBlocks:s,replaceBlocks:l,toggleSelection:r,__unstableMarkLastChangeAsPersistent:c,moveBlocksToPosition:a,removeBlock:d,selectBlock:u}=e(L);return{setAttributes(e){const{getMultiSelectedBlockClientIds:i}=n.select(L),s=i(),{clientId:l}=t,r=s.length?s:[l];o(r,e)},onInsertBlocks(e,n){const{rootClientId:o}=t;i(e,n,o)},onInsertBlocksAfter(e){const{clientId:o,rootClientId:s}=t,{getBlockIndex:l}=n.select(L),r=l(o);i(e,r+1,s)},onMerge(e){const{clientId:o,rootClientId:r}=t,{getPreviousBlockClientId:c,getNextBlockClientId:f,getBlock:g,getBlockAttributes:m,getBlockName:b,getBlockOrder:p,getBlockIndex:k,getBlockRootClientId:v,canInsertBlockType:h}=n.select(L);function I(){const e=g(o),t=Ne();if(b(o)!==t){const n=Ae(e,t);n&&n.length&&l(o,n)}else if(Te(e)){const e=f(o);e&&n.batch(()=>{d(o),u(e)})}}function B(e,t=!0){const s=v(e),r=p(e),[c]=r;1===r.length&&Re(g(c))?d(e):n.batch(()=>{const n=g(c),r=Ot(n),m=Ne(),b=Ae(n,m),v=!!b?.length&&b.every(t=>h(t.name,e));if(r&&v)l(c,b,t);else if(r&&n.name===m){d(c);const e=f(o);e&&u(e)}else if(h(n.name,s))a([c],e,s,k(e));else{!!b?.length&&b.every(e=>h(e.name,s))?(i(b,k(e),s,t),d(c,!1)):I()}!p(e).length&&Re(g(e))&&d(e,!1)})}if(e){if(r){const e=f(r);if(e){if(b(r)!==b(e))return void s(r,e);{const t=m(r),o=m(e);if(Object.keys(t).every(e=>t[e]===o[e]))return void n.batch(()=>{a(p(e),e,r),d(e,!1)})}}}const e=f(o);if(!e)return;p(e).length?B(e,!1):s(o,e)}else{const e=c(o);if(e)s(e,o);else if(r){const e=c(r);if(e&&b(r)===b(e)){const t=m(r),o=m(e);if(Object.keys(t).every(e=>t[e]===o[e]))return void n.batch(()=>{a(p(r),r,e),d(r,!1)})}B(r)}else I()}},onReplace(e,n,o){e.length&&!Te(e[e.length-1])&&c();const i=1===e?.length&&Array.isArray(e[0])?e[0]:e;l([t.clientId],i,n,o)},toggleSelection(e){r(e)}}});zt=N(Ft,Qe("editor.BlockListBlock"))(zt);const Ht=ke.memo(function(e){const{clientId:t,rootClientId:n}=e,o=r(e=>{const{isBlockSelected:o,getBlockMode:i,isSelectionEnabled:s,getTemplateLock:l,isSectionBlock:r,getBlockWithoutAttributes:c,getBlockAttributes:a,canRemoveBlock:d,canMoveBlock:u,getSettings:f,getTemporarilyEditingAsBlocks:g,getBlockEditingMode:b,getBlockName:p,isFirstMultiSelectedBlock:k,getMultiSelectedBlockClientIds:v,hasSelectedInnerBlock:h,getBlocksByName:I,getBlockIndex:B,isBlockMultiSelected:y,isBlockSubtreeDisabled:C,isBlockHighlighted:S,__unstableIsFullySelected:E,__unstableSelectionHasUnmergeableBlock:_,isBlockBeingDragged:x,isDragging:w,__unstableHasActiveBlockOverlayActive:D,getSelectedBlocksInitialCaretPosition:P}=m(e(L)),M=c(t);if(!M)return;const{hasBlockSupport:j,getActiveBlockVariation:T}=e(we),N=a(t),{name:A,isValid:R}=M,O=Ce(A),{supportsLayout:V,__unstableIsPreviewMode:z}=f(),F=O?.apiVersion>1,H={isPreviewMode:z,blockWithoutAttributes:M,name:A,attributes:N,isValid:R,themeSupportsLayout:V,index:B(t),isReusable:Le(O),className:F?N.className:void 0,defaultClassName:F?De(A):void 0,blockTitle:O?.title};if(z)return H;const K=o(t),G=d(t),W=u(t),U=T(A,N),Z=y(t),q=h(t,!0),X=b(t),$=Pe(A,"multiple",!0)?[]:I(A),Y=$.length&&$[0]!==t;return{...H,mode:i(t),isSelectionEnabled:s(),isLocked:!!l(n),isSectionBlock:r(t),canRemove:G,canMove:W,isSelected:K,isTemporarilyEditingAsBlocks:g()===t,blockEditingMode:X,mayDisplayControls:K||k(t)&&v().every(e=>p(e)===A),mayDisplayParentControls:j(p(t),"__experimentalExposeControlsToChildren",!1)&&h(t),blockApiVersion:O?.apiVersion||1,blockTitle:U?.title||O?.title,isSubtreeDisabled:"disabled"===X&&C(t),hasOverlay:D(t)&&!w(),initialPosition:K?P():void 0,isHighlighted:S(t),isMultiSelected:Z,isPartiallySelected:Z&&!E()&&!_(),isDragging:x(t),hasChildSelected:q,isEditingDisabled:"disabled"===X,hasEditableOutline:"disabled"!==X&&"disabled"===b(n),originalBlockClientId:!!Y&&$[0]}},[t,n]),{isPreviewMode:i,mode:s="visual",isSelectionEnabled:l=!1,isLocked:c=!1,canRemove:a=!1,canMove:d=!1,blockWithoutAttributes:u,name:f,attributes:g,isValid:b,isSelected:p=!1,themeSupportsLayout:k,isTemporarilyEditingAsBlocks:v,blockEditingMode:h,mayDisplayControls:I,mayDisplayParentControls:B,index:y,blockApiVersion:C,blockTitle:S,isSubtreeDisabled:E,hasOverlay:_,initialPosition:x,isHighlighted:w,isMultiSelected:D,isPartiallySelected:P,isReusable:M,isDragging:j,hasChildSelected:T,isSectionBlock:N,isEditingDisabled:A,hasEditableOutline:R,className:O,defaultClassName:V,originalBlockClientId:z}=o,F=ke.useMemo(()=>({...u,attributes:g}),[u,g]);if(!o)return null;const H={isPreviewMode:i,clientId:t,className:O,index:y,mode:s,name:f,blockApiVersion:C,blockTitle:S,isSelected:p,isSubtreeDisabled:E,hasOverlay:_,initialPosition:x,blockEditingMode:h,isHighlighted:w,isMultiSelected:D,isPartiallySelected:P,isReusable:M,isDragging:j,hasChildSelected:T,isSectionBlock:N,isEditingDisabled:A,hasEditableOutline:R,isTemporarilyEditingAsBlocks:v,defaultClassName:V,mayDisplayControls:I,mayDisplayParentControls:B,originalBlockClientId:z,themeSupportsLayout:k};return ve.jsx(mt.Provider,{value:H,children:ve.jsx(zt,{...e,mode:s,isSelectionEnabled:l,isLocked:c,canRemove:a,canMove:d,block:F,name:f,attributes:g,isValid:b,isSelected:p})})});function Kt(e){const{isMultiSelecting:t,getMultiSelectedBlockClientIds:n,hasMultiSelection:o,getSelectedBlockClientId:i,getSelectedBlocksInitialCaretPosition:s,__unstableIsFullySelected:l}=e(L);return{isMultiSelecting:t(),multiSelectedBlockClientIds:n(),hasMultiSelection:o(),selectedBlockClientId:i(),initialPosition:s(),isFullSelection:l()}}function Gt(){const{initialPosition:e,isMultiSelecting:t,multiSelectedBlockClientIds:n,hasMultiSelection:o,selectedBlockClientId:i,isFullSelection:s}=r(Kt,[]);return P(i=>{const{ownerDocument:l}=i,{defaultView:r}=l;if(null==e)return;if(!o||t)return;const{length:c}=n;c<2||s&&(i.contentEditable=!0,i.focus(),r.getSelection().removeAllRanges())},[o,t,n,i,e,s])}function Wt(e,t,n,o){let i,s=O.focusable.find(n);return t&&s.reverse(),s=s.slice(s.indexOf(e)+1),o&&(i=e.getBoundingClientRect()),s.find(function(e){if(!(e.closest("[inert]")||1===e.children.length&&ue(e,e.firstElementChild)&&"true"===e.firstElementChild.getAttribute("contenteditable"))){if(!O.tabbable.isTabbableIndex(e))return!1;if(e.isContentEditable&&"true"!==e.contentEditable)return!1;if(o){const t=e.getBoundingClientRect();if(t.left>=i.right||t.right<=i.left)return!1}return!0}})}function Ut(){const{getMultiSelectedBlocksStartClientId:e,getMultiSelectedBlocksEndClientId:t,getSettings:n,hasMultiSelection:o,__unstableIsFullySelected:i}=r(L),{selectBlock:s}=c(L);return P(l=>{let r;function c(){r=null}function a(c){if(c.defaultPrevented)return;const{keyCode:a,target:d,shiftKey:u,ctrlKey:f,altKey:g,metaKey:m}=c,b=a===I,p=a===y,k=b||p,v=p||a===C,h=b||a===B,S=v||h,E=u||f||g||m,_=h?U:Z,{ownerDocument:x}=l,{defaultView:w}=x;if(!S)return;if(o()){if(u)return;if(!i())return;return c.preventDefault(),void(k?s(e()):s(t(),-1))}if(!function(e,t,n){const o=t===I||t===B,{tagName:i}=e,s=e.getAttribute("type");if(o&&!n)return"INPUT"!==i||!["date","datetime-local","month","number","range","time","week"].includes(s);if("INPUT"===i)return["button","checkbox","number","color","file","image","radio","reset","submit"].includes(s);return"TEXTAREA"!==i}(d,a,E))return;h?r||(r=G(w)):r=null;const D=W(d)?!k:k,{keepCaretInsideBlock:L}=n();if(u)(function(e,t){const n=Wt(e,t,l);return n&&fe(n)})(d,k)&&_(d,k)&&(l.contentEditable=!0,l.focus());else if(!h||!U(d,k)||g&&!Z(d,D)||L){if(v&&w.getSelection().isCollapsed&&Z(d,D)&&!L){const e=Wt(d,D,l);F(e,k),c.preventDefault()}}else{const e=Wt(d,k,l,!0);e&&(q(e,g?!k:k,g?void 0:r),c.preventDefault())}}return l.addEventListener("mousedown",c),l.addEventListener("keydown",a),()=>{l.removeEventListener("mousedown",c),l.removeEventListener("keydown",a)}},[])}function Zt(){const{getBlockOrder:e,getSelectedBlockClientIds:t,getBlockRootClientId:n}=r(L),{multiSelect:o,selectBlock:i}=c(L),s=X();return P(l=>{function r(r){if(!s("core/block-editor/select-all",r))return;const c=t();if(c.length<2&&!$(r.target))return;r.preventDefault();const[a]=c,d=n(a),u=e(d);c.length!==u.length?o(u[0],u[u.length-1]):d&&(l.ownerDocument.defaultView.getSelection().removeAllRanges(),i(d))}return l.addEventListener("keydown",r),()=>{l.removeEventListener("keydown",r)}},[])}function qt(e,t){e.contentEditable=t,t&&e.focus()}function Xt(){const{startMultiSelect:e,stopMultiSelect:t}=c(L),{isSelectionEnabled:n,hasSelectedBlock:o,isDraggingBlocks:i,isMultiSelecting:s}=r(L);return P(l=>{const{ownerDocument:r}=l,{defaultView:c}=r;let a,d;function u(){t(),c.removeEventListener("mouseup",u),d=c.requestAnimationFrame(()=>{if(!o())return;qt(l,!1);const e=c.getSelection();if(e.rangeCount){const t=e.getRangeAt(0),{commonAncestorContainer:n}=t,o=t.cloneRange();a.contains(n)&&(a.focus(),e.removeAllRanges(),e.addRange(o))}})}function f({buttons:t,target:o,relatedTarget:r}){o.contains(r)||i()||1===t&&(s()||l!==o&&"true"===o.getAttribute("contenteditable")&&n()&&(a=o,e(),c.addEventListener("mouseup",u),qt(l,!0)))}return l.addEventListener("mouseout",f),()=>{l.removeEventListener("mouseout",f),c.removeEventListener("mouseup",u),c.cancelAnimationFrame(d)}},[e,t,n,o])}function $t(e,t){e.contentEditable!==String(t)&&(e.contentEditable=t)}function Yt(e){const t=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;return t?.closest("[data-wp-block-attribute-key]")}function Qt(){const{multiSelect:e,selectBlock:t,selectionChange:n}=c(L),{getBlockParents:o,getBlockSelectionStart:i,isMultiSelecting:s}=r(L);return P(l=>{const{ownerDocument:r}=l,{defaultView:c}=r;function a(r){const a=c.getSelection();if(!a.rangeCount)return;const d=function(e){const{anchorNode:t,anchorOffset:n}=e;return t.nodeType===t.TEXT_NODE||0===n?t:t.childNodes[n-1]}(a),u=function(e){const{focusNode:t,focusOffset:n}=e;return t.nodeType===t.TEXT_NODE||n===t.childNodes.length?t:0===n&&Q(e)?null!==(o=t.previousSibling)&&void 0!==o?o:t.parentElement:t.childNodes[n];var o}(a);if(!l.contains(d)||!l.contains(u))return;const f=r.shiftKey&&"mouseup"===r.type;if(a.isCollapsed&&!f){if("true"===l.contentEditable&&!s()){$t(l,!1);let e=d.nodeType===d.ELEMENT_NODE?d:d.parentElement;e=e?.closest("[contenteditable]"),e?.focus()}return}let g=fe(d),m=fe(u);if(f){const e=i(),t=fe(r.target),n=t!==m;(g===m&&a.isCollapsed||!m||n)&&(m=t),g!==e&&(g=e)}if(void 0===g&&void 0===m)return void $t(l,!1);if(g===m)s()?e(g,g):t(g);else{const t=[...o(g),g],i=[...o(m),m],s=function(e,t){let n=0;for(;e[n]===t[n];)n++;return n}(t,i);if(t[s]!==g||i[s]!==m)return void e(t[s],i[s]);const l=Yt(d),r=Yt(u);if(l&&r){var b,p;const e=a.getRangeAt(0),t=Y({element:l,range:e,__unstableIsEditableTree:!0}),o=Y({element:r,range:e,__unstableIsEditableTree:!0}),i=null!==(b=t.start)&&void 0!==b?b:t.end,s=null!==(p=o.start)&&void 0!==p?p:o.end;n({start:{clientId:g,attributeKey:l.dataset.wpBlockAttributeKey,offset:i},end:{clientId:m,attributeKey:r.dataset.wpBlockAttributeKey,offset:s}})}else e(g,m)}}return r.addEventListener("selectionchange",a),c.addEventListener("mouseup",a),()=>{r.removeEventListener("selectionchange",a),c.removeEventListener("mouseup",a)}},[e,t,n,o])}function Jt(){const{selectBlock:e}=c(L),{isSelectionEnabled:t,getBlockSelectionStart:n,hasMultiSelection:o}=r(L);return P(i=>{function s(s){if(!t()||0!==s.button)return;const l=n(),r=fe(s.target);s.shiftKey?l!==r&&(i.contentEditable=!0,i.focus()):o()&&e(r)}return i.addEventListener("mousedown",s),()=>{i.removeEventListener("mousedown",s)}},[e,t,n,o])}function en(){const{__unstableIsFullySelected:e,getSelectedBlockClientIds:t,getSelectedBlockClientId:n,__unstableIsSelectionMergeable:o,hasMultiSelection:i,getBlockName:s,canInsertBlockType:l,getBlockRootClientId:a,getSelectionStart:d,getSelectionEnd:m,getBlockAttributes:b}=r(L),{replaceBlocks:p,__unstableSplitSelection:k,removeBlocks:v,__unstableDeleteSelection:h,__unstableExpandSelection:I,__unstableMarkAutomaticChange:B}=c(L);return P(r=>{function c(e){"true"===r.contentEditable&&e.preventDefault()}function y(c){if(!c.defaultPrevented)if(i())c.keyCode===u?(r.contentEditable=!1,c.preventDefault(),e()?p(t(),Ie(Ne())):k()):c.keyCode===f||c.keyCode===g?(r.contentEditable=!1,c.preventDefault(),e()?v(t()):o()?h(c.keyCode===g):I()):1!==c.key.length||c.metaKey||c.ctrlKey||(r.contentEditable=!1,o()?h(c.keyCode===g):(c.preventDefault(),r.ownerDocument.defaultView.getSelection().removeAllRanges()));else if(c.keyCode===u){if(c.shiftKey||e())return;const t=n(),o=s(t),i=d(),r=m();if(i.attributeKey===r.attributeKey){const e=b(t)[i.attributeKey],n=Oe("from").filter(({type:e})=>"enter"===e),o=Ve(n,t=>t.regExp.test(e));if(o)return p(t,o.transform({content:e})),void B()}if(!Pe(o,"splitting",!1)&&!c.__deprecatedOnSplit)return;l(o,a(t))&&(k(),c.preventDefault())}}function C(e){i()&&(r.contentEditable=!1,o()?h():(e.preventDefault(),r.ownerDocument.defaultView.getSelection().removeAllRanges()))}return r.addEventListener("beforeinput",c),r.addEventListener("keydown",y),r.addEventListener("compositionstart",C),()=>{r.removeEventListener("beforeinput",c),r.removeEventListener("keydown",y),r.removeEventListener("compositionstart",C)}},[])}const tn=Symbol("requiresWrapperOnCopy");function nn(e,t,n){let o=t;const[i]=t;if(i){if(n.select(we).getBlockType(i.name)[tn]){const{getBlockRootClientId:e,getBlockName:t,getBlockAttributes:s}=n.select(L),l=e(i.clientId),r=t(l);r&&(o=Ie(r,s(l),o))}}const s=ze(o);e.clipboardData.setData("text/plain",function(e){e=e.replace(/<br>/g,"\n");return J(e).trim().replace(/\n\n+/g,"\n\n")}(s)),e.clipboardData.setData("text/html",s)}function on(e,t){const{plainText:n,html:o,files:i}=ge(e);let s=[];if(i.length){const e=Oe("from");s=i.reduce((t,n)=>{const o=Ve(e,e=>"files"===e.type&&e.isMatch([n]));return o&&t.push(o.transform([n])),t},[]).flat()}else s=Fe({HTML:o,plainText:n,mode:"BLOCKS"});return s}function sn(){const e=Ue(),{getBlocksByClientId:t,getSelectedBlockClientIds:n,hasMultiSelection:o,getSettings:i,getBlockName:s,__unstableIsFullySelected:l,__unstableIsSelectionCollapsed:a,__unstableIsSelectionMergeable:d,__unstableGetSelectedBlocksWithPartialSelection:u,canInsertBlockType:f,getBlockRootClientId:g}=r(L),{flashBlock:m,removeBlocks:b,replaceBlocks:p,__unstableDeleteSelection:k,__unstableExpandSelection:v,__unstableSplitSelection:h}=c(L),I=He();return P(r=>{function c(c){if(c.defaultPrevented)return;const B=n();if(0===B.length)return;if(!o()){const{target:e}=c,{ownerDocument:t}=e;if("copy"===c.type||"cut"===c.type?ee(t):te(t)&&!t.activeElement.isContentEditable)return}const{activeElement:y}=c.target.ownerDocument;if(!r.contains(y))return;const C=d(),S=a()||l(),E=!S&&!C;if("copy"===c.type||"cut"===c.type)if(c.preventDefault(),1===B.length&&m(B[0]),E)v();else{let n;if(I(c.type,B),S)n=t(B);else{const[e,o]=u();n=[e,...t(B.slice(1,B.length-1)),o]}nn(c,n,e)}if("cut"===c.type)S&&!E?b(B):(c.target.ownerDocument.activeElement.contentEditable=!1,k());else if("paste"===c.type){const{__experimentalCanUserUseUnfilteredHTML:e}=i();if("true"===c.clipboardData.getData("rich-text"))return;const{plainText:t,html:n,files:r}=ge(c),a=l();let d=[];if(r.length){const e=Oe("from");d=r.reduce((t,n)=>{const o=Ve(e,e=>"files"===e.type&&e.isMatch([n]));return o&&t.push(o.transform([n])),t},[]).flat()}else d=Fe({HTML:n,plainText:t,mode:a?"BLOCKS":"AUTO"});if("string"==typeof d)return;if(a)return p(B,d,d.length-1,-1),void c.preventDefault();if(!o()&&!Pe(s(B[0]),"splitting",!1)&&!c.__deprecatedOnSplit)return;const[u]=B,m=g(u),b=[];for(const o of d)if(f(o.name,m))b.push(o);else{const e=s(m),t=o.name!==e?Ae(o,e):[o];if(!t)return;for(const n of t)for(const e of n.innerBlocks)b.push(e)}h(b),c.preventDefault()}}return r.ownerDocument.addEventListener("copy",c),r.ownerDocument.addEventListener("cut",c),r.ownerDocument.addEventListener("paste",c),()=>{r.ownerDocument.removeEventListener("copy",c),r.ownerDocument.removeEventListener("cut",c),r.ownerDocument.removeEventListener("paste",c)}},[])}function ln(){const[e,t,o]=function(){const e=ke.useRef(),t=ke.useRef(),n=ke.useRef(),{hasMultiSelection:o,getSelectedBlockClientId:i,getBlockCount:s}=r(L),{setLastFocus:l}=m(c(L)),{getLastFocus:a}=m(r(L)),d=ke.useRef();function u(t){if(d.current)d.current=null;else if(o())e.current.focus();else if(i())a()?.current?a().current.focus():e.current.querySelector(`[data-block="${i()}"]`).focus();else{const n=e.current.ownerDocument===t.target.ownerDocument?e.current:e.current.ownerDocument.defaultView.frameElement,o=t.target.compareDocumentPosition(n)&t.target.DOCUMENT_POSITION_FOLLOWING,i=O.tabbable.find(e.current);i.length&&(o?i[0]:i[i.length-1]).focus()}}const f=ve.jsx("div",{ref:t,tabIndex:"0",onFocus:u}),g=ve.jsx("div",{ref:n,tabIndex:"0",onFocus:u}),b=P(o=>{function i(e){if(e.defaultPrevented)return;if(e.keyCode!==h)return;const o=e.shiftKey,i=o?"findPrevious":"findNext",s=O.tabbable[i](e.target),l=e.target.closest("[data-block]"),r=l&&s&&(ue(l,s)||ae(l,s));if(z(s)&&r)return;const c=o?t:n;d.current=!0,c.current.focus({preventScroll:!0})}function r(e){l({...a(),current:e.target});const{ownerDocument:t}=o;e.relatedTarget||t.activeElement!==t.body||0!==s()||o.focus()}function c(o){if(o.keyCode!==h)return;if("region"===o.target?.getAttribute("role"))return;if(e.current===o.target)return;const i=o.shiftKey?"findPrevious":"findNext",s=O.tabbable[i](o.target);s!==t.current&&s!==n.current||(o.preventDefault(),s.focus({preventScroll:!0}))}const{ownerDocument:u}=o,{defaultView:f}=u;return f.addEventListener("keydown",c),o.addEventListener("keydown",i),o.addEventListener("focusout",r),()=>{f.removeEventListener("keydown",c),o.removeEventListener("keydown",i),o.removeEventListener("focusout",r)}},[]);return[f,j([e,b]),g]}(),i=r(e=>e(L).hasMultiSelection(),[]);return[e,j([t,sn(),en(),Xt(),Qt(),Jt(),Gt(),Zt(),Ut(),P(e=>{if(e.tabIndex=0,i)return e.classList.add("has-multi-selection"),e.setAttribute("aria-label",n("Multiple selected blocks")),()=>{e.classList.remove("has-multi-selection"),e.removeAttribute("aria-label")}},[i])]),o]}const rn=ke.forwardRef(function({children:t,...n},o){const[i,s,l]=ln();return ve.jsxs(ve.Fragment,{children:[i,ve.jsx("div",{...n,ref:j([s,o]),className:e(n.className,"block-editor-writing-flow"),children:t}),l]})});function cn({rootClientId:e}){return r(t=>t(L).canInsertBlockType(Ne(),e))?ve.jsx(S,{rootClientId:e}):ve.jsx(E,{rootClientId:e,className:"block-list-appender__toggle"})}function an({rootClientId:t,CustomAppender:n,className:o,tagName:i="div"}){const s=r(e=>{const{getBlockInsertionPoint:n,isBlockInsertionPointVisible:o,getBlockCount:i}=e(L),s=n();return o()&&t===s?.rootClientId&&0===i(t)},[t]);return ve.jsx(i,{tabIndex:-1,className:e("block-list-appender wp-block",o,{"is-drag-over":s}),contentEditable:!1,"data-block":!0,children:n?ve.jsx(n,{}):ve.jsx(cn,{rootClientId:t})})}const dn=ke.createContext();function un({__unstablePopoverSlot:t,__unstableContentRef:n,operation:o="insert",nearestSide:i="right"}){const{selectBlock:s,hideInsertionPoint:l}=c(L),a=ke.useContext(dn),d=ke.useRef(),{orientation:u,previousClientId:f,nextClientId:g,rootClientId:m,isInserterShown:b,isDistractionFree:p,isZoomOutMode:k}=r(e=>{const{getBlockOrder:t,getBlockListSettings:n,getBlockInsertionPoint:o,isBlockBeingDragged:i,getPreviousBlockClientId:s,getNextBlockClientId:l,getSettings:r,__unstableGetEditorMode:c}=e(L),a=o(),d=t(a.rootClientId);if(!d.length)return{};let u=d[a.index-1],f=d[a.index];for(;i(u);)u=s(u);for(;i(f);)f=l(f);const g=r();return{previousClientId:u,nextClientId:f,orientation:n(a.rootClientId)?.orientation||"vertical",rootClientId:a.rootClientId,isDistractionFree:g.isDistractionFree,isInserterShown:a?.__unstableWithInserter,isZoomOutMode:"zoom-out"===c()}},[]),{getBlockEditingMode:v}=r(L),h=M();const I={start:{opacity:0,scale:0},rest:{opacity:1,scale:1,transition:{delay:b?.5:0,type:"tween"}},hover:{opacity:1,scale:1,transition:{delay:.5,type:"tween"}}},B={start:{scale:h?1:0},rest:{scale:1,transition:{delay:.4,type:"tween"}}};if(p)return null;if(k&&"insert"!==o)return null;const y=e("block-editor-block-list__insertion-point","horizontal"===u||"group"===o?"is-horizontal":"is-vertical");return ve.jsx(st,{previousClientId:f,nextClientId:g,__unstablePopoverSlot:t,__unstableContentRef:n,operation:o,nearestSide:i,children:ve.jsxs(Je.div,{layout:!h,initial:h?"rest":"start",animate:"rest",whileHover:"hover",whileTap:"pressed",exit:"start",ref:d,tabIndex:-1,onClick:function(e){e.target===d.current&&g&&"disabled"!==v(g)&&s(g,-1)},onFocus:function(e){e.target!==d.current&&(a.current=!0)},className:e(y,{"is-with-inserter":b}),onHoverEnd:function(e){e.target!==d.current||a.current||l()},children:[ve.jsx(Je.div,{variants:I,className:"block-editor-block-list__insertion-point-indicator","data-testid":"block-list-insertion-point-indicator"}),b&&ve.jsx(Je.div,{variants:B,className:e("block-editor-block-list__insertion-point-inserter"),children:ve.jsx(at,{position:"bottom center",clientId:g,rootClientId:m,__experimentalIsQuick:!0,onToggle:e=>{a.current=e},onSelectOrClose:()=>{a.current=!1}})})]})})}function fn(e){const{insertionPoint:t,isVisible:n,isBlockListEmpty:o}=r(e=>{const{getBlockInsertionPoint:t,isBlockInsertionPointVisible:n,getBlockCount:o}=e(L),i=t();return{insertionPoint:i,isVisible:n(),isBlockListEmpty:0===o(i?.rootClientId)}},[]);return!n||o?null:"replace"===t.operation?ve.jsx(ft,{...e},`${t.rootClientId}-${t.index}`):ve.jsx(un,{operation:t.operation,nearestSide:t.nearestSide,...e})}function gn(){const e=ke.useContext(dn),t=r(e=>e(L).getSettings().isDistractionFree||"zoom-out"===e(L).__unstableGetEditorMode(),[]),{getBlockListSettings:n,getBlockIndex:o,isMultiSelecting:s,getSelectedBlockClientIds:l,getSettings:a,getTemplateLock:d,__unstableIsWithinBlockOverlay:u,getBlockEditingMode:f,getBlockName:g,getBlockAttributes:b,getParentSectionBlock:p}=m(r(L)),{showInsertionPoint:k,hideInsertionPoint:v}=c(L);return P(r=>{if(!t)return r.addEventListener("mousemove",c),()=>{r.removeEventListener("mousemove",c)};function c(t){if(void 0===e||e.current)return;if(t.target.nodeType===t.target.TEXT_NODE)return;if(s())return;if(!t.target.classList.contains("block-editor-block-list__layout"))return void v();let r;if(!t.target.classList.contains("is-root-container")){r=(t.target.getAttribute("data-block")?t.target:t.target.closest("[data-block]")).getAttribute("data-block")}if(d(r)||"disabled"===f(r)||"core/block"===g(r)||r&&b(r).layout?.isManualPlacement)return;const c=n(r),m=c?.orientation||"vertical",h=!!c?.__experimentalCaptureToolbars,I=t.clientY,B=t.clientX;let y=Array.from(t.target.children).find(e=>{const t=e.getBoundingClientRect();return e.classList.contains("wp-block")&&"vertical"===m&&t.top>I||e.classList.contains("wp-block")&&"horizontal"===m&&(i()?t.right<B:t.left>B)});if(!y)return void v();if(!y.id&&(y=y.firstElementChild,!y))return void v();const C=y.id.slice(6);if(!C||u(C)||p(C))return;if(l().includes(C)&&"vertical"===m&&!h&&!a().hasFixedToolbar)return;const S=y.getBoundingClientRect();if("horizontal"===m&&(t.clientY>S.bottom||t.clientY<S.top)||"vertical"===m&&(t.clientX>S.right||t.clientX<S.left))return void v();const E=o(C);0!==E?k(r,E,{__unstableWithInserter:!0}):v()}},[e,n,o,s,k,v,l,t])}const mn=new Set([I,C,B,y,u,f]);function bn(){const e=r(e=>e(L).isTyping(),[]),{stopTyping:t}=c(L);return P(n=>{if(!e)return;const{ownerDocument:o}=n;let i,s;function l(e){const{clientX:n,clientY:o}=e;i&&s&&(i!==n||s!==o)&&t(),i=n,s=o}return o.addEventListener("mousemove",l),()=>{o.removeEventListener("mousemove",l)}},[e,t])}function pn(){const{isTyping:e}=r(e=>{const{isTyping:t}=e(L);return{isTyping:t()}},[]),{startTyping:t,stopTyping:n}=c(L),o=bn(),i=P(o=>{const{ownerDocument:i}=o,{defaultView:s}=i,l=s.getSelection();if(e){let c;function a(e){const{target:t}=e;c=s.setTimeout(()=>{V(t)||n()})}function d(e){const{keyCode:t}=e;t!==_&&t!==h||n()}function u(){l.isCollapsed||n()}return o.addEventListener("focus",a),o.addEventListener("keydown",d),i.addEventListener("selectionchange",u),()=>{s.clearTimeout(c),o.removeEventListener("focus",a),o.removeEventListener("keydown",d),i.removeEventListener("selectionchange",u)}}function r(e){const{type:n,target:i}=e;V(i)&&o.contains(i)&&("keydown"!==n||function(e){const{keyCode:t,shiftKey:n}=e;return!n&&mn.has(t)}(e))&&t()}return o.addEventListener("keypress",r),o.addEventListener("keydown",r),()=>{o.removeEventListener("keypress",r),o.removeEventListener("keydown",r)}},[e,t,n]);return j([o,i])}function kn({children:e}){return ve.jsx("div",{ref:pn(),children:e})}function vn({clientId:t,rootClientId:o="",position:i="top"}){const[s,l]=ke.useState(!1),{sectionRootClientId:c,sectionClientIds:a,insertionPoint:d,blockInsertionPointVisible:u,blockInsertionPoint:f}=r(e=>{const{getInsertionPoint:t,getBlockOrder:n,getSectionRootClientId:o,isBlockInsertionPointVisible:i,getBlockInsertionPoint:s}=m(e(L)),l=o();return{sectionRootClientId:l,sectionClientIds:n(l),blockOrder:n(l),insertionPoint:t(),blockInsertionPoint:s(),blockInsertionPointVisible:i()}},[]),g=M();if(!t)return;let b=!1;if(!(o===c&&a&&a.includes(t)))return null;const p=0===d?.index&&t===a[d.index],k=d&&d.hasOwnProperty("index")&&t===a[d.index-1];return"top"===i&&(b=p||u&&0===f.index&&t===a[f.index]),"bottom"===i&&(b=k||u&&t===a[f.index-1]),ve.jsx(et,{children:b&&ve.jsx(Je.div,{as:"button",layout:!g,initial:{height:0},animate:{height:"120px"},exit:{height:0},transition:{type:"tween",duration:.2,ease:[.6,0,.4,1]},className:e("block-editor-block-list__zoom-out-separator",{"is-dragged-over":s}),"data-is-insertion-point":"true",onDragOver:()=>l(!0),onDragLeave:()=>l(!1),children:ve.jsx(Je.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{type:"tween",duration:.1},children:n("Drop pattern.")})})})}const hn=ke.createContext(),In=new WeakMap;function Bn({className:t,...n}){const o=A("medium"),{isOutlineMode:i,isFocusMode:s,temporarilyEditingAsBlocks:l}=r(e=>{const{getSettings:t,getTemporarilyEditingAsBlocks:n,isTyping:o}=m(e(L)),{outlineMode:i,focusMode:s}=t();return{isOutlineMode:i&&!o(),isFocusMode:s,temporarilyEditingAsBlocks:n()}},[]),a=Ue(),{setBlockVisibility:d}=c(L),u=R(ke.useCallback(()=>{const e={};In.get(a).forEach(([t,n])=>{e[t]=n}),d(e)},[a]),300,{trailing:!0}),f=ke.useMemo(()=>{const{IntersectionObserver:e}=window;if(e)return new e(e=>{In.get(a)||In.set(a,[]);for(const t of e){const e=t.target.getAttribute("data-block");In.get(a).push([e,t.isIntersecting])}u()})},[]),g=x({ref:j([ot(),gn(),pn()]),className:e("is-root-container",t,{"is-outline-mode":i,"is-focus-mode":s&&o})},n);return ve.jsxs(hn.Provider,{value:f,children:[ve.jsx("div",{...g}),!!l&&ve.jsx(yn,{clientId:l})]})}function yn({clientId:e}){const{stopEditingAsBlocks:t}=m(c(L)),n=r(t=>{const{isBlockSelected:n,hasSelectedInnerBlock:o}=t(L);return n(e)||o(e,!0)},[e]);return ke.useEffect(()=>{n||t(e)},[n,e,t]),null}function Cn(e){return ve.jsx(Ze,{value:qe,children:ve.jsx(Bn,{...e})})}const Sn=[],En=new Set;function _n({placeholder:e,rootClientId:t,renderAppender:n,__experimentalAppenderTagName:o,layout:i=bt}){const s=!1!==n,l=!!n,{order:c,isZoomOut:a,selectedBlocks:d,visibleBlocks:u,shouldRenderAppender:f}=r(e=>{const{getSettings:n,getBlockOrder:o,getSelectedBlockClientId:i,getSelectedBlockClientIds:r,__unstableGetVisibleBlocks:c,getTemplateLock:a,getBlockEditingMode:d,__unstableGetEditorMode:u,isSectionBlock:f}=m(e(L)),g=o(t);if(n().__unstableIsPreviewMode)return{order:g,selectedBlocks:Sn,visibleBlocks:En};const b=i();return{order:g,selectedBlocks:r(),visibleBlocks:c(),isZoomOut:"zoom-out"===u(),shouldRenderAppender:!f(t)&&"disabled"!==d(t)&&!a(t)&&s&&"zoom-out"!==u()&&(l||t===b||!t&&!b&&!g.length)}},[t,s,l]);return ve.jsxs(kt,{value:i,children:[c.map(e=>ve.jsxs(Xe,{value:!u.has(e)&&!d.includes(e),children:[a&&ve.jsx(vn,{clientId:e,rootClientId:t,position:"top"}),ve.jsx(Ht,{rootClientId:t,clientId:e}),a&&ve.jsx(vn,{clientId:e,rootClientId:t,position:"bottom"})]},e)),c.length<1&&e,f&&ve.jsx(an,{tagName:o,rootClientId:t,CustomAppender:n})]})}function xn(e){return ve.jsx(Xe,{value:!1,children:ve.jsx(_n,{...e})})}const wn={placement:"top-start"},Dn={...wn,flip:!1,shift:!0},Ln={...wn,flip:!0,shift:!1};function Pn(e,t,n,o,i){if(!e||!t)return Dn;const s=n?.scrollTop||0,l=be(t),r=s+e.getBoundingClientRect().top,c=e.ownerDocument.documentElement.clientHeight,a=r+o,d=l.top>a,u=l.height>c-o;return i||!d&&!u?Ln:Dn}function Mn({contentElement:e,clientId:t}){const n=Ct(t),[o,i]=ke.useState(0),{blockIndex:s,isSticky:l}=r(e=>{const{getBlockIndex:n,getBlockAttributes:o}=e(L);return{blockIndex:n(t),isSticky:me(o(t))}},[t]),c=ke.useMemo(()=>{if(e)return ne(e)},[e]),[a,d]=ke.useState(()=>Pn(e,n,c,o,l)),u=P(e=>{i(e.offsetHeight)},[]),f=ke.useCallback(()=>d(Pn(e,n,c,o,l)),[e,n,c,o]);return ke.useLayoutEffect(f,[s,f]),ke.useLayoutEffect(()=>{if(!e||!n)return;const t=e?.ownerDocument?.defaultView;let o;t?.addEventHandler?.("resize",f);const i=n?.ownerDocument?.defaultView;return i.ResizeObserver&&(o=new i.ResizeObserver(f),o.observe(n)),()=>{t?.removeEventHandler?.("resize",f),o&&o.disconnect()}},[f,e,n]),{...a,ref:u}}function jn(e){return r(t=>{const{getBlockRootClientId:n,getBlockParents:o,__experimentalGetBlockListSettingsForBlocks:i,isBlockInsertionPointVisible:s,getBlockInsertionPoint:l,getBlockOrder:r,hasMultiSelection:c,getLastMultiSelectedBlockClientId:a}=t(L),d=o(e),u=i(d),f=d.find(e=>u[e]?.__experimentalCaptureToolbars);let g=!1;if(s()){const t=l();g=r(t.rootClientId)[t.index]===e}return{capturingClientId:f,isInsertionPointVisible:g,lastClientId:c()?a():null,rootClientId:n(e)}},[e])}function Tn({clientId:t,__unstableContentRef:n}){const{capturingClientId:o,isInsertionPointVisible:i,lastClientId:s,rootClientId:l}=jn(t),r=Mn({contentElement:n?.current,clientId:t});return ve.jsx(lt,{clientId:o||t,bottomClientId:s,className:e("block-editor-block-list__block-side-inserter-popover",{"is-insertion-point-visible":i}),__unstableContentRef:n,...r,children:ve.jsx("div",{className:"block-editor-block-list__empty-block-inserter",children:ve.jsx(at,{position:"bottom right",rootClientId:l,clientId:t,__experimentalIsQuick:!0})})})}function Nn({clientId:t,isTyping:n,__unstableContentRef:o}){const{capturingClientId:i,isInsertionPointVisible:s,lastClientId:l}=jn(t),r=ke.useRef();ke.useEffect(()=>{r.current=void 0},[t]);const{stopTyping:a}=c(L),d=ke.useRef(!1);oe("core/block-editor/focus-toolbar",()=>{d.current=!0,a(!0)}),ke.useEffect(()=>{d.current=!1});const u=i||t,f=Mn({contentElement:o?.current,clientId:u});return!n&&ve.jsx(rt,{clientId:u,bottomClientId:l,className:e("block-editor-block-list__block-popover",{"is-insertion-point-visible":s}),resize:!1,...f,children:ve.jsx(dt,{focusOnMount:d.current,__experimentalInitialIndex:r.current,__experimentalOnIndexChange:e=>{r.current=e},variant:"toolbar"})})}function An({clientId:e,__unstableContentRef:t}){const o=r(t=>{const{getBlock:n,getNextBlockClientId:o,getPreviousBlockClientId:i,canRemoveBlock:s,canMoveBlock:l,getSettings:r}=t(L),{__experimentalSetIsInserterOpened:c}=r(),{getBlockType:a}=t(we),{name:d}=n(e),u=a(d),f="core/template-part"===u?.name;let g=!1;const m=o();if(m){const{name:e}=n(m),t=a(e);g="core/template-part"===t?.name}let b=!1;const p=i();if(p){const{name:e}=n(p),t=a(e);b="core/template-part"===t?.name}return{isBlockTemplatePart:f,isNextBlockTemplatePart:g,isPrevBlockTemplatePart:b,canRemove:s(e),canMove:l(e),setIsInserterOpened:c}},[e]),{isBlockTemplatePart:i,isNextBlockTemplatePart:s,isPrevBlockTemplatePart:l,canRemove:a,canMove:d,setIsInserterOpened:u}=o,{removeBlock:f,__unstableSetEditorMode:g,resetZoomLevel:b}=m(c(L)),p=d&&!i;return ve.jsxs(w,{className:"zoom-out-toolbar","aria-label":n("Block tools"),variant:"unstyled",orientation:"vertical",children:[p&&ve.jsx(gt,{clientIds:[e],children:e=>ve.jsx($e,{icon:ie,className:"block-selection-button_drag-handle zoom-out-toolbar-button",label:n("Drag"),iconSize:24,size:"compact",tabIndex:"-1",...e})}),!i&&ve.jsx(D,{clientIds:[e],hideDragHandle:!0,isBlockMoverUpButtonDisabled:l,isBlockMoverDownButtonDisabled:s,iconSize:24,size:"compact"}),d&&a&&ve.jsx(ut,{clientId:e,as:tt}),!i&&ve.jsx(tt,{className:"zoom-out-toolbar-button",icon:se,label:n("Edit"),onClick:()=>{"function"==typeof u&&u(!1),g("edit"),b(),t.current?.focus()}}),a&&!i&&ve.jsx(tt,{className:"zoom-out-toolbar-button",icon:le,label:n("Delete"),onClick:()=>{f(e),t.current?.focus()}})]})}function Rn({clientId:t,__unstableContentRef:n}){const{capturingClientId:o,isInsertionPointVisible:i,lastClientId:s}=jn(t),l={...Mn({contentElement:n?.current,clientId:t}),placement:"left-start",flip:!1,shift:!0};return ve.jsx(rt,{clientId:o||t,bottomClientId:s,className:e("zoom-out-toolbar-popover",{"is-insertion-point-visible":i}),resize:!1,...l,children:ve.jsx(An,{__unstableContentRef:n,clientId:t})})}function On({onClick:n}){return ve.jsx($e,{variant:"primary",icon:re,size:"compact",className:e("block-editor-button-pattern-inserter__button","block-editor-block-tools__zoom-out-mode-inserter-button"),onClick:n,label:t("Add pattern","Generic label for pattern inserter button")})}function Vn(){const[e,t]=ke.useState(!1),{hasSelection:n,insertionPoint:o,blockOrder:i,blockInsertionPointVisible:s,setInserterIsOpened:l,sectionRootClientId:a,selectedBlockClientId:d}=r(e=>{const{getSettings:t,getInsertionPoint:n,getBlockOrder:o,getSelectionStart:i,getSelectedBlockClientId:s,getSectionRootClientId:l,isBlockInsertionPointVisible:r}=m(e(L)),c=l();return{hasSelection:!!i().clientId,insertionPoint:n(),blockOrder:o(c),blockInsertionPointVisible:r(),sectionRootClientId:c,setInserterIsOpened:t().__experimentalSetIsInserterOpened,selectedBlockClientId:s()}},[]),{showInsertionPoint:u}=m(c(L));return ke.useEffect(()=>{const e=setTimeout(()=>{t(!0)},500);return()=>{clearTimeout(e)}},[]),e&&n?[void 0,...i].map((e,t)=>{const n=s&&o?.index===t,r=e,c=i[t],f=d===r||d===c;return ve.jsx(st,{previousClientId:r,nextClientId:c,children:!n&&f&&ve.jsx(On,{onClick:()=>{l({rootClientId:a,insertionIndex:t,tab:"patterns",category:"all"}),u(a,t,{operation:"insert"})}})},t)}):null}function zn(e){const{getSelectedBlockClientId:t,getFirstMultiSelectedBlockClientId:n,getSettings:o,__unstableGetEditorMode:i,isTyping:s,isDragging:l}=m(e(L)),r=t()||n(),c=i();return{clientId:r,hasFixedToolbar:o().hasFixedToolbar,isTyping:s(),isZoomOutMode:"zoom-out"===c,isDragging:l()}}function Fn({children:e,__unstableContentRef:t,...o}){const{clientId:i,hasFixedToolbar:s,isTyping:l,isZoomOutMode:a,isDragging:d}=r(zn,[]),u=X(),{getBlocksByClientId:f,getSelectedBlockClientIds:g,getBlockRootClientId:b,isGroupable:p}=r(L),{getGroupingBlockName:k}=r(we),{showEmptyBlockSideInserter:v,showBlockToolbarPopover:h,showZoomOutToolbar:I}=r(e=>{const{getSelectedBlockClientId:t,getFirstMultiSelectedBlockClientId:n,getBlock:o,getBlockMode:i,getSettings:s,__unstableGetEditorMode:l,isTyping:r}=e(L),c=t()||n(),a=o(c),d=l(),u=!!c&&!!a,f=u&&Te(a)&&"html"!==i(c),g=c&&!r()&&"edit"===d&&f,m="zoom-out"===d&&"full"===a?.attributes?.align&&!g;return{showEmptyBlockSideInserter:g,showBlockToolbarPopover:!m&&!s().hasFixedToolbar&&!g&&u&&!f,showZoomOutToolbar:m}},[]),{clearSelectedBlock:B,duplicateBlocks:y,removeBlocks:C,replaceBlocks:S,insertAfterBlock:E,insertBeforeBlock:_,selectBlock:x,moveBlocksUp:w,moveBlocksDown:D,expandBlock:P}=m(c(L)),M=ke.useRef();const j=ct(t),T=ct(t);return ve.jsx("div",{...o,onKeyDown:function(e){if(!e.defaultPrevented)if(u("core/block-editor/move-up",e)){const t=g();if(t.length){e.preventDefault();const n=b(t[0]);w(t,n)}}else if(u("core/block-editor/move-down",e)){const t=g();if(t.length){e.preventDefault();const n=b(t[0]);D(t,n)}}else if(u("core/block-editor/duplicate",e)){const t=g();t.length&&(e.preventDefault(),y(t))}else if(u("core/block-editor/remove",e)){const t=g();t.length&&(e.preventDefault(),C(t))}else if(u("core/block-editor/insert-after",e)){const t=g();t.length&&(e.preventDefault(),E(t[t.length-1]))}else if(u("core/block-editor/insert-before",e)){const t=g();t.length&&(e.preventDefault(),_(t[0]))}else if(u("core/block-editor/unselect",e)){if(e.target.closest("[role=toolbar]"))return;const n=g();n.length>1?(e.preventDefault(),x(n[0])):1===n.length&&e.target===M?.current&&(e.preventDefault(),B(),pe(t.current)?.focus())}else if(u("core/block-editor/collapse-list-view",e)){if(V(e.target)||V(e.target?.contentWindow?.document?.activeElement))return;e.preventDefault(),P(i)}else if(u("core/block-editor/group",e)){const t=g();if(t.length>1&&p(t)){e.preventDefault();const o=f(t),i=k(),s=Ae(o,i);S(t,s),ce(n("Selected blocks are grouped."))}}},children:ve.jsxs(dn.Provider,{value:ke.useRef(!1),children:[!l&&!a&&ve.jsx(fn,{__unstableContentRef:t}),v&&ve.jsx(Tn,{__unstableContentRef:t,clientId:i}),h&&ve.jsx(Nn,{__unstableContentRef:t,clientId:i,isTyping:l}),I&&ve.jsx(Rn,{__unstableContentRef:t,clientId:i}),!a&&!s&&ve.jsx(nt.Slot,{name:"block-toolbar",ref:j}),e,ve.jsx(nt.Slot,{name:"__unstable-block-tools-after",ref:T}),a&&!d&&ve.jsx(Vn,{__unstableContentRef:t})]})})}export{xn as B,ht as L,kn as O,mt as P,rn as W,Ct as a,vt as b,yt as c,ln as d,bn as e,Fn as f,on as g,Cn as h,Rt as i,pn as j,tn as r,nn as s,sn as u};
