import{a as t,c as e,g as i,h as o,b as s}from"./wp-blocks-core-65VcejHr.js";import{s as n,g as a}from"./wp-block-editor-store-BOagVFfu.js";import{u as r,B as l,a as c,b as u}from"./wp-block-editor-misc-Bvzg-2Jv.js";import{P as m}from"./wp-block-editor-preview-WXXja22U.js";import{r as d,j as f}from"./vendor-react-DqgGMt48.js";import{MenuItem as b,Placeholder as p,Button as v,VisuallyHidden as k,__experimentalToggleGroupControl as g,__experimentalToggleGroupControlOptionIcon as h,DropdownMenu as j,MenuGroup as x,MenuItemsChoice as y}from"./wp-components-Uj2D7Nfy.js";import{c as S}from"./vendor-ui-CrFdsnXa.js";import{a as _,s as N}from"./wp-i18n-BuBz6Sgx.js";import{l as B,c as w}from"./wp-misc-DyLrwF9p.js";import{a as V}from"./wp-core-BVMytgUH.js";import{u as C,g as I}from"./wp-block-editor-utils-BmaAXcuk.js";import{g as T,t as $,G as L}from"./wp-block-editor-global-styles-DFEUywv4.js";const M={};function O({clientIds:e,blocks:i}){const{activeBlockVariation:o,blockVariationTransformations:s}=r(o=>{const{getBlockAttributes:s,canRemoveBlocks:a}=o(n),{getActiveBlockVariation:r,getBlockVariations:l}=o(t),c=a(e);if(1!==i.length||!c)return M;const[u]=i;return{blockVariationTransformations:l(u.name,"transform"),activeBlockVariation:r(u.name,s(u.clientId))}},[e,i]);return d.useMemo(()=>s?.filter(({name:t})=>t!==o?.name),[s,o])}const P=({transformations:t,onSelect:i,blocks:o})=>{const[s,n]=d.useState();return f.jsxs(f.Fragment,{children:[s&&f.jsx(m,{blocks:e(o[0],t.find(({name:t})=>t===s).attributes)}),t?.map(t=>f.jsx(z,{item:t,onSelect:i,setHoveredTransformItemName:n},t.name))]})};function z({item:t,onSelect:e,setHoveredTransformItemName:o}){const{name:s,icon:n,title:a}=t;return f.jsxs(b,{className:i(s),onClick:t=>{t.preventDefault(),e(s)},onMouseLeave:()=>o(null),onMouseEnter:()=>o(s),children:[f.jsx(l,{icon:n,showColors:!0}),a]})}function A({children:t,...e}){const i=d.useRef();return d.useEffect(()=>{i.current&&(i.current.textContent=i.current.textContent)},[t]),f.jsx("div",{hidden:!0,...e,ref:i,children:t})}function D({icon:t=B,label:e=_("Choose variation"),instructions:i=_("Select a variation to start with:"),variations:o,onSelect:s,allowSkip:n}){const a=S("block-editor-block-variation-picker",{"has-many-variations":o.length>4});return f.jsxs(p,{icon:t,label:e,instructions:i,className:a,children:[f.jsx("ul",{className:"block-editor-block-variation-picker__variations",role:"list","aria-label":_("Block variations"),children:o.map(t=>f.jsxs("li",{children:[f.jsx(v,{__next40pxDefaultSize:!0,variant:"tertiary",icon:t.icon&&t.icon.src?t.icon.src:t.icon,iconSize:48,onClick:()=>s(t),className:"block-editor-block-variation-picker__variation",label:t.description||t.title}),f.jsx("span",{className:"block-editor-block-variation-picker__variation-label",children:t.title})]},t.name))}),n&&f.jsx("div",{className:"block-editor-block-variation-picker__skip",children:f.jsx(v,{__next40pxDefaultSize:!0,variant:"link",onClick:()=>s(),children:_("Skip")})})]})}function E({className:t,onSelectVariation:e,selectedValue:i,variations:o}){return f.jsxs("fieldset",{className:t,children:[f.jsx(k,{as:"legend",children:_("Transform to variation")}),o.map(t=>f.jsx(v,{__next40pxDefaultSize:!0,size:"compact",icon:f.jsx(l,{icon:t.icon,showColors:!0}),isPressed:i===t.name,label:i===t.name?t.title:N(_("Transform to %s"),t.title),onClick:()=>e(t.name),"aria-label":t.title,showTooltip:!0},t.name))]})}function G({className:t,onSelectVariation:e,selectedValue:i,variations:o}){const s=o.map(({name:t,title:e,description:i})=>({value:t,label:e,info:i}));return f.jsx(j,{className:t,label:_("Transform to variation"),text:_("Transform to variation"),popoverProps:{position:"bottom center",className:`${t}__popover`},icon:w,toggleProps:{iconPosition:"right"},children:()=>f.jsx("div",{className:`${t}__container`,children:f.jsx(x,{children:f.jsx(y,{choices:s,value:i,onSelect:e})})})})}function R({className:t,onSelectVariation:e,selectedValue:i,variations:o}){return f.jsx("div",{className:t,children:f.jsx(g,{label:_("Transform to variation"),value:i,hideLabelFromVision:!0,onChange:e,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,children:o.map(t=>f.jsx(h,{icon:f.jsx(l,{icon:t.icon,showColors:!0}),value:t.name,label:i===t.name?t.title:N(_("Transform to %s"),t.title)},t.name))})})}function F({blockClientId:e}){const{updateBlockAttributes:i}=c(n),{activeBlockVariation:o,variations:s,isContentOnly:a}=r(i=>{const{getActiveBlockVariation:o,getBlockVariations:s}=i(t),{getBlockName:a,getBlockAttributes:r,getBlockEditingMode:l}=i(n),c=e&&a(e),{hasContentRoleAttribute:m}=u(i(t)),d=m(c);return{activeBlockVariation:o(c,r(e)),variations:c&&s(c,"transform"),isContentOnly:"contentOnly"===l(e)&&!d}},[e]),l=o?.name,m=d.useMemo(()=>{const t=new Set;return!!s&&(s.forEach(e=>{e.icon&&t.add(e.icon?.src||e.icon)}),t.size===s.length)},[s]);if(!s?.length||a)return null;const b=s.length>5,p=m?b?E:R:G;return f.jsx(p,{className:"block-editor-block-variation-transforms",onSelectVariation:t=>{i(e,{...s.find(({name:e})=>e===t).attributes})},selectedValue:l,variations:s})}const H={type:"string",source:"attribute",attribute:"aria-label",selector:"*"};const J={addSaveProps:function(t,e,i){return o(e,"ariaLabel")&&(t["aria-label"]=""===i.ariaLabel?null:i.ariaLabel),t},attributeKeys:["ariaLabel"],hasSupport:t=>o(t,"ariaLabel")};V("blocks.registerBlockType","core/ariaLabel/attribute",function(t){return t?.attributes?.ariaLabel?.type||o(t,"ariaLabel")&&(t.attributes={...t.attributes,ariaLabel:H}),t});const K="is-style-";function W(t){return t?t.split(/\s+/).reduce((t,e)=>{if(e.startsWith(K)){const i=e.slice(9);"default"!==i&&t.push(i)}return t},[]):[]}function q({override:t}){C(t)}function Q({config:e}){const{getBlockStyles:i,overrides:o}=r(e=>({getBlockStyles:e(t).getBlockStyles,overrides:u(e(n)).getStyleOverrides()}),[]),{getBlockName:a}=r(n),l=d.useMemo(()=>{if(!o?.length)return;const t=[],n=[];for(const[,r]of o)if(r?.variation&&r?.clientId&&!n.includes(r.clientId)){const o=a(r.clientId),l=e?.styles?.blocks?.[o]?.variations?.[r.variation];if(l){const a={settings:e?.settings,styles:{blocks:{[o]:{variations:{[`${r.variation}-${r.clientId}`]:l}}}}},c=T(s(),i,r.clientId),u=$(a,c,!1,!0,!0,!0,{blockGap:!1,blockStyles:!0,layoutStyles:!1,marginReset:!1,presets:!1,rootPadding:!1,variationStyles:!0});t.push({id:`${r.variation}-${r.clientId}`,css:u,__unstableType:"variation",variation:r.variation,clientId:r.clientId}),n.push(r.clientId)}}return t},[e,o,i,a]);if(l&&l.length)return f.jsx(f.Fragment,{children:l.map(t=>f.jsx(q,{override:t},t.id))})}function U(t,e,i){const{merged:o}=d.useContext(L),{globalSettings:s,globalStyles:l}=r(t=>{const e=t(n).getSettings();return{globalSettings:e.__experimentalFeatures,globalStyles:e[a]}},[]);return d.useMemo(()=>{var n,a,r;const c=function(t,e,i){if(!t?.styles?.blocks?.[e]?.variations?.[i])return;const o=e=>{Object.keys(e).forEach(i=>{const s=e[i];if("object"==typeof s&&null!==s)if(void 0!==s.ref)if("string"!=typeof s.ref||""===s.ref.trim())delete e[i];else{const o=I(t,s.ref);o?e[i]=o:delete e[i]}else o(s),0===Object.keys(s).length&&delete e[i]})},s=JSON.parse(JSON.stringify(t.styles.blocks[e].variations[i]));return o(s),s}({settings:null!==(n=o?.settings)&&void 0!==n?n:s,styles:null!==(a=o?.styles)&&void 0!==a?a:l},t,e);return{settings:null!==(r=o?.settings)&&void 0!==r?r:s,styles:{blocks:{[t]:{variations:{[`${e}-${i}`]:c}}}}}},[o,s,l,e,i,t])}const X={hasSupport:()=>!0,attributeKeys:["className"],isMatch:({className:t})=>W(t).length>0,useBlockProps:function({name:e,className:i,clientId:o}){const{getBlockStyles:n}=r(t),a=function(t,e=[]){const i=W(t);if(!i)return null;for(const o of i)if(e.some(t=>t.name===o))return o;return null}(i,n(e)),l=`${K}${a}-${o}`,{settings:c,styles:u}=U(e,a,o),m=d.useMemo(()=>{if(!a)return;const t={settings:c,styles:u},e=T(s(),n,o);return $(t,e,!1,!0,!0,!0,{blockGap:!1,blockStyles:!0,layoutStyles:!1,marginReset:!1,presets:!1,rootPadding:!1,variationStyles:!0})},[a,c,u,n,o]);return C({id:`variation-${o}`,css:m,__unstableType:"variation",variation:a,clientId:o}),a?{className:l}:{}}};export{A,D as B,Q as _,F as a,P as b,X as c,J as d,O as u};
