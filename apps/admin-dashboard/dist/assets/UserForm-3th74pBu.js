import{a4 as s,a3 as e,r as a,ca as r,V as l,j as t,a5 as i,a1 as d}from"./vendor-react-B2e3hjul.js";import{a as c,o,_ as n,b as m,s as u,l as p}from"./vendor-forms-CCrOMuuw.js";import{B as x,C as h,k as j,l as v,t as N,m as g,L as f,I as b,S as w,f as y,g as C,h as k,i as S}from"./page-gutenberg-C_zDdNV3.js";import{C as U}from"./checkbox-CamNsulW.js";import{a as F}from"./base-Bn37bo7A.js";import"./vendor-monaco-BxJH8uUv.js";import"./vendor-ui-CrFdsnXa.js";import"./vendor-query-gT6dZ-b7.js";import"./vendor-utils-B-KQWpLj.js";import"./wp-all-B6DO5GFQ.js";import"./index-D29lZukw.js";import"./vendor-socket-CMcZe9fK.js";const A=o({email:u().email("Invalid email address"),password:u().min(6,"Password must be at least 6 characters").optional().or(p("")),firstName:u().optional(),lastName:u().optional(),roles:m(u()).min(1,"At least one role is required"),status:n(["active","pending","approved","rejected"])});function P(){const{id:o}=s(),n=e(),[m,u]=a.useState(!1),p=!!o,{register:P,handleSubmit:V,setValue:B,watch:E,formState:{errors:L}}=r({resolver:c(A),defaultValues:{email:"",password:"",firstName:"",lastName:"",roles:["customer"],status:"pending"}}),R=E("roles");a.useEffect(()=>{p&&q()},[o]);const q=async()=>{try{u(!0);const s=await F.get(`/v1/users/${o}`);if(s.data.success){const e=s.data.data;B("email",e.email),B("firstName",e.firstName||""),B("lastName",e.lastName||""),B("roles",e.roles),B("status",e.status)}}catch(s){l.error("Failed to load user"),n("/users")}finally{u(!1)}},I=s=>{const e=R||[];e.includes(s)?e.length>1&&B("roles",e.filter(e=>e!==s)):B("roles",[...e,s])};return t.jsxs("div",{className:"p-6",children:[t.jsx("div",{className:"mb-6",children:t.jsxs(x,{variant:"ghost",onClick:()=>n("/users"),children:[t.jsx(i,{className:"mr-2 h-4 w-4"}),"Back to Users"]})}),t.jsx("form",{onSubmit:V(async s=>{try{u(!0);const e={...s,role:s.roles[0]};p?(e.password||delete e.password,await F.put(`/v1/users/${o}`,e),l.success("User updated successfully")):(await F.post("/v1/users",e),l.success("User created successfully")),n("/users")}catch(e){l.error(e.response?.data?.error||"Failed to save user")}finally{u(!1)}}),children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsx("div",{className:"lg:col-span-2",children:t.jsxs(h,{children:[t.jsxs(j,{children:[t.jsx(v,{children:p?"Edit User":"Add New User"}),t.jsx(N,{children:p?"Update user information":"Create a new user account"})]}),t.jsxs(g,{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(f,{htmlFor:"firstName",children:"First Name"}),t.jsx(b,{id:"firstName",...P("firstName"),placeholder:"John"}),L.firstName&&t.jsx("p",{className:"text-sm text-red-500 mt-1",children:L.firstName.message})]}),t.jsxs("div",{children:[t.jsx(f,{htmlFor:"lastName",children:"Last Name"}),t.jsx(b,{id:"lastName",...P("lastName"),placeholder:"Doe"}),L.lastName&&t.jsx("p",{className:"text-sm text-red-500 mt-1",children:L.lastName.message})]})]}),t.jsxs("div",{children:[t.jsx(f,{htmlFor:"email",children:"Email"}),t.jsx(b,{id:"email",type:"email",...P("email"),placeholder:"john.doe@example.com",disabled:p}),L.email&&t.jsx("p",{className:"text-sm text-red-500 mt-1",children:L.email.message})]}),t.jsxs("div",{children:[t.jsxs(f,{htmlFor:"password",children:["Password ",p&&"(leave blank to keep current)"]}),t.jsx(b,{id:"password",type:"password",...P("password"),placeholder:p?"Leave blank to keep current":"Enter password"}),L.password&&t.jsx("p",{className:"text-sm text-red-500 mt-1",children:L.password.message})]}),t.jsxs("div",{children:[t.jsx(f,{htmlFor:"status",children:"Status"}),t.jsxs(w,{value:E("status"),onValueChange:s=>B("status",s),children:[t.jsx(y,{children:t.jsx(C,{placeholder:"Select status"})}),t.jsxs(k,{children:[t.jsx(S,{value:"active",children:"Active"}),t.jsx(S,{value:"pending",children:"Pending"}),t.jsx(S,{value:"approved",children:"Approved"}),t.jsx(S,{value:"rejected",children:"Rejected"})]})]}),L.status&&t.jsx("p",{className:"text-sm text-red-500 mt-1",children:L.status.message})]})]})]})}),t.jsxs("div",{children:[t.jsxs(h,{children:[t.jsxs(j,{children:[t.jsx(v,{children:"User Roles"}),t.jsx(N,{children:"Select one or more roles for this user"})]}),t.jsxs(g,{children:[t.jsx("div",{className:"space-y-3",children:[{value:"super_admin",label:"Super Admin",description:"Full system access"},{value:"admin",label:"Admin",description:"Administrative access"},{value:"vendor",label:"Vendor",description:"Vendor/supplier access"},{value:"seller",label:"Seller",description:"Can sell products"},{value:"customer",label:"Customer",description:"Regular user"},{value:"business",label:"Business",description:"Business account"},{value:"moderator",label:"Moderator",description:"Content moderation"},{value:"partner",label:"Partner",description:"Partner access"}].map(s=>t.jsxs("div",{className:"flex items-start space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>I(s.value),children:[t.jsx(U,{checked:R?.includes(s.value)||!1,onCheckedChange:()=>I(s.value),onClick:s=>s.stopPropagation()}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"font-medium",children:s.label}),t.jsx("div",{className:"text-sm text-gray-600",children:s.description})]})]},s.value))}),L.roles&&t.jsx("p",{className:"text-sm text-red-500 mt-2",children:L.roles.message})]})]}),t.jsxs("div",{className:"mt-6 flex gap-3",children:[t.jsxs(x,{type:"submit",className:"flex-1",disabled:m,children:[t.jsx(d,{className:"mr-2 h-4 w-4"}),m?"Saving...":p?"Update User":"Create User"]}),t.jsx(x,{type:"button",variant:"outline",onClick:()=>n("/users"),disabled:m,children:"Cancel"})]})]})]})})]})}export{P as default};
