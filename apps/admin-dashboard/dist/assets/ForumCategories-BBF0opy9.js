import{r as u,V as n,j as e,x as k,cl as F,J as q,z}from"./vendor-react-LfmQXg7x.js";import{u as Q,a as $,b as h}from"./vendor-query-D_Ku9Rpr.js";import{j as l,B as c,w as E,x as K,y as L,z as M,E as O,L as d,I as y,T as P,F as T}from"./page-gutenberg-Bgd5YFXg.js";import{S as I}from"./page-template-editor-oe7vVC5R.js";import"./wp-blocks-CxaEvwYA.js";import"./wp-i18n-DqTnaU2e.js";import"./wp-core-B49sp2kV.js";import"./vendor-ui-BkLtITBR.js";import"./wp-misc-ifGAUd0I.js";import"./wp-data-DJ51zZuL.js";import"./vendor-monaco-cpVGocfO.js";import"./vendor-utils-DQ8F5vJI.js";import"./wp-components-CCcEz8J1.js";const se=()=>{const o=Q(),[N,x]=u.useState(!1),[i,m]=u.useState(null),[a,r]=u.useState({name:"",slug:"",description:"",active:!0}),{data:j=[],isLoading:w}=$({queryKey:["forum-categories"],queryFn:async()=>(await l.api.get("/v1/forum/categories")).data.data}),g=h({mutationFn:async s=>(await l.api.post("/v1/forum/categories",s)).data,onSuccess:()=>{n.success("카테고리가 생성되었습니다"),o.invalidateQueries({queryKey:["forum-categories"]}),p()}}),f=h({mutationFn:async({id:s,data:t})=>(await l.api.put(`/v1/forum/categories/${s}`,t)).data,onSuccess:()=>{n.success("카테고리가 수정되었습니다"),o.invalidateQueries({queryKey:["forum-categories"]}),p()}}),b=h({mutationFn:async s=>(await l.api.delete(`/v1/forum/categories/${s}`)).data,onSuccess:()=>{n.success("카테고리가 삭제되었습니다"),o.invalidateQueries({queryKey:["forum-categories"]})}}),v=s=>{s?(m(s),r({name:s.name,slug:s.slug,description:s.description,active:s.active})):(m(null),r({name:"",slug:"",description:"",active:!0})),x(!0)},p=()=>{x(!1),m(null),r({name:"",slug:"",description:"",active:!0})},C=s=>{if(s.preventDefault(),!a.name.trim()){n.error("카테고리 이름을 입력하세요");return}i?f.mutate({id:i.id,data:a}):g.mutate(a)},D=s=>{if(s.postCount>0){n.error("게시글이 있는 카테고리는 삭제할 수 없습니다");return}confirm(`"${s.name}" 카테고리를 삭제하시겠습니까?`)&&b.mutate(s.id)},S=s=>s.toLowerCase().replace(/[^a-z0-9가-힣]+/g,"-").replace(/^-+|-+$/g,"");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-modern-text-primary",children:"포럼 카테고리"}),e.jsx("p",{className:"text-modern-text-secondary mt-1",children:"포럼 카테고리를 관리하세요."})]}),e.jsxs(c,{onClick:()=>v(),children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"새 카테고리"]})]}),e.jsx("div",{className:"wp-card",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-modern-bg-tertiary border-b border-modern-border-primary",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"순서"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"이름"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"설명"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"게시글 수"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"상태"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-modern-text-secondary uppercase tracking-wider",children:"작업"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-modern-border-primary",children:w?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-modern-primary"})})})}):j.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-modern-text-secondary",children:"카테고리가 없습니다."})}):j.map(s=>e.jsxs("tr",{className:"hover:bg-modern-bg-hover",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(F,{className:"w-5 h-5 text-modern-text-tertiary cursor-move"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-modern-text-primary",children:s.name}),e.jsxs("p",{className:"text-xs text-modern-text-secondary",children:["/",s.slug]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("p",{className:"text-sm text-modern-text-secondary truncate max-w-xs",children:s.description||"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-modern-text-primary",children:s.postCount}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${s.active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:s.active?"활성":"비활성"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>v(s),children:e.jsx(q,{className:"w-4 h-4"})}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>D(s),disabled:s.postCount>0,children:e.jsx(z,{className:"w-4 h-4 text-destructive"})})]})})]},s.id))})]})})}),e.jsx(E,{open:N,onOpenChange:x,children:e.jsx(K,{children:e.jsxs("form",{onSubmit:C,children:[e.jsxs(L,{children:[e.jsx(M,{children:i?"카테고리 수정":"새 카테고리"}),e.jsx(O,{children:"포럼 카테고리 정보를 입력하세요."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"name",children:"이름 *"}),e.jsx(y,{id:"name",value:a.name,onChange:s=>{r(t=>({...t,name:s.target.value,slug:i?t.slug:S(s.target.value)}))},placeholder:"예: 일반 토론",required:!0})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"slug",children:"Slug"}),e.jsx(y,{id:"slug",value:a.slug,onChange:s=>r(t=>({...t,slug:s.target.value})),placeholder:"예: general-discussion"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"description",children:"설명"}),e.jsx(P,{id:"description",value:a.description,onChange:s=>r(t=>({...t,description:s.target.value})),placeholder:"카테고리에 대한 설명을 입력하세요...",rows:3})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"active",children:"활성화"}),e.jsx("p",{className:"text-sm text-modern-text-secondary",children:"비활성화 시 게시글 작성이 불가능합니다"})]}),e.jsx(I,{id:"active",checked:a.active,onCheckedChange:s=>r(t=>({...t,active:s}))})]})]}),e.jsxs(T,{children:[e.jsx(c,{type:"button",variant:"outline",onClick:p,children:"취소"}),e.jsx(c,{type:"submit",disabled:g.isPending||f.isPending,children:i?"수정":"생성"})]})]})})})]})};export{se as default};
