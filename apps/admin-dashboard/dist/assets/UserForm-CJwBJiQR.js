import{b as s,u as e,r,cR as a,V as t,j as i,A as o,S as l}from"./vendor-react-BQ6HOJoh.js";import{a as d,o as c,_ as m,b as p,s as n,l as j}from"./vendor-forms-wv2ZtvHS.js";import{B as u,L as x,I as h,S as v,h as b,i as w,j as k,k as N}from"./page-template-editor-C7FodHrK.js";import{C as g}from"./checkbox-BfnqKnJs.js";import{ak as f,al as y,am as C,aw as S,an as F}from"./wp-misc-DS9m4_P2.js";import{a as U}from"./base-CCc79OzR.js";import"./wp-block-editor-a11y-DrduSWFW.js";import"./wp-block-editor-misc-pHCPYvR2.js";import"./wp-block-editor-api-Buev8_QU.js";import"./wp-block-editor-utils-M5qXzE1L.js";import"./wp-block-editor-colors-D38h-Odz.js";import"./wp-blocks-core-6vwQKPfS.js";import"./wp-block-editor-clipboard-Dg0Y1gQ6.js";import"./wp-block-editor-store-B-g1aSix.js";import"./vendor-ui-CrFdsnXa.js";import"./wp-block-editor-dnd-BYoS8-II.js";import"./wp-block-editor-library-BpQvynjE.js";import"./wp-block-editor-menus-BTQ2wZ-f.js";import"./wp-block-editor-keyboard-CeHTtvP5.js";import"./wp-block-editor-typography-Bl_1REQP.js";import"./wp-block-editor-spacing-BD_2CpN7.js";import"./wp-block-editor-core-DL280tSA.js";import"./wp-block-editor-selection-CC4tJpUu.js";import"./wp-block-editor-formats-CLXkimOp.js";import"./wp-block-editor-inline-CpXpUhQU.js";import"./wp-block-editor-ui-B8YE_4QL.js";import"./wp-block-editor-transforms-jLcKa8Hv.js";import"./wp-block-editor-preview-iw2Xu1ib.js";import"./wp-block-editor-global-styles-CV5-K6QF.js";import"./wp-block-editor-borders-BH1devca.js";import"./wp-block-editor-patterns-BXdHo9lm.js";import"./wp-block-editor-navigation-BFSoKzg0.js";import"./wp-block-editor-media-Bg-JiQDT.js";import"./wp-api-BeoadipR.js";import"./wp-i18n-DGPtqsXY.js";import"./wp-core-Y-jV-nrZ.js";import"./vendor-monaco-BxJH8uUv.js";import"./wp-block-editor-upload-BLw1R9wP.js";import"./vendor-utils-D-spY-QM.js";import"./wp-block-editor-templates-o1_wAMb9.js";import"./vendor-query-LYSOqK5P.js";import"./wp-data-BmtL8k4r.js";import"./wp-components-CeQNCpMW.js";import"./index-C-wyiE3c.js";import"./vendor-socket-CMcZe9fK.js";const A=c({email:n().email("Invalid email address"),password:n().min(6,"Password must be at least 6 characters").optional().or(j("")),firstName:n().optional(),lastName:n().optional(),roles:p(n()).min(1,"At least one role is required"),status:m(["active","pending","approved","rejected"])});function P(){const{id:c}=s(),m=e(),[p,n]=r.useState(!1),j=!!c,{register:P,handleSubmit:V,setValue:B,watch:E,formState:{errors:R}}=a({resolver:d(A),defaultValues:{email:"",password:"",firstName:"",lastName:"",roles:["customer"],status:"pending"}}),q=E("roles");r.useEffect(()=>{j&&L()},[c]);const L=async()=>{try{n(!0);const s=await U.get(`/v1/users/${c}`);if(s.data.success){const e=s.data.data;B("email",e.email),B("firstName",e.firstName||""),B("lastName",e.lastName||""),B("roles",e.roles),B("status",e.status)}}catch(s){t.error("Failed to load user"),m("/users")}finally{n(!1)}},D=s=>{const e=q||[];e.includes(s)?e.length>1&&B("roles",e.filter(e=>e!==s)):B("roles",[...e,s])};return i.jsxs("div",{className:"p-6",children:[i.jsx("div",{className:"mb-6",children:i.jsxs(u,{variant:"ghost",onClick:()=>m("/users"),children:[i.jsx(o,{className:"mr-2 h-4 w-4"}),"Back to Users"]})}),i.jsx("form",{onSubmit:V(async s=>{try{n(!0);const e={...s,role:s.roles[0]};j?(e.password||delete e.password,await U.put(`/v1/users/${c}`,e),t.success("User updated successfully")):(await U.post("/v1/users",e),t.success("User created successfully")),m("/users")}catch(e){t.error(e.response?.data?.error||"Failed to save user")}finally{n(!1)}}),children:i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[i.jsx("div",{className:"lg:col-span-2",children:i.jsxs(f,{children:[i.jsxs(y,{children:[i.jsx(C,{children:j?"Edit User":"Add New User"}),i.jsx(S,{children:j?"Update user information":"Create a new user account"})]}),i.jsxs(F,{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx(x,{htmlFor:"firstName",children:"First Name"}),i.jsx(h,{id:"firstName",...P("firstName"),placeholder:"John"}),R.firstName&&i.jsx("p",{className:"text-sm text-red-500 mt-1",children:R.firstName.message})]}),i.jsxs("div",{children:[i.jsx(x,{htmlFor:"lastName",children:"Last Name"}),i.jsx(h,{id:"lastName",...P("lastName"),placeholder:"Doe"}),R.lastName&&i.jsx("p",{className:"text-sm text-red-500 mt-1",children:R.lastName.message})]})]}),i.jsxs("div",{children:[i.jsx(x,{htmlFor:"email",children:"Email"}),i.jsx(h,{id:"email",type:"email",...P("email"),placeholder:"john.doe@example.com",disabled:j}),R.email&&i.jsx("p",{className:"text-sm text-red-500 mt-1",children:R.email.message})]}),i.jsxs("div",{children:[i.jsxs(x,{htmlFor:"password",children:["Password ",j&&"(leave blank to keep current)"]}),i.jsx(h,{id:"password",type:"password",...P("password"),placeholder:j?"Leave blank to keep current":"Enter password"}),R.password&&i.jsx("p",{className:"text-sm text-red-500 mt-1",children:R.password.message})]}),i.jsxs("div",{children:[i.jsx(x,{htmlFor:"status",children:"Status"}),i.jsxs(v,{value:E("status"),onValueChange:s=>B("status",s),children:[i.jsx(b,{children:i.jsx(w,{placeholder:"Select status"})}),i.jsxs(k,{children:[i.jsx(N,{value:"active",children:"Active"}),i.jsx(N,{value:"pending",children:"Pending"}),i.jsx(N,{value:"approved",children:"Approved"}),i.jsx(N,{value:"rejected",children:"Rejected"})]})]}),R.status&&i.jsx("p",{className:"text-sm text-red-500 mt-1",children:R.status.message})]})]})]})}),i.jsxs("div",{children:[i.jsxs(f,{children:[i.jsxs(y,{children:[i.jsx(C,{children:"User Roles"}),i.jsx(S,{children:"Select one or more roles for this user"})]}),i.jsxs(F,{children:[i.jsx("div",{className:"space-y-3",children:[{value:"super_admin",label:"Super Admin",description:"Full system access"},{value:"admin",label:"Admin",description:"Administrative access"},{value:"vendor",label:"Vendor",description:"Vendor/supplier access"},{value:"seller",label:"Seller",description:"Can sell products"},{value:"customer",label:"Customer",description:"Regular user"},{value:"business",label:"Business",description:"Business account"},{value:"moderator",label:"Moderator",description:"Content moderation"},{value:"partner",label:"Partner",description:"Partner access"}].map(s=>i.jsxs("div",{className:"flex items-start space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>D(s.value),children:[i.jsx(g,{checked:q?.includes(s.value)||!1,onCheckedChange:()=>D(s.value),onClick:s=>s.stopPropagation()}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"font-medium",children:s.label}),i.jsx("div",{className:"text-sm text-gray-600",children:s.description})]})]},s.value))}),R.roles&&i.jsx("p",{className:"text-sm text-red-500 mt-2",children:R.roles.message})]})]}),i.jsxs("div",{className:"mt-6 flex gap-3",children:[i.jsxs(u,{type:"submit",className:"flex-1",disabled:p,children:[i.jsx(l,{className:"mr-2 h-4 w-4"}),p?"Saving...":j?"Update User":"Create User"]}),i.jsx(u,{type:"button",variant:"outline",onClick:()=>m("/users"),disabled:p,children:"Cancel"})]})]})]})})]})}export{P as default};
