import{j as s,d4 as e,bx as r,r as l}from"./vendor-react-BqkIXTmC.js";import{cF as a,cG as t,cH as i,cR as d,cI as c}from"./wp-misc-D0_U3Yh3.js";import{S as n,h as o,i as m,j as x,k as h,B as j}from"./page-template-editor-DmUXhR56.js";import{a as p}from"./api-client-CxLCD9ze.js";import"./vendor-monaco-BxJH8uUv.js";import"./vendor-ui-CrFdsnXa.js";import"./vendor-query-C5jzPyjL.js";import"./vendor-utils-C9jLuAcl.js";import"./wp-data-CsLR-lZb.js";import"./wp-block-editor-main-DEdKEcH7.js";import"./wp-block-editor-store-Cdz5rmmV.js";import"./wp-blocks-core-C_Umt3qd.js";import"./wp-core-skmJSxj5.js";import"./wp-i18n-DP14Ry5v.js";import"./wp-block-editor-utils-CmROb2t9.js";import"./wp-components-i3qvAB06.js";import"./wp-api-Dq90bqIA.js";function u(){return s.jsxs(a,{className:"w-full max-w-4xl mx-auto",children:[s.jsxs(t,{children:[s.jsxs(i,{className:"flex items-center gap-2",children:[s.jsx(e,{className:"w-6 h-6 text-green-500"}),"3가지 시스템 통합 완료!"]}),s.jsx(d,{children:"Loop 블록 + Input 폼 + CPT/ACF 시스템이 완벽하게 연동되었습니다"})]}),s.jsxs(c,{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-3",children:"✅ 완료된 작업"}),s.jsxs("ul",{className:"space-y-2 text-sm",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx(e,{className:"w-4 h-4 text-green-500 mt-0.5"}),s.jsxs("div",{children:[s.jsx("strong",{children:"API 데이터 표준화:"})," CustomPost → WordPress REST API 형식 변환"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx(e,{className:"w-4 h-4 text-green-500 mt-0.5"}),s.jsxs("div",{children:[s.jsx("strong",{children:"ACF 필드 자동 매핑:"})," fields → acf 객체 변환"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx(e,{className:"w-4 h-4 text-green-500 mt-0.5"}),s.jsxs("div",{children:[s.jsx("strong",{children:"Loop 블록 CPT 연동:"})," CPT API 엔드포인트 직접 사용"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx(e,{className:"w-4 h-4 text-green-500 mt-0.5"}),s.jsxs("div",{children:[s.jsx("strong",{children:"자동 갱신 시스템:"})," 30초 주기 자동 새로고침"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx(e,{className:"w-4 h-4 text-green-500 mt-0.5"}),s.jsxs("div",{children:[s.jsx("strong",{children:"폼 제출 연동:"})," 이벤트 버스를 통한 실시간 갱신"]})]})]})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[s.jsx(r,{className:"w-4 h-4"}),"작동 방식"]}),s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg text-sm space-y-2",children:[s.jsxs("p",{children:["1. ",s.jsx("strong",{children:"폼 입력"})," → CPT/ACF 데이터베이스에 저장"]}),s.jsxs("p",{children:["2. ",s.jsx("strong",{children:"이벤트 발생"})," → eventBus.emit(EVENTS.POST_CREATED)"]}),s.jsxs("p",{children:["3. ",s.jsx("strong",{children:"Loop 블록 감지"})," → 자동으로 데이터 갱신"]}),s.jsxs("p",{children:["4. ",s.jsx("strong",{children:"UI 업데이트"})," → 새로운 콘텐츠 즉시 표시"]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-3",children:"🚀 사용 가능한 기능"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"border rounded-lg p-3",children:[s.jsx("h4",{className:"font-medium mb-1",children:"자동 갱신"}),s.jsx("p",{className:"text-sm text-gray-600",children:"30초마다 자동으로 최신 데이터 로드"})]}),s.jsxs("div",{className:"border rounded-lg p-3",children:[s.jsx("h4",{className:"font-medium mb-1",children:"실시간 반영"}),s.jsx("p",{className:"text-sm text-gray-600",children:"폼 제출 시 Loop 블록 즉시 갱신"})]}),s.jsxs("div",{className:"border rounded-lg p-3",children:[s.jsx("h4",{className:"font-medium mb-1",children:"WordPress 호환"}),s.jsx("p",{className:"text-sm text-gray-600",children:"WordPress REST API 형식 지원"})]}),s.jsxs("div",{className:"border rounded-lg p-3",children:[s.jsx("h4",{className:"font-medium mb-1",children:"유연한 UI/UX"}),s.jsx("p",{className:"text-sm text-gray-600",children:"무제한 커스터마이징 가능"})]})]})]}),s.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[s.jsx("h3",{className:"font-semibold mb-2",children:"🧪 테스트 방법"}),s.jsxs("ol",{className:"text-sm space-y-1 list-decimal list-inside",children:[s.jsx("li",{children:"Gutenberg 에디터에서 Loop 블록 추가"}),s.jsx("li",{children:"Post Type 선택 (예: products)"}),s.jsx("li",{children:"다른 탭에서 해당 CPT 폼으로 새 항목 추가"}),s.jsx("li",{children:"Loop 블록이 자동으로 갱신되는 것 확인"})]})]})]})]})}function g(){const[e,r]=l.useState([]),[d,g]=l.useState(!1),[N,b]=l.useState(null),[f,v]=l.useState("products"),[P,w]=l.useState(0),[y,C]=l.useState(1),T=async()=>{g(!0),b(null);try{const s=await p.get(`/cpt/${f}/posts`,{params:{per_page:10,page:y,_embed:!0,orderby:"date",order:"desc"}});r(s.data);const e=s.headers["x-wp-totalpages"];e&&w(parseInt(e))}catch(s){b(s.message||"Failed to fetch posts")}finally{g(!1)}};l.useEffect(()=>{T()},[f,y]);return s.jsxs("div",{className:"container mx-auto p-6",children:[s.jsx("div",{className:"mb-8",children:s.jsx(u,{})}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Loop Block API Test"}),s.jsxs("div",{className:"flex gap-4 items-center mb-4",children:[s.jsxs(n,{value:f,onValueChange:v,children:[s.jsx(o,{className:"w-48",children:s.jsx(m,{})}),s.jsxs(x,{children:[s.jsx(h,{value:"products",children:"Products"}),s.jsx(h,{value:"services",children:"Services"}),s.jsx(h,{value:"events",children:"Events"}),s.jsx(h,{value:"testimonials",children:"Testimonials"})]})]}),s.jsx(j,{onClick:T,disabled:d,children:d?"Loading...":"Refresh"})]}),N&&s.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:N})]}),s.jsxs("div",{className:"grid gap-4",children:[0===e.length&&!d&&s.jsx(a,{children:s.jsx(c,{className:"text-center py-8",children:s.jsx("p",{className:"text-gray-500",children:"No posts found for this post type."})})}),e.map(e=>{const r=e._embedded?.["wp:featuredmedia"]?.[0]?.source_url,l=e._embedded?.author?.[0]?.name||"Unknown";return s.jsxs(a,{className:"mb-4",children:[s.jsxs(t,{children:[s.jsx(i,{children:e.title.rendered}),s.jsxs("div",{className:"text-sm text-gray-500",children:["By ",l," on ",new Date(e.date).toLocaleDateString()]})]}),s.jsxs(c,{children:[r&&s.jsx("img",{src:r,alt:e.title.rendered,className:"w-full h-48 object-cover mb-4 rounded"}),s.jsx("div",{className:"prose max-w-none",dangerouslySetInnerHTML:{__html:e.content.rendered}}),e.acf&&Object.keys(e.acf).length>0&&s.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded",children:[s.jsx("h4",{className:"font-semibold mb-2",children:"Custom Fields (ACF):"}),s.jsx("pre",{className:"text-xs overflow-auto",children:JSON.stringify(e.acf,null,2)})]})]})]},e.id)})]}),P>1&&s.jsxs("div",{className:"flex justify-center gap-2 mt-6",children:[s.jsx(j,{variant:"outline",onClick:()=>C(s=>Math.max(1,s-1)),disabled:1===y,children:"Previous"}),s.jsxs("span",{className:"flex items-center px-4",children:["Page ",y," of ",P]}),s.jsx(j,{variant:"outline",onClick:()=>C(s=>Math.min(P,s+1)),disabled:y===P,children:"Next"})]}),s.jsxs("div",{className:"mt-8 p-4 bg-blue-50 rounded",children:[s.jsx("h3",{className:"font-semibold mb-2",children:"API Endpoint:"}),s.jsxs("code",{className:"text-sm",children:["/api/v1/cpt/",f,"/posts?per_page=10&page=1&_embed=true"]}),s.jsx("p",{className:"text-sm mt-2",children:"This endpoint returns WordPress REST API formatted data that can be consumed by the Loop block."})]}),s.jsxs("div",{className:"mt-4 p-4 bg-green-50 rounded",children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Integration Status:"}),s.jsxs("ul",{className:"text-sm space-y-1",children:[s.jsx("li",{children:"✅ WordPress Post 형식 변환 완료"}),s.jsx("li",{children:"✅ ACF 필드 매핑 (fields → acf) 완료"}),s.jsx("li",{children:"✅ Loop 블록 CPT API 연동 완료"}),s.jsx("li",{children:"✅ WordPress API 미들웨어 설정 완료"})]}),s.jsx("p",{className:"text-sm mt-2",children:"이제 Gutenberg 에디터의 Loop 블록에서 CPT 데이터를 불러올 수 있습니다."})]})]})}export{g as default};
