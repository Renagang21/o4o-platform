import{u as he,r,j as e,w as xe,C as A,ay as pe,bj as W,B as G,R as ge,as as be,z as o,c6 as fe,c7 as K,a2 as ye}from"./vendor-react-P__8vGRG.js";import{A as je}from"./index-C0gS3Jf3.js";import"./vendor-query-CucHvDcH.js";import"./page-template-editor-BTdVTS-a.js";import"./vendor-ui-BkLtITBR.js";import"./vendor-utils-dq2XMRwt.js";import"./vendor-socket-DgcwqWsT.js";const Ne=()=>{const D=he(),[b,x]=r.useState([]),[X,z]=r.useState(!0),[B,v]=r.useState(null),[u,k]=r.useState(()=>sessionStorage.getItem("pages-active-tab")||"all");r.useEffect(()=>{(async()=>{try{z(!0);const s=localStorage.getItem("accessToken")||localStorage.getItem("token"),i="https://api.neture.co.kr",d=new URLSearchParams;d.append("type","page"),d.append("per_page","1000");const l=await fetch(`${i}/api/posts?${d}`,{headers:{Authorization:s?`Bearer ${s}`:""}});if(!l.ok){l.status===401?(v("Authentication required. Please login."),window.location.href="/login"):v(`Failed to fetch pages: ${l.status}`),x([]);return}const a=await l.json(),H=(a.data||a.posts||[]).map(c=>{let U=new Date().toISOString().split("T")[0];try{c.publishedAt?U=new Date(c.publishedAt).toISOString().split("T")[0]:c.createdAt&&(U=new Date(c.createdAt).toISOString().split("T")[0])}catch{}return{id:c.id||c._id,title:c.title||"Untitled",slug:c.slug||"",author:c.author?.name||c.authorName||"Unknown",template:c.template||"Default Template",comments:c.commentCount||0,date:U,status:c.status||"draft",views:c.views||0}});x(H),sessionStorage.setItem("pages-data",JSON.stringify(H)),v(null)}catch{v("Failed to load pages. Please try again."),x([])}finally{z(!1)}})()},[]),r.useEffect(()=>{sessionStorage.setItem("pages-active-tab",u)},[u]);const[h,w]=r.useState(new Set),[R,E]=r.useState(!1),[f,I]=r.useState(""),[S,Y]=r.useState(""),[p,Z]=r.useState(null),[C,O]=r.useState("asc"),[L,Q]=r.useState(!1),[J,ee]=r.useState(20),[n,te]=r.useState({author:!0,template:!0,comments:!0,date:!0,status:!0}),[P,F]=r.useState(null),[m,g]=r.useState({title:"",slug:"",status:"publish",template:"default"}),[se,M]=r.useState(null),y=r.useRef(null);r.useEffect(()=>()=>{y.current&&clearTimeout(y.current)},[]);const j=t=>{te(s=>({...s,[t]:!s[t]}))},T={all:b.length,published:b.filter(t=>t.status==="publish").length,draft:b.filter(t=>t.status==="draft").length,trash:b.filter(t=>t.status==="trash").length},ae=()=>{D("/editor/pages/new")},V=t=>{D(`/editor/pages/${t}`)},re=t=>{F(t.id),g({title:t.title,slug:t.slug,status:t.status,template:t.template||"default"})},le=async()=>{if(P)try{const t=localStorage.getItem("accessToken")||localStorage.getItem("token");(await fetch(`https://api.neture.co.kr/api/posts/${P}`,{method:"PUT",headers:{Authorization:t?`Bearer ${t}`:"","Content-Type":"application/json"},body:JSON.stringify(m)})).ok?(x(d=>d.map(l=>l.id===P?{...l,...m}:l)),F(null),o.success("Page updated successfully")):o.error("Failed to update page")}catch{o.error("Failed to update page")}},ne=()=>{F(null),g({title:"",slug:"",status:"publish",template:"default"})},oe=async t=>{if(confirm("정말 이 페이지를 휴지통으로 이동하시겠습니까?"))try{const s=localStorage.getItem("accessToken")||localStorage.getItem("token");(await fetch(`https://api.neture.co.kr/api/posts/${t}`,{method:"PUT",headers:{Authorization:s?`Bearer ${s}`:"","Content-Type":"application/json"},body:JSON.stringify({status:"trash"})})).ok?(x(l=>l.map(a=>a.id===t?{...a,status:"trash"}:a)),o.success("Page moved to trash")):o.error("Failed to delete page")}catch{o.error("Failed to delete page")}},ce=async t=>{if(confirm("이 페이지를 영구적으로 삭제하시겠습니까? 이 작업은 취소할 수 없습니다."))try{const s=localStorage.getItem("accessToken")||localStorage.getItem("token");(await fetch(`https://api.neture.co.kr/api/posts/${t}`,{method:"DELETE",headers:{Authorization:s?`Bearer ${s}`:""}})).ok?(x(l=>l.filter(a=>a.id!==t)),sessionStorage.removeItem("pages-data"),o.success("Page deleted permanently")):o.error("Failed to delete page")}catch{o.error("Failed to delete page")}},ie=async t=>{if(confirm("이 페이지를 복원하시겠습니까?"))try{const s=localStorage.getItem("accessToken")||localStorage.getItem("token");(await fetch(`https://api.neture.co.kr/api/posts/${t}`,{method:"PUT",headers:{Authorization:s?`Bearer ${s}`:"","Content-Type":"application/json"},body:JSON.stringify({status:"draft"})})).ok?(x(l=>l.map(a=>a.id===t?{...a,status:"draft"}:a)),o.success("Page restored")):o.error("Failed to restore page")}catch{o.error("Failed to restore page")}},de=t=>{window.open(`/preview/pages/${t}`,"_blank")},ue=async()=>{if(!f){alert("Please select an action.");return}if(h.size===0){alert("No pages selected.");return}if(f==="trash"&&confirm(`선택한 ${h.size}개의 페이지를 휴지통으로 이동하시겠습니까?`))try{const t=localStorage.getItem("accessToken")||localStorage.getItem("token"),s="https://api.neture.co.kr",i=Array.from(h).map(a=>fetch(`${s}/api/posts/${a}`,{method:"PUT",headers:{Authorization:t?`Bearer ${t}`:"","Content-Type":"application/json"},body:JSON.stringify({status:"trash"})}));(await Promise.all(i)).every(a=>a.ok)?(x(a=>a.map($=>h.has($.id)?{...$,status:"trash"}:$)),w(new Set),I(""),o.success("Pages moved to trash")):o.error("Some pages failed to move to trash")}catch{o.error("Failed to move pages to trash")}},me=()=>{},q=t=>{p===t?O(C==="asc"?"desc":"asc"):(Z(t),O("asc"))},N=(()=>{let t=b;return u==="publish"?t=t.filter(s=>s.status==="publish"):u==="draft"?t=t.filter(s=>s.status==="draft"):u==="trash"&&(t=t.filter(s=>s.status==="trash")),S&&(t=t.filter(s=>s.title.toLowerCase().includes(S.toLowerCase())||s.slug.toLowerCase().includes(S.toLowerCase()))),p&&(t=[...t].sort((s,i)=>{const d=s[p],l=i[p],a=d<l?-1:d>l?1:0;return C==="asc"?a:-a})),t})(),_=t=>{y.current&&clearTimeout(y.current),t?y.current=setTimeout(()=>{M(t)},100):M(null)};return X?e.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"#f0f0f1"},children:e.jsx("div",{className:"text-gray-600",children:"Loading pages..."})}):e.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"#f0f0f1"},children:[B&&e.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mx-8 mt-4",children:e.jsx("p",{className:"text-sm text-yellow-700",children:B})}),e.jsx("div",{className:"bg-white border-b border-gray-200 px-8 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(je,{items:[{label:"Admin"},{label:"페이지"},{label:"모든 페이지"}]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>Q(!L),className:"flex items-center gap-2 px-3 py-1.5 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded transition-colors",children:[e.jsx(xe,{className:"w-4 h-4"}),"Screen Options",e.jsx(A,{className:"w-3 h-3"})]}),L&&e.jsx("div",{className:"absolute right-0 top-full mt-2 w-72 bg-white border border-gray-300 rounded-md shadow-lg z-50",children:e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-medium text-sm mb-3",children:"Columns"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:n.author,onChange:()=>j("author"),className:"mr-2"}),"작성자"]}),e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:n.template,onChange:()=>j("template"),className:"mr-2"}),"템플릿"]}),e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:n.comments,onChange:()=>j("comments"),className:"mr-2"}),"댓글"]}),e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:n.date,onChange:()=>j("date"),className:"mr-2"}),"날짜"]}),e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:n.status,onChange:()=>j("status"),className:"mr-2"}),"상태"]})]}),e.jsxs("div",{className:"border-t border-gray-200 mt-3 pt-3",children:[e.jsx("h3",{className:"font-medium text-sm mb-3",children:"Pagination"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"페이징 항목 수:"}),e.jsx("input",{type:"number",value:J,onChange:t=>ee(Number(t.target.value)),min:"1",max:"999",className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"}),e.jsx("button",{onClick:()=>Q(!1),className:"ml-auto px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"적용"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"1-999 사이의 숫자를 입력하세요"})]})]})})]})]})}),e.jsxs("div",{className:"px-8 py-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("h1",{className:"text-2xl font-normal text-gray-900",children:"Pages"}),e.jsx("button",{onClick:ae,className:"px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-50 transition-colors",children:"Add New"})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("button",{onClick:()=>k("all"),className:`text-sm ${u==="all"?"text-gray-900 font-medium":"text-blue-600 hover:text-blue-800"}`,children:["모든 (",T.all,")"]}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsxs("button",{onClick:()=>k("publish"),className:`text-sm ${u==="publish"?"text-gray-900 font-medium":"text-blue-600 hover:text-blue-800"}`,children:["발행됨 (",T.published,")"]}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsxs("button",{onClick:()=>k("draft"),className:`text-sm ${u==="draft"?"text-gray-900 font-medium":"text-blue-600 hover:text-blue-800"}`,children:["임시글 (",T.draft,")"]}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsxs("button",{onClick:()=>k("trash"),className:`text-sm ${u==="trash"?"text-gray-900 font-medium":"text-blue-600 hover:text-blue-800"}`,children:["휴지통 (",T.trash||0,")"]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>E(!R),className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-white border border-gray-300 rounded hover:bg-gray-50",children:[f==="trash"?"Move to Trash":f==="edit"?"Edit":"Bulk Actions",e.jsx(A,{className:"w-3 h-3"})]}),R&&e.jsxs("div",{className:"absolute left-0 top-full mt-1 w-48 bg-white border border-gray-300 rounded shadow-lg z-20",children:[e.jsx("button",{onClick:()=>{I("edit"),E(!1)},className:"block w-full text-left px-3 py-2 text-sm hover:bg-gray-50",children:"Edit"}),e.jsx("button",{onClick:()=>{I("trash"),E(!1)},className:"block w-full text-left px-3 py-2 text-sm hover:bg-gray-50",children:"Move to Trash"})]})]}),e.jsx("button",{onClick:ue,className:`px-3 py-1.5 text-sm border border-gray-300 rounded transition-colors ${f&&h.size>0?"bg-blue-600 text-white border-blue-600 hover:bg-blue-700":"bg-white hover:bg-gray-50"}`,children:"Apply"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:S,onChange:t=>Y(t.target.value),placeholder:"Search pages...",className:"px-3 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 pr-8"}),e.jsx(pe,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"})]}),e.jsx("button",{onClick:me,className:"px-3 py-1.5 text-sm bg-white border border-gray-300 rounded hover:bg-gray-50",children:"Search Pages"})]})]}),e.jsx("div",{className:"bg-white border border-gray-300 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-white border-b border-gray-200",children:[e.jsx("th",{className:"w-10 px-3 py-2",children:e.jsx("input",{type:"checkbox",checked:h.size>0&&h.size===N.length,onChange:t=>{t.target.checked?w(new Set(N.map(s=>s.id))):w(new Set)},className:"rounded border-gray-300"})}),e.jsx("th",{className:"text-left px-3 py-2",children:e.jsxs("button",{onClick:()=>q("title"),className:"flex items-center gap-1 text-sm font-medium text-gray-900 hover:text-blue-600",children:["제목",p==="title"&&(C==="asc"?e.jsx(W,{className:"w-3 h-3"}):e.jsx(A,{className:"w-3 h-3"}))]})}),n.author&&e.jsx("th",{className:"text-left px-3 py-2 text-sm font-medium text-gray-900",children:"작성자"}),n.template&&e.jsx("th",{className:"text-left px-3 py-2 text-sm font-medium text-gray-900",children:"템플릿"}),n.comments&&e.jsx("th",{className:"text-center px-3 py-2",children:e.jsx(G,{className:"w-4 h-4 text-gray-600 mx-auto"})}),n.date&&e.jsx("th",{className:"text-left px-3 py-2",children:e.jsxs("button",{onClick:()=>q("date"),className:"flex items-center gap-1 text-sm font-medium text-gray-900 hover:text-blue-600",children:["날짜",p==="date"&&(C==="asc"?e.jsx(W,{className:"w-3 h-3"}):e.jsx(A,{className:"w-3 h-3"}))]})}),n.status&&e.jsx("th",{className:"text-left px-3 py-2 text-sm font-medium text-gray-900",children:"상태"})]})}),e.jsx("tbody",{children:N.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-8 text-gray-500",children:"No pages found."})}):N.slice(0,J).map(t=>e.jsx(ge.Fragment,{children:P===t.id?e.jsx("tr",{className:"border-b border-gray-200 bg-gray-50",children:e.jsx("td",{colSpan:100,className:"p-4",children:e.jsxs("div",{className:"bg-white border border-gray-300 rounded p-4",children:[e.jsx("h3",{className:"font-medium text-sm mb-3",children:"Quick Edit Page"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),e.jsx("input",{type:"text",value:m.title,onChange:s=>g({...m,title:s.target.value}),className:"w-full px-3 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Slug"}),e.jsx("input",{type:"text",value:m.slug,onChange:s=>g({...m,slug:s.target.value}),className:"w-full px-3 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:m.status,onChange:s=>g({...m,status:s.target.value}),className:"w-full px-3 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",children:[e.jsx("option",{value:"publish",children:"Published"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"private",children:"Private"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Template"}),e.jsxs("select",{value:m.template||"default",onChange:s=>g({...m,template:s.target.value}),className:"w-full px-3 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",children:[e.jsx("option",{value:"default",children:"Default Template"}),e.jsx("option",{value:"page",children:"Page Template"}),e.jsx("option",{value:"full-width",children:"Full Width"}),e.jsx("option",{value:"no-sidebar",children:"No Sidebar"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx("button",{onClick:ne,className:"px-4 py-2 text-sm border border-gray-300 rounded hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:le,className:"px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"Update Page"})]})]})})}):e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",onMouseEnter:()=>_(t.id),onMouseLeave:()=>_(null),children:[e.jsx("td",{className:"px-3 py-3",children:e.jsx("input",{type:"checkbox",checked:h.has(t.id),onChange:s=>{const i=new Set(h);s.target.checked?i.add(t.id):i.delete(t.id),w(i)},className:"rounded border-gray-300"})}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs("div",{children:[e.jsx("a",{href:`/editor/pages/${t.id}`,className:"text-sm font-medium text-gray-900 hover:text-blue-600",onClick:s=>{s.preventDefault(),V(t.id)},children:t.title}),t.status==="draft"&&e.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"— Draft"}),se===t.id&&e.jsx("div",{className:"flex items-center gap-2 mt-1 text-xs",children:u!=="trash"?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>V(t.id),className:"text-blue-600 hover:text-blue-800",children:"Edit"}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsx("button",{onClick:()=>re(t),className:"text-blue-600 hover:text-blue-800",children:"Quick Edit"}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsx("button",{onClick:()=>oe(t.id),className:"text-red-600 hover:text-red-800",children:"Trash"}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsx("button",{onClick:()=>de(t.id),className:"text-blue-600 hover:text-blue-800",children:"View"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>ie(t.id),className:"text-blue-600 hover:text-blue-800",children:"Restore"}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsx("button",{onClick:()=>ce(t.id),className:"text-red-600 hover:text-red-800",children:"Delete Permanently"})]})})]})}),n.author&&e.jsx("td",{className:"px-3 py-3 text-sm text-gray-600",children:t.author}),n.template&&e.jsx("td",{className:"px-3 py-3 text-sm text-gray-600",children:t.template}),n.comments&&e.jsx("td",{className:"px-3 py-3 text-center",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(G,{className:"w-3 h-3 text-gray-400 mr-1"}),e.jsx("span",{className:"text-sm text-gray-600",children:t.comments})]})}),n.date&&e.jsx("td",{className:"px-3 py-3 text-sm text-gray-600",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(be,{className:"w-3 h-3 text-gray-400"}),t.date]})}),n.status&&e.jsx("td",{className:"px-3 py-3",children:e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${t.status==="publish"?"bg-green-100 text-green-800":t.status==="draft"?"bg-yellow-100 text-yellow-800":t.status==="trash"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:t.status==="publish"?"Published":t.status==="draft"?"Draft":t.status==="trash"?"Trash":t.status})})]})},t.id))})]})}),e.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[N.length," items"]})]})]})},Ee=()=>e.jsxs(fe,{children:[e.jsx(K,{path:"/",element:e.jsx(Ne,{})}),e.jsx(K,{path:"*",element:e.jsx(ye,{to:"/",replace:!0})})]});export{Ee as default};
//# sourceMappingURL=PagesRouter-Rd5URAIp.js.map
