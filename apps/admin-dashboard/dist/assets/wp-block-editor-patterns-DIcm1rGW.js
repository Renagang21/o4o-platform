import{c as e}from"./vendor-ui-CrFdsnXa.js";import{c as t,e as s,a as i,J as a}from"./wp-blocks-core-65VcejHr.js";import{s as l,b as n,a as o,c as r,i as c}from"./wp-i18n-BuBz6Sgx.js";import{u as d,a as p}from"./wp-block-editor-misc-Bvzg-2Jv.js";import{B as m}from"./wp-block-editor-preview-WXXja22U.js";import{t as b,v as u,w as k}from"./wp-block-editor-ui-DwG3jajt.js";import{j as h,r as x}from"./vendor-react-DqgGMt48.js";import{__experimentalVStack as v,__experimentalText as _,__experimentalHStack as j,Button as g,Composite as f,VisuallyHidden as w,Tooltip as N,MenuItem as y,MenuGroup as S,__experimentalTruncate as P,Popover as B}from"./wp-components-Uj2D7Nfy.js";import{d as T,h as C,q as M}from"./wp-core-BVMytgUH.js";import{I as D,bu as I,bv as $,i as z,a$ as W,bw as H,b3 as E,b4 as F}from"./wp-misc-DyLrwF9p.js";import{s as A}from"./wp-block-editor-store-BOagVFfu.js";function L({currentPage:e,numPages:t,changePage:s,totalItems:i}){return h.jsxs(v,{className:"block-editor-patterns__grid-pagination-wrapper",children:[h.jsx(_,{variant:"muted",children:l(n("%s item","%s items",i),i)}),t>1&&h.jsxs(j,{expanded:!1,spacing:3,justify:"flex-start",className:"block-editor-patterns__grid-pagination",children:[h.jsxs(j,{expanded:!1,spacing:1,className:"block-editor-patterns__grid-pagination-previous",children:[h.jsx(g,{variant:"tertiary",onClick:()=>s(1),disabled:1===e,"aria-label":o("First page"),size:"compact",accessibleWhenDisabled:!0,className:"block-editor-patterns__grid-pagination-button",children:h.jsx("span",{children:"«"})}),h.jsx(g,{variant:"tertiary",onClick:()=>s(e-1),disabled:1===e,"aria-label":o("Previous page"),size:"compact",accessibleWhenDisabled:!0,className:"block-editor-patterns__grid-pagination-button",children:h.jsx("span",{children:"‹"})})]}),h.jsx(_,{variant:"muted",children:l(r("%1$s of %2$s","paging"),e,t)}),h.jsxs(j,{expanded:!1,spacing:1,className:"block-editor-patterns__grid-pagination-next",children:[h.jsx(g,{variant:"tertiary",onClick:()=>s(e+1),disabled:e===t,"aria-label":o("Next page"),size:"compact",accessibleWhenDisabled:!0,className:"block-editor-patterns__grid-pagination-button",children:h.jsx("span",{children:"›"})}),h.jsx(g,{variant:"tertiary",onClick:()=>s(t),disabled:e===t,"aria-label":o("Last page"),size:"compact",accessibleWhenDisabled:!0,className:"block-editor-patterns__grid-pagination-button",children:h.jsx("span",{children:"»"})})]})]})]})}const R=({showTooltip:e,title:t,children:s})=>e?h.jsx(N,{text:t,children:s}):h.jsx(h.Fragment,{children:s});function V({id:s,isDraggable:i,pattern:a,onClick:l,onHover:n,showTitle:o=!0,showTooltip:r,category:c}){const[d,p]=x.useState(!1),{blocks:k,viewportWidth:v}=a,_=`block-editor-block-patterns-list__item-description-${T(V)}`,g=x.useMemo(()=>c&&i?(null!=k?k:[]).map(e=>{const s=t(e);return s.attributes.metadata?.categories?.includes(c)&&(s.attributes.metadata.categories=[c]),s}):k,[k,i,c]);return h.jsx(b,{isEnabled:i,blocks:g,pattern:a,children:({draggable:t,onDragStart:i,onDragEnd:c})=>h.jsx("div",{className:"block-editor-block-patterns-list__list-item",draggable:t,onDragStart:e=>{p(!0),i&&(n?.(null),i(e))},onDragEnd:e=>{p(!1),c&&c(e)},children:h.jsx(R,{showTooltip:r&&!a.type!==u.user,title:a.title,children:h.jsxs(f.Item,{render:h.jsx("div",{role:"option","aria-label":a.title,"aria-describedby":a.description?_:void 0,className:e("block-editor-block-patterns-list__item",{"block-editor-block-patterns-list__list-item-synced":a.type===u.user&&!a.syncStatus})}),id:s,onClick:()=>{l(a,k),n?.(null)},onMouseEnter:()=>{d||n?.(a)},onMouseLeave:()=>n?.(null),children:[h.jsx(m,{blocks:k,viewportWidth:v}),o&&h.jsxs(j,{className:"block-editor-patterns__pattern-details",spacing:2,children:[a.type===u.user&&!a.syncStatus&&h.jsx("div",{className:"block-editor-patterns__pattern-icon-wrapper",children:h.jsx(D,{className:"block-editor-patterns__pattern-icon",icon:I})}),(!r||a.type===u.user)&&h.jsx("div",{className:"block-editor-block-patterns-list__item-title",children:a.title})]}),!!a.description&&h.jsx(w,{id:_,children:a.description})]})})})})}function O(){return h.jsx("div",{className:"block-editor-block-patterns-list__item is-placeholder"})}const G=x.forwardRef(function({isDraggable:e,blockPatterns:t,shownPatterns:s,onHover:i,onClickPattern:a,orientation:l,label:n=o("Block patterns"),category:r,showTitle:c=!0,showTitlesAsTooltip:d,pagingProps:p},m){const[b,u]=x.useState(void 0);return x.useEffect(()=>{const e=t.find(e=>s.includes(e))?.name;u(e)},[s,t]),h.jsxs(f,{orientation:l,activeId:b,setActiveId:u,role:"listbox",className:"block-editor-block-patterns-list","aria-label":n,ref:m,children:[t.map(t=>s.includes(t)?h.jsx(V,{id:t.name,pattern:t,onClick:a,onHover:i,isDraggable:e,showTitle:c,showTooltip:d,category:r},t.name):h.jsx(O,{},t.name)),p&&h.jsx(L,{...p})]})});function q(e,t,s){const i=new $(e);return t&&i.remove("is-style-"+t.name),i.add("is-style-"+s.name),i.value}function J(e){return e?.find(e=>e.isDefault)}function K({clientId:e,onSwitch:l}){const{styles:n,block:o,blockType:c,className:m}=d(t=>{const{getBlock:a}=t(A),l=a(e);if(!l)return{};const n=s(l.name),{getBlockStyles:o}=t(i);return{block:l,blockType:n,styles:o(l.name),className:l.attributes.className||""}},[e]),{updateBlockAttributes:b}=p(A),u=function(e){return e&&0!==e.length?J(e)?e:[{name:"default",label:r("Default","block style"),isDefault:!0},...e]:[]}(n),k=function(e,t){for(const s of new $(t).values()){if(-1===s.indexOf("is-style-"))continue;const t=s.substring(9),i=e?.find(({name:e})=>e===t);if(i)return i}return J(e)}(u,m),h=function(e,s){return x.useMemo(()=>{const i=s?.example,l=s?.name;return i&&l?a(l,{attributes:i.attributes,innerBlocks:i.innerBlocks}):e?t(e):void 0},[s?.example?e?.name:e,s])}(o,c);return{onSelect:t=>{const s=q(m,k,t);b(e,{className:s}),l()},stylesToRender:u,activeStyle:k,genericPreviewBlock:h,className:m}}const Q=()=>{};function U({clientId:e,onSwitch:t=Q}){const{onSelect:s,stylesToRender:i,activeStyle:a}=K({clientId:e,onSwitch:t});return i&&0!==i.length?h.jsx(h.Fragment,{children:i.map(e=>{const t=e.label||e.name;return h.jsx(y,{icon:a.name===e.name?z:null,onClick:()=>s(e),children:h.jsx(_,{as:"span",limit:18,ellipsizeMode:"tail",truncate:!0,children:t})},e.name)})}):null}function X({hoveredBlock:e,onSwitch:t}){const{clientId:s}=e;return h.jsx(S,{label:o("Styles"),className:"block-editor-block-switcher__styles__menugroup",children:h.jsx(U,{clientId:s,onSwitch:t})})}function Y({genericPreviewBlock:e,style:t,className:i,activeStyle:a}){const l=s(e.name)?.example,n=q(i,a,t),o=x.useMemo(()=>({...e,title:t.label||t.name,description:t.description,initialAttributes:{...e.attributes,className:n+" block-editor-block-styles__block-preview-container"},example:l}),[e,n]);return h.jsx(k,{item:o})}const Z=()=>{};function ee({clientId:t,onSwitch:s=Z,onHoverClassName:i=Z}){const{onSelect:a,stylesToRender:l,activeStyle:n,genericPreviewBlock:o,className:r}=K({clientId:t,onSwitch:s}),[c,d]=x.useState(null),p=C("medium","<");if(!l||0===l.length)return null;const m=M(d,250),b=e=>{var t;c!==e?(m(e),i(null!==(t=e?.name)&&void 0!==t?t:null)):m.cancel()};return h.jsxs("div",{className:"block-editor-block-styles",children:[h.jsx("div",{className:"block-editor-block-styles__variants",children:l.map(t=>{const s=t.label||t.name;return h.jsx(g,{__next40pxDefaultSize:!0,className:e("block-editor-block-styles__item",{"is-active":n.name===t.name}),variant:"secondary",label:s,onMouseEnter:()=>b(t),onFocus:()=>b(t),onMouseLeave:()=>b(null),onBlur:()=>b(null),onClick:()=>(e=>{a(e),i(null),d(null),m.cancel()})(t),"aria-current":n.name===t.name,children:h.jsx(P,{numberOfLines:1,className:"block-editor-block-styles__item-text",children:s})},t.name)})}),c&&!p&&h.jsx(B,{placement:"left-start",offset:34,focusOnMount:!1,children:h.jsx("div",{className:"block-editor-block-styles__preview-panel",onMouseLeave:()=>b(null),children:h.jsx(Y,{activeStyle:n,className:r,genericPreviewBlock:o,style:c})})})]})}const te="carousel",se="grid",ie=({onBlockPatternSelect:e})=>h.jsx("div",{className:"block-editor-block-pattern-setup__actions",children:h.jsx(g,{__next40pxDefaultSize:!0,variant:"primary",onClick:e,children:o("Choose")})}),ae=({handlePrevious:e,handleNext:t,activeSlide:s,totalSlides:i})=>h.jsxs("div",{className:"block-editor-block-pattern-setup__navigation",children:[h.jsx(g,{size:"compact",icon:c()?E:F,label:o("Previous pattern"),onClick:e,disabled:0===s,accessibleWhenDisabled:!0}),h.jsx(g,{size:"compact",icon:c()?F:E,label:o("Next pattern"),onClick:t,disabled:s===i-1,accessibleWhenDisabled:!0})]}),le=({viewMode:e,setViewMode:t,handlePrevious:s,handleNext:i,activeSlide:a,totalSlides:l,onBlockPatternSelect:n})=>{const r=e===te,c=h.jsxs("div",{className:"block-editor-block-pattern-setup__display-controls",children:[h.jsx(g,{size:"compact",icon:W,label:o("Carousel view"),onClick:()=>t(te),isPressed:r}),h.jsx(g,{size:"compact",icon:H,label:o("Grid view"),onClick:()=>t(se),isPressed:e===se})]});return h.jsxs("div",{className:"block-editor-block-pattern-setup__toolbar",children:[r&&h.jsx(ae,{handlePrevious:s,handleNext:i,activeSlide:a,totalSlides:l}),c,r&&h.jsx(ie,{onBlockPatternSelect:n})]})};const ne=({viewMode:e,activeSlide:t,patterns:s,onBlockPatternSelect:i,showTitles:a})=>{const l="block-editor-block-pattern-setup__container";if(e===te){const e=new Map([[t,"active-slide"],[t-1,"previous-slide"],[t+1,"next-slide"]]);return h.jsx("div",{className:"block-editor-block-pattern-setup__carousel",children:h.jsx("div",{className:l,children:h.jsx("div",{className:"carousel-container",children:s.map((s,i)=>h.jsx(re,{active:i===t,className:e.get(i)||"",pattern:s},s.name))})})})}return h.jsx("div",{className:"block-editor-block-pattern-setup__grid",children:h.jsx(f,{role:"listbox",className:l,"aria-label":o("Patterns list"),children:s.map(e=>h.jsx(oe,{pattern:e,onSelect:i,showTitles:a},e.name))})})};function oe({pattern:e,onSelect:t,showTitles:s}){const i="block-editor-block-pattern-setup-list",{blocks:a,description:l,viewportWidth:n=700}=e,o=T(oe,`${i}__item-description`);return h.jsx("div",{className:`${i}__list-item`,children:h.jsxs(f.Item,{render:h.jsx("div",{"aria-describedby":l?o:void 0,"aria-label":e.title,className:`${i}__item`}),id:`${i}__pattern__${e.name}`,role:"option",onClick:()=>t(a),children:[h.jsx(m,{blocks:a,viewportWidth:n}),s&&h.jsx("div",{className:`${i}__item-title`,children:e.title}),!!l&&h.jsx(w,{id:o,children:l})]})})}function re({active:e,className:t,pattern:s,minHeight:i}){const{blocks:a,title:l,description:n}=s,o=T(re,"block-editor-block-pattern-setup-list__item-description");return h.jsxs("div",{"aria-hidden":!e,role:"img",className:`pattern-slide ${t}`,"aria-label":l,"aria-describedby":n?o:void 0,children:[h.jsx(m,{blocks:a,minHeight:i}),!!n&&h.jsx(w,{id:o,children:n})]})}const ce=({clientId:e,blockName:s,filterPatternsFn:i,onBlockPatternSelect:a,initialViewMode:l=te,showTitles:n=!1})=>{const[o,r]=x.useState(l),[c,m]=x.useState(0),{replaceBlock:b}=p(A),u=function(e,t,s){return d(i=>{const{getBlockRootClientId:a,getPatternsByBlockTypes:l,__experimentalGetAllowedPatterns:n}=i(A),o=a(e);return s?n(o).filter(s):l(t,o)},[e,t,s])}(e,s,i);if(!u?.length)return null;const k=a||(s=>{const i=s.map(e=>t(e));b(e,i)});return h.jsx(h.Fragment,{children:h.jsxs("div",{className:`block-editor-block-pattern-setup view-mode-${o}`,children:[h.jsx(ne,{viewMode:o,activeSlide:c,patterns:u,onBlockPatternSelect:k,showTitles:n}),h.jsx(le,{viewMode:o,setViewMode:r,activeSlide:c,totalSlides:u.length,handleNext:()=>{m(e=>Math.min(e+1,u.length-1))},handlePrevious:()=>{m(e=>Math.max(e-1,0))},onBlockPatternSelect:()=>{k(u[c].blocks)}})]})})};export{X as B,L as P,ee as a,ce as b,G as c};
