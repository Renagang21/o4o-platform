import{u as e,b as s,r as t,V as r,j as i,A as o,S as a}from"./vendor-react-DqgGMt48.js";import{u as d,a as c,b as n}from"./vendor-query-D_c3FRkE.js";import{b as l,B as m,L as p,I as j,S as u,h,i as x,j as b,k as w,T as y,m as k}from"./page-template-editor-Dej8aqbo.js";import{cF as v,cG as f,cH as g,cI as N}from"./wp-misc-CVe7ECV4.js";import"./vendor-monaco-BxJH8uUv.js";import"./vendor-ui-CrFdsnXa.js";import"./vendor-utils-C9jLuAcl.js";import"./wp-blocks-core-NinAvWTg.js";import"./wp-block-editor-misc-De1L5-zR.js";import"./wp-core-kvRrOm9B.js";import"./wp-block-editor-api-BKhomcj9.js";import"./wp-block-editor-store-BZ6fZn58.js";import"./wp-block-editor-clipboard-DrG0xX4B.js";import"./wp-i18n-D6_Il8Rt.js";import"./wp-block-editor-global-styles-DiR2HQC4.js";import"./wp-block-editor-typography-W96exnXk.js";import"./wp-components-BJYLMD7r.js";import"./wp-block-editor-spacing-CpdaiY4Q.js";import"./wp-block-editor-menus-IWaA-N3x.js";import"./wp-block-editor-core-BSca1VBH.js";import"./wp-block-editor-utils-Bqn4TiQr.js";import"./wp-block-editor-a11y-YlMsb8JF.js";import"./wp-block-editor-preview-CaF7fUZD.js";import"./wp-block-editor-borders-BtjnCtLF.js";import"./wp-block-editor-formats-B4-8T-Nh.js";import"./wp-block-editor-selection-DYIw7ude.js";import"./wp-block-editor-inline-DHEsfgnI.js";import"./wp-block-editor-ui-l6-7VhtF.js";import"./wp-block-editor-transforms-Bm69JWBw.js";import"./wp-block-editor-patterns-CNk0M6ZZ.js";import"./wp-block-editor-navigation-iME_YXGb.js";import"./wp-block-editor-dnd-DduwJSaE.js";import"./wp-block-editor-media-CVSKmHRK.js";import"./wp-api-Dp_oFsVM.js";import"./wp-block-editor-keyboard-C8o4qxcy.js";import"./wp-block-editor-templates-A6LfENHh.js";import"./wp-data-D64LRRbU.js";const q=()=>{const q=e(),{id:C}=s(),F=d(),L=!!C,[P,I]=t.useState({title:"",content:"",categoryId:"",status:"published",isPinned:!1,isLocked:!1}),{data:S}=c({queryKey:["forum-categories"],queryFn:async()=>(await l.api.get("/v1/forum/categories")).data}),K=S?.data||[],{data:E,isLoading:Q}=c({queryKey:["forum-post",C],queryFn:async()=>(await l.api.get(`/v1/forum/posts/${C}`)).data.data,enabled:L}),V=n({mutationFn:async e=>(await l.api.post("/v1/forum/posts",e)).data,onSuccess:()=>{r.success("게시글이 작성되었습니다"),F.invalidateQueries({queryKey:["forum-posts"]}),q("/forum")},onError:()=>{r.error("게시글 작성에 실패했습니다")}}),z=n({mutationFn:async e=>(await l.api.put(`/v1/forum/posts/${C}`,e)).data,onSuccess:()=>{r.success("게시글이 수정되었습니다"),F.invalidateQueries({queryKey:["forum-posts"]}),F.invalidateQueries({queryKey:["forum-post",C]}),q("/forum")},onError:()=>{r.error("게시글 수정에 실패했습니다")}});t.useEffect(()=>{E&&I({title:E.title,content:E.content,categoryId:E.category.id,status:E.status,isPinned:E.isPinned,isLocked:E.isLocked})},[E]);const A=(e,s)=>{I(t=>({...t,[e]:s}))};return L&&Q?i.jsx("div",{className:"flex items-center justify-center h-96",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-modern-primary"})}):i.jsxs("div",{className:"max-w-4xl mx-auto",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[i.jsxs(m,{variant:"ghost",size:"sm",onClick:()=>q("/forum"),children:[i.jsx(o,{className:"w-4 h-4 mr-2"}),"게시판 목록"]}),i.jsx("h1",{className:"text-2xl font-bold text-modern-text-primary",children:L?"게시글 수정":"새 게시글 작성"})]}),i.jsxs("form",{onSubmit:e=>{e.preventDefault(),P.title.trim()?P.content.trim()?P.categoryId?L?z.mutate(P):V.mutate(P):r.error("카테고리를 선택하세요"):r.error("내용을 입력하세요"):r.error("제목을 입력하세요")},children:[i.jsxs("div",{className:"space-y-6",children:[i.jsxs(v,{children:[i.jsx(f,{children:i.jsx(g,{children:"게시글 정보"})}),i.jsxs(N,{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx(p,{htmlFor:"title",children:"제목 *"}),i.jsx(j,{id:"title",value:P.title,onChange:e=>A("title",e.target.value),placeholder:"게시글 제목을 입력하세요",required:!0})]}),i.jsxs("div",{children:[i.jsx(p,{htmlFor:"category",children:"카테고리 *"}),i.jsxs(u,{value:P.categoryId,onValueChange:e=>A("categoryId",e),children:[i.jsx(h,{children:i.jsx(x,{placeholder:"카테고리를 선택하세요"})}),i.jsx(b,{children:K.map(e=>i.jsx(w,{value:e.id,children:e.name},e.id))})]})]}),i.jsxs("div",{children:[i.jsx(p,{htmlFor:"content",children:"내용 *"}),i.jsx(y,{id:"content",value:P.content,onChange:e=>A("content",e.target.value),placeholder:"게시글 내용을 입력하세요...",rows:12,required:!0})]})]})]}),i.jsxs(v,{children:[i.jsx(f,{children:i.jsx(g,{children:"게시 옵션"})}),i.jsxs(N,{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx(p,{htmlFor:"status",children:"상태"}),i.jsxs(u,{value:P.status,onValueChange:e=>A("status",e),children:[i.jsx(h,{children:i.jsx(x,{})}),i.jsxs(b,{children:[i.jsx(w,{value:"published",children:"게시"}),i.jsx(w,{value:"draft",children:"초안"})]})]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx(p,{htmlFor:"isPinned",children:"상단 고정"}),i.jsx("p",{className:"text-sm text-modern-text-secondary",children:"게시글을 목록 상단에 고정합니다"})]}),i.jsx(k,{id:"isPinned",checked:P.isPinned,onCheckedChange:e=>A("isPinned",e)})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx(p,{htmlFor:"isLocked",children:"댓글 잠금"}),i.jsx("p",{className:"text-sm text-modern-text-secondary",children:"새 댓글 작성을 차단합니다"})]}),i.jsx(k,{id:"isLocked",checked:P.isLocked,onCheckedChange:e=>A("isLocked",e)})]})]})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[i.jsx(m,{type:"button",variant:"outline",onClick:()=>q("/forum"),children:"취소"}),i.jsxs(m,{type:"submit",disabled:V.isPending||z.isPending,children:[i.jsx(a,{className:"w-4 h-4 mr-2"}),L?"수정하기":"작성하기"]})]})]})]})};export{q as default};
