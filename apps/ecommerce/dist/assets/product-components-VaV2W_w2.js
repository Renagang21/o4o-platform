import{j as a,h as E,i as A,k as O,l as Q,m as B,T as W,L as T,C as H,n as _}from"./vendor-react-Cb3rBkAv.js";import{c as j,f as $,S as M,a as q,b as G,d as J,e as I,T as R,g as k}from"./cart-components-BZREMwR_.js";import{u as z}from"./vendor-query-Cr2HpTb8.js";import{a as U}from"./vendor-utils-COe-vthL.js";class K{constructor(t){this.baseURL=t,this.api=U.create({baseURL:this.baseURL,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(s=>{let r=localStorage.getItem("accessToken")||localStorage.getItem("authToken");if(!r){const n=localStorage.getItem("auth-storage");if(n)try{const i=JSON.parse(n);i.state?.token&&(r=i.state.token)}catch{}}return r&&(s.headers.Authorization=`Bearer ${r}`),s})}async login(t){return(await this.api.post("/auth/login",t)).data}async logout(){await this.api.post("/auth/logout")}async checkSession(){try{return(await this.api.get("/accounts/sso/check")).data}catch{return{isAuthenticated:!1}}}}const V=()=>{const e="https://api.neture.co.kr/api/v1";if(typeof window>"u")return e;try{if(globalThis.import?.meta?.env?.VITE_API_URL)return globalThis.import.meta.env.VITE_API_URL}catch{}return window.__API_URL__?window.__API_URL__:e},c=new K(V());class X{constructor(t){this.refreshPromise=null,this.currentToken=null,this.baseURL=t,this.api=U.create({baseURL:this.baseURL,headers:{"Content-Type":"application/json"},withCredentials:!0}),this.api.interceptors.response.use(s=>s,async s=>{const r=s.config;if(s.response?.status===401&&!r._retry){if(r._retry=!0,this.refreshPromise){if(await this.refreshPromise)return this.api.request(r);throw s}this.refreshPromise=this.refreshToken();const n=await this.refreshPromise;if(this.refreshPromise=null,n)return this.api.request(r)}return Promise.reject(s)})}async login(t){const s=await this.api.post("/auth/v2/login",t);return s.data.token&&(this.currentToken=s.data.token),s.data}async register(t){return(await this.api.post("/auth/v2/register",t)).data}async logout(){try{await this.api.post("/auth/v2/logout")}catch(t){console.error("Logout error:",t)}finally{this.currentToken=null}}async logoutAll(){await this.api.post("/auth/v2/logout-all"),this.currentToken=null}async refreshToken(){try{return(await this.api.post("/auth/v2/refresh")).data.success}catch{return!1}}async getCurrentUser(){try{return(await this.api.get("/auth/v2/me")).data.user}catch{return null}}getApiUrl(){return this.baseURL}getAccessToken(){return this.currentToken}setupSessionSync(){typeof window>"u"||window.addEventListener("storage",t=>{t.key==="auth-logout"?window.location.reload():t.key==="auth-login"&&this.refreshToken()})}broadcastAuthChange(t){if(typeof window>"u")return;const s=`auth-${t}`;localStorage.setItem(s,Date.now().toString()),setTimeout(()=>localStorage.removeItem(s),100)}async loginWithSync(t){const s=await this.login(t);return this.broadcastAuthChange("login"),s}async logoutWithSync(){await this.logout(),this.broadcastAuthChange("logout")}}const Y=new X(typeof window<"u"&&window.location.hostname==="localhost"?"http://localhost:4000/api/v1":"/api/v1");typeof window<"u"&&Y.setupSessionSync();class Z{constructor(t){this.checkInterval=null,this.handleStorageEvent=s=>{s.key==="sso:logout"?this.handleLogout():s.key==="sso:login"&&this.checkSession()},this.config={checkInterval:3e4,...t}}initialize(t){this.onSessionChange=t,typeof window<"u"&&window.addEventListener("storage",this.handleStorageEvent),this.startSessionMonitoring(),this.checkSession()}destroy(){typeof window<"u"&&window.removeEventListener("storage",this.handleStorageEvent),this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)}startSessionMonitoring(){this.checkInterval&&clearInterval(this.checkInterval),this.checkInterval=setInterval(()=>{this.checkSession()},this.config.checkInterval)}async checkSession(){try{const t=await fetch(`${this.config.apiUrl}/auth/v2/me`,{credentials:"include",headers:{"Content-Type":"application/json"}});if(t.ok){const r=(await t.json()).user;return this.onSessionChange?.(r),r}else return this.onSessionChange?.(null),null}catch(t){return console.error("Session check error:",t),this.onSessionChange?.(null),null}}broadcastLogin(){typeof window<"u"&&(localStorage.setItem("sso:login",Date.now().toString()),localStorage.removeItem("sso:login"))}broadcastLogout(){typeof window<"u"&&(localStorage.setItem("sso:logout",Date.now().toString()),localStorage.removeItem("sso:logout"))}handleLogout(){this.onSessionChange?.(null),this.config.domain&&(window.location.href="/login")}getSessionId(){if(typeof document>"u")return null;const t=document.cookie.match(/sessionId=([^;]+)/);return t?t[1]:null}hasSession(){return!!this.getSessionId()}}new Z({apiUrl:typeof window<"u"&&window.location.hostname==="localhost"?"http://localhost:4000/api/v1":"/api/v1"});const ee=({product:e,mode:t="customer",onEdit:s,onDelete:r,onDuplicate:n,onAddToCart:i,className:l})=>{const o=e.pricing?.customer||0,d=e.compareAtPrice||0,u=d>o?Math.round((d-o)/d*100):0,h=()=>e.inventory?.manageStock?!e.inventory?.stockQuantity||e.inventory.stockQuantity===0?{label:"품절",className:"text-red-600"}:e.inventory?.lowStockThreshold&&e.inventory.stockQuantity<=e.inventory.lowStockThreshold?{label:"재고 부족",className:"text-orange-600"}:{label:"재고 있음",className:"text-green-600"}:{label:"재고 관리 안함",className:"text-blue-600"},m=b=>{const x={published:{label:"게시됨",className:"bg-green-100 text-green-800"},draft:{label:"임시저장",className:"bg-yellow-100 text-yellow-800"},private:{label:"비공개",className:"bg-blue-100 text-blue-800"},trash:{label:"휴지통",className:"bg-red-100 text-red-800"}}[b]||{label:b,className:"bg-gray-100 text-gray-800"};return a.jsx("span",{className:j("px-2 py-1 text-xs font-medium rounded-full",x.className),children:x.label})},f=a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"aspect-w-1 aspect-h-1 w-full overflow-hidden bg-gray-200 relative",children:[e.images&&e.images[0]?a.jsx("img",{src:e.images[0].url,alt:e.name,className:"object-cover object-center w-full h-full group-hover:scale-105 transition-transform duration-200"}):a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsx(E,{className:"w-12 h-12 text-gray-400"})}),a.jsxs("div",{className:"absolute top-2 left-2 space-y-1",children:[t==="admin"&&m(e.status),e.isFeatured&&a.jsx("span",{className:"block px-2 py-1 text-xs font-medium bg-yellow-400 text-yellow-900 rounded",children:"추천"}),u>0&&a.jsxs("span",{className:"block px-2 py-1 text-xs font-medium bg-red-500 text-white rounded",children:[u,"% 할인"]}),e.inventory?.stockQuantity===0&&a.jsx("span",{className:"block px-2 py-1 text-xs font-medium bg-gray-500 text-white rounded",children:"품절"})]})]}),a.jsxs("div",{className:"p-4",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-900 line-clamp-2 mb-2",children:e.name}),t==="admin"&&e.sku&&a.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:["SKU: ",e.sku]}),t==="customer"&&e.supplierName&&a.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:["판매자: ",e.supplierName]}),t==="customer"&&e.rating&&a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx("div",{className:"flex items-center",children:[...Array(5)].map((b,p)=>a.jsx(A,{className:j("w-4 h-4",p<Math.floor(e.rating)?"text-yellow-400 fill-current":"text-gray-300")},p))}),a.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",e.reviewCount||0,")"]})]}),t==="admin"&&a.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[a.jsx("span",{children:"재고:"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("span",{children:[e.inventory?.stockQuantity||0,"개"]}),a.jsx("span",{className:h().className,children:h().label})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-lg font-semibold text-gray-900",children:$(o)}),d>o&&a.jsx("span",{className:"text-sm text-gray-500 line-through ml-2",children:$(d)})]}),t==="customer"&&e.inventory?.stockQuantity&&e.inventory.stockQuantity>0&&i&&a.jsx("button",{onClick:b=>{b.preventDefault(),i(e.id)},className:"p-2 bg-primary text-primary-foreground rounded-lg opacity-0 group-hover:opacity-100 transition-opacity",title:"장바구니에 담기",children:a.jsx(O,{className:"w-4 h-4"})})]}),t==="admin"&&a.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[e.isVirtual&&a.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded",children:"가상상품"}),e.isDownloadable&&a.jsx("span",{className:"px-2 py-1 text-xs bg-indigo-100 text-indigo-800 rounded",children:"다운로드"})]})]}),t==="admin"&&a.jsxs("div",{className:"p-4 pt-0 flex space-x-2",children:[s&&a.jsxs("button",{onClick:()=>s(e),className:"flex-1 px-3 py-2 text-sm border rounded hover:bg-gray-50",children:[a.jsx(Q,{className:"w-4 h-4 inline mr-1"}),"편집"]}),n&&a.jsx("button",{onClick:()=>n(e.id),className:"px-3 py-2 text-sm border rounded hover:bg-gray-50",children:a.jsx(B,{className:"w-4 h-4"})}),r&&a.jsx("button",{onClick:()=>r(e.id),className:"px-3 py-2 text-sm text-red-600 border border-red-300 rounded hover:bg-red-50",children:a.jsx(W,{className:"w-4 h-4"})})]})]}),w=a.jsx("div",{className:j("group relative bg-white rounded-lg shadow-sm border overflow-hidden hover:shadow-md transition-all duration-200",l),children:f});return t==="customer"?a.jsx(T,{to:`/products/${e.slug||e.id}`,className:"block",children:w}):w},he=({products:e,columns:t=4,mode:s="customer",onEdit:r,onDelete:n,onDuplicate:i,onAddToCart:l,className:o})=>{const d={1:"grid-cols-1",2:"grid-cols-1 md:grid-cols-2",3:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3",4:"grid-cols-1 md:grid-cols-2 lg:grid-cols-4",5:"grid-cols-1 md:grid-cols-2 lg:grid-cols-5",6:"grid-cols-1 md:grid-cols-3 lg:grid-cols-6"};return e.length===0?a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-muted-foreground",children:"상품이 없습니다."})}):a.jsx("div",{className:j(`grid ${d[t]} gap-6`,o),children:e.map(u=>a.jsx(ee,{product:u,mode:s,onEdit:r,onDelete:n,onDuplicate:i,onAddToCart:l},u.id))})};function ge({filters:e,totalReviews:t,onFiltersChange:s,className:r}){const n=o=>{s({...e,sort:o})},i=o=>{const d=o?parseInt(o):void 0;s({...e,rating:d})},l=o=>{s({...e,verified:o==="verified"?!0:void 0})};return a.jsxs("div",{className:j("space-y-3",r),children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("p",{className:"text-sm text-gray-600",children:["총 ",t.toLocaleString(),"개의 리뷰"]}),a.jsxs(M,{value:e.sort||"recent",onChange:o=>n(o.target.value),children:[a.jsx(q,{className:"w-40",children:a.jsx(G,{})}),a.jsxs(J,{children:[a.jsx(I,{value:"recent",children:"최신순"}),a.jsx(I,{value:"helpful",children:"도움순"}),a.jsx(I,{value:"rating_high",children:"평점 높은순"}),a.jsx(I,{value:"rating_low",children:"평점 낮은순"})]})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-3",children:[a.jsxs(R,{type:"single",value:e.rating?.toString()||"all",onValueChange:o=>i(typeof o=="string"?o:o[0]||""),children:[a.jsx(k,{value:"all",className:"gap-1",children:"전체"}),[5,4,3,2,1].map(o=>a.jsxs(k,{value:o.toString(),className:"gap-1",children:[a.jsx(A,{className:"w-3 h-3 fill-yellow-400 text-yellow-400"}),o]},o))]}),a.jsxs(R,{type:"single",value:e.verified===!0?"verified":"all",onValueChange:o=>l(typeof o=="string"?o:o[0]||""),children:[a.jsx(k,{value:"all",children:"모든 리뷰"}),a.jsxs(k,{value:"verified",className:"gap-1",children:[a.jsx(H,{className:"w-3 h-3"}),"구매 인증"]})]})]})]})}const te={getProducts:async e=>(await c.api.get("/products",{params:e})).data,getProduct:async e=>(await c.api.get(`/products/${e}`)).data,getProductBySlug:async e=>(await c.api.get(`/products/slug/${e}`)).data,searchProducts:async e=>(await c.api.get("/products/search",{params:{q:e}})).data,getRelatedProducts:async(e,t=4)=>(await c.api.get(`/products/${e}/related`,{params:{limit:t}})).data,getFeaturedProducts:async(e=8)=>(await c.api.get("/products/featured",{params:{limit:e}})).data,getProductsByCategory:async(e,t)=>(await c.api.get(`/categories/${e}/products`,{params:t})).data,createReview:async(e,t)=>(await c.api.post(`/products/${e}/reviews`,t)).data,getReviews:async(e,t=1,s=10)=>(await c.api.get(`/products/${e}/reviews`,{params:{page:t,limit:s}})).data},g="/api/v1/reviews",se={getProductReviews:async(e,t)=>(await c.api.get(`${g}/product/${e}`,{params:t})).data,getReview:async e=>(await c.api.get(`${g}/${e}`)).data,getUserReviews:async e=>(await c.api.get(`${g}/my-reviews`,{params:e})).data,createReview:async e=>(await c.api.post(g,e)).data,updateReview:async(e,t)=>(await c.api.put(`${g}/${e}`,t)).data,deleteReview:async e=>{await c.api.delete(`${g}/${e}`)},markHelpful:async(e,t)=>(await c.api.post(`${g}/${e}/helpful`,t)).data,reportReview:async(e,t)=>{await c.api.post(`${g}/${e}/report`,{reason:t})},getProductReviewStats:async e=>(await c.api.get(`${g}/product/${e}/stats`)).data,uploadImages:async e=>{const t=new FormData;return e.forEach((r,n)=>{t.append(`images[${n}]`,r)}),(await c.api.post(`${g}/upload`,t,{headers:{"Content-Type":"multipart/form-data"}})).data.urls},canReviewProduct:async e=>(await c.api.get(`${g}/product/${e}/can-review`)).data,admin:{getAllReviews:async e=>(await c.api.get(`${g}/admin`,{params:e})).data,approveReview:async e=>(await c.api.post(`${g}/${e}/approve`)).data,rejectReview:async(e,t)=>(await c.api.post(`${g}/${e}/reject`,{reason:t})).data,hideReview:async e=>(await c.api.post(`${g}/${e}/hide`)).data,unhideReview:async e=>(await c.api.post(`${g}/${e}/unhide`)).data}},S="/api/v1/suppliers",ae={getPublicProfile:async e=>(await c.api.get(`${S}/shop/${e}`)).data,getPublicProducts:async(e,t)=>(await c.api.get(`${S}/${e}/products`,{params:t})).data,getMyProfile:async()=>(await c.api.get(`${S}/profile`)).data,updateProfile:async e=>(await c.api.put(`${S}/profile`,e)).data,uploadLogo:async e=>{const t=new FormData;return t.append("logo",e),(await c.api.post(`${S}/profile/logo`,t,{headers:{"Content-Type":"multipart/form-data"}})).data},uploadBanner:async e=>{const t=new FormData;return t.append("banner",e),(await c.api.post(`${S}/profile/banner`,t,{headers:{"Content-Type":"multipart/form-data"}})).data},getStats:async()=>(await c.api.get(`${S}/stats`)).data,checkSlugAvailability:async e=>(await c.api.get(`${S}/check-slug/${e}`)).data,generateSlug:async e=>(await c.api.post(`${S}/generate-slug`,{storeName:e})).data},re={products:te,reviews:se,suppliers:ae},L=e=>{let t;const s=new Set,r=(u,h)=>{const m=typeof u=="function"?u(t):u;if(!Object.is(m,t)){const f=t;t=h??(typeof m!="object"||m===null)?m:Object.assign({},t,m),s.forEach(w=>w(t,f))}},n=()=>t,o={setState:r,getState:n,getInitialState:()=>d,subscribe:u=>(s.add(u),()=>s.delete(u))},d=t=e(r,n,o);return o},we=e=>e?L(e):L;function ne(e,t){let s;try{s=e()}catch{return}return{getItem:n=>{var i;const l=d=>d===null?null:JSON.parse(d,void 0),o=(i=s.getItem(n))!=null?i:null;return o instanceof Promise?o.then(l):l(o)},setItem:(n,i)=>s.setItem(n,JSON.stringify(i,void 0)),removeItem:n=>s.removeItem(n)}}const P=e=>t=>{try{const s=e(t);return s instanceof Promise?s:{then(r){return P(r)(s)},catch(r){return this}}}catch(s){return{then(r){return this},catch(r){return P(r)(s)}}}},ie=(e,t)=>(s,r,n)=>{let i={storage:ne(()=>localStorage),partialize:p=>p,version:0,merge:(p,x)=>({...x,...p}),...t},l=!1;const o=new Set,d=new Set;let u=i.storage;if(!u)return e((...p)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),s(...p)},r,n);const h=()=>{const p=i.partialize({...r()});return u.setItem(i.name,{state:p,version:i.version})},m=n.setState;n.setState=(p,x)=>{m(p,x),h()};const f=e((...p)=>{s(...p),h()},r,n);n.getInitialState=()=>f;let w;const b=()=>{var p,x;if(!u)return;l=!1,o.forEach(y=>{var v;return y((v=r())!=null?v:f)});const N=((x=i.onRehydrateStorage)==null?void 0:x.call(i,(p=r())!=null?p:f))||void 0;return P(u.getItem.bind(u))(i.name).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==i.version){if(i.migrate){const v=i.migrate(y.state,y.version);return v instanceof Promise?v.then(C=>[!0,C]):[!0,v]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,y.state];return[!1,void 0]}).then(y=>{var v;const[C,F]=y;if(w=i.merge(F,(v=r())!=null?v:f),s(w,!0),C)return h()}).then(()=>{N?.(w,void 0),w=r(),l=!0,d.forEach(y=>y(w))}).catch(y=>{N?.(void 0,y)})};return n.persist={setOptions:p=>{i={...i,...p},p.storage&&(u=p.storage)},clearStorage:()=>{u?.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>b(),hasHydrated:()=>l,onHydrate:p=>(o.add(p),()=>{o.delete(p)}),onFinishHydration:p=>(d.add(p),()=>{d.delete(p)})},i.skipHydration||b(),w||f},D=ie,ye=_()(D((e,t)=>({cart:null,isLoading:!1,error:null,fetchCart:async()=>{e({isLoading:!0,error:null});try{const s=await c.api.get("/cart");e({cart:s.data,isLoading:!1})}catch(s){const r=s instanceof Error?s.message:"Failed to fetch cart";e({error:r,isLoading:!1})}},addToCart:async(s,r)=>{const{optimisticAddToCart:n}=t();n(s,r);try{await c.api.post("/cart/items",{productId:s.id,quantity:r}),await t().fetchCart()}catch(i){throw await t().fetchCart(),i}},updateQuantity:async(s,r)=>{const{optimisticUpdateQuantity:n}=t();n(s,r);try{await c.api.patch(`/cart/items/${s}`,{quantity:r}),await t().fetchCart()}catch(i){throw await t().fetchCart(),i}},removeFromCart:async s=>{const{optimisticRemoveFromCart:r}=t();r(s);try{await c.api.delete(`/cart/items/${s}`),await t().fetchCart()}catch(n){throw await t().fetchCart(),n}},clearCart:async()=>{e({cart:null});try{await c.api.delete("/cart"),e({cart:null})}catch(s){throw await t().fetchCart(),s}},setCart:s=>e({cart:s}),optimisticAddToCart:(s,r)=>{const{cart:n}=t();if(n){const i=n.items.find(l=>l.productId===s.id);if(i){const l=n.items.map(d=>d.id===i.id?{...d,quantity:d.quantity+r}:d),o=l.reduce((d,u)=>{const h=u.unitPrice||u.product?.pricing.customer||0;return d+h*u.quantity},0);e({cart:{...n,items:l,summary:{...n.summary,subtotal:o,total:o+n.summary.shipping+n.summary.tax-n.summary.discount}}})}else{const l={id:"temp-item-"+Date.now(),cartId:n.id,productId:s.id,product:s,quantity:r,unitPrice:s.pricing.customer,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},o=[...n.items,l],d=o.reduce((u,h)=>{const m=h.unitPrice||h.product?.pricing.customer||0;return u+m*h.quantity},0);e({cart:{...n,items:o,summary:{...n.summary,subtotal:d,total:d+n.summary.shipping+n.summary.tax-n.summary.discount}}})}}else{const i={id:"temp-"+Date.now(),userId:"current-user",items:[{id:"temp-item-"+Date.now(),cartId:"temp-"+Date.now(),productId:s.id,product:s,quantity:r,unitPrice:s.pricing.customer,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}],summary:{subtotal:s.pricing.customer*r,discount:0,shipping:0,tax:0,total:s.pricing.customer*r},createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};e({cart:i})}},optimisticUpdateQuantity:(s,r)=>{const{cart:n}=t();if(!n)return;const i=n.items.map(l=>l.id===s?{...l,quantity:r}:l);e({cart:{...n,items:i}})},optimisticRemoveFromCart:s=>{const{cart:r}=t();if(!r)return;const n=r.items.filter(i=>i.id!==s);e({cart:{...r,items:n}})}}),{name:"cart-storage",partialize:e=>({cart:e.cart})}));_()(D((e,t)=>({items:[],isLoading:!1,error:null,fetchWishlist:async()=>{e({isLoading:!0,error:null});try{const s=await c.api.get("/wishlist");e({items:s.data.items,isLoading:!1})}catch(s){const r=s instanceof Error?s.message:"Failed to fetch wishlist";e({error:r,isLoading:!1})}},addToWishlist:async s=>{const{items:r}=t();if(r.some(i=>i.productId===s.id))return;const n={id:"temp-"+Date.now(),productId:s.id,product:s,addedAt:new Date().toISOString()};e({items:[...r,n]});try{const i=await c.api.post("/wishlist/items",{productId:s.id}),l=r.map(o=>o.id===n.id?{...o,id:i.data.id}:o);e({items:l})}catch(i){throw e({items:r.filter(l=>l.id!==n.id)}),i}},removeFromWishlist:async s=>{const{items:r}=t();if(r.find(i=>i.productId===s)){e({items:r.filter(i=>i.productId!==s)});try{await c.api.delete(`/wishlist/items/${s}`)}catch(i){throw e({items:r}),i}}},clearWishlist:async()=>{const{items:s}=t();e({items:[]});try{await c.api.delete("/wishlist")}catch(r){throw e({items:s}),r}},isInWishlist:s=>t().items.some(r=>r.productId===s),setItems:s=>e({items:s})}),{name:"wishlist-storage",partialize:e=>({items:e.items})}));const oe=e=>z({queryKey:["products",e],queryFn:()=>re.products.getProducts(e)}),ce=({category:e,limit:t=12,sort:s="newest",columns:r=4,showPrice:n=!0,showRating:i=!0})=>{const{data:l,isLoading:o,error:d}=oe({category:e,limit:t,sortBy:s==="price-asc"||s==="price-desc"?"price":s==="name"?"name":"created",sortOrder:s==="price-asc"?"asc":"desc"}),u={2:"grid-cols-2",3:"grid-cols-3",4:"grid-cols-4",6:"grid-cols-6"}[r]||"grid-cols-4";if(o)return a.jsx("div",{className:"text-center py-8",children:"Loading products..."});if(d)return a.jsx("div",{className:"text-center py-8 text-red-500",children:"Error loading products"});if(!l?.products||l.products.length===0)return a.jsx("div",{className:"text-center py-8",children:"No products found"});const h=l.products;return a.jsx("div",{className:`grid ${u} gap-6`,children:h.map(m=>a.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow",children:a.jsxs(T,{to:`/products/${m.slug}`,children:[m.images?.[0]&&a.jsx("img",{src:typeof m.images[0]=="string"?m.images[0]:m.images[0].url,alt:m.name,className:"w-full h-48 object-cover"}),a.jsxs("div",{className:"p-4",children:[a.jsx("h3",{className:"font-semibold text-lg mb-2",children:m.name}),n&&a.jsx("div",{className:"text-xl font-bold text-blue-600 mb-2",children:$(m.pricing.customer)}),i&&m.rating&&a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex text-yellow-400",children:[...Array(5)].map((f,w)=>a.jsx("svg",{className:`w-4 h-4 ${w<Math.floor(m.rating)?"fill-current":"stroke-current"}`,viewBox:"0 0 24 24",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})},w))}),a.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["(",m.reviewCount||0,")"]})]})]})]})},m.id))})},le=({attributes:e})=>{const t={category:e.category,limit:e.limit?Number(e.limit):void 0,sort:e.sort,columns:e.columns?Number(e.columns):void 0,showPrice:e.showPrice!==!1,showRating:e.showRating!==!1};return a.jsx(ce,{...t})},fe={name:"product-grid",component:le,attributes:{category:{type:"string"},limit:{type:"number"},sort:{type:"string"},columns:{type:"number"},showPrice:{type:"boolean"},showRating:{type:"boolean"}}};export{he as P,ge as R,re as a,we as b,Y as c,c as d,fe as p,ye as u};
