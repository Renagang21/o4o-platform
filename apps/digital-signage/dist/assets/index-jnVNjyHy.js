import{r as i,j as e,u as ae,L as ne,F as re,C as O,S as ie,a as E,b as le,R as U,A as V,T as oe,U as ce,c as de,M,d as F,e as xe,f as he,P as me,g as ue,h as ge,i as W,k as R,l as T,m as pe,n as fe,o as ye,p as D,q,E as _,s as H,t as Z,X as je,v as ee,I as Q,w as be,V as G,B as ve,x as se,y as B,z as S,D as Ne,W as K,G as Y,H as we,J as ke,K as Se,N as Ce,O as Ie,Q as Pe,Y as Ae}from"./vendor-react-CsgEnmWC.js";import{Q as Ee,a as Le}from"./vendor-query-CeHBtouo.js";import{a as I}from"./vendor-utils-COe-vthL.js";import{l as Re}from"./vendor-socket-BDGyx5_k.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const m of r.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&l(m)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}})();typeof window<"u"&&typeof globalThis>"u"&&(window.global=window);i.createContext(void 0);class Te{constructor(s){this.baseURL=s,this.api=I.create({baseURL:this.baseURL,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(t=>{let l=localStorage.getItem("accessToken")||localStorage.getItem("authToken");if(!l){const o=localStorage.getItem("auth-storage");if(o)try{const r=JSON.parse(o);r.state?.token&&(l=r.state.token)}catch{}}return l&&(t.headers.Authorization=`Bearer ${l}`),t})}async login(s){return(await this.api.post("/auth/login",s)).data}async logout(){await this.api.post("/auth/logout")}async checkSession(){try{return(await this.api.get("/accounts/sso/check")).data}catch{return{isAuthenticated:!1}}}}const De=()=>{const c="https://api.neture.co.kr/api/v1";if(typeof window>"u")return c;try{if(globalThis.import?.meta?.env?.VITE_API_URL)return globalThis.import.meta.env.VITE_API_URL}catch{}return window.__API_URL__?window.__API_URL__:c};new Te(De());class Me{constructor(s){this.refreshPromise=null,this.currentToken=null,this.baseURL=s,this.api=I.create({baseURL:this.baseURL,headers:{"Content-Type":"application/json"},withCredentials:!0}),this.api.interceptors.response.use(t=>t,async t=>{const l=t.config;if(t.response?.status===401&&!l._retry){if(l._retry=!0,this.refreshPromise){if(await this.refreshPromise)return this.api.request(l);throw t}this.refreshPromise=this.refreshToken();const o=await this.refreshPromise;if(this.refreshPromise=null,o)return this.api.request(l)}return Promise.reject(t)})}async login(s){const t=await this.api.post("/auth/v2/login",s);return t.data.token&&(this.currentToken=t.data.token),t.data}async register(s){return(await this.api.post("/auth/v2/register",s)).data}async logout(){try{await this.api.post("/auth/v2/logout")}catch(s){console.error("Logout error:",s)}finally{this.currentToken=null}}async logoutAll(){await this.api.post("/auth/v2/logout-all"),this.currentToken=null}async refreshToken(){try{return(await this.api.post("/auth/v2/refresh")).data.success}catch{return!1}}async getCurrentUser(){try{return(await this.api.get("/auth/v2/me")).data.user}catch{return null}}getApiUrl(){return this.baseURL}getAccessToken(){return this.currentToken}setupSessionSync(){typeof window>"u"||window.addEventListener("storage",s=>{s.key==="auth-logout"?window.location.reload():s.key==="auth-login"&&this.refreshToken()})}broadcastAuthChange(s){if(typeof window>"u")return;const t=`auth-${s}`;localStorage.setItem(t,Date.now().toString()),setTimeout(()=>localStorage.removeItem(t),100)}async loginWithSync(s){const t=await this.login(s);return this.broadcastAuthChange("login"),t}async logoutWithSync(){await this.logout(),this.broadcastAuthChange("logout")}}const A=new Me(typeof window<"u"&&window.location.hostname==="localhost"?"http://localhost:4000/api/v1":"/api/v1");typeof window<"u"&&A.setupSessionSync();class Ue{constructor(s){this.checkInterval=null,this.handleStorageEvent=t=>{t.key==="sso:logout"?this.handleLogout():t.key==="sso:login"&&this.checkSession()},this.config={checkInterval:3e4,...s}}initialize(s){this.onSessionChange=s,typeof window<"u"&&window.addEventListener("storage",this.handleStorageEvent),this.startSessionMonitoring(),this.checkSession()}destroy(){typeof window<"u"&&window.removeEventListener("storage",this.handleStorageEvent),this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)}startSessionMonitoring(){this.checkInterval&&clearInterval(this.checkInterval),this.checkInterval=setInterval(()=>{this.checkSession()},this.config.checkInterval)}async checkSession(){try{const s=await fetch(`${this.config.apiUrl}/auth/v2/me`,{credentials:"include",headers:{"Content-Type":"application/json"}});if(s.ok){const l=(await s.json()).user;return this.onSessionChange?.(l),l}else return this.onSessionChange?.(null),null}catch(s){return console.error("Session check error:",s),this.onSessionChange?.(null),null}}broadcastLogin(){typeof window<"u"&&(localStorage.setItem("sso:login",Date.now().toString()),localStorage.removeItem("sso:login"))}broadcastLogout(){typeof window<"u"&&(localStorage.setItem("sso:logout",Date.now().toString()),localStorage.removeItem("sso:logout"))}handleLogout(){this.onSessionChange?.(null),this.config.domain&&(window.location.href="/login")}getSessionId(){if(typeof document>"u")return null;const s=document.cookie.match(/sessionId=([^;]+)/);return s?s[1]:null}hasSession(){return!!this.getSessionId()}}new Ue({apiUrl:typeof window<"u"&&window.location.hostname==="localhost"?"http://localhost:4000/api/v1":"/api/v1"});if(typeof document<"u"&&!document.getElementById("auth-spinner-styles")){const c=document.createElement("style");c.id="auth-spinner-styles",c.textContent=`
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  `,document.head.appendChild(c)}class Fe{constructor(s,t=3e4){this.apiUrl=s,this.checkInterval=t,this.socket=null,this.sessionCheckInterval=null}connect(s,t){if(this.socket?.connected)return;t?.onSessionEvent&&(this.onSessionEvent=t.onSessionEvent),t?.onForceLogout&&(this.onForceLogout=t.onForceLogout);const l=this.apiUrl.replace("/api/v1","");this.socket=Re(l,{auth:{token:s},transports:["websocket","polling"],reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3}),this.setupEventListeners(),this.startSessionCheck()}disconnect(){this.sessionCheckInterval&&(clearInterval(this.sessionCheckInterval),this.sessionCheckInterval=null),this.socket&&(this.socket.disconnect(),this.socket=null)}setupEventListeners(){this.socket&&(this.socket.on("connect",()=>{this.checkSession()}),this.socket.on("disconnect",s=>{}),this.socket.on("connect_error",s=>{console.error("[Session Sync] Connection error:",s.message)}),this.socket.on("session:status",s=>{}),this.socket.on("session:event",s=>{this.onSessionEvent&&this.onSessionEvent(s)}),this.socket.on("session:created",s=>{this.onSessionEvent&&this.onSessionEvent({event:"created",sessionId:s.sessionId,timestamp:Date.now()})}),this.socket.on("session:removed",s=>{this.onSessionEvent&&this.onSessionEvent({event:"removed",sessionId:s.sessionId,timestamp:Date.now()})}),this.socket.on("session:refreshed",s=>{this.onSessionEvent&&this.onSessionEvent({event:"refreshed",sessionId:s.sessionId,timestamp:Date.now()})}),this.socket.on("session:force_logout",s=>{this.onForceLogout&&this.onForceLogout(s.reason)}))}startSessionCheck(){this.sessionCheckInterval&&clearInterval(this.sessionCheckInterval),this.sessionCheckInterval=setInterval(()=>{this.checkSession()},this.checkInterval)}checkSession(){this.socket?.connected&&this.socket.emit("session:check")}logoutSession(s){this.socket?.connected&&this.socket.emit("session:logout",{sessionId:s})}logoutAllDevices(){this.socket?.connected&&this.socket.emit("session:logout",{allDevices:!0})}updateToken(s){this.socket&&(this.disconnect(),this.connect(s))}isConnected(){return this.socket?.connected||!1}}const $e=i.createContext(void 0),_e=({children:c,onAuthChange:s,enableSessionSync:t=!0,sessionCheckInterval:l=3e4})=>{const[o,r]=i.useState(null),[m,u]=i.useState(!0),[y,x]=i.useState(null),h=i.useRef(null),g=i.useCallback(async()=>{try{u(!0),x(null);const d=await A.getCurrentUser();if(r(d),s?.(d),d&&t){const j=A.getAccessToken();j&&N(j)}}catch{r(null),s?.(null)}finally{u(!1)}},[s]),N=i.useCallback(d=>{!t||!d||(h.current||(h.current=new Fe(A.getApiUrl(),l)),h.current.connect(d,{onSessionEvent:j=>{switch(j.event){case"logout_all":case"removed":g();break}},onForceLogout:j=>{r(null),x(j),s?.(null),h.current?.disconnect()}}))},[t,l,g,s]);i.useEffect(()=>()=>{h.current?.disconnect()},[]),i.useEffect(()=>{g()},[g]);const b=i.useCallback(async d=>{try{x(null),u(!0);const j=await A.loginWithSync(d);j.success&&j.user&&(r(j.user),s?.(j.user),j.token&&N(j.token))}catch(j){const P=j.response?.data?.error||"Login failed";throw x(P),new Error(P)}finally{u(!1)}},[s]),k=i.useCallback(async d=>{try{x(null),u(!0);const j=await A.register(d);if(!j.success)throw new Error(j.message||"Registration failed")}catch(j){const P=j.response?.data?.error||"Registration failed";throw x(P),new Error(P)}finally{u(!1)}},[]),n=i.useCallback(async()=>{try{u(!0),await A.logoutWithSync(),r(null),s?.(null),h.current?.disconnect()}catch(d){console.error("Logout error:",d)}finally{u(!1)}},[s]),f=i.useCallback(async()=>{try{u(!0),await A.logoutAll(),r(null),s?.(null),h.current?.disconnect()}catch(d){console.error("Logout all error:",d)}finally{u(!1)}},[s]),v=i.useCallback(d=>o?(Array.isArray(d)?d:[d]).includes(o.role):!1,[o]),w=i.useCallback(d=>o?o.role==="admin"?!0:o.permissions?.includes(d)||!1:!1,[o]),C={user:o,loading:m,error:y,login:b,register:k,logout:n,logoutAll:f,checkAuth:g,isAuthenticated:!!o,hasRole:v,hasPermission:w};return e.jsx($e.Provider,{value:C,children:c})},Be=()=>({user:{name:"관리자",email:"admin@o4o.com"},isAuthenticated:!0,logout:()=>{}});function Oe({children:c}){const s=ae(),{user:t,logout:l}=Be(),o=[{name:"Dashboard",href:"/dashboard",icon:ne},{name:"Content",href:"/content",icon:re},{name:"Schedule",href:"/schedule",icon:O},{name:"Stores",href:"/stores",icon:ie}],r=m=>s.pathname.startsWith(m);return e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsxs("div",{className:"w-64 bg-white shadow-md",children:[e.jsxs("div",{className:"p-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Digital Signage"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"O4O Platform"})]}),e.jsx("nav",{className:"mt-8",children:o.map(m=>{const u=m.icon;return e.jsxs(E,{to:m.href,className:`flex items-center px-4 py-3 text-sm font-medium transition-colors ${r(m.href)?"bg-primary-50 text-primary-700 border-r-2 border-primary-700":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:[e.jsx(u,{className:"mr-3 h-5 w-5"}),m.name]},m.name)})}),e.jsx("div",{className:"absolute bottom-0 w-64 p-4 border-t",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t?.name}),e.jsx("p",{className:"text-xs text-gray-500",children:t?.email})]}),e.jsx("button",{onClick:l,className:"p-2 text-gray-400 hover:text-gray-600",title:"Logout",children:e.jsx(le,{className:"h-5 w-5"})})]})})]}),e.jsx("main",{className:"flex-1 overflow-y-auto",children:c})]})}const Ve=()=>({success:t=>{},error:t=>{}}),J=()=>{const c=Ve(),[s,t]=i.useState([]),[l,o]=i.useState([]),[r,m]=i.useState(null),[u,y]=i.useState(null),[x,h]=i.useState(null),[g,N]=i.useState(""),[b,k]=i.useState("all"),[n,f]=i.useState(!0),v=i.useCallback(async()=>{try{const a=await I.get("/api/signage/analytics");m(a.data.data)}catch{}},[]),w=i.useCallback(async()=>{try{const a=x?{storeId:x.id}:{},p=await I.get("/api/signage/dashboard/live",{params:a});y(p.data.data)}catch{}},[x]),C=i.useCallback(async()=>{try{const a={page:1,limit:20,sortBy:"latest"};g&&(a.search=g),b!=="all"&&(a.status=b),x&&(a.storeId=x.id);const p=await I.get("/api/signage/contents",{params:a});t(p.data.data.contents)}catch{c.error("Failed to load contents")}},[g,b,x,c]),d=i.useCallback(async()=>{try{const p=(await I.get("/api/signage/stores")).data.data.stores;o(p),p.length>0&&!x&&h(p[0])}catch{}},[x]);i.useEffect(()=>{(async()=>{f(!0),await Promise.all([v(),d(),C(),w()]),f(!1)})()},[v,d,C,w]),i.useEffect(()=>{const a=setInterval(()=>{w()},3e4);return()=>{a&&clearInterval(a)}},[w]);const j=async(a,p)=>{try{await I.post(`/api/signage/stores/${a}/playback/control`,{action:p}),c.success(`Playback ${p} command sent`),w()}catch{c.error("Failed to control playback")}},P=async(a,p,L)=>{try{await I.patch(`/api/signage/contents/${a}/approval`,{action:p,reason:L}),c.success(`Content ${p}d successfully`),C()}catch{c.error(`Failed to ${p} content`)}},$=({status:a})=>{const p={pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",inactive:"bg-gray-100 text-gray-800",active:"bg-green-100 text-green-800",playing:"bg-blue-100 text-blue-800",idle:"bg-gray-100 text-gray-800"},z={pending:D,approved:R,rejected:T,inactive:D,active:R,playing:ye,idle:fe}[a]||D;return e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${p[a]||p.inactive}`,children:[e.jsx(z,{className:"w-3 h-3"}),a]})};return n?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(U,{className:"w-8 h-8 text-blue-600 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading dashboard..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b sticky top-0 z-40",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(E,{to:"/",className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx(V,{className:"w-5 h-5"}),"Back"]}),e.jsx("div",{className:"h-6 w-px bg-gray-300"}),e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"📺 Enhanced Signage Dashboard"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>w(),className:"p-2 text-gray-600 hover:text-gray-900 transition-colors",title:"Refresh",children:e.jsx(U,{className:"w-5 h-5"})}),e.jsxs(E,{to:"/signage/tv",target:"_blank",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(oe,{className:"w-4 h-4"}),"TV Display"]}),e.jsxs(E,{to:"/signage/content/upload",className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(ce,{className:"w-4 h-4"}),"Add Content"]})]})]})})}),r&&e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Content"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.totalContent})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(de,{className:"w-6 h-6 text-blue-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Stores"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.activeStores})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(M,{className:"w-6 h-6 text-green-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Playtime"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[Math.floor(r.totalPlaytime/3600),"h"]})]}),e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(F,{className:"w-6 h-6 text-purple-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Playlists"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.totalPlaylists})]}),e.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:e.jsx(xe,{className:"w-6 h-6 text-orange-600"})})]})})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[u&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5 text-green-600"}),"Live Activity"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Auto-refresh: 30s"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:u.activeStores}),e.jsx("p",{className:"text-xs text-gray-600",children:"Active Stores"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:u.currentlyPlaying}),e.jsx("p",{className:"text-xs text-gray-600",children:"Now Playing"})]})]}),u.liveActivity.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Store Status"}),u.liveActivity.slice(0,5).map(a=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:a.storeName}),a.currentContent&&e.jsx("p",{className:"text-xs text-gray-600 truncate",children:a.currentContent})]}),e.jsx($,{status:a.status})]},a.storeId))]})]})]}),l.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Store Management"}),e.jsxs("select",{value:x?.id||"",onChange:a=>{const p=l.find(L=>L.id===a.target.value);h(p||null)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Stores"}),l.map(a=>e.jsxs("option",{value:a.id,children:[a.name," (",a.status,")"]},a.id))]}),x&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Status:"}),e.jsx($,{status:x.status})]}),x.displaySettings&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Display:"}),e.jsx("span",{className:"text-gray-900",children:x.displaySettings.resolution})]}),e.jsxs("div",{className:"pt-3 flex gap-2",children:[e.jsxs("button",{onClick:()=>j(x.id,"play"),className:"flex-1 flex items-center justify-center gap-1 px-3 py-2 bg-green-100 text-green-700 rounded hover:bg-green-200 transition-colors",children:[e.jsx(me,{className:"w-4 h-4"}),"Play"]}),e.jsxs("button",{onClick:()=>j(x.id,"pause"),className:"flex-1 flex items-center justify-center gap-1 px-3 py-2 bg-yellow-100 text-yellow-700 rounded hover:bg-yellow-200 transition-colors",children:[e.jsx(ue,{className:"w-4 h-4"}),"Pause"]})]})]})]}),r&&r.topContent.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5 text-blue-600"}),"Top Content"]}),e.jsx("div",{className:"space-y-2",children:r.topContent.map((a,p)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-lg font-bold text-gray-400 w-6",children:["#",p+1]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:a.title}),e.jsxs("p",{className:"text-xs text-gray-600",children:[a.playCount," plays"]})]})]},a.id))})]})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(W,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search content...",value:g,onChange:a=>N(a.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("select",{value:b,onChange:a=>k(a.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(a=>e.jsxs("div",{className:"border rounded-lg overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"relative",children:[a.thumbnailUrl?e.jsx("img",{src:a.thumbnailUrl,alt:a.title,className:"w-full h-40 object-cover",onError:p=>{p.target.src="/api/placeholder/400/200"}}):e.jsx("div",{className:"w-full h-40 bg-gray-200 flex items-center justify-center",children:e.jsx(M,{className:"w-12 h-12 text-gray-400"})}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx($,{status:a.status})}),e.jsx("div",{className:"absolute bottom-2 left-2 bg-black bg-opacity-70 text-white px-2 py-1 rounded text-xs capitalize",children:a.type})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:a.title}),a.description&&e.jsx("p",{className:"text-sm text-gray-600 truncate mt-1",children:a.description}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[a.creator&&e.jsxs("span",{className:"text-xs text-gray-500",children:["By ",a.creator.username]}),a.duration&&e.jsxs("span",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(F,{className:"w-3 h-3"}),Math.floor(a.duration/60),":",(a.duration%60).toString().padStart(2,"0")]})]}),a.tags&&a.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:a.tags.slice(0,3).map(p=>e.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded",children:p},p))}),a.status==="pending"&&e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsxs("button",{onClick:()=>P(a.id,"approve"),className:"flex-1 flex items-center justify-center gap-1 px-3 py-2 bg-green-100 text-green-700 rounded hover:bg-green-200 transition-colors",children:[e.jsx(R,{className:"w-4 h-4"}),"Approve"]}),e.jsxs("button",{onClick:()=>{const p=prompt("Rejection reason:");p&&P(a.id,"reject",p)},className:"flex-1 flex items-center justify-center gap-1 px-3 py-2 bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors",children:[e.jsx(T,{className:"w-4 h-4"}),"Reject"]})]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx(E,{to:`/signage/content/${a.id}`,className:"flex-1 text-center px-3 py-2 bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",children:"View Details"}),e.jsx(E,{to:`/signage/content/edit/${a.id}`,className:"px-3 py-2 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition-colors",children:e.jsx(pe,{className:"w-4 h-4"})})]})]})]},a.id))}),s.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(M,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No content found"})]})]})]})})]})})]})};function We(){const[c,s]=i.useState([]),[t,l]=i.useState(!0),[o,r]=i.useState(null),[m,u]=i.useState({}),[y,x]=i.useState({page:1,limit:20,total:0,totalPages:0});i.useEffect(()=>{h()},[m,y.page]);const h=async()=>{try{l(!0);const n=new URLSearchParams({page:y.page.toString(),limit:y.limit.toString(),...m.status&&{status:m.status},...m.type&&{type:m.type},...m.search&&{search:m.search},...m.isPublic!==void 0&&{isPublic:m.isPublic.toString()}}),f=await fetch(`/api/signage/contents?${n}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!f.ok)throw new Error("Failed to fetch contents");const v=await f.json();s(v.data.contents),x(w=>({...w,total:v.data.pagination.total,totalPages:v.data.pagination.totalPages}))}catch(n){r(n instanceof Error?n.message:"An error occurred")}finally{l(!1)}},g=n=>{const v={pending:{color:"bg-yellow-100 text-yellow-800",icon:F,text:"Pending"},approved:{color:"bg-green-100 text-green-800",icon:R,text:"Approved"},rejected:{color:"bg-red-100 text-red-800",icon:T,text:"Rejected"},inactive:{color:"bg-gray-100 text-gray-800",icon:T,text:"Inactive"}}[n],w=v.icon;return e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${v.color}`,children:[e.jsx(w,{className:"w-3 h-3 mr-1"}),v.text]})},N=n=>{if(!n)return"Unknown";const f=Math.floor(n/60),v=n%60;return`${f}:${v.toString().padStart(2,"0")}`},b=async(n,f,v)=>{try{if(!(await fetch(`/api/signage/contents/${n}/approval`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({action:f,reason:v})})).ok)throw new Error("Failed to update content status");h()}catch(w){r(w instanceof Error?w.message:"An error occurred")}},k=async n=>{if(confirm("Are you sure you want to delete this content?"))try{if(!(await fetch(`/api/signage/contents/${n}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).ok)throw new Error("Failed to delete content");h()}catch(f){r(f instanceof Error?f.message:"An error occurred")}};return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Digital Signage Content"}),e.jsx("p",{className:"text-gray-600",children:"Manage video content for digital signage displays"})]}),e.jsxs("button",{onClick:()=>{},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center",children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Add Content"]})]}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("div",{className:"flex-1 min-w-64",children:e.jsxs("div",{className:"relative",children:[e.jsx(W,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search content...",className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:m.search||"",onChange:n=>u(f=>({...f,search:n.target.value}))})]})}),e.jsxs("select",{className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",value:m.status||"",onChange:n=>u(f=>({...f,status:n.target.value||void 0})),children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"inactive",children:"Inactive"})]}),e.jsxs("select",{className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",value:m.type||"",onChange:n=>u(f=>({...f,type:n.target.value||void 0})),children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"youtube",children:"YouTube"}),e.jsx("option",{value:"vimeo",children:"Vimeo"})]}),e.jsxs("select",{className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",value:m.isPublic?.toString()||"",onChange:n=>u(f=>({...f,isPublic:n.target.value?n.target.value==="true":void 0})),children:[e.jsx("option",{value:"",children:"All Visibility"}),e.jsx("option",{value:"true",children:"Public"}),e.jsx("option",{value:"false",children:"Private"})]})]})}),o&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-600",children:o})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(n=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden",children:[e.jsxs("div",{className:"aspect-video bg-gray-100 relative",children:[n.thumbnailUrl?e.jsx("img",{src:n.thumbnailUrl,alt:n.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:e.jsx(_,{className:"w-8 h-8"})}),n.duration&&e.jsx("span",{className:"absolute bottom-2 right-2 bg-black bg-opacity-75 text-white px-2 py-1 rounded text-xs",children:N(n.duration)}),e.jsx("span",{className:`absolute top-2 left-2 px-2 py-1 rounded text-xs font-medium ${n.type==="youtube"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:n.type.toUpperCase()})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-sm line-clamp-2",children:n.title}),g(n.status)]}),n.description&&e.jsx("p",{className:"text-gray-600 text-xs mb-3 line-clamp-2",children:n.description}),n.tags&&n.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[n.tags.slice(0,3).map((f,v)=>e.jsx("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs",children:f},v)),n.tags.length>3&&e.jsxs("span",{className:"text-gray-500 text-xs",children:["+",n.tags.length-3," more"]})]}),e.jsxs("div",{className:"text-xs text-gray-500 mb-3",children:["By ",n.creator.name," • ",new Date(n.createdAt).toLocaleDateString()]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-2",children:n.isPublic&&e.jsx("span",{className:"text-green-600 text-xs",children:"Public"})}),e.jsxs("div",{className:"flex items-center space-x-1",children:[n.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>b(n.id,"approve"),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Approve",children:e.jsx(R,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>b(n.id,"reject","Rejected by admin"),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Reject",children:e.jsx(T,{className:"w-4 h-4"})})]}),e.jsx("button",{className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"View",children:e.jsx(_,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-1 text-gray-600 hover:bg-gray-50 rounded",title:"Edit",children:e.jsx(H,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>k(n.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:e.jsx(Z,{className:"w-4 h-4"})})]})]})]})]},n.id))}),c.length===0&&!t&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(_,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No content found"}),e.jsx("p",{className:"text-gray-600",children:"Get started by adding your first video content."})]}),y.totalPages>1&&e.jsxs("div",{className:"flex items-center justify-between bg-white px-4 py-3 border rounded-lg",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",(y.page-1)*y.limit+1," to ",Math.min(y.page*y.limit,y.total)," of ",y.total," results"]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>x(n=>({...n,page:n.page-1})),disabled:y.page===1,className:"px-3 py-1 border rounded text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsxs("span",{className:"px-3 py-1 text-sm",children:["Page ",y.page," of ",y.totalPages]}),e.jsx("button",{onClick:()=>x(n=>({...n,page:n.page+1})),disabled:y.page===y.totalPages,className:"px-3 py-1 border rounded text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})}const qe=["월","화","수","목","금","토","일"],te=({schedule:c,onChange:s})=>{const[t,l]=i.useState(c.days),[o,r]=i.useState(c.timeRanges),m=h=>{const g=t.includes(h)?t.filter(N=>N!==h):[...t,h];l(g),s({days:g,timeRanges:o})},u=()=>{const h=[...o,{start:"09:00",end:"18:00"}];r(h),s({days:t,timeRanges:h})},y=h=>{const g=o.filter((N,b)=>b!==h);r(g),s({days:t,timeRanges:g})},x=(h,g,N)=>{const b=o.map((k,n)=>n===h?{...k,[g]:N}:k);r(b),s({days:t,timeRanges:b})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-text-main mb-4",children:"송출 요일"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:qe.map(h=>e.jsx("button",{onClick:()=>m(h),className:`px-4 py-2 rounded-lg transition-colors duration-200 ${t.includes(h)?"bg-primary text-white":"bg-secondary text-text-secondary hover:bg-secondary-dark"}`,children:h},h))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-text-main",children:"송출 시간"}),e.jsxs("button",{onClick:u,className:"inline-flex items-center px-3 py-1.5 bg-secondary text-text-secondary rounded-lg hover:bg-secondary-dark transition-colors duration-200",children:[e.jsx(q,{className:"w-4 h-4 mr-1"}),"시간 추가"]})]}),e.jsx("div",{className:"space-y-3",children:o.map((h,g)=>e.jsxs("div",{className:"flex items-center space-x-3 bg-secondary p-3 rounded-lg",children:[e.jsx("input",{type:"time",value:h.start,onChange:N=>x(g,"start",N.target.value),className:"px-3 py-2 bg-white border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"}),e.jsx("span",{className:"text-text-secondary",children:"~"}),e.jsx("input",{type:"time",value:h.end,onChange:N=>x(g,"end",N.target.value),className:"px-3 py-2 bg-white border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"}),e.jsx("button",{onClick:()=>y(g),className:"p-2 text-text-secondary hover:text-text-main transition-colors duration-200",children:e.jsx(je,{className:"w-5 h-5"})})]},g))})]})]})},X=()=>{const c=ee(),[s,t]=i.useState({title:"",type:"image",content:"",schedule:{days:[],timeRanges:[{start:"09:00",end:"18:00"}]}}),l=x=>{t({...s,type:x,content:""})},o=x=>{const h=x.target.files?.[0];if(h){const g=new FileReader;g.onload=N=>{t({...s,content:N.target?.result})},g.readAsDataURL(h)}},r=x=>{t({...s,content:x.target.value})},m=x=>{t({...s,schedule:x})},u=x=>{x.preventDefault(),c("/signage")},y=()=>{switch(s.type){case"image":case"video":return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center w-full",children:e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer bg-secondary hover:bg-secondary-dark",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[s.type==="image"?e.jsx(Q,{className:"w-12 h-12 text-text-secondary mb-3"}):e.jsx(G,{className:"w-12 h-12 text-text-secondary mb-3"}),e.jsxs("p",{className:"mb-2 text-sm text-text-secondary",children:[e.jsx("span",{className:"font-semibold",children:"클릭"}),"하여 파일 업로드"]}),e.jsx("p",{className:"text-xs text-text-secondary",children:s.type==="image"?"PNG, JPG, GIF (최대 10MB)":"MP4, WebM (최대 100MB)"})]}),e.jsx("input",{type:"file",className:"hidden",accept:s.type==="image"?"image/*":"video/*",onChange:o})]})}),s.content&&e.jsx("div",{className:"mt-4",children:s.type==="image"?e.jsx("img",{src:s.content,alt:"미리보기",className:"w-full h-auto rounded-lg"}):e.jsx("video",{src:s.content,controls:!0,className:"w-full rounded-lg"})})]});case"text":case"notice":return e.jsx("textarea",{value:s.content,onChange:r,placeholder:s.type==="text"?"텍스트 내용을 입력하세요":"공지사항 내용을 입력하세요",className:"w-full h-64 p-4 bg-white border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary resize-none"});default:return null}};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex items-center mb-8",children:[e.jsx("button",{onClick:()=>c("/signage"),className:"mr-4 p-2 text-text-secondary hover:text-text-main transition-colors duration-200",children:e.jsx(V,{className:"w-6 h-6"})}),e.jsx("h1",{className:"text-2xl font-semibold text-text-main",children:s.id?"콘텐츠 수정":"새 콘텐츠 등록"})]}),e.jsxs("form",{onSubmit:u,className:"space-y-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-text-main mb-4",children:"기본 정보"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-text-secondary mb-1",children:"제목"}),e.jsx("input",{type:"text",id:"title",value:s.title,onChange:x=>t({...s,title:x.target.value}),className:"w-full px-4 py-2 bg-white border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"콘텐츠 제목을 입력하세요",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"콘텐츠 타입"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{type:"button",onClick:()=>l("image"),className:`flex items-center px-4 py-2 rounded-lg ${s.type==="image"?"bg-primary text-white":"bg-secondary text-text-secondary hover:bg-secondary-dark"}`,children:[e.jsx(Q,{className:"w-5 h-5 mr-2"}),"이미지"]}),e.jsxs("button",{type:"button",onClick:()=>l("text"),className:`flex items-center px-4 py-2 rounded-lg ${s.type==="text"?"bg-primary text-white":"bg-secondary text-text-secondary hover:bg-secondary-dark"}`,children:[e.jsx(be,{className:"w-5 h-5 mr-2"}),"텍스트"]}),e.jsxs("button",{type:"button",onClick:()=>l("video"),className:`flex items-center px-4 py-2 rounded-lg ${s.type==="video"?"bg-primary text-white":"bg-secondary text-text-secondary hover:bg-secondary-dark"}`,children:[e.jsx(G,{className:"w-5 h-5 mr-2"}),"동영상"]}),e.jsxs("button",{type:"button",onClick:()=>l("notice"),className:`flex items-center px-4 py-2 rounded-lg ${s.type==="notice"?"bg-primary text-white":"bg-secondary text-text-secondary hover:bg-secondary-dark"}`,children:[e.jsx(ve,{className:"w-5 h-5 mr-2"}),"공지"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"콘텐츠"}),y()]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-text-main mb-4",children:"송출 설정"}),e.jsx(te,{schedule:s.schedule,onChange:m})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>c("/signage"),className:"px-6 py-2 bg-secondary text-text-secondary rounded-lg hover:bg-secondary-dark transition-colors duration-200",children:"취소"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors duration-200",children:"저장"})]})]})]})},ze=()=>{const{id:c}=se(),s=ee(),t={id:"1",title:"신규 입고 안내",type:"image",content:"https://via.placeholder.com/1920x1080",schedule:{days:["월","화","수","목","금"],timeRanges:[{start:"09:00",end:"12:00"},{start:"14:00",end:"18:00"}]}},l=()=>{window.confirm("정말로 이 콘텐츠를 삭제하시겠습니까?")&&s("/signage")},o=()=>{switch(t.type){case"image":return e.jsx("img",{src:t.content,alt:t.title,className:"w-full h-auto rounded-lg"});case"text":return e.jsx("div",{className:"p-8 bg-white rounded-lg",children:e.jsx("p",{className:"text-lg text-text-main whitespace-pre-wrap",children:t.content})});case"video":return e.jsx("video",{src:t.content,controls:!0,className:"w-full rounded-lg"});case"notice":return e.jsxs("div",{className:"p-8 bg-white rounded-lg",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"w-2 h-2 bg-danger rounded-full mr-2"}),e.jsx("h3",{className:"text-lg font-medium text-text-main",children:"긴급 공지"})]}),e.jsx("p",{className:"text-lg text-text-main whitespace-pre-wrap",children:t.content})]});default:return null}};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex items-center mb-8",children:[e.jsx("button",{onClick:()=>s("/signage"),className:"mr-4 p-2 text-text-secondary hover:text-text-main transition-colors duration-200",children:e.jsx(V,{className:"w-6 h-6"})}),e.jsx("h1",{className:"text-2xl font-semibold text-text-main",children:t.title})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-medium text-text-main mb-4",children:"미리보기"}),o()]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-text-main mb-4",children:"송출 정보"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(O,{className:"w-5 h-5 text-text-secondary mr-2"}),e.jsx("span",{className:"text-text-secondary",children:"송출 요일"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.schedule.days.map(r=>e.jsx("span",{className:"px-3 py-1 bg-secondary text-text-secondary rounded-full text-sm",children:r},r))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(F,{className:"w-5 h-5 text-text-secondary mr-2"}),e.jsx("span",{className:"text-text-secondary",children:"송출 시간"})]}),e.jsx("div",{className:"space-y-2",children:t.schedule.timeRanges.map((r,m)=>e.jsxs("div",{className:"px-3 py-2 bg-secondary text-text-secondary rounded-lg text-sm",children:[r.start," - ",r.end]},m))})]})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("button",{onClick:()=>s(`/signage/edit/${t.id}`),className:"flex-1 inline-flex items-center justify-center px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors duration-200",children:[e.jsx(H,{className:"w-5 h-5 mr-2"}),"수정"]}),e.jsxs("button",{onClick:l,className:"flex-1 inline-flex items-center justify-center px-4 py-2 bg-danger text-white rounded-lg hover:bg-danger-dark transition-colors duration-200",children:[e.jsx(Z,{className:"w-5 h-5 mr-2"}),"삭제"]})]})]})]})]})};function Qe(){return e.jsxs(B,{children:[e.jsx(S,{index:!0,element:e.jsx(We,{})}),e.jsx(S,{path:"new",element:e.jsx(X,{})}),e.jsx(S,{path:":id",element:e.jsx(ze,{})}),e.jsx(S,{path:":id/edit",element:e.jsx(X,{})})]})}function Ge(){const[c,s]=i.useState({days:[],timeRanges:[]});return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Schedule Management"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Manage content schedules for your digital displays"})]}),e.jsx(te,{schedule:c,onChange:s})]})}function Ke(){const[c,s]=i.useState(""),t=[{id:"1",name:"Downtown Store",address:"123 Main St, City",displays:3,status:"active"},{id:"2",name:"Mall Location",address:"456 Shopping Center",displays:5,status:"active"}];return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Store Management"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Manage stores and their digital display configurations"})]}),e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(W,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search stores...",value:c,onChange:l=>s(l.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("button",{className:"ml-4 flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[e.jsx(q,{className:"h-5 w-5 mr-2"}),"Add Store"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(l=>e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:l.name}),e.jsx("span",{className:"px-2 py-1 text-xs font-medium text-green-700 bg-green-100 rounded",children:l.status})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),l.address]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),l.displays," displays"]})]}),e.jsxs("div",{className:"mt-4 flex space-x-2",children:[e.jsx("button",{className:"flex-1 px-3 py-2 text-sm font-medium text-primary-600 bg-primary-50 rounded hover:bg-primary-100",children:"Manage"}),e.jsx("button",{className:"flex-1 px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded hover:bg-gray-200",children:"View Display"})]})]},l.id))})]})}const Ye=()=>{const{storeId:c}=se(),[s,t]=i.useState(null),[l,o]=i.useState(new Date),[r,m]=i.useState(!0),[u,y]=i.useState(!1),[x,h]=i.useState(!1),[g,N]=i.useState(null),b=i.useCallback(async()=>{try{const d=await I.get(`/api/signage/stores/${c}/playback/status`);t(d.data.data),m(!0),N(null)}catch{m(!1),N("Connection lost. Retrying...")}},[c]);i.useEffect(()=>{b();const d=setInterval(()=>{b()},1e4);return()=>{d&&clearInterval(d)}},[b]),i.useEffect(()=>{const d=setInterval(()=>{o(new Date)},1e3);return()=>clearInterval(d)},[]);const k=()=>{document.fullscreenElement?(document.exitFullscreen(),h(!1)):(document.documentElement.requestFullscreen(),h(!0))};i.useEffect(()=>{const d=j=>{switch(j.key){case"f":case"F":k();break;case"m":case"M":y(!u);break;case"r":case"R":b();break}};return window.addEventListener("keypress",d),()=>window.removeEventListener("keypress",d)},[u,b]);const n=({videoId:d})=>e.jsx("iframe",{src:`https://www.youtube.com/embed/${d}?autoplay=1&mute=${u?1:0}&controls=0&showinfo=0&rel=0&iv_load_policy=3&modestbranding=1&loop=1&playlist=${d}`,className:"w-full h-full",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),f=({videoId:d})=>e.jsx("iframe",{src:`https://player.vimeo.com/video/${d}?autoplay=1&muted=${u?1:0}&loop=1&title=0&byline=0&portrait=0`,className:"w-full h-full",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0}),v=d=>d.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),w=d=>d.toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"long"});if(!s||!s.isPlaying||!s.currentItem)return e.jsxs("div",{className:"fixed inset-0 bg-black flex items-center justify-center",children:[e.jsxs("div",{className:"text-center text-white",children:[e.jsx(D,{className:"w-24 h-24 mx-auto mb-6 text-gray-600"}),e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"No Content Playing"}),e.jsx("p",{className:"text-xl text-gray-400 mb-8",children:"Waiting for content..."}),g&&e.jsx("div",{className:"bg-red-900 bg-opacity-50 text-red-200 px-6 py-3 rounded-lg mb-4",children:g}),e.jsxs("button",{onClick:b,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors mx-auto",children:[e.jsx(U,{className:"w-5 h-5"}),"Refresh"]})]}),e.jsx("div",{className:"fixed top-4 right-4 text-white",children:e.jsxs("div",{className:"flex items-center gap-2",children:[r?e.jsx(K,{className:"w-5 h-5 text-green-400"}):e.jsx(Y,{className:"w-5 h-5 text-red-400"}),e.jsx("span",{className:"text-sm",children:v(l)})]})})]});const{content:C}=s.currentItem;return e.jsx("div",{className:"fixed inset-0 bg-black",children:e.jsxs("div",{className:"w-full h-full relative",children:[C.type==="youtube"?e.jsx(n,{videoId:C.videoId}):e.jsx(f,{videoId:C.videoId}),e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsxs("div",{className:"absolute top-0 left-0 right-0 bg-gradient-to-b from-black/70 to-transparent p-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-white",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:C.title}),s.playlist&&e.jsxs("p",{className:"text-sm text-gray-300",children:["Playlist: ",s.playlist.name,"(",s.currentItem.order,"/",s.playlist.items.length,")"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-medium",children:v(l)}),e.jsx("p",{className:"text-sm text-gray-300",children:w(l)})]}),e.jsx("div",{className:"flex items-center gap-2",children:r?e.jsx(K,{className:"w-5 h-5 text-green-400"}):e.jsx(Y,{className:"w-5 h-5 text-red-400 animate-pulse"})})]})]}),s.schedule&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-sm text-gray-300",children:[e.jsx(O,{className:"w-4 h-4"}),e.jsxs("span",{children:["Schedule: ",s.schedule.name,"(",s.schedule.startTime," - ",s.schedule.endTime,")"]})]})]}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-white pointer-events-auto",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>y(!u),className:"p-2 hover:bg-white/20 rounded transition-colors",title:u?"Unmute (M)":"Mute (M)",children:u?e.jsx(we,{className:"w-5 h-5"}):e.jsx(ke,{className:"w-5 h-5"})}),e.jsx("button",{onClick:b,className:"p-2 hover:bg-white/20 rounded transition-colors",title:"Refresh (R)",children:e.jsx(U,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[s.playlist?.loop&&e.jsx("span",{className:"text-sm bg-white/20 px-3 py-1 rounded",children:"Loop Mode"}),e.jsx("button",{onClick:k,className:"p-2 hover:bg-white/20 rounded transition-colors",title:"Fullscreen (F)",children:x?e.jsx(Se,{className:"w-5 h-5"}):e.jsx(Ce,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"mt-2 text-center text-xs text-gray-400",children:"Press F for fullscreen • M to mute/unmute • R to refresh"})]})]}),g&&e.jsxs("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-red-900 bg-opacity-90 text-white px-6 py-4 rounded-lg flex items-center gap-3",children:[e.jsx(D,{className:"w-6 h-6"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Connection Error"}),e.jsx("p",{className:"text-sm",children:g})]})]})]})})};function Je(){return e.jsx(Ye,{})}const Xe=()=>({isAuthenticated:!0,isLoading:!1,user:{id:"admin_1",role:"admin"}});function He(){const{user:c}=Xe();return window.location.pathname.startsWith("/display/")?e.jsx(B,{children:e.jsx(S,{path:"/display/:storeId",element:e.jsx(Je,{})})}):!c||!["admin","manager","store_manager"].includes(c.role)?e.jsx("div",{className:"p-8 text-center",children:"You don't have permission to access this application."}):e.jsx(Oe,{children:e.jsxs(B,{children:[e.jsx(S,{path:"/",element:e.jsx(Ie,{to:"/dashboard",replace:!0})}),e.jsx(S,{path:"/dashboard",element:e.jsx(J,{})}),e.jsx(S,{path:"/signage/dashboard",element:e.jsx(J,{})}),e.jsx(S,{path:"/content/*",element:e.jsx(Qe,{})}),e.jsx(S,{path:"/schedule/*",element:e.jsx(Ge,{})}),e.jsx(S,{path:"/stores/*",element:e.jsx(Ke,{})})]})})}const Ze=new Ee({defaultOptions:{queries:{staleTime:1e3*60*5,gcTime:1e3*60*10,retry:1,refetchOnWindowFocus:!1}}});Pe.createRoot(document.getElementById("root")).render(e.jsx(i.StrictMode,{children:e.jsx(Ae,{children:e.jsx(Le,{client:Ze,children:e.jsx(_e,{children:e.jsx(He,{})})})})}));
