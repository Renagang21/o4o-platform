import{r as f,j as e,u as ie,L as u,H as oe,a as B,F as C,T as le,S as F,B as ce,U as de,b as H,c as me,X as he,M as xe,O as ue,d as T,e as ge,f as $,A as K,C as Y,E as q,g as _,h as pe,i as fe,G as je,k as ye,l as Ne,V as ve,m as V,n as G,o as be,P as J,p as we,q as Z,s as ke,t as Se,R as Ce,v as Ie}from"./vendor-react-DgEsAQIL.js";import{u as I,a as Le,b as Pe,c as Te,Q as Ae,d as Ee,R as Oe}from"./vendor-query-dj6g6who.js";import{a as ee,f as D,k as M}from"./vendor-utils-CJRRMt2y.js";import"./vendor-socket-C11HzXDw.js";import{t as Ue,c as Re}from"./vendor-ui-BkLtITBR.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const m of l.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&o(m)}).observe(document,{childList:!0,subtree:!0});function a(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(i){if(i.ep)return;i.ep=!0;const l=a(i);fetch(i.href,l)}})();typeof window<"u"&&typeof globalThis>"u"&&(window.global=window);const se=f.createContext(void 0),Fe=()=>{const s=f.useContext(se);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s};class te{constructor(t){this.baseURL=t,this.api=ee.create({baseURL:this.baseURL,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(a=>{let o=localStorage.getItem("accessToken")||localStorage.getItem("authToken");if(!o){const i=localStorage.getItem("auth-storage");if(i)try{const l=JSON.parse(i);l.state?.token&&(o=l.state.token)}catch{}}return o&&(a.headers.Authorization=`Bearer ${o}`),a})}async login(t){return(await this.api.post("/auth/login",t)).data}async logout(){await this.api.post("/auth/logout")}async checkSession(){try{return(await this.api.get("/accounts/sso/check")).data}catch{return{isAuthenticated:!1}}}}const $e=()=>{const s="https://api.neture.co.kr/api/v1";if(typeof window>"u")return s;try{if(globalThis.import?.meta?.env?.VITE_API_URL)return globalThis.import.meta.env.VITE_API_URL}catch{}return window.__API_URL__?window.__API_URL__:s},v=new te($e());class qe{constructor(t){this.refreshPromise=null,this.currentToken=null,this.baseURL=t,this.api=ee.create({baseURL:this.baseURL,headers:{"Content-Type":"application/json"},withCredentials:!0}),this.api.interceptors.response.use(a=>a,async a=>{const o=a.config;if(a.response?.status===401&&!o._retry){if(o._retry=!0,this.refreshPromise){if(await this.refreshPromise)return this.api.request(o);throw a}this.refreshPromise=this.refreshToken();const i=await this.refreshPromise;if(this.refreshPromise=null,i)return this.api.request(o)}return Promise.reject(a)})}async login(t){const a=await this.api.post("/auth/v2/login",t);return a.data.token&&(this.currentToken=a.data.token),a.data}async register(t){return(await this.api.post("/auth/v2/register",t)).data}async logout(){try{await this.api.post("/auth/v2/logout")}catch(t){console.error("Logout error:",t)}finally{this.currentToken=null}}async logoutAll(){await this.api.post("/auth/v2/logout-all"),this.currentToken=null}async refreshToken(){try{return(await this.api.post("/auth/v2/refresh")).data.success}catch{return!1}}async getCurrentUser(){try{return(await this.api.get("/auth/v2/me")).data.user}catch{return null}}getApiUrl(){return this.baseURL}getAccessToken(){return this.currentToken}setupSessionSync(){typeof window>"u"||window.addEventListener("storage",t=>{t.key==="auth-logout"?window.location.reload():t.key==="auth-login"&&this.refreshToken()})}broadcastAuthChange(t){if(typeof window>"u")return;const a=`auth-${t}`;localStorage.setItem(a,Date.now().toString()),setTimeout(()=>localStorage.removeItem(a),100)}async loginWithSync(t){const a=await this.login(t);return this.broadcastAuthChange("login"),a}async logoutWithSync(){await this.logout(),this.broadcastAuthChange("logout")}}const _e=new qe(typeof window<"u"&&window.location.hostname==="localhost"?"http://localhost:4000/api/v1":"/api/v1");typeof window<"u"&&_e.setupSessionSync();class De{constructor(t){this.checkInterval=null,this.handleStorageEvent=a=>{a.key==="sso:logout"?this.handleLogout():a.key==="sso:login"&&this.checkSession()},this.config={checkInterval:3e4,...t}}initialize(t){this.onSessionChange=t,typeof window<"u"&&window.addEventListener("storage",this.handleStorageEvent),this.startSessionMonitoring(),this.checkSession()}destroy(){typeof window<"u"&&window.removeEventListener("storage",this.handleStorageEvent),this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)}startSessionMonitoring(){this.checkInterval&&clearInterval(this.checkInterval),this.checkInterval=setInterval(()=>{this.checkSession()},this.config.checkInterval)}async checkSession(){try{const t=await fetch(`${this.config.apiUrl}/auth/v2/me`,{credentials:"include",headers:{"Content-Type":"application/json"}});if(t.ok){const o=(await t.json()).user;return this.onSessionChange?.(o),o}else return this.onSessionChange?.(null),null}catch(t){return console.error("Session check error:",t),this.onSessionChange?.(null),null}}broadcastLogin(){typeof window<"u"&&(localStorage.setItem("sso:login",Date.now().toString()),localStorage.removeItem("sso:login"))}broadcastLogout(){typeof window<"u"&&(localStorage.setItem("sso:logout",Date.now().toString()),localStorage.removeItem("sso:logout"))}handleLogout(){this.onSessionChange?.(null),this.config.domain&&(window.location.href="/login")}getSessionId(){if(typeof document>"u")return null;const t=document.cookie.match(/sessionId=([^;]+)/);return t?t[1]:null}hasSession(){return!!this.getSessionId()}}new De({apiUrl:typeof window<"u"&&window.location.hostname==="localhost"?"http://localhost:4000/api/v1":"/api/v1"});const Me=({children:s,ssoClient:t,onAuthError:a})=>{const o=()=>{if(typeof window>"u")return null;const h=localStorage.getItem("admin-auth-storage");if(h)try{const c=JSON.parse(h);if(c.state&&c.state.user)return c.state.user}catch(c){console.error("Failed to parse auth storage:",c)}return null},[i,l]=f.useState(o()),[m,d]=f.useState(!0),[n,g]=f.useState(null),b=t||new te(typeof window<"u"&&window.import?.meta?.env?.VITE_API_BASE_URL||"");f.useEffect(()=>{(async()=>{try{const c=o(),r=localStorage.getItem("accessToken")||localStorage.getItem("token");if(c&&r){if(l(c),t&&typeof window<"u")try{(await b.checkSession()).isAuthenticated||(l(null),localStorage.removeItem("admin-auth-storage"),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("token"),localStorage.removeItem("authToken"),localStorage.removeItem("user"))}catch(x){console.error("SSO session check failed:",x)}}else l(null)}catch(c){console.error("Initial auth check failed:",c),l(null)}finally{d(!1)}})()},[b,t]);const A=async h=>{try{d(!0),g(null);const c=await b.login(h);if(l(c.user),c.token){localStorage.setItem("accessToken",c.token),localStorage.setItem("token",c.token),c.refreshToken&&localStorage.setItem("refreshToken",c.refreshToken);const r={state:{user:c.user,token:c.token,accessToken:c.token,refreshToken:c.refreshToken,isAuthenticated:!0}};localStorage.setItem("admin-auth-storage",JSON.stringify(r))}}catch(c){const r=c instanceof Error?c.message:"Login failed";throw g(r),a?.(r),c}finally{d(!1)}},O=()=>{b.logout(),l(null),g(null),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("token"),localStorage.removeItem("authToken"),localStorage.removeItem("admin-auth-storage"),localStorage.removeItem("user")},U=()=>{g(null)},E=()=>{if(!i)return null;const h=new Date,c=new Date(h.getTime()+3600*1e3),r=c.getTime()-h.getTime();return{isValid:r>0,expiresAt:c,remainingTime:r}},R={user:i,isAuthenticated:!!i,isLoading:m,error:n,isAdmin:i?.role==="admin",login:A,logout:O,clearError:U,getSessionStatus:E};return e.jsx(se.Provider,{value:R,children:s})};if(typeof document<"u"&&!document.getElementById("auth-spinner-styles")){const s=document.createElement("style");s.id="auth-spinner-styles",s.textContent=`
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  `,document.head.appendChild(s)}f.createContext(void 0);function j(...s){return Ue(Re(s))}const Be=()=>{const{user:s,logout:t}=Fe(),a=ie(),[o,i]=f.useState(!1),l=[{name:"홈",href:"/",icon:oe},{name:"카테고리",href:"/categories",icon:B},{name:"게시글",href:"/posts",icon:C},{name:"태그",href:"/tags",icon:le},{name:"검색",href:"/search",icon:F}],m=[{name:"내 게시글",href:"/my-posts",icon:C},{name:"북마크",href:"/my-bookmarks",icon:ce}],d=n=>a.pathname===n||n!=="/"&&a.pathname.startsWith(n);return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("header",{className:"bg-white shadow-sm border-b",children:[e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(u,{to:"/",className:"flex items-center",children:e.jsx("h1",{className:"text-xl font-bold text-primary-600",children:"O4O Forum"})}),e.jsx("nav",{className:"hidden md:flex ml-10 space-x-1",children:l.map(n=>e.jsxs(u,{to:n.href,className:j("px-3 py-2 rounded-md text-sm font-medium transition-colors","flex items-center gap-2",d(n.href)?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-100"),children:[e.jsx(n.icon,{className:"w-4 h-4"}),n.name]},n.name))})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"hidden md:flex items-center gap-4",children:[m.map(n=>e.jsxs(u,{to:n.href,className:j("px-3 py-2 rounded-md text-sm font-medium transition-colors","flex items-center gap-2",d(n.href)?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-100"),children:[e.jsx(n.icon,{className:"w-4 h-4"}),n.name]},n.name)),e.jsxs("div",{className:"flex items-center gap-3 ml-4 pl-4 border-l",children:[e.jsxs("span",{className:"text-sm text-gray-700 flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4"}),s.name||s.email]}),e.jsx("button",{onClick:()=>t(),className:"text-gray-500 hover:text-gray-700",children:e.jsx(H,{className:"w-5 h-5"})})]})]}),e.jsx(u,{to:"/posts/new",className:"btn btn-primary btn-sm",children:"글쓰기"})]}):e.jsxs("a",{href:"/login",className:"btn btn-primary btn-sm flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4"}),"로그인"]}),e.jsx("button",{className:"md:hidden",onClick:()=>i(!o),children:o?e.jsx(he,{className:"w-6 h-6"}):e.jsx(xe,{className:"w-6 h-6"})})]})]})}),o&&e.jsx("div",{className:"md:hidden border-t",children:e.jsxs("nav",{className:"px-2 pt-2 pb-3 space-y-1",children:[l.map(n=>e.jsxs(u,{to:n.href,onClick:()=>i(!1),className:j("block px-3 py-2 rounded-md text-base font-medium","flex items-center gap-2",d(n.href)?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-100"),children:[e.jsx(n.icon,{className:"w-5 h-5"}),n.name]},n.name)),s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-t pt-2 mt-2",children:m.map(n=>e.jsxs(u,{to:n.href,onClick:()=>i(!1),className:j("block px-3 py-2 rounded-md text-base font-medium","flex items-center gap-2",d(n.href)?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-100"),children:[e.jsx(n.icon,{className:"w-5 h-5"}),n.name]},n.name))}),e.jsxs("div",{className:"border-t pt-2 mt-2",children:[e.jsx("div",{className:"px-3 py-2 text-sm text-gray-700",children:s.name||s.email}),e.jsxs("button",{onClick:()=>{t(),i(!1)},className:"w-full text-left px-3 py-2 text-base font-medium text-gray-700 hover:bg-gray-100 rounded-md flex items-center gap-2",children:[e.jsx(H,{className:"w-5 h-5"}),"로그아웃"]})]})]})]})})]}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(ue,{})}),e.jsx("footer",{className:"bg-white border-t mt-auto",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx("div",{className:"text-center text-sm text-gray-500",children:"© 2025 O4O Platform. All rights reserved."})})})]})};function Q(s){return I({queryKey:["forum-categories",s],queryFn:async()=>{const t=new URLSearchParams;return s&&Object.entries(s).forEach(([o,i])=>{i!=null&&t.append(o,String(i))}),(await v.api.get(`/api/forum/categories?${t}`)).data}})}function Qe(s){return I({queryKey:["forum-category",s],queryFn:async()=>(await v.api.get(`/api/forum/categories/${s}`)).data,enabled:!!s})}function ze(s){return Le({queryKey:["forum-posts",s],queryFn:async({pageParam:t=1})=>{const a=new URLSearchParams;return a.append("page",String(t)),a.append("limit",String(s?.limit||20)),s&&Object.entries(s).forEach(([i,l])=>{l!=null&&i!=="page"&&i!=="limit"&&(Array.isArray(l)?a.append(i,l.join(",")):a.append(i,String(l)))}),(await v.api.get(`/api/forum/posts?${a}`)).data},getNextPageParam:t=>{const{current:a,totalPages:o}=t.pagination;return a<o?a+1:void 0},initialPageParam:1})}function He(s){return I({queryKey:["forum-post",s],queryFn:async()=>(await v.api.get(`/api/forum/posts/${s}`)).data,enabled:!!s})}function Ke(){const s=Pe();return Te({mutationFn:async t=>(await v.api.post("/api/forum/posts",t)).data,onSuccess:()=>{s.invalidateQueries({queryKey:["forum-posts"]})}})}function Ve(s=5){return I({queryKey:["trending-posts",s],queryFn:async()=>(await v.api.get(`/api/forum/posts/trending?limit=${s}`)).data})}function Ge(s=5){return I({queryKey:["recent-posts",s],queryFn:async()=>(await v.api.get(`/api/forum/posts/recent?limit=${s}`)).data})}function Je(){return I({queryKey:["forum-stats"],queryFn:async()=>(await v.api.get("/api/forum/stats")).data,staleTime:1e3*60*5})}const We=()=>{const{data:s,isLoading:t}=Q({isActive:!0}),{data:a,isLoading:o}=Ve(5),{data:i,isLoading:l}=Ge(5),{data:m,isLoading:d}=Je();return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-primary-600 to-primary-700 rounded-lg text-white p-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"O4O Community Forum"}),e.jsx("p",{className:"text-primary-100 mb-6",children:"지식을 공유하고, 질문하고, 함께 성장하는 커뮤니티"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(u,{to:"/posts/new",className:"btn bg-white text-primary-600 hover:bg-gray-100",children:"새 글 작성하기"}),e.jsx(u,{to:"/posts",className:"btn btn-ghost text-white border-white hover:bg-white/10",children:"모든 게시글 보기"})]})]}),m&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"전체 게시글"}),e.jsx("p",{className:"text-2xl font-bold",children:m.totalPosts.toLocaleString()})]}),e.jsx(C,{className:"w-8 h-8 text-primary-500"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"전체 댓글"}),e.jsx("p",{className:"text-2xl font-bold",children:m.totalComments.toLocaleString()})]}),e.jsx(T,{className:"w-8 h-8 text-primary-500"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"활성 사용자"}),e.jsx("p",{className:"text-2xl font-bold",children:m.totalUsers.toLocaleString()})]}),e.jsx(ge,{className:"w-8 h-8 text-primary-500"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"오늘 게시글"}),e.jsx("p",{className:"text-2xl font-bold",children:m.postsToday.toLocaleString()})]}),e.jsx($,{className:"w-8 h-8 text-primary-500"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1",children:[e.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5"}),"카테고리"]}),t?e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((n,g)=>e.jsx("div",{className:"skeleton h-16 rounded-lg"},g))}):e.jsxs("div",{className:"space-y-3",children:[s?.map(n=>e.jsx(u,{to:`/categories/${n.slug}`,className:"block card hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:n.name}),n.description&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:n.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-2xl font-bold text-primary-600",children:n.postCount}),e.jsx("p",{className:"text-xs text-gray-500",children:"게시글"})]})]})},n.id)),e.jsxs(u,{to:"/categories",className:"block text-center py-3 text-primary-600 hover:text-primary-700 font-medium",children:["모든 카테고리 보기 ",e.jsx(K,{className:"inline w-4 h-4"})]})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5"}),"인기 게시글"]}),o?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((n,g)=>e.jsx("div",{className:"skeleton h-24 rounded-lg"},g))}):e.jsx("div",{className:"space-y-4",children:a?.map(n=>e.jsx(W,{post:n},n.id))})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5"}),"최신 게시글"]}),l?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((n,g)=>e.jsx("div",{className:"skeleton h-24 rounded-lg"},g))}):e.jsxs("div",{className:"space-y-4",children:[i?.map(n=>e.jsx(W,{post:n},n.id)),e.jsxs(u,{to:"/posts",className:"block text-center py-3 text-primary-600 hover:text-primary-700 font-medium",children:["모든 게시글 보기 ",e.jsx(K,{className:"inline w-4 h-4"})]})]})]})]})]})]})},W=({post:s})=>e.jsx(u,{to:`/posts/${s.slug}`,className:"block card hover:shadow-md transition-shadow",children:e.jsx("div",{className:"flex items-start gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:j("badge text-xs",s.type==="announcement"?"badge-primary":"badge-secondary"),children:[s.type==="discussion"&&"토론",s.type==="question"&&"질문",s.type==="announcement"&&"공지",s.type==="poll"&&"투표",s.type==="guide"&&"가이드"]}),s.isPinned&&e.jsx("span",{className:"text-xs text-primary-600 font-medium",children:"📌 고정됨"})]}),e.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:s.title}),s.excerpt&&e.jsx("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:s.excerpt}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsx("span",{children:s.authorName}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"w-3 h-3"}),s.viewCount]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"w-3 h-3"}),s.commentCount]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"w-3 h-3"}),s.likeCount]}),e.jsx("span",{children:D(new Date(s.createdAt),{addSuffix:!0,locale:M})})]})]})})}),Xe=()=>{const{data:s,isLoading:t}=Q({isActive:!0});return t?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"카테고리"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(6)].map((a,o)=>e.jsx("div",{className:"skeleton h-32 rounded-lg"},o))})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(B,{className:"w-6 h-6"}),"카테고리"]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s?.map(a=>e.jsxs(u,{to:`/categories/${a.slug}`,className:"card hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a.name}),a.color&&e.jsx("div",{className:"w-6 h-6 rounded-full",style:{backgroundColor:a.color}})]}),a.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:a.description}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[e.jsx(C,{className:"w-4 h-4"}),e.jsxs("span",{children:[a.postCount," 게시글"]})]}),a.requireApproval&&e.jsx("span",{className:"text-xs text-amber-600 bg-amber-50 px-2 py-1 rounded",children:"승인 필요"})]})]},a.id))})]})};var ae=(s=>(s.DRAFT="draft",s.PUBLISHED="published",s.PENDING="pending",s.REJECTED="rejected",s.ARCHIVED="archived",s))(ae||{}),p=(s=>(s.DISCUSSION="discussion",s.QUESTION="question",s.ANNOUNCEMENT="announcement",s.POLL="poll",s.GUIDE="guide",s))(p||{});const y=({variant:s="primary",size:t="md",className:a="",children:o,...i})=>{const l="inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",m={primary:"bg-primary text-primary-foreground hover:bg-primary/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",outline:"border border-input hover:bg-accent hover:text-accent-foreground",ghost:"hover:bg-accent hover:text-accent-foreground",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",default:"bg-primary text-primary-foreground hover:bg-primary/90"},d={sm:"h-9 px-3 text-sm",md:"h-10 py-2 px-4",lg:"h-11 px-8",icon:"h-10 w-10 p-0"};return e.jsx("button",{className:`${l} ${m[s]} ${d[t]} ${a}`,...i,children:o})},Ye=({className:s="",error:t,...a})=>e.jsxs("div",{className:"space-y-1",children:[e.jsx("input",{className:`flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ${t?"border-red-500":""} ${s}`,...a}),t&&e.jsx("p",{className:"text-sm text-red-500",children:t})]}),w=({className:s="",children:t,...a})=>e.jsx("div",{className:`rounded-lg border bg-card text-card-foreground shadow-sm ${s}`,...a,children:t}),Ze=({className:s="",children:t,...a})=>e.jsx("div",{className:`flex flex-col space-y-1.5 p-6 ${s}`,...a,children:t}),k=({className:s="",children:t,...a})=>e.jsx("div",{className:`p-6 pt-0 ${s}`,...a,children:t}),es=({className:s="",children:t,...a})=>e.jsx("h3",{className:`text-2xl font-semibold leading-none tracking-tight ${s}`,...a,children:t}),S=({variant:s="default",className:t="",children:a,...o})=>{const i={default:"bg-primary text-primary-foreground hover:bg-primary/80",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground border border-input hover:bg-accent hover:text-accent-foreground"};return e.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 ${i[s]} ${t}`,...o,children:a})},N=({className:s="",...t})=>e.jsx("div",{className:`animate-pulse rounded-md bg-muted ${s}`,...t}),ss=({className:s="",type:t="single",children:a,...o})=>e.jsx("div",{className:`inline-flex rounded-md shadow-sm ${s}`,role:"group",...o,children:a}),X=({className:s="",value:t,children:a,...o})=>e.jsx("button",{type:"button",className:`inline-flex items-center justify-center px-3 py-2 text-sm font-medium text-gray-900 bg-white border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 ${s}`,"data-value":t,...o,children:a}),re=()=>{const[s,t]=pe(),{data:a}=Q({isActive:!0}),[o,i]=f.useState("list"),[l,m]=f.useState(!1),[d,n]=f.useState({type:s.get("type"),categoryId:s.get("category")||void 0,sortBy:s.get("sortBy")||"createdAt",sortOrder:s.get("sortOrder")||"desc",search:s.get("search")||""}),{data:g,isLoading:b,isFetchingNextPage:A,hasNextPage:O,fetchNextPage:U}=ze({...d,status:ae.PUBLISHED,limit:20}),E=g?.pages.flatMap(r=>r.posts)||[],R=g?.pages[0]?.pagination?.total||0,h=(r,x)=>{const L={...d,[r]:x};n(L);const P=new URLSearchParams;Object.entries(L).forEach(([ne,z])=>{z&&P.set(ne,String(z))}),t(P)},c={[p.DISCUSSION]:{icon:T,label:"토론",color:"text-blue-600 bg-blue-50"},[p.QUESTION]:{icon:G,label:"질문",color:"text-purple-600 bg-purple-50"},[p.ANNOUNCEMENT]:{icon:V,label:"공지",color:"text-red-600 bg-red-50"},[p.POLL]:{icon:ve,label:"투표",color:"text-green-600 bg-green-50"},[p.GUIDE]:{icon:Ne,label:"가이드",color:"text-orange-600 bg-orange-50"}};return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"커뮤니티 포럼"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:["총 ",R.toLocaleString(),"개의 게시글"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ss,{type:"single",value:o,onValueChange:r=>r&&i(r),children:[e.jsx(X,{value:"list","aria-label":"List view",children:e.jsx(fe,{className:"h-4 w-4"})}),e.jsx(X,{value:"grid","aria-label":"Grid view",children:e.jsx(je,{className:"h-4 w-4"})})]}),e.jsx(y,{variant:"outline",size:"icon",onClick:()=>m(!l),className:j(l&&"bg-gray-100 dark:bg-gray-800"),children:e.jsx(ye,{className:"h-4 w-4"})})]})]})}),e.jsx(w,{className:"mb-6",children:e.jsx(k,{className:"p-4",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(F,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx(Ye,{type:"text",placeholder:"제목, 내용, 태그로 검색...",value:d.search,onChange:r=>h("search",r.target.value),className:"pl-10"})]}),e.jsxs(y,{variant:"default",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"검색"]})]})})}),l&&e.jsx(w,{className:"mb-6",children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"카테고리"}),e.jsxs("select",{value:d.categoryId||"all",onChange:r=>h("categoryId",r.target.value==="all"?void 0:r.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx("option",{value:"all",children:"모든 카테고리"}),a?.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"게시글 유형"}),e.jsxs("select",{value:d.type||"all",onChange:r=>h("type",r.target.value==="all"?void 0:r.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx("option",{value:"all",children:"모든 유형"}),Object.entries(c).map(([r,x])=>e.jsx("option",{value:r,children:x.label},r))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"정렬 기준"}),e.jsxs("select",{value:d.sortBy,onChange:r=>h("sortBy",r.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx("option",{value:"createdAt",children:"최신순"}),e.jsx("option",{value:"viewCount",children:"조회순"}),e.jsx("option",{value:"likeCount",children:"인기순"}),e.jsx("option",{value:"commentCount",children:"댓글순"})]})]})]})})}),e.jsxs("div",{className:"flex gap-2 mb-6 flex-wrap",children:[e.jsxs(y,{variant:d.sortBy==="createdAt"?"default":"outline",size:"sm",onClick:()=>h("sortBy","createdAt"),children:[e.jsx(be,{className:"h-4 w-4 mr-1"}),"최신"]}),e.jsxs(y,{variant:d.sortBy==="likeCount"?"default":"outline",size:"sm",onClick:()=>h("sortBy","likeCount"),children:[e.jsx($,{className:"h-4 w-4 mr-1"}),"인기"]}),e.jsxs(y,{variant:d.type===p.QUESTION?"default":"outline",size:"sm",onClick:()=>h("type",d.type===p.QUESTION?void 0:p.QUESTION),children:[e.jsx(G,{className:"h-4 w-4 mr-1"}),"질문만"]}),e.jsxs(y,{variant:d.type===p.ANNOUNCEMENT?"default":"outline",size:"sm",onClick:()=>h("type",d.type===p.ANNOUNCEMENT?void 0:p.ANNOUNCEMENT),children:[e.jsx(V,{className:"h-4 w-4 mr-1"}),"공지만"]})]}),e.jsx("div",{className:j(o==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4":"space-y-4"),children:b?[...Array(6)].map((r,x)=>e.jsx(w,{children:e.jsxs(k,{className:"p-6",children:[e.jsx(N,{className:"h-4 w-24 mb-4"}),e.jsx(N,{className:"h-6 w-full mb-2"}),e.jsx(N,{className:"h-4 w-full mb-2"}),e.jsx(N,{className:"h-4 w-3/4 mb-4"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(N,{className:"h-4 w-16"}),e.jsx(N,{className:"h-4 w-16"}),e.jsx(N,{className:"h-4 w-16"})]})]})},x)):E.length===0?e.jsx(w,{className:"col-span-full",children:e.jsxs(k,{className:"text-center py-12",children:[e.jsx(C,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"게시글이 없습니다"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"검색 조건에 맞는 게시글을 찾을 수 없습니다."}),e.jsx(y,{variant:"outline",onClick:()=>n({type:void 0,categoryId:void 0,sortBy:"createdAt",sortOrder:"desc",search:""}),children:"필터 초기화"})]})}):e.jsxs(e.Fragment,{children:[E.map(r=>{const x=r.type?c[r.type]:null,L=x?.icon||C;return o==="grid"?e.jsx(u,{to:`/posts/${r.slug}`,className:"block h-full",children:e.jsxs(w,{className:"h-full hover:shadow-lg transition-all duration-200 hover:-translate-y-1",children:[e.jsxs(Ze,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[x&&e.jsx("div",{className:j("p-1.5 rounded-md",x.color),children:e.jsx(L,{className:"h-4 w-4"})}),r.isPinned&&e.jsxs(S,{variant:"secondary",className:"gap-1",children:[e.jsx(J,{className:"h-3 w-3"}),"고정"]})]}),r.category&&e.jsx(S,{variant:"outline",className:"text-xs",children:r.category.name})]}),e.jsx(es,{className:"line-clamp-2 text-lg",children:r.title})]}),e.jsxs(k,{children:[r.excerpt&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 line-clamp-3 mb-4",children:r.excerpt}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("span",{className:"font-medium",children:r.authorName}),e.jsx("span",{children:D(new Date(r.createdAt),{addSuffix:!0,locale:M})})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-3 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"w-3.5 h-3.5"}),r.viewCount]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"w-3.5 h-3.5"}),r.commentCount]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"w-3.5 h-3.5"}),r.likeCount]})]})]})]})},r.id):e.jsx(u,{to:`/posts/${r.slug}`,className:"block",children:e.jsx(w,{className:"hover:shadow-md transition-all duration-200",children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[x&&e.jsx("div",{className:j("p-2 rounded-lg flex-shrink-0",x.color),children:e.jsx(L,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[r.isPinned&&e.jsxs(S,{variant:"secondary",className:"gap-1",children:[e.jsx(J,{className:"h-3 w-3"}),"고정됨"]}),r.category&&e.jsx(S,{variant:"outline",children:r.category.name}),x&&e.jsx(S,{variant:"secondary",children:x.label})]}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:r.title}),r.excerpt&&e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-3 line-clamp-2",children:r.excerpt}),r.tags&&r.tags.length>0&&e.jsx("div",{className:"flex gap-2 mb-3 flex-wrap",children:r.tags.map(P=>e.jsxs(S,{variant:"secondary",className:"text-xs",children:["#",P]},P))}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400 flex-wrap",children:[e.jsx("span",{className:"font-medium",children:r.authorName}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"w-4 h-4"}),r.viewCount.toLocaleString()]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"w-4 h-4"}),r.commentCount.toLocaleString()]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"w-4 h-4"}),r.likeCount.toLocaleString()]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Y,{className:"w-4 h-4"}),D(new Date(r.createdAt),{addSuffix:!0,locale:M})]})]})]})]})})})},r.id)}),O&&e.jsx("div",{className:"col-span-full text-center py-8",children:e.jsx(y,{onClick:()=>U(),disabled:A,variant:"outline",size:"lg",children:A?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"h-4 w-4 mr-2 animate-spin"}),"로딩 중..."]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"더 많은 게시글 보기"]})})})]})})]})})},ts=()=>{const{categorySlug:s}=Z(),{data:t,isLoading:a}=Qe(s);return a?e.jsx("div",{className:"skeleton h-96"}):t?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:t.name}),t.description&&e.jsx("p",{className:"text-gray-600",children:t.description})]}),e.jsx(re,{})]}):e.jsx("div",{children:"카테고리를 찾을 수 없습니다."})},as=()=>{const{postSlug:s}=Z(),{data:t,isLoading:a}=He(s);return a?e.jsx("div",{className:"skeleton h-96"}):t?e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("article",{className:"bg-white rounded-lg shadow-sm p-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:t.title}),e.jsx("div",{className:"prose max-w-none",dangerouslySetInnerHTML:{__html:t.content}})]})}):e.jsx("div",{children:"게시글을 찾을 수 없습니다."})},rs=()=>(ke(),Ke(),e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"새 게시글 작성"}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsx("p",{className:"text-gray-600",children:"게시글 작성 폼이 여기에 구현됩니다."})})]})),ns=()=>e.jsx("div",{children:"게시글 수정 페이지"}),is=()=>e.jsx("div",{children:"검색 페이지"}),os=()=>e.jsx("div",{children:"태그 페이지"}),ls=()=>e.jsx("div",{children:"내 게시글 페이지"}),cs=()=>e.jsx("div",{children:"북마크 페이지"}),ds=()=>e.jsxs("div",{className:"text-center py-16",children:[e.jsx("h1",{className:"text-6xl font-bold text-gray-300 mb-4",children:"404"}),e.jsx("p",{className:"text-xl text-gray-600 mb-8",children:"페이지를 찾을 수 없습니다."}),e.jsx(u,{to:"/",className:"btn btn-primary",children:"홈으로 돌아가기"})]}),ms=Se([{path:"/",element:e.jsx(Be,{}),children:[{index:!0,element:e.jsx(We,{})},{path:"categories",element:e.jsx(Xe,{})},{path:"categories/:categorySlug",element:e.jsx(ts,{})},{path:"posts",element:e.jsx(re,{})},{path:"posts/new",element:e.jsx(rs,{})},{path:"posts/:postSlug",element:e.jsx(as,{})},{path:"posts/:postSlug/edit",element:e.jsx(ns,{})},{path:"search",element:e.jsx(is,{})},{path:"tags",element:e.jsx(os,{})},{path:"my-posts",element:e.jsx(ls,{})},{path:"my-bookmarks",element:e.jsx(cs,{})},{path:"*",element:e.jsx(ds,{})}]}]);function hs(){return e.jsx(Ce,{router:ms})}const xs=new Ae({defaultOptions:{queries:{staleTime:1e3*60*5,gcTime:1e3*60*10,retry:1}}});Ie.createRoot(document.getElementById("root")).render(e.jsx(f.StrictMode,{children:e.jsx(Ee,{client:xs,children:e.jsxs(Me,{children:[e.jsx(hs,{}),e.jsx(Oe,{initialIsOpen:!1})]})})}));
