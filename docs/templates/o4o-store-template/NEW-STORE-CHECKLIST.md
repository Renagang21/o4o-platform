# O4O ìƒˆ ë§¤ì¥ ìƒì„± ì²´í¬ë¦¬ìŠ¤íŠ¸

> **Phase 8 í™•ì • ë¬¸ì„œ**
> ìƒˆë¡œìš´ O4O ë§¤ì¥ì„ ìƒì„±í•  ë•Œ ë°˜ë“œì‹œ ë”°ë¼ì•¼ í•˜ëŠ” ì²´í¬ë¦¬ìŠ¤íŠ¸

## ì‚¬ì „ ì¡°ê±´

- [ ] CLAUDE.md Â§7 (E-commerce Core ì ˆëŒ€ ê·œì¹™) ìˆ™ì§€
- [ ] CLAUDE.md Â§21 (O4O Store Template Rules) ìˆ™ì§€
- [ ] Reference Implementation (Cosmetics, Tourism) ì½”ë“œ ê²€í† 

---

## Phase 0: B2C í…œí”Œë¦¿ ì„ íƒ

### 0.1 í…œí”Œë¦¿ ì„ íƒ ê°€ì´ë“œ

ë§¤ì¥ì˜ í•µì‹¬ ê°€ì¹˜ì— ë”°ë¼ ì í•©í•œ B2C í…œí”Œë¦¿ì„ ì„ íƒí•©ë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ë§¤ì¥ì˜ í•µì‹¬ ê°€ì¹˜ëŠ” ë¬´ì—‡ì¸ê°€?                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚                     â”‚
        â–¼                     â–¼                     â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ì „ë¬¸ì„±  â”‚          â”‚ ë¸Œëœë“œ  â”‚          â”‚ ì§€ì—­    â”‚
   â”‚ ì‹ ë¢°    â”‚          â”‚ ê°ì„±    â”‚          â”‚ ì¹œë°€ê°  â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
        â”‚                    â”‚                    â”‚
        â–¼                    â–¼                    â–¼
  Professional         Beauty              Local
  Service Store        Experience          Community
                       Store               Store
        â”‚                    â”‚                    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ ìœ„ 3ê°œì— í•´ë‹¹    â”‚
                    â”‚ ì•ˆ í•˜ë©´?         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                      Modern Standard
                      Store (ê¸°ë³¸í˜•)
```

### 0.2 í…œí”Œë¦¿ë³„ íŠ¹ì§•

| í…œí”Œë¦¿ | í•µì‹¬ ê°€ì¹˜ | ê¶Œì¥ ì—…ì¢… | í´ë” |
|--------|----------|----------|------|
| **Modern Standard** | ë²”ìš©/í™•ì¥ | ì¼ë°˜ ì‡¼í•‘ëª°, MVP | `b2c-templates/modern-standard/` |
| **Professional Service** | ì „ë¬¸ì„±/ì‹ ë¢° | ì•½êµ­, í—¬ìŠ¤ì¼€ì–´ | `b2c-templates/professional-service/` |
| **Beauty Experience** | ë¸Œëœë“œ/ê°ì„± | í™”ì¥í’ˆ, K-Beauty | `b2c-templates/beauty-experience/` |
| **Local Community** | ì§€ì—­/ì¹œë°€ê° | ë™ë„¤ ê°€ê²Œ, ì§€ì—­ ë§¤ì¥ | `b2c-templates/local-community/` |

### 0.3 í…œí”Œë¦¿ ë³µì‚¬

ì„ íƒí•œ í…œí”Œë¦¿ì„ ë§¤ì¥ ì„¤ì • í´ë”ë¡œ ë³µì‚¬í•©ë‹ˆë‹¤.

```bash
# ì˜ˆ: Beauty Experience Store ì‚¬ìš©
cp -r docs/templates/o4o-store-template/b2c-templates/beauty-experience \
      apps/api-server/src/routes/{store-name}/template-config
```

- [ ] B2C í…œí”Œë¦¿ ì„ íƒ ì™„ë£Œ
- [ ] í…œí”Œë¦¿ í´ë” ë³µì‚¬ ì™„ë£Œ

> ğŸ“„ í…œí”Œë¦¿ ìƒì„¸: [B2C-TEMPLATE-INDEX.md](./b2c-templates/B2C-TEMPLATE-INDEX.md)

---

## Phase 1: ì„¤ê³„

### 1.1 ë„ë©”ì¸ ì •ì˜
- [ ] ë§¤ì¥ ì´ë¦„ í™•ì •: `{store-name}`
- [ ] OrderType ê°’ í™•ì •: `{STORE_TYPE}`
- [ ] ë§¤ì¥ ì±…ì„ ë²”ìœ„ ì •ì˜ (ìƒí’ˆ/ì½˜í…ì¸ /ê°€ê²© ë“±)

### 1.2 ë©”íƒ€ë°ì´í„° ìŠ¤í‚¤ë§ˆ ì •ì˜
- [ ] `{Store}OrderMetadata` ì¸í„°í˜ì´ìŠ¤ ì„¤ê³„
- [ ] í•„ìˆ˜ í•„ë“œ í™•ì •
- [ ] ì„ íƒ í•„ë“œ í™•ì •

### 1.3 í…Œì´ë¸” ì„¤ê³„
- [ ] `{store}_` prefix í…Œì´ë¸” ëª©ë¡ í™•ì •
- [ ] `{store}_orders` í…Œì´ë¸” **ìƒì„±í•˜ì§€ ì•ŠìŒ** í™•ì¸
- [ ] Entity ê´€ê³„ë„ ì‘ì„±

---

## Phase 2: OrderType ë“±ë¡

### 2.1 enum ì¶”ê°€

**íŒŒì¼**: `apps/api-server/src/entities/checkout/CheckoutOrder.entity.ts`

```typescript
export enum OrderType {
  GENERIC = 'GENERIC',
  DROPSHIPPING = 'DROPSHIPPING',
  GLYCOPHARM = 'GLYCOPHARM',
  COSMETICS = 'COSMETICS',
  TOURISM = 'TOURISM',
  // ìƒˆ ë§¤ì¥ ì¶”ê°€
  {STORE_TYPE} = '{STORE_TYPE}',
}
```

- [ ] OrderType enumì— ê°’ ì¶”ê°€ë¨
- [ ] TypeScript ë¹Œë“œ ì„±ê³µ

---

## Phase 3: Entity ìƒì„±

### 3.1 ìƒí’ˆ/ì½˜í…ì¸  Entity

**íŒŒì¼**: `apps/api-server/src/routes/{store-name}/entities/{store}-item.entity.ts`

```typescript
import {
  Entity,
  PrimaryGeneratedColumn,
  Column,
  CreateDateColumn,
  UpdateDateColumn,
  Index,
  ManyToOne,
  JoinColumn,
} from 'typeorm';
// ESM í˜¸í™˜: type-only import
import type { RelatedEntity } from './related.entity.js';

@Entity('{store}_items')
export class {Store}Item {
  @PrimaryGeneratedColumn('uuid')
  id!: string;

  // ... ë„ë©”ì¸ í•„ë“œ

  // ESM í˜¸í™˜: ë¬¸ìì—´ ê¸°ë°˜ ê´€ê³„
  @ManyToOne('RelatedEntity', 'items')
  @JoinColumn({ name: 'related_id' })
  related?: RelatedEntity;
}
```

ì²´í¬ë¦¬ìŠ¤íŠ¸:
- [ ] `{store}_` prefix í…Œì´ë¸”ëª… ì‚¬ìš©
- [ ] `type` í‚¤ì›Œë“œë¡œ ê´€ë ¨ Entity import
- [ ] ë¬¸ìì—´ ê¸°ë°˜ ê´€ê³„ ë°ì½”ë ˆì´í„° ì‚¬ìš©
- [ ] TypeScript ë¹Œë“œ ì„±ê³µ

---

## Phase 4: Order Controller ìƒì„±

### 4.1 Controller êµ¬í˜„

**íŒŒì¼**: `apps/api-server/src/routes/{store-name}/controllers/{store}-order.controller.ts`

í•„ìˆ˜ íŒ¨í„´ í™•ì¸:
- [ ] `checkoutService.createOrder()` ì‚¬ìš©
- [ ] `OrderType.{STORE_TYPE}` ì§€ì •
- [ ] ì§ì ‘ DB INSERT ì—†ìŒ
- [ ] ìì²´ Order Entity ì—†ìŒ

### 4.2 Route ì—°ê²°

**íŒŒì¼**: `apps/api-server/src/routes/{store-name}/{store}.routes.ts`

- [ ] Order Controller ë“±ë¡
- [ ] ì¸ì¦ ë¯¸ë“¤ì›¨ì–´ ì ìš©
- [ ] Scope ê²€ì¦ ì ìš© (`{store}:write`)

---

## Phase 5: ë¬¸ì„œí™”

### 5.1 ë„ë©”ì¸ ê²½ê³„ ë¬¸ì„œ

**íŒŒì¼**: `apps/api-server/src/routes/{store-name}/DOMAIN-BOUNDARY.md`

- [ ] ë§¤ì¥ ì±…ì„ ë²”ìœ„ ëª…ì‹œ
- [ ] Core ìœ„ì„ ì‚¬í•­ ëª…ì‹œ
- [ ] ê¸ˆì§€ ì‚¬í•­ ëª…ì‹œ

### 5.2 API ë¬¸ì„œ (ì„ íƒ)

- [ ] OpenAPI ìŠ¤í™ ì‘ì„± (í•„ìš” ì‹œ)
- [ ] ìš”ì²­/ì‘ë‹µ ìŠ¤í‚¤ë§ˆ ì •ì˜

---

## Phase 6: ê²€ì¦

### 6.1 ë¹Œë“œ ê²€ì¦

```bash
cd apps/api-server
npx tsc --noEmit
```

- [ ] TypeScript ë¹Œë“œ ì„±ê³µ

### 6.2 ê¸ˆì§€ í…Œì´ë¸” ê²€ì‚¬

```bash
node scripts/check-forbidden-tables.mjs
```

- [ ] ê¸ˆì§€ íŒ¨í„´ ê²€ì‚¬ í†µê³¼
- [ ] `{store}_orders` í…Œì´ë¸” ì—†ìŒ í™•ì¸

### 6.3 ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸

- [ ] ì£¼ë¬¸ ìƒì„± API í…ŒìŠ¤íŠ¸
- [ ] `checkout_orders`ì— ì €ì¥ í™•ì¸
- [ ] `orderType` í•„ë“œ ê°’ í™•ì¸
- [ ] ì£¼ë¬¸ ì¡°íšŒ API í…ŒìŠ¤íŠ¸

---

## ìµœì¢… í™•ì¸

| í•­ëª© | í™•ì¸ |
|------|------|
| OrderType enum ì¶”ê°€ | [ ] |
| checkoutService.createOrder() ì‚¬ìš© | [ ] |
| ìì²´ ì£¼ë¬¸ í…Œì´ë¸” ì—†ìŒ | [ ] |
| ESM í˜¸í™˜ Entity íŒ¨í„´ | [ ] |
| CLAUDE.md Â§7 ì¤€ìˆ˜ | [ ] |
| DOMAIN-BOUNDARY.md ìƒì„± | [ ] |
| TypeScript ë¹Œë“œ ì„±ê³µ | [ ] |
| ê¸ˆì§€ í…Œì´ë¸” ê²€ì‚¬ í†µê³¼ | [ ] |

---

## ì°¸ì¡°

- [STORE-TEMPLATE-README.md](./STORE-TEMPLATE-README.md)
- [ORDER-DELEGATION.md](./ORDER-DELEGATION.md)
- [DOMAIN-BOUNDARY.md](./DOMAIN-BOUNDARY.md)
- [CLAUDE.md Â§7](../../../CLAUDE.md) - E-commerce Core ì ˆëŒ€ ê·œì¹™
- [CLAUDE.md Â§21](../../../CLAUDE.md) - O4O Store Template Rules

---

*Phase 8 (2026-01-11) - O4O Store Template Standardization*
