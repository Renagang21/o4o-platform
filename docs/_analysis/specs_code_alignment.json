{
  "report_id": "specs_code_alignment",
  "report_date": "2025-12-10",
  "phase": 16,
  "document_base": "docs/specs/sellerops/, docs/specs/partnerops/",

  "sellerops": {
    "alignment_score": 40,
    "status": "FIELD_NAME_MISMATCHES",
    "spec_file": "docs/specs/sellerops/sellerops-spec.md",

    "entity_mismatches": [
      {
        "id": "SO-001",
        "severity": "HIGH",
        "entity": "SupplierProductOffer",
        "spec_field": "supplyPrice",
        "actual_field": "supplierPrice",
        "file": "packages/dropshipping-core/src/entities/SupplierProductOffer.entity.ts:45",
        "impact": "OrderOpsService.ts queries non-existent field"
      },
      {
        "id": "SO-002",
        "severity": "HIGH",
        "entity": "SupplierProductOffer",
        "spec_field": "stock",
        "actual_field": "stockQuantity",
        "file": "packages/dropshipping-core/src/entities/SupplierProductOffer.entity.ts:52",
        "impact": "Stock queries may fail"
      },
      {
        "id": "SO-003",
        "severity": "HIGH",
        "entity": "SupplierProductOffer",
        "spec_field": "isActive (boolean)",
        "actual_field": "status (enum: 'pending'|'approved'|'rejected'|'suspended')",
        "file": "packages/dropshipping-core/src/entities/SupplierProductOffer.entity.ts:38",
        "impact": "Boolean vs enum type mismatch"
      },
      {
        "id": "SO-004",
        "severity": "HIGH",
        "entity": "SettlementBatch",
        "spec_field": "sellerId",
        "actual_field": "NOT_FOUND",
        "impact": "SettlementOpsService.ts queries non-existent field"
      },
      {
        "id": "SO-005",
        "severity": "HIGH",
        "entity": "SettlementBatch",
        "spec_field": "netAmount",
        "actual_field": "NOT_FOUND",
        "impact": "Settlement amount calculation broken"
      }
    ],

    "service_issues": [
      {
        "file": "packages/sellerops/src/services/OrderOpsService.ts",
        "line": "107-108",
        "code": "supplyPrice: offer?.supplyPrice || 0",
        "issue": "References non-existent field supplyPrice (should be supplierPrice)"
      },
      {
        "file": "packages/sellerops/src/services/SettlementOpsService.ts",
        "issue": "References batch.sellerId and batch.netAmount which don't exist on SettlementBatch entity"
      }
    ]
  },

  "partnerops": {
    "alignment_score": 20,
    "status": "SKELETON_IMPLEMENTATION",
    "spec_file": "docs/specs/partnerops/partnerops-spec.md",

    "documented_features": [
      "Partner Dashboard with analytics",
      "Order relay management",
      "Fulfillment tracking",
      "Settlement reports"
    ],

    "implemented_features": [
      {
        "feature": "OrderRelayService",
        "status": "SKELETON",
        "file": "packages/partnerops/src/services/OrderRelayService.ts",
        "notes": "Basic structure, minimal logic"
      },
      {
        "feature": "FulfillmentService",
        "status": "SKELETON",
        "file": "packages/partnerops/src/services/FulfillmentService.ts",
        "notes": "Stub methods only"
      }
    ],

    "entity_issues": [
      {
        "id": "PO-001",
        "severity": "HIGH",
        "entity": "OrderRelay",
        "issue": "Entity structure doesn't match spec - missing many required fields",
        "missing_fields": ["relayedAt", "acceptedAt", "deliveryInfo", "partnerNotes"]
      }
    ]
  },

  "supplierops": {
    "alignment_score": 30,
    "status": "PARTIAL_IMPLEMENTATION",
    "notes": "Similar issues to SellerOps - field name mismatches with dropshipping-core entities"
  },

  "priority_fixes": [
    {
      "priority": 1,
      "action": "Update SupplierProductOffer entity OR update all services to use correct field names",
      "affected_files": [
        "packages/sellerops/src/services/OrderOpsService.ts",
        "packages/sellerops/src/services/ListingOpsService.ts"
      ]
    },
    {
      "priority": 2,
      "action": "Add sellerId and netAmount to SettlementBatch OR update SettlementOpsService queries",
      "affected_files": [
        "packages/dropshipping-core/src/entities/SettlementBatch.entity.ts",
        "packages/sellerops/src/services/SettlementOpsService.ts"
      ]
    },
    {
      "priority": 3,
      "action": "Complete PartnerOps implementation or mark as WIP in documentation"
    }
  ]
}
