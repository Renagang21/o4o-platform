# O4O-COMMON-REQUEST-DEFINITION-V1

**(공통 Request 기준 선언)**

## 1. 문서의 목적

이 문서는 o4o 전반에서 발생하는 **"사람의 판단과 처리가 필요한 행위"를
하나의 공통 개념(Request)으로 정의**하기 위한 기준 선언이다.

* 이 문서는 설계 문서가 아니다.
* 이 문서는 구현 지시서가 아니다.
* 이 문서는 **요청이 무엇이고, 무엇이 아닌지를 고정**하기 위한 기준이다.

---

## 2. o4o에서의 Request 정의

### Request란 무엇인가

Request는 다음 조건을 **모두 만족하는 상태**를 의미한다.

1. 소비자의 행동으로 시작되었고
2. 자동 처리로 끝낼 수 없으며
3. **매장 근무자 또는 운영자의 판단이 필요하고**
4. 승인 / 거절 / 보류 중 하나의 결론이 필요하며
5. 그 결과가 **업무 또는 수익 흐름**으로 이어진다

즉,

> **Request = 이벤트(Event)가 '사람의 업무'로 승격된 상태**

---

## 3. Request와 Event의 경계 (재확인)

| 구분 | Event | Request |
|------|-------|---------|
| 성격 | 관찰 | 업무 |
| 자동 처리 | 가능 | 불가 |
| 승인/거절 | 없음 | 필수 |
| 책임 주체 | 시스템 | 사람 |
| 목적 | 분석/전환 | 처리/결과 |

Event는 많을수록 좋지만,
Request는 **필요한 만큼만 존재해야 한다.**

---

## 4. Request의 표준 목적(purpose)

Request는 반드시 아래 목적 중 **하나 이상**을 가진다.

* **consultation** : 상담 요청
* **sample** : 샘플 신청 (재고/선별 필요)
* **order** : 주문 의도 (확정 아님)
* **survey_followup** : 설문/퀴즈 이후 후속 대응
* **info_followup** : 정보 요청 후 설명 필요

> info / survey 자체는 Request가 아니다.
> **"후속 조치가 필요한 경우에만" Request가 된다.**

---

## 5. Request의 공통 상태 모델

모든 Request는 아래 상태 모델을 따른다.

```
pending → approved | rejected
              ↘
               cancelled
```

### 상태 의미

* **pending**: 처리 대기
* **approved**: 처리 승인 (상담 진행, 주문 연결 등)
* **rejected**: 거절
* **cancelled**: 고객 또는 시스템에 의한 취소

---

## 6. Request의 공통 필드 (개념 기준)

Request는 구현체와 무관하게 다음 개념을 반드시 포함한다.

* purpose : 요청 목적
* sourceType : signage | tablet | qr | web | print
* sourceId : 콘텐츠/QR/플레이리스트 식별자
* serviceKey : 서비스 구분
* status : pending / approved / rejected / cancelled
* requestedAt : 요청 시각
* handledBy : 처리자
* handledAt : 처리 시각
* metadata : 맥락 정보 (JSON)

> 어떤 필드를 어떻게 저장할지는 **각 서비스 구현에 맡긴다.**
> 단, 의미는 반드시 동일해야 한다.

---

## 7. Request 생성 원칙 (중요)

Request는 다음 경우에만 생성된다.

### 생성 허용

* QR purpose가 consultation / sample / order 인 경우
* 태블릿에서 "직원에게 요청"이 명시된 경우
* 설문/퀴즈 이후 후속 설명이 필요한 경우

### 생성 금지

* 단순 조회
* 단순 클릭
* 단순 설문 응답
* 자동 리다이렉트

---

## 8. Request의 UI 위치 원칙

Request는 반드시 **"결과 화면"이 아니라 "업무 대기 상태"로 노출**되어야 한다.

* 매장 대시보드
* 근무자 화면
* 운영자 승인 화면

Request는 알림이 아니라 **업무 큐(queue)** 이다.

---

## 9. Request의 책임 경계

* Request 생성: 시스템
* Request 판단: 매장 근무자 / 운영자
* Request 결과 책임:
  * 상담/샘플 → 매장
  * 주문 → 매장 + 시스템 + 공급자 분리

o4o는 **판단을 대신하지 않는다.**

---

## 10. 본 문서의 위치

이 문서는 다음 모든 구현의 **판단 기준**이다.

* 태블릿 고객 요청
* QR 기반 상담/샘플/주문
* 설문 기반 후속 대응
* 매장 대시보드 "요청 관리"

---

### 상태

* 문서 유형: 기준 선언
* 변경 빈도: 매우 낮음
* 구현 강제성: 없음 (판단 기준)
* 작성일: 2026-02-09
