# IR-CYBER-STORE-GAP-TABLE-V1

> **사이버 매장 정비 GAP 분석 및 우선순위**
> **작성일**: 2026-02-17
> **범위**: GlycoPharm 기준, K-Cosmetics/KPA 참조

---

## 1. 현 상태 요약

### 1-1. 핵심 아키텍처

```
┌─────────────────────────────────────────────────────────────┐
│                      사이버 매장 구조                        │
├─────────────────────────────────────────────────────────────┤
│  신청 → 승인 → 개설 → 설정 → 공개                            │
│    │      │      │      │      │                            │
│    │      │      │      │      └─ /store/:slug (Public)    │
│    │      │      │      └─ PharmacySettings (템플릿/테마)   │
│    │      │      └─ GlycopharmPharmacy (slug 자동생성)      │
│    │      └─ ApplicationDetailPage (승인/반려)              │
│    └─ PharmacyApplyPage (slug 입력 없음)                   │
└─────────────────────────────────────────────────────────────┘
```

### 1-2. 서비스별 현황

| 서비스 | 신청/승인 DB | 신청 API | slug DB | storefront_config |
|--------|------------|---------|---------|-------------------|
| GlycoPharm | ✅ | ✅ | ✅ JSONB | ✅ JSONB |
| K-Cosmetics | ✅ | ✅ | ✅ varchar | ❌ 없음 |
| KPA | ❌ | ❌ | ❌ 없음 | ✅ JSONB |

---

## 2. GAP 체크리스트

### 2-1. 신청(Workflow) GAP

| 항목 | DB | API | UI | 상태 | 우선순위 |
|------|-----|-----|-----|------|----------|
| 신청 엔티티/테이블 | ✅ glycopharm_applications | ✅ POST /applications | ✅ PharmacyApplyPage | **구현됨** | - |
| 서브디렉토리(slug) 입력 | ❌ 필드 없음 | ❌ 필드 없음 | ❌ UI 없음 | **미구현** | P0 |
| slug 중복 체크 | 승인 시 내부 | ❌ 별도 API 없음 | ❌ 미리 확인 불가 | **미구현** | P0 |
| 예약어 체크 | ❌ | ❌ | ❌ | **미구현** | P1 |
| 승인/반려 | ✅ status 필드 | ✅ PATCH /review | ✅ ApplicationDetailPage | **구현됨** | - |
| 반려 사유 기록 | ✅ rejection_reason | ✅ 필수 입력 | ✅ 모달 | **구현됨** | - |
| 보완 요청 | ❌ status 없음 | ❌ | ❌ | **미구현** | P2 |

### 2-2. 개설 GAP

| 항목 | DB | API | UI | 상태 | 우선순위 |
|------|-----|-----|-----|------|----------|
| 템플릿 선택 | ❌ 고정값 | ❌ 선택지 없음 | ✅ select (1개만) | **제한적** | P2 |
| 개설 시 기본값 생성 | ✅ slug 자동 | ✅ generateUniqueStoreSlug | - | **구현됨** | - |
| 개설 후 상태 | ✅ active/inactive | ✅ | ✅ 토글 | **구현됨** | - |
| 승인 시 slug 지정 | ❌ | ❌ | ❌ | **미구현** | P1 |

### 2-3. 설정(미세조정) GAP

| 항목 | DB | API | UI | 상태 | 우선순위 |
|------|-----|-----|-----|------|----------|
| 테마 색상 변경 | ✅ storefront_config.theme | ✅ PUT | ✅ select + 미리보기 | **구현됨** | - |
| 로고/배너 업로드 | ✅ logo, hero_image 컬럼 | ⚠️ 부분 | ⚠️ Hero만 | **부분 구현** | P2 |
| 섹션 구성 (hide/show) | ❌ | ❌ | ❌ | **미구현** | P2 |
| 키오스크 채널 | ❌ API 미연결 | ❌ TODO | ✅ UI만 | **미구현** | P1 |
| 태블릿 채널 | ❌ API 미연결 | ❌ TODO | ✅ UI만 | **미구현** | P1 |
| slug 변경 | ❌ | ❌ | ⚠️ input 있음 | **미구현** | P1 |

### 2-4. 운영/법적 GAP

| 항목 | DB | API | UI | 상태 | 우선순위 |
|------|-----|-----|-----|------|----------|
| 약관/개인정보 | ❌ | ❌ | ❌ | **미구현** | P1 (B2C 필수) |
| 배송/환불 정책 | ❌ | ❌ | ⚠️ "준비 중" | **미구현** | P1 (B2C 필수) |
| PG/결제 설정 | ❌ | ❌ | ⚠️ "준비 중" | **미구현** | P1 (B2C 필수) |
| 운영 로그/변경 이력 | ❌ | ❌ | ❌ | **미구현** | P2 |

---

## 3. 우선순위 정의

### P0 (막힘 - 서비스 성립 불가)

> 이것이 없으면 정상적인 매장 개설/운영 불가능

| 번호 | 항목 | 현재 상태 | 문제점 |
|------|------|----------|--------|
| P0-1 | **slug 신청 시 입력** | 미구현 | 신청자가 원하는 URL 지정 불가 |
| P0-2 | **slug 중복 체크 API** | 미구현 | 신청 전 가용성 확인 불가 |

### P1 (운영 리스크)

> 법적/보안/핵심 UX 이슈

| 번호 | 항목 | 현재 상태 | 문제점 |
|------|------|----------|--------|
| P1-1 | **slug 예약어 체크** | 미구현 | admin, api, store 등 예약어 충돌 가능 |
| P1-2 | **승인 시 slug 지정** | 미구현 | 운영자가 slug 조정 불가 |
| P1-3 | **slug 변경 API** | 미구현 | 개설 후 URL 변경 불가 |
| P1-4 | **약관/개인정보** | 미구현 | B2C 판매 시 법적 필수 |
| P1-5 | **배송/환불 정책** | 미구현 | B2C 판매 시 법적 필수 |
| P1-6 | **PG/결제 설정** | 미구현 | B2C 판매 시 필수 |
| P1-7 | **키오스크 채널 API** | 미구현 | UI만 있고 동작 안함 |
| P1-8 | **태블릿 채널 API** | 미구현 | UI만 있고 동작 안함 |

### P2 (확장/UX)

> 있으면 좋지만 필수 아님

| 번호 | 항목 | 현재 상태 |
|------|------|----------|
| P2-1 | 보완 요청 (supplementing) | 미구현 |
| P2-2 | 템플릿 선택 (다중) | 1개만 |
| P2-3 | 로고 업로드 UI | Hero만 |
| P2-4 | 섹션 hide/show | 미구현 |
| P2-5 | 운영 로그/변경 이력 | 미구현 |
| P2-6 | 전체 페이지 미리보기 | 미구현 |

---

## 4. 정비 권장 순서

### Phase A: slug 정책 완성 (P0 해소)

```
1. Application 엔티티에 requested_slug 필드 추가
2. 신청 API/UI에 slug 입력 추가
3. GET /stores/check-slug?slug=xxx API 추가
4. 예약어 목록 정의 및 검증 로직
5. 승인 API에 slug 지정 옵션 추가
6. 승인 UI에 slug 수정 필드 추가
```

### Phase B: B2C 법적 필수 (P1 일부)

```
1. 약관/개인정보/배송/환불 정책 DB 스키마
2. 정책 CRUD API
3. PharmacySettings에 정책 탭 추가
4. StoreFront 하단에 정책 링크 표시
```

### Phase C: 채널 확장 완성 (P1 나머지)

```
1. organization_channels 엔티티/API 완성
2. 키오스크/태블릿 신청 API 연결
3. 채널 승인 운영자 UI
4. 채널별 설정 저장 API
```

### Phase D: UX 개선 (P2)

```
1. 보완 요청 상태 추가
2. 템플릿 다중화
3. 섹션 구성 기능
4. 운영 로그
```

---

## 5. 참조 문서

| 문서 | 경로 |
|------|------|
| Phase 1: DB 조사 | `docs/investigations/IR-CYBER-STORE-PHASE1-DB-INVENTORY-V1.md` |
| Phase 2: API 조사 | `docs/investigations/IR-CYBER-STORE-PHASE2-API-INVENTORY-V1.md` |
| Phase 3: UI 조사 | `docs/investigations/IR-CYBER-STORE-PHASE3-UI-INVENTORY-V1.md` |

---

## 6. 결론

### 현재 가장 큰 GAP

> **slug(서브디렉토리) 정책이 불완전함**
> - 신청자가 원하는 URL 지정 불가
> - 신청 전 중복 확인 불가
> - 승인 시 운영자 조정 불가
> - 개설 후 변경 불가

### 즉시 조치 권장

1. **P0-1, P0-2**: slug 신청/중복체크 → 즉시 설계 착수
2. **P1-1, P1-2, P1-3**: slug 예약어/승인지정/변경 → Phase A로 묶어 처리
3. **P1-4~P1-6**: B2C 법적 요건 → Phase B로 별도 진행

---

*GAP 분석 완료 - 정비 Work Order 작성 가능*
