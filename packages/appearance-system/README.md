# @o4o/appearance-system

> **Single Source of Truth (SSOT)** for all appearance-related functionality in the O4O Platform

## Overview

This package consolidates design tokens, CSS generation logic, and style injection utilities that were previously scattered across multiple applications.

### What's Inside

- **Design Tokens** - Color, spacing, typography, and other design system values
- **CSS Generators** - Functions to generate CSS from tokens
- **Style Injection** - Utilities for injecting styles into the DOM or SSR

## Installation

This is an internal monorepo package. It's automatically available to all apps in the workspace.

```bash
pnpm install
```

## Usage

### Importing

```typescript
// Recommended: Use the short alias
import { defaultTokens, generateAllCSS, injectCSS } from '@o4o/appearance';

// Also available: Full package name
import { defaultTokens } from '@o4o/appearance-system';
```

### Basic Example

```typescript
import { defaultTokens, generateAllCSS, injectCSS, STYLE_IDS } from '@o4o/appearance';

// Generate CSS from design tokens
const css = generateAllCSS(defaultTokens);

// Inject into the DOM
injectCSS(css, STYLE_IDS.APPEARANCE_SYSTEM);
```

### Custom Tokens

```typescript
import { generateAllCSS, defaultTokens, type DesignTokens } from '@o4o/appearance';

// Override default tokens
const customTokens: DesignTokens = {
  ...defaultTokens,
  colors: {
    ...defaultTokens.colors,
    primary: '#ff0000',
  },
};

const css = generateAllCSS(customTokens);
```

## Rules and Best Practices

### ✅ DO

- Import design tokens from this package
- Use CSS variables generated by this package
- Keep all appearance logic centralized here
- Update tokens through the SSOT (this package)

### ❌ DO NOT

- Hardcode colors, spacing, or other design values in components
- Use legacy CSS variables directly (`--wp-*`, `--ast-*`)
- Create new CSS generation functions outside this package
- Duplicate appearance logic in individual apps

### Migration Path

**Phase 1 (Current)**: Package setup and structure
**Phase 2**: Migrate existing CSS generators from apps
**Phase 3**: Update components to use CSS variables
**Phase 4**: Standardize naming (`--o4o-*` convention)
**Phase 5**: Documentation and cleanup

## Architecture

```
@o4o/appearance-system/
├── src/
│   ├── tokens.ts          # Design token definitions (SSOT)
│   ├── css-generators.ts  # CSS generation functions
│   ├── inject.ts          # Style injection utilities
│   └── index.ts           # Public API
├── package.json
├── tsconfig.json
└── README.md
```

## Development

### Build

```bash
pnpm build
```

### Type Check

```bash
pnpm type-check
```

### Lint

```bash
pnpm lint
```

## Related Documentation

- [APPEARANCE_TOKENS.md](/docs/APPEARANCE_TOKENS.md) - Complete token reference
- [APPEARANCE_CLEANUP_PLAN.md](/docs/APPEARANCE_CLEANUP_PLAN.md) - Migration strategy
- [APPEARANCE_INVESTIGATION.md](/docs/APPEARANCE_INVESTIGATION.md) - Technical analysis

## Legacy Systems

This package replaces and consolidates:

1. `apps/admin-dashboard/src/lib/appearance/*`
2. `apps/main-site/src/utils/css-generator.ts`
3. `apps/api-server/src/utils/customizer/*`

**Do not create new appearance logic in these locations.** All new development should use this package.

## Troubleshooting

### Import not found

Make sure the package is built:

```bash
cd packages/appearance-system
pnpm build
```

### Type errors

Clear TypeScript cache and rebuild:

```bash
rm -rf packages/appearance-system/dist
rm -rf packages/appearance-system/tsconfig.tsbuildinfo
pnpm build
```

## Support

For questions or issues, refer to the documentation or contact the platform team.

---

**Status**: Phase 1 - Active Development
**Last Updated**: 2024-11-06
